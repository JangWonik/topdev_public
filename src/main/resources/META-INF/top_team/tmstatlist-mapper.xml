<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="TopTeamMapper">

	<select id="getAllTeam" resultType ="kr.co.toplac.topteam.TopTmBscVO">
		SELECT d.cnt, e.*
		FROM (SELECT sum(c.cnt) cnt, c.team_group_order
		      FROM (SELECT (SELECT count(*) FROM top_mbr_bsc WHERE user_state != 1 AND team_id_loc = a.team_id) cnt, a.team_group_order
		            FROM top_tm_bsc a) c
		            GROUP BY c.team_group_order) d, top_tm_bsc e
		WHERE e.team_level = 0
		AND e.team_group_order = d.team_group_order
		
		UNION ALL
		
		SELECT (SELECT count(*) FROM top_mbr_bsc WHERE user_state != 1 AND team_id_loc = a.team_id) cnt, a.*
		FROM top_tm_bsc a
		WHERE a.team_level > 0
		  AND a.only_statistics = 0
		  AND a.only_statistics = 0
		ORDER BY team_group_order DESC, team_order DESC, team_level
	</select>

	<select id="countAllWorkMember" parameterType="String" resultType="String">
		SELECT 
			count(*)
		FROM
			top_mbr_bsc
		WHERE
			user_state = 0
	</select>

	<select id="countAllPendingMember" parameterType="String" resultType="String">
		SELECT 
			count(*)
		FROM
			top_mbr_bsc
		WHERE
			user_state = 2
	</select>

	<select id="countAllRetireMember" parameterType="String" resultType="String">
		SELECT 
			count(*)
		FROM
			top_mbr_bsc
		WHERE
			user_state = 1
	</select>

</mapper>
