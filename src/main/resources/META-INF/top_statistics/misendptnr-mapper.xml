<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="MisEndPtnrMapper">

	<select id="selectTeamNameByTeamId" parameterType="String" resultType="String">
		SELECT 
			team_name
		FROM top_tm_bsc
		WHERE team_id = #{team_id}
	</select>

	<select id="selectCenterNameByTeamCenter" parameterType="String" resultType="String">
		SELECT 
			col_val AS center_name
		FROM sysadm_codedic 
		WHERE tbl_nm = 'top_tm_bsc' 
		AND col_nm = 'team_center'
		AND col_cd =  #{team_center}
	</select>

	<select id="selectPtnrNameByPtnrId" parameterType="String" resultType="String">
		SELECT 
			ptnr_nick AS ptnr_name
		FROM top_ptnr_bsc 
		WHERE ptnr_id = #{ptnr_id}
	</select>

	<!-- 물보험 심사 별도 종결 데이터 가져오기 -->
	<select id="MisEndPtnr1WrittenExtra" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT			
			IFNULL(SUM(GA.cls_12),0) AS cls_12			
			,IFNULL(SUM(GA.cls_11),0) AS cls_11			
			,IFNULL(SUM(GA.cls_10),0) AS cls_10			
			,IFNULL(SUM(GA.cls_9),0) AS cls_9			
			,IFNULL(SUM(GA.cls_8),0) AS cls_8			
			,IFNULL(SUM(GA.cls_7),0) AS cls_7			
			,IFNULL(SUM(GA.cls_6),0) AS cls_6			
			,IFNULL(SUM(GA.cls_5),0) AS cls_5			
			,IFNULL(SUM(GA.cls_4),0) AS cls_4			
			,IFNULL(SUM(GA.cls_3),0) AS cls_3			
			,IFNULL(SUM(GA.cls_2),0) AS cls_2			
			,IFNULL(SUM(GA.cls_1),0) AS cls_1			
		FROM(
			SELECT
				IFNULL(SUM(end_cnt),0) AS cls_12				
				,0 AS cls_11				
				,0 AS cls_10				
				,0 AS cls_9				
				,0 AS cls_8				
				,0 AS cls_7				
				,0 AS cls_6				
				,0 AS cls_5				
				,0 AS cls_4				
				,0 AS cls_3				
				,0 AS cls_2				
				,0 AS cls_1
			FROM top_rpt_written_info
			WHERE 1=1						
			AND base_date >= #{monBefore12}
			AND base_date &lt; #{monBefore11}
			AND ptnr_id = #{ptnr_id}
			
			UNION ALL
			
			SELECT		
				0 AS cls_12				
				,IFNULL(SUM(end_cnt),0) AS cls_11				
				,0 AS cls_10				
				,0 AS cls_9				
				,0 AS cls_8				
				,0 AS cls_7				
				,0 AS cls_6				
				,0 AS cls_5				
				,0 AS cls_4				
				,0 AS cls_3				
				,0 AS cls_2				
				,0 AS cls_1
			FROM top_rpt_written_info
			WHERE 1=1						
			AND base_date >= #{monBefore11}
			AND base_date &lt; #{monBefore10}
			AND ptnr_id = #{ptnr_id}
			
			UNION ALL
			
			SELECT		
				0 AS cls_12				
				,0 AS cls_11				
				,IFNULL(SUM(end_cnt),0) AS cls_10				
				,0 AS cls_9				
				,0 AS cls_8				
				,0 AS cls_7				
				,0 AS cls_6				
				,0 AS cls_5				
				,0 AS cls_4				
				,0 AS cls_3				
				,0 AS cls_2				
				,0 AS cls_1
			FROM top_rpt_written_info
			WHERE 1=1						
			AND base_date >= #{monBefore10}
			AND base_date &lt; #{monBefore9}
			AND ptnr_id = #{ptnr_id}
			
			UNION ALL
			
			SELECT		
				0 AS cls_12				
				,0 AS cls_11				
				,0 AS cls_10				
				,IFNULL(SUM(end_cnt),0) AS cls_9				
				,0 AS cls_8				
				,0 AS cls_7				
				,0 AS cls_6				
				,0 AS cls_5				
				,0 AS cls_4				
				,0 AS cls_3				
				,0 AS cls_2				
				,0 AS cls_1
			FROM top_rpt_written_info
			WHERE 1=1						
			AND base_date >= #{monBefore9}
			AND base_date &lt; #{monBefore8}
			AND ptnr_id = #{ptnr_id}
			
			UNION ALL
			
			SELECT		
				0 AS cls_12				
				,0 AS cls_11				
				,0 AS cls_10				
				,0 AS cls_9				
				,IFNULL(SUM(end_cnt),0) AS cls_8				
				,0 AS cls_7				
				,0 AS cls_6				
				,0 AS cls_5				
				,0 AS cls_4				
				,0 AS cls_3				
				,0 AS cls_2				
				,0 AS cls_1
			FROM top_rpt_written_info
			WHERE 1=1						
			AND base_date >= #{monBefore8}
			AND base_date &lt; #{monBefore7}
			AND ptnr_id = #{ptnr_id}
			
			UNION ALL
			
			SELECT		
				0 AS cls_12				
				,0 AS cls_11				
				,0 AS cls_10				
				,0 AS cls_9				
				,0 AS cls_8				
				,IFNULL(SUM(end_cnt),0) AS cls_7
				,0 AS cls_6				
				,0 AS cls_5				
				,0 AS cls_4				
				,0 AS cls_3				
				,0 AS cls_2				
				,0 AS cls_1
			FROM top_rpt_written_info
			WHERE 1=1						
			AND base_date >= #{monBefore7}
			AND base_date &lt; #{monBefore6}
			AND ptnr_id = #{ptnr_id}
			
			UNION ALL
			
			SELECT		
				0 AS cls_12				
				,0 AS cls_11				
				,0 AS cls_10				
				,0 AS cls_9				
				,0 AS cls_8				
				,0 AS cls_7
				,IFNULL(SUM(end_cnt),0) AS cls_6				
				,0 AS cls_5				
				,0 AS cls_4				
				,0 AS cls_3				
				,0 AS cls_2				
				,0 AS cls_1
			FROM top_rpt_written_info
			WHERE 1=1						
			AND base_date >= #{monBefore6}
			AND base_date &lt; #{monBefore5}
			AND ptnr_id = #{ptnr_id}
			
			UNION ALL
			
			SELECT		
				0 AS cls_12				
				,0 AS cls_11				
				,0 AS cls_10				
				,0 AS cls_9				
				,0 AS cls_8				
				,0 AS cls_7
				,0 AS cls_6				
				,IFNULL(SUM(end_cnt),0) AS cls_5				
				,0 AS cls_4				
				,0 AS cls_3				
				,0 AS cls_2				
				,0 AS cls_1
			FROM top_rpt_written_info
			WHERE 1=1						
			AND base_date >= #{monBefore5}
			AND base_date &lt; #{monBefore4}
			AND ptnr_id = #{ptnr_id}
			
			UNION ALL
			
			SELECT		
				0 AS cls_12				
				,0 AS cls_11				
				,0 AS cls_10				
				,0 AS cls_9				
				,0 AS cls_8				
				,0 AS cls_7
				,0 AS cls_6				
				,0 AS cls_5				
				,IFNULL(SUM(end_cnt),0) AS cls_4				
				,0 AS cls_3				
				,0 AS cls_2				
				,0 AS cls_1
			FROM top_rpt_written_info
			WHERE 1=1						
			AND base_date >= #{monBefore4}
			AND base_date &lt; #{monBefore3}
			AND ptnr_id = #{ptnr_id}
			
			UNION ALL
			
			SELECT		
				0 AS cls_12				
				,0 AS cls_11				
				,0 AS cls_10				
				,0 AS cls_9				
				,0 AS cls_8				
				,0 AS cls_7
				,0 AS cls_6				
				,0 AS cls_5				
				,0 AS cls_4				
				,IFNULL(SUM(end_cnt),0) AS cls_3				
				,0 AS cls_2				
				,0 AS cls_1
			FROM top_rpt_written_info
			WHERE 1=1						
			AND base_date >= #{monBefore3}
			AND base_date &lt; #{monBefore2}
			AND ptnr_id = #{ptnr_id}
			
			UNION ALL
			
			SELECT		
				0 AS cls_12				
				,0 AS cls_11				
				,0 AS cls_10				
				,0 AS cls_9				
				,0 AS cls_8				
				,0 AS cls_7
				,0 AS cls_6				
				,0 AS cls_5				
				,0 AS cls_4				
				,0 AS cls_3				
				,IFNULL(SUM(end_cnt),0) AS cls_2				
				,0 AS cls_1
			FROM top_rpt_written_info
			WHERE 1=1						
			AND base_date >= #{monBefore2}
			AND base_date &lt; #{monBefore1}
			AND ptnr_id = #{ptnr_id}
			
			UNION ALL
			
			SELECT		
				0 AS cls_12				
				,0 AS cls_11				
				,0 AS cls_10				
				,0 AS cls_9				
				,0 AS cls_8				
				,0 AS cls_7
				,0 AS cls_6				
				,0 AS cls_5				
				,0 AS cls_4				
				,0 AS cls_3				
				,0 AS cls_2				
				,IFNULL(SUM(end_cnt),0) AS cls_1
			FROM top_rpt_written_info
			WHERE 1=1						
			AND base_date >= #{monBefore1}
			AND base_date &lt; #{monBefore0}
			AND ptnr_id = #{ptnr_id}			
			
		)GA
	</select>
	
	<!-- 보험사별 통계 좌측 rowspan 수를 v_ptnr_stat_cnt view 에서 계산 해 온다. -->
	<select id="ptnrLeftRowCnt" resultType="integer">
		SELECT
			SUM(PT.ptnr_cnt) AS nRowCnt
		FROM(
			SELECT
				SUM(ptnr_row_cnt) AS ptnr_cnt
			FROM v_ptnr_stat_cnt
		
			UNION
		
			SELECT
				COUNT(*) AS ptnr_cnt
			FROM v_ptnr_stat_cnt
			WHERE ptnr_row_cnt > 1
		)PT
	</select>
	
	<!-- 보험사별 교통비 신규 : 물보험 20230613-->
	<select id="PtnrStatTraffic" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			PA.ptnr_id			
			,CAST(PA.ptnr_id_sub AS SIGNED INTEGER) AS ptnr_id_sub
			,PA.period_flag_code
			,PA.ptnr_nick
			,PA.ptnr_id_sub_nm
			,PA.period_flag_nm
			,PA.ptnr_row_cnt
			,IFNULL(GB.TRAFFIC_12,0) AS TRAFFIC_12
			,IFNULL(GB.TRAFFIC_11,0) AS TRAFFIC_11
			,IFNULL(GB.TRAFFIC_10,0) AS TRAFFIC_10
			,IFNULL(GB.TRAFFIC_09,0) AS TRAFFIC_09
			,IFNULL(GB.TRAFFIC_08,0) AS TRAFFIC_08
			,IFNULL(GB.TRAFFIC_07,0) AS TRAFFIC_07
			,IFNULL(GB.TRAFFIC_06,0) AS TRAFFIC_06
			,IFNULL(GB.TRAFFIC_05,0) AS TRAFFIC_05
			,IFNULL(GB.TRAFFIC_04,0) AS TRAFFIC_04
			,IFNULL(GB.TRAFFIC_03,0) AS TRAFFIC_03
			,IFNULL(GB.TRAFFIC_02,0) AS TRAFFIC_02
			,IFNULL(GB.TRAFFIC_01,0) AS TRAFFIC_01	
		FROM v_ptnr_stat PA
		LEFT JOIN
		(
			SELECT
				GA.ptnr_id
				,GA.ptnr_id_sub
				,GA.div_type
				,GA.period_flag
				,GA.suim_rpt_no
				,SUM(GA.TRAFFIC_12) AS TRAFFIC_12
				,SUM(GA.TRAFFIC_11) AS TRAFFIC_11
				,SUM(GA.TRAFFIC_10) AS TRAFFIC_10
				,SUM(GA.TRAFFIC_09) AS TRAFFIC_09
				,SUM(GA.TRAFFIC_08) AS TRAFFIC_08
				,SUM(GA.TRAFFIC_07) AS TRAFFIC_07
				,SUM(GA.TRAFFIC_06) AS TRAFFIC_06
				,SUM(GA.TRAFFIC_05) AS TRAFFIC_05
				,SUM(GA.TRAFFIC_04) AS TRAFFIC_04
				,SUM(GA.TRAFFIC_03) AS TRAFFIC_03
				,SUM(GA.TRAFFIC_02) AS TRAFFIC_02
				,SUM(GA.TRAFFIC_01) AS TRAFFIC_01	
			FROM
			(	
			
				SELECT
					"" AS ptnr_id
					,"" AS ptnr_id_sub
					,"" AS div_type
					,"" AS period_flag
					,"" AS suim_rpt_no  			
					,0 AS TRAFFIC_12
					,0 AS TRAFFIC_11
					,0 AS TRAFFIC_10
					,0 AS TRAFFIC_09
					,0 AS TRAFFIC_08
					,0 AS TRAFFIC_07
					,0 AS TRAFFIC_06
					,0 AS TRAFFIC_05
					,0 AS TRAFFIC_04
					,0 AS TRAFFIC_03
					,0 AS TRAFFIC_02
					,0 AS TRAFFIC_01
				FROM  DUAL
				
				<if test='basicYN == "Y"'>					
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_12
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_11
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_10
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_09
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_08
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_07
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_06
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_05
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_04
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_03
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_02
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_01	
				FROM v_top_rpt_head_type A
				INNER JOIN top_tm_bsc B
				ON A.team_id = B.team_id
				INNER JOIN top_rpt_invoice C
				ON A.suim_rpt_no = C.suim_rpt_no
				WHERE 1=1
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}				
				</if>				
				<if test='primYN == "Y" and div_type == "5"'>				
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub					
					,"5" AS div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_12
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_11
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_10
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_09
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_08
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_07
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_06
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_05
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_04
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_03
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_02
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_01
				FROM top_prim_biz_rpt_head A
				INNER JOIN top_tm_bsc B
				ON A.team_id = B.team_id
				INNER JOIN top_prim_biz_inv C
				ON A.suim_rpt_no = C.suim_rpt_no
				WHERE 1=1
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})								
				</if>
			)GA
			GROUP BY GA.ptnr_id, GA.ptnr_id_sub, GA.period_flag
		)GB
		ON PA.ptnr_id = GB.ptnr_id
		AND PA.ptnr_id_sub = GB.ptnr_id_sub
		AND PA.period_flag_code = GB.period_flag
	</select>
	
	<!-- 보험사별 총합계 신규 : 물보험 20230613-->
	<select id="PtnrStatEntire" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			PA.ptnr_id			
			,CAST(PA.ptnr_id_sub AS SIGNED INTEGER) AS ptnr_id_sub
			,PA.period_flag_code
			,PA.ptnr_nick
			,PA.ptnr_id_sub_nm
			,PA.period_flag_nm
			,PA.ptnr_row_cnt
			,IFNULL(GB.ENTIRE_12,0) AS ENTIRE_12
			,IFNULL(GB.ENTIRE_11,0) AS ENTIRE_11
			,IFNULL(GB.ENTIRE_10,0) AS ENTIRE_10
			,IFNULL(GB.ENTIRE_09,0) AS ENTIRE_09
			,IFNULL(GB.ENTIRE_08,0) AS ENTIRE_08
			,IFNULL(GB.ENTIRE_07,0) AS ENTIRE_07
			,IFNULL(GB.ENTIRE_06,0) AS ENTIRE_06
			,IFNULL(GB.ENTIRE_05,0) AS ENTIRE_05
			,IFNULL(GB.ENTIRE_04,0) AS ENTIRE_04
			,IFNULL(GB.ENTIRE_03,0) AS ENTIRE_03
			,IFNULL(GB.ENTIRE_02,0) AS ENTIRE_02
			,IFNULL(GB.ENTIRE_01,0) AS ENTIRE_01	
		FROM v_ptnr_stat PA
		LEFT JOIN
		(
			SELECT
				GA.ptnr_id
				,GA.ptnr_id_sub
				,GA.div_type
				,GA.period_flag
				,GA.suim_rpt_no
				,SUM(GA.ENTIRE_12) AS ENTIRE_12
				,SUM(GA.ENTIRE_11) AS ENTIRE_11
				,SUM(GA.ENTIRE_10) AS ENTIRE_10
				,SUM(GA.ENTIRE_09) AS ENTIRE_09
				,SUM(GA.ENTIRE_08) AS ENTIRE_08
				,SUM(GA.ENTIRE_07) AS ENTIRE_07
				,SUM(GA.ENTIRE_06) AS ENTIRE_06
				,SUM(GA.ENTIRE_05) AS ENTIRE_05
				,SUM(GA.ENTIRE_04) AS ENTIRE_04
				,SUM(GA.ENTIRE_03) AS ENTIRE_03
				,SUM(GA.ENTIRE_02) AS ENTIRE_02
				,SUM(GA.ENTIRE_01) AS ENTIRE_01	
			FROM
			(	
			
				SELECT
					"" AS ptnr_id
					,"" AS ptnr_id_sub
					,"" AS div_type
					,"" AS period_flag
					,"" AS suim_rpt_no  			
					,0 AS ENTIRE_12
					,0 AS ENTIRE_11
					,0 AS ENTIRE_10
					,0 AS ENTIRE_09
					,0 AS ENTIRE_08
					,0 AS ENTIRE_07
					,0 AS ENTIRE_06
					,0 AS ENTIRE_05
					,0 AS ENTIRE_04
					,0 AS ENTIRE_03
					,0 AS ENTIRE_02
					,0 AS ENTIRE_01
				FROM  DUAL
				
				<if test='basicYN == "Y"'>					
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_total ELSE 0 END AS ENTIRE_12
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_total ELSE 0 END AS ENTIRE_11
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_total ELSE 0 END AS ENTIRE_10
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_total ELSE 0 END AS ENTIRE_09
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_total ELSE 0 END AS ENTIRE_08
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_total ELSE 0 END AS ENTIRE_07
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_total ELSE 0 END AS ENTIRE_06
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_total ELSE 0 END AS ENTIRE_05
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_total ELSE 0 END AS ENTIRE_04
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_total ELSE 0 END AS ENTIRE_03
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_total ELSE 0 END AS ENTIRE_02
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_total ELSE 0 END AS ENTIRE_01	
				FROM v_top_rpt_head_type A
				INNER JOIN top_tm_bsc B
				ON A.team_id = B.team_id
				INNER JOIN top_rpt_invoice C
				ON A.suim_rpt_no = C.suim_rpt_no
				WHERE 1=1
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}				
				</if>				
				<if test='primYN == "Y" and div_type == "5"'>				
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub					
					,"5" AS div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_total ELSE 0 END AS ENTIRE_12
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_total ELSE 0 END AS ENTIRE_11
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_total ELSE 0 END AS ENTIRE_10
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_total ELSE 0 END AS ENTIRE_09
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_total ELSE 0 END AS ENTIRE_08
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_total ELSE 0 END AS ENTIRE_07
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_total ELSE 0 END AS ENTIRE_06
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_total ELSE 0 END AS ENTIRE_05
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_total ELSE 0 END AS ENTIRE_04
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_total ELSE 0 END AS ENTIRE_03
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_total ELSE 0 END AS ENTIRE_02
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_total ELSE 0 END AS ENTIRE_01
				FROM top_prim_biz_rpt_head A
				INNER JOIN top_tm_bsc B
				ON A.team_id = B.team_id
				INNER JOIN top_prim_biz_inv C
				ON A.suim_rpt_no = C.suim_rpt_no
				WHERE 1=1
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})								
				</if>
			)GA
			GROUP BY GA.ptnr_id, GA.ptnr_id_sub, GA.period_flag
		)GB
		ON PA.ptnr_id = GB.ptnr_id
		AND PA.ptnr_id_sub = GB.ptnr_id_sub
		AND PA.period_flag_code = GB.period_flag
	</select>
	
	<!-- 보험사별 자문료+기타 신규 : 물보험 20230613-->
	<select id="PtnrStatEtc" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			PA.ptnr_id			
			,CAST(PA.ptnr_id_sub AS SIGNED INTEGER) AS ptnr_id_sub
			,PA.period_flag_code
			,PA.ptnr_nick
			,PA.ptnr_id_sub_nm
			,PA.period_flag_nm
			,PA.ptnr_row_cnt
			,IFNULL(GB.ETC_12,0) AS ETC_12
			,IFNULL(GB.ETC_11,0) AS ETC_11
			,IFNULL(GB.ETC_10,0) AS ETC_10
			,IFNULL(GB.ETC_09,0) AS ETC_09
			,IFNULL(GB.ETC_08,0) AS ETC_08
			,IFNULL(GB.ETC_07,0) AS ETC_07
			,IFNULL(GB.ETC_06,0) AS ETC_06
			,IFNULL(GB.ETC_05,0) AS ETC_05
			,IFNULL(GB.ETC_04,0) AS ETC_04
			,IFNULL(GB.ETC_03,0) AS ETC_03
			,IFNULL(GB.ETC_02,0) AS ETC_02
			,IFNULL(GB.ETC_01,0) AS ETC_01	
		FROM v_ptnr_stat PA
		LEFT JOIN
		(
			SELECT
				GA.ptnr_id
				,GA.ptnr_id_sub
				,GA.div_type
				,GA.period_flag
				,GA.suim_rpt_no
				,SUM(GA.ETC_12) AS ETC_12
				,SUM(GA.ETC_11) AS ETC_11
				,SUM(GA.ETC_10) AS ETC_10
				,SUM(GA.ETC_09) AS ETC_09
				,SUM(GA.ETC_08) AS ETC_08
				,SUM(GA.ETC_07) AS ETC_07
				,SUM(GA.ETC_06) AS ETC_06
				,SUM(GA.ETC_05) AS ETC_05
				,SUM(GA.ETC_04) AS ETC_04
				,SUM(GA.ETC_03) AS ETC_03
				,SUM(GA.ETC_02) AS ETC_02
				,SUM(GA.ETC_01) AS ETC_01	
			FROM
			(	
			
				SELECT
					"" AS ptnr_id
					,"" AS ptnr_id_sub
					,"" AS div_type
					,"" AS period_flag
					,"" AS suim_rpt_no  			
					,0 AS ETC_12
					,0 AS ETC_11
					,0 AS ETC_10
					,0 AS ETC_09
					,0 AS ETC_08
					,0 AS ETC_07
					,0 AS ETC_06
					,0 AS ETC_05
					,0 AS ETC_04
					,0 AS ETC_03
					,0 AS ETC_02
					,0 AS ETC_01
				FROM  DUAL
				
				<if test='basicYN == "Y"'>					
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_12
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_11
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_10
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_09
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_08
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_07
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_06
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_05
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_04
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_03
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_02
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_01	
				FROM v_top_rpt_head_type A
				INNER JOIN top_tm_bsc B
				ON A.team_id = B.team_id
				INNER JOIN top_rpt_invoice C
				ON A.suim_rpt_no = C.suim_rpt_no
				WHERE 1=1
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}				
				</if>				
				<if test='primYN == "Y" and div_type == "5"'>				
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub					
					,"5" AS div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_12
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_11
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_10
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_09
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_08
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_07
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_06
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_05
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_04
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_03
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_02
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_01
				FROM top_prim_biz_rpt_head A
				INNER JOIN top_tm_bsc B
				ON A.team_id = B.team_id
				INNER JOIN top_prim_biz_inv C
				ON A.suim_rpt_no = C.suim_rpt_no
				WHERE 1=1
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})								
				</if>
			)GA
			GROUP BY GA.ptnr_id, GA.ptnr_id_sub, GA.period_flag
		)GB
		ON PA.ptnr_id = GB.ptnr_id
		AND PA.ptnr_id_sub = GB.ptnr_id_sub
		AND PA.period_flag_code = GB.period_flag
	</select>
	
	<!-- 보험사별 건당 일비 신규 : 물보험 20230621-->
	<select id="PtnrStatCntTime" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			GC.ptnr_id			
			,GC.ptnr_id_sub
			,GC.period_flag_code
			,GC.ptnr_nick
			,GC.ptnr_id_sub_nm
			,GC.period_flag_nm
			,GC.ptnr_row_cnt
			
			,IFNULL(ROUND(GC.TIME_12 / GC.END_12),0) AS CNT_TIME_12
			,IFNULL(ROUND(GC.TIME_11 / GC.END_11),0) AS CNT_TIME_11
			,IFNULL(ROUND(GC.TIME_10 / GC.END_10),0) AS CNT_TIME_10
			,IFNULL(ROUND(GC.TIME_09 / GC.END_09),0) AS CNT_TIME_09
			,IFNULL(ROUND(GC.TIME_08 / GC.END_08),0) AS CNT_TIME_08
			,IFNULL(ROUND(GC.TIME_07 / GC.END_07),0) AS CNT_TIME_07
			,IFNULL(ROUND(GC.TIME_06 / GC.END_06),0) AS CNT_TIME_06
			,IFNULL(ROUND(GC.TIME_05 / GC.END_05),0) AS CNT_TIME_05
			,IFNULL(ROUND(GC.TIME_04 / GC.END_04),0) AS CNT_TIME_04
			,IFNULL(ROUND(GC.TIME_03 / GC.END_03),0) AS CNT_TIME_03
			,IFNULL(ROUND(GC.TIME_02 / GC.END_02),0) AS CNT_TIME_02
			,IFNULL(ROUND(GC.TIME_01 / GC.END_01),0) AS CNT_TIME_01
			
			,GC.TIME_12
			,GC.TIME_11
			,GC.TIME_10
			,GC.TIME_09
			,GC.TIME_08
			,GC.TIME_07
			,GC.TIME_06
			,GC.TIME_05
			,GC.TIME_04
			,GC.TIME_03
			,GC.TIME_02
			,GC.TIME_01
			
			,GC.END_12
			,GC.END_11
			,GC.END_10
			,GC.END_09
			,GC.END_08
			,GC.END_07
			,GC.END_06
			,GC.END_05
			,GC.END_04
			,GC.END_03
			,GC.END_02
			,GC.END_01
			
		FROM
		(	
			SELECT
				PA.ptnr_id			
				,CAST(PA.ptnr_id_sub AS SIGNED INTEGER) AS ptnr_id_sub
				,PA.period_flag_code
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				,PA.period_flag_nm
				,PA.ptnr_row_cnt
				,IFNULL(GB.TIME_12,0) AS TIME_12
				,IFNULL(GB.TIME_11,0) AS TIME_11
				,IFNULL(GB.TIME_10,0) AS TIME_10
				,IFNULL(GB.TIME_09,0) AS TIME_09
				,IFNULL(GB.TIME_08,0) AS TIME_08
				,IFNULL(GB.TIME_07,0) AS TIME_07
				,IFNULL(GB.TIME_06,0) AS TIME_06
				,IFNULL(GB.TIME_05,0) AS TIME_05
				,IFNULL(GB.TIME_04,0) AS TIME_04
				,IFNULL(GB.TIME_03,0) AS TIME_03
				,IFNULL(GB.TIME_02,0) AS TIME_02
				,IFNULL(GB.TIME_01,0) AS TIME_01	
				
				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01
			FROM v_ptnr_stat PA
			LEFT JOIN
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type
					,GA.period_flag
					,GA.suim_rpt_no
					,SUM(GA.TIME_12) AS TIME_12
					,SUM(GA.TIME_11) AS TIME_11
					,SUM(GA.TIME_10) AS TIME_10
					,SUM(GA.TIME_09) AS TIME_09
					,SUM(GA.TIME_08) AS TIME_08
					,SUM(GA.TIME_07) AS TIME_07
					,SUM(GA.TIME_06) AS TIME_06
					,SUM(GA.TIME_05) AS TIME_05
					,SUM(GA.TIME_04) AS TIME_04
					,SUM(GA.TIME_03) AS TIME_03
					,SUM(GA.TIME_02) AS TIME_02
					,SUM(GA.TIME_01) AS TIME_01
					
					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type
						,"" AS period_flag
						,"" AS suim_rpt_no  			
						,0 AS TIME_12
						,0 AS TIME_11
						,0 AS TIME_10
						,0 AS TIME_09
						,0 AS TIME_08
						,0 AS TIME_07
						,0 AS TIME_06
						,0 AS TIME_05
						,0 AS TIME_04
						,0 AS TIME_03
						,0 AS TIME_02
						,0 AS TIME_01
						
						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type
						,A.period_flag
						,A.suim_rpt_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01
						
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND A.suim_rpt_state != 3
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub					
						,"5" AS div_type
						,A.period_flag
						,A.suim_rpt_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01
						
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND A.suim_rpt_state != 3
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})								
					</if>
				)GA
				GROUP BY GA.ptnr_id, GA.ptnr_id_sub, GA.period_flag
			)GB
			ON PA.ptnr_id = GB.ptnr_id
			AND PA.ptnr_id_sub = GB.ptnr_id_sub
			AND PA.period_flag_code = GB.period_flag
		)GC
	</select>
	
	<!-- 보험사별 일비 신규 : 물보험 20230613-->
	<select id="PtnrStatTime" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			PA.ptnr_id			
			,CAST(PA.ptnr_id_sub AS SIGNED INTEGER) AS ptnr_id_sub
			,PA.period_flag_code
			,PA.ptnr_nick
			,PA.ptnr_id_sub_nm
			,PA.period_flag_nm
			,PA.ptnr_row_cnt
			,IFNULL(GB.TIME_12,0) AS TIME_12
			,IFNULL(GB.TIME_11,0) AS TIME_11
			,IFNULL(GB.TIME_10,0) AS TIME_10
			,IFNULL(GB.TIME_09,0) AS TIME_09
			,IFNULL(GB.TIME_08,0) AS TIME_08
			,IFNULL(GB.TIME_07,0) AS TIME_07
			,IFNULL(GB.TIME_06,0) AS TIME_06
			,IFNULL(GB.TIME_05,0) AS TIME_05
			,IFNULL(GB.TIME_04,0) AS TIME_04
			,IFNULL(GB.TIME_03,0) AS TIME_03
			,IFNULL(GB.TIME_02,0) AS TIME_02
			,IFNULL(GB.TIME_01,0) AS TIME_01	
		FROM v_ptnr_stat PA
		LEFT JOIN
		(
			SELECT
				GA.ptnr_id
				,GA.ptnr_id_sub
				,GA.div_type
				,GA.period_flag
				,GA.suim_rpt_no
				,SUM(GA.TIME_12) AS TIME_12
				,SUM(GA.TIME_11) AS TIME_11
				,SUM(GA.TIME_10) AS TIME_10
				,SUM(GA.TIME_09) AS TIME_09
				,SUM(GA.TIME_08) AS TIME_08
				,SUM(GA.TIME_07) AS TIME_07
				,SUM(GA.TIME_06) AS TIME_06
				,SUM(GA.TIME_05) AS TIME_05
				,SUM(GA.TIME_04) AS TIME_04
				,SUM(GA.TIME_03) AS TIME_03
				,SUM(GA.TIME_02) AS TIME_02
				,SUM(GA.TIME_01) AS TIME_01	
			FROM
			(	
			
				SELECT
					"" AS ptnr_id
					,"" AS ptnr_id_sub
					,"" AS div_type
					,"" AS period_flag
					,"" AS suim_rpt_no  			
					,0 AS TIME_12
					,0 AS TIME_11
					,0 AS TIME_10
					,0 AS TIME_09
					,0 AS TIME_08
					,0 AS TIME_07
					,0 AS TIME_06
					,0 AS TIME_05
					,0 AS TIME_04
					,0 AS TIME_03
					,0 AS TIME_02
					,0 AS TIME_01
				FROM  DUAL
				
				<if test='basicYN == "Y"'>					
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01	
				FROM v_top_rpt_head_type A
				INNER JOIN top_tm_bsc B
				ON A.team_id = B.team_id
				INNER JOIN top_rpt_invoice C
				ON A.suim_rpt_no = C.suim_rpt_no
				WHERE 1=1
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}				
				</if>				
				<if test='primYN == "Y" and div_type == "5"'>				
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub					
					,"5" AS div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01
				FROM top_prim_biz_rpt_head A
				INNER JOIN top_tm_bsc B
				ON A.team_id = B.team_id
				INNER JOIN top_prim_biz_inv C
				ON A.suim_rpt_no = C.suim_rpt_no
				WHERE 1=1
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})								
				</if>
			)GA
			GROUP BY GA.ptnr_id, GA.ptnr_id_sub, GA.period_flag
		)GB
		ON PA.ptnr_id = GB.ptnr_id
		AND PA.ptnr_id_sub = GB.ptnr_id_sub
		AND PA.period_flag_code = GB.period_flag
	</select>
	
	<!-- 보험사별 건당 순수피 신규 : 물보험 20230620-->
	<select id="PtnrStatCntFee" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			GC.ptnr_id			
			,GC.ptnr_id_sub
			,GC.period_flag_code
			,GC.ptnr_nick
			,GC.ptnr_id_sub_nm
			,GC.period_flag_nm
			,GC.ptnr_row_cnt
			
			,IFNULL(ROUND(GC.FEE_12 / GC.END_12),0) AS CNT_FEE_12
			,IFNULL(ROUND(GC.FEE_11 / GC.END_11),0) AS CNT_FEE_11
			,IFNULL(ROUND(GC.FEE_10 / GC.END_10),0) AS CNT_FEE_10
			,IFNULL(ROUND(GC.FEE_09 / GC.END_09),0) AS CNT_FEE_09
			,IFNULL(ROUND(GC.FEE_08 / GC.END_08),0) AS CNT_FEE_08
			,IFNULL(ROUND(GC.FEE_07 / GC.END_07),0) AS CNT_FEE_07
			,IFNULL(ROUND(GC.FEE_06 / GC.END_06),0) AS CNT_FEE_06
			,IFNULL(ROUND(GC.FEE_05 / GC.END_05),0) AS CNT_FEE_05
			,IFNULL(ROUND(GC.FEE_04 / GC.END_04),0) AS CNT_FEE_04
			,IFNULL(ROUND(GC.FEE_03 / GC.END_03),0) AS CNT_FEE_03
			,IFNULL(ROUND(GC.FEE_02 / GC.END_02),0) AS CNT_FEE_02
			,IFNULL(ROUND(GC.FEE_01 / GC.END_01),0) AS CNT_FEE_01			
			
			,GC.FEE_12
			,GC.FEE_11
			,GC.FEE_10
			,GC.FEE_09
			,GC.FEE_08
			,GC.FEE_07
			,GC.FEE_06
			,GC.FEE_05
			,GC.FEE_04
			,GC.FEE_03
			,GC.FEE_02
			,GC.FEE_01
			
			,GC.END_12
			,GC.END_11
			,GC.END_10
			,GC.END_09
			,GC.END_08
			,GC.END_07
			,GC.END_06
			,GC.END_05
			,GC.END_04
			,GC.END_03
			,GC.END_02
			,GC.END_01	
		FROM
		(
			SELECT
				PA.ptnr_id			
				,CAST(PA.ptnr_id_sub AS SIGNED INTEGER) AS ptnr_id_sub
				,PA.period_flag_code
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				,PA.period_flag_nm
				,PA.ptnr_row_cnt
				,IFNULL(GB.FEE_12,0) AS FEE_12
				,IFNULL(GB.FEE_11,0) AS FEE_11
				,IFNULL(GB.FEE_10,0) AS FEE_10
				,IFNULL(GB.FEE_09,0) AS FEE_09
				,IFNULL(GB.FEE_08,0) AS FEE_08
				,IFNULL(GB.FEE_07,0) AS FEE_07
				,IFNULL(GB.FEE_06,0) AS FEE_06
				,IFNULL(GB.FEE_05,0) AS FEE_05
				,IFNULL(GB.FEE_04,0) AS FEE_04
				,IFNULL(GB.FEE_03,0) AS FEE_03
				,IFNULL(GB.FEE_02,0) AS FEE_02
				,IFNULL(GB.FEE_01,0) AS FEE_01
				
				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01
			FROM v_ptnr_stat PA
			LEFT JOIN
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type
					,GA.period_flag
					,GA.suim_rpt_no
					,SUM(GA.FEE_12) AS FEE_12
					,SUM(GA.FEE_11) AS FEE_11
					,SUM(GA.FEE_10) AS FEE_10
					,SUM(GA.FEE_09) AS FEE_09
					,SUM(GA.FEE_08) AS FEE_08
					,SUM(GA.FEE_07) AS FEE_07
					,SUM(GA.FEE_06) AS FEE_06
					,SUM(GA.FEE_05) AS FEE_05
					,SUM(GA.FEE_04) AS FEE_04
					,SUM(GA.FEE_03) AS FEE_03
					,SUM(GA.FEE_02) AS FEE_02
					,SUM(GA.FEE_01) AS FEE_01
					
					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type
						,"" AS period_flag
						,"" AS suim_rpt_no  			
						,0 AS FEE_12
						,0 AS FEE_11
						,0 AS FEE_10
						,0 AS FEE_09
						,0 AS FEE_08
						,0 AS FEE_07
						,0 AS FEE_06
						,0 AS FEE_05
						,0 AS FEE_04
						,0 AS FEE_03
						,0 AS FEE_02
						,0 AS FEE_01
	
						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type
						,A.period_flag
						,A.suim_rpt_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_01	
	
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND A.suim_rpt_state != 3
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						<!-- ,A.div_type -->
						,"5" AS div_type
						,A.period_flag
						,A.suim_rpt_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_basic ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_basic ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_basic ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_basic ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_basic ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_basic ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_basic ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_basic ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_basic ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_basic ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_basic ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_basic ELSE 0 END AS FEE_01
	
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND A.suim_rpt_state != 3
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					<!-- AND A.div_type = #{div_type} -->				
					</if>
				)GA
				GROUP BY GA.ptnr_id, GA.ptnr_id_sub, GA.period_flag
			)GB
			ON PA.ptnr_id = GB.ptnr_id
			AND PA.ptnr_id_sub = GB.ptnr_id_sub
			AND PA.period_flag_code = GB.period_flag	
		)GC	
	</select>
	
	<!-- 보험사별 순수피 신규 : 물보험 20230613-->
	<select id="PtnrStatFee" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			PA.ptnr_id			
			,CAST(PA.ptnr_id_sub AS SIGNED INTEGER) AS ptnr_id_sub
			,PA.period_flag_code
			,PA.ptnr_nick
			,PA.ptnr_id_sub_nm
			,PA.period_flag_nm
			,PA.ptnr_row_cnt
			,IFNULL(GB.FEE_12,0) AS FEE_12
			,IFNULL(GB.FEE_11,0) AS FEE_11
			,IFNULL(GB.FEE_10,0) AS FEE_10
			,IFNULL(GB.FEE_09,0) AS FEE_09
			,IFNULL(GB.FEE_08,0) AS FEE_08
			,IFNULL(GB.FEE_07,0) AS FEE_07
			,IFNULL(GB.FEE_06,0) AS FEE_06
			,IFNULL(GB.FEE_05,0) AS FEE_05
			,IFNULL(GB.FEE_04,0) AS FEE_04
			,IFNULL(GB.FEE_03,0) AS FEE_03
			,IFNULL(GB.FEE_02,0) AS FEE_02
			,IFNULL(GB.FEE_01,0) AS FEE_01	
		FROM v_ptnr_stat PA
		LEFT JOIN
		(
			SELECT
				GA.ptnr_id
				,GA.ptnr_id_sub
				,GA.div_type
				,GA.period_flag
				,GA.suim_rpt_no
				,SUM(GA.FEE_12) AS FEE_12
				,SUM(GA.FEE_11) AS FEE_11
				,SUM(GA.FEE_10) AS FEE_10
				,SUM(GA.FEE_09) AS FEE_09
				,SUM(GA.FEE_08) AS FEE_08
				,SUM(GA.FEE_07) AS FEE_07
				,SUM(GA.FEE_06) AS FEE_06
				,SUM(GA.FEE_05) AS FEE_05
				,SUM(GA.FEE_04) AS FEE_04
				,SUM(GA.FEE_03) AS FEE_03
				,SUM(GA.FEE_02) AS FEE_02
				,SUM(GA.FEE_01) AS FEE_01	
			FROM
			(	
			
				SELECT
					"" AS ptnr_id
					,"" AS ptnr_id_sub
					,"" AS div_type
					,"" AS period_flag
					,"" AS suim_rpt_no  			
					,0 AS FEE_12
					,0 AS FEE_11
					,0 AS FEE_10
					,0 AS FEE_09
					,0 AS FEE_08
					,0 AS FEE_07
					,0 AS FEE_06
					,0 AS FEE_05
					,0 AS FEE_04
					,0 AS FEE_03
					,0 AS FEE_02
					,0 AS FEE_01
				FROM  DUAL
				
				<if test='basicYN == "Y"'>					
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_12
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_11
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_10
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_09
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_08
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_07
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_06
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_05
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_04
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_03
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_02
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_01	
				FROM v_top_rpt_head_type A
				INNER JOIN top_tm_bsc B
				ON A.team_id = B.team_id
				INNER JOIN top_rpt_invoice C
				ON A.suim_rpt_no = C.suim_rpt_no
				WHERE 1=1
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}				
				</if>				
				<if test='primYN == "Y" and div_type == "5"'>				
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					<!-- ,A.div_type -->
					,"5" AS div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_basic ELSE 0 END AS FEE_12
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_basic ELSE 0 END AS FEE_11
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_basic ELSE 0 END AS FEE_10
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_basic ELSE 0 END AS FEE_09
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_basic ELSE 0 END AS FEE_08
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_basic ELSE 0 END AS FEE_07
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_basic ELSE 0 END AS FEE_06
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_basic ELSE 0 END AS FEE_05
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_basic ELSE 0 END AS FEE_04
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_basic ELSE 0 END AS FEE_03
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_basic ELSE 0 END AS FEE_02
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_basic ELSE 0 END AS FEE_01
				FROM top_prim_biz_rpt_head A
				INNER JOIN top_tm_bsc B
				ON A.team_id = B.team_id
				INNER JOIN top_prim_biz_inv C
				ON A.suim_rpt_no = C.suim_rpt_no
				WHERE 1=1
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				<!-- AND A.div_type = #{div_type} -->				
				</if>
			)GA
			GROUP BY GA.ptnr_id, GA.ptnr_id_sub, GA.period_flag
		)GB
		ON PA.ptnr_id = GB.ptnr_id
		AND PA.ptnr_id_sub = GB.ptnr_id_sub
		AND PA.period_flag_code = GB.period_flag
	</select>
	
	<!-- 보험사별 종결현황 신규 : 물보험 20230612-->
	<select id="PtnrStatEnd" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			PA.ptnr_id			
			,CAST(PA.ptnr_id_sub AS SIGNED INTEGER) AS ptnr_id_sub
			,PA.period_flag_code
			,PA.ptnr_nick
			,PA.ptnr_id_sub_nm
			,PA.period_flag_nm
			,PA.ptnr_row_cnt
			,IFNULL(GB.END_12,0) AS END_12
			,IFNULL(GB.END_11,0) AS END_11
			,IFNULL(GB.END_10,0) AS END_10
			,IFNULL(GB.END_09,0) AS END_09
			,IFNULL(GB.END_08,0) AS END_08
			,IFNULL(GB.END_07,0) AS END_07
			,IFNULL(GB.END_06,0) AS END_06
			,IFNULL(GB.END_05,0) AS END_05
			,IFNULL(GB.END_04,0) AS END_04
			,IFNULL(GB.END_03,0) AS END_03
			,IFNULL(GB.END_02,0) AS END_02
			,IFNULL(GB.END_01,0) AS END_01	
		FROM v_ptnr_stat PA
		LEFT JOIN
		(
			SELECT
				GA.ptnr_id
				,GA.ptnr_id_sub
				,GA.div_type
				,GA.period_flag
				,GA.suim_rpt_no
				,SUM(GA.END_12) AS END_12
				,SUM(GA.END_11) AS END_11
				,SUM(GA.END_10) AS END_10
				,SUM(GA.END_09) AS END_09
				,SUM(GA.END_08) AS END_08
				,SUM(GA.END_07) AS END_07
				,SUM(GA.END_06) AS END_06
				,SUM(GA.END_05) AS END_05
				,SUM(GA.END_04) AS END_04
				,SUM(GA.END_03) AS END_03
				,SUM(GA.END_02) AS END_02
				,SUM(GA.END_01) AS END_01	
			FROM
			(	
			
				SELECT
					"" AS ptnr_id
					,"" AS ptnr_id_sub
					,"" AS div_type
					,"" AS period_flag
					,"" AS suim_rpt_no  			
					,0 AS END_12
					,0 AS END_11
					,0 AS END_10
					,0 AS END_09
					,0 AS END_08
					,0 AS END_07
					,0 AS END_06
					,0 AS END_05
					,0 AS END_04
					,0 AS END_03
					,0 AS END_02
					,0 AS END_01
				FROM  DUAL
				
				<if test='basicYN == "Y"'>					
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}				
				</if>				
				<if test='primYN == "Y" and div_type == "5"'>				
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,"5" AS div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
					,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
				FROM top_prim_biz_rpt_head A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				<!-- AND A.div_type = #{div_type}	 -->			
				</if>
			)GA
			GROUP BY GA.ptnr_id, GA.ptnr_id_sub, GA.period_flag
		)GB
		ON PA.ptnr_id = GB.ptnr_id
		AND PA.ptnr_id_sub = GB.ptnr_id_sub
		AND PA.period_flag_code = GB.period_flag	
	</select>
	
	<!-- 보험사별 팀내 직원별  종결현황 좌측 row 계산 20230703 -->
	<select id="PtnrStatMemberAllEndLeftRow" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="integer">
		SELECT
			IFNULL(SUM(GC.row_sum),0) AS left_row
		FROM 
		(
			SELECT
				CASE
					WHEN (GB.row_cnt > 1)
					THEN (GB.row_cnt + 1)
					ELSE 1
				END AS row_sum
			FROM 
			(
				SELECT
					GA.user_no
					,COUNT(GA.user_no)AS row_cnt
				FROM(
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type
						,A.user_no
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}
					GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
				)GA
				GROUP BY GA.user_no
			)GB
		)GC
	</select>
	
	<!-- 보험사별 팀내 직원별  종결현황 좌측 row 계산 20230627 -->
	<select id="PtnrStatMemberEndLeftRow" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="integer">
		SELECT
			IFNULL(SUM(GC.row_sum),0) AS left_row
		FROM 
		(
			SELECT
				CASE
					WHEN (GB.row_cnt > 1)
					THEN (GB.row_cnt + 1)
					ELSE 1
				END AS row_sum
			FROM 
			(
				SELECT
					GA.user_no
					,COUNT(GA.user_no)AS row_cnt
				FROM(
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type
						,A.user_no
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}
					GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
				)GA
				GROUP BY GA.user_no
			)GB
		)GC
	</select>
	
	<!-- 보험사별 직원전체  수임현황 좌측 row 계산 20230703 -->
	<select id="PtnrStatMemberAllRegLeftRow" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="integer">
		SELECT
			IFNULL(SUM(GC.row_sum),0) AS left_row
		FROM 
		(
			SELECT
				CASE
					WHEN (GB.row_cnt > 1)
					THEN (GB.row_cnt + 1)
					ELSE 1
				END AS row_sum
			FROM 
			(
				SELECT
					GA.user_no
					,COUNT(GA.user_no)AS row_cnt
				FROM(
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type
						,A.user_no
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}
					GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
				)GA
				GROUP BY GA.user_no
			)GB
		)GC
	</select>
	
	<!-- 보험사별 팀내 직원별  수임현황 좌측 row 계산 20230627 -->
	<select id="PtnrStatMemberRegLeftRow" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="integer">
		SELECT
			IFNULL(SUM(GC.row_sum),0) AS left_row
		FROM 
		(
			SELECT
				CASE
					WHEN (GB.row_cnt > 1)
					THEN (GB.row_cnt + 1)
					ELSE 1
				END AS row_sum
			FROM 
			(
				SELECT
					GA.user_no
					,COUNT(GA.user_no)AS row_cnt
				FROM(
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type
						,A.user_no
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}
					GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
				)GA
				GROUP BY GA.user_no
			)GB
		)GC
	</select>
	
	<!-- 보험사별 센터 내 팀별  수임현황 좌측 row 계산 20230623 -->
	<select id="PtnrStatTeamRegLeftRow" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="integer">
		SELECT
			IFNULL(SUM(GC.row_sum),0) AS left_row
		FROM 
		(
			SELECT
				CASE
					WHEN (GB.row_cnt > 1)
					THEN (GB.row_cnt + 1)
					ELSE 1
				END AS row_sum
			FROM 
			(
				SELECT
					GA.team_id
					,COUNT(GA.team_id)AS row_cnt
				FROM(
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type
						,B.team_id
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}
					GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
				)GA
				GROUP BY GA.team_id
			)GB
		)GC	
	</select>
	
	<!-- 보험사별 팀별  수임현황 좌측 row 계산 20230627 -->
	<select id="PtnrStatTeamAllRegLeftRow" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="integer">
		SELECT
			IFNULL(SUM(GC.row_sum),0) AS left_row
		FROM 
		(
			SELECT
				CASE
					WHEN (GB.row_cnt > 1)
					THEN (GB.row_cnt + 1)
					ELSE 1
				END AS row_sum
			FROM 
			(
				SELECT
					GA.team_id
					,COUNT(GA.team_id)AS row_cnt
				FROM(
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type
						,B.team_id
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}
					GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
				)GA
				GROUP BY GA.team_id
			)GB
		)GC	
	</select>
	
	<!-- 보험사별 센터별  수임현황 좌측 row 계산 20230622 -->
	<select id="PtnrStatCenterRegLeftRow" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="integer">
		SELECT
			IFNULL(SUM(GC.row_sum),0) AS left_row
		FROM 
		(
			SELECT
				CASE
					WHEN (GB.row_cnt > 1)
					THEN (GB.row_cnt + 1)
					ELSE 1
				END AS row_sum
			FROM 
			(
				SELECT
					GA.team_center
					,COUNT(GA.team_center)AS row_cnt
				FROM(
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type
						,B.team_center
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}
					GROUP BY B.team_center, A.ptnr_id, A.ptnr_id_sub
				)GA
				GROUP BY GA.team_center
			)GB
		)GC	
	</select>
	
	<!-- 보험사별 팀 전체  종결현황 좌측 row 계산 20230628 -->
	<select id="PtnrStatTeamAllEndLeftRow" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="integer">
		SELECT
			IFNULL(SUM(GC.row_sum),0) AS left_row
		FROM 
		(
			SELECT
				CASE
					WHEN (GB.row_cnt > 1)
					THEN (GB.row_cnt + 1)
					ELSE 1
				END AS row_sum
			FROM 
			(
				SELECT
					GA.team_id
					,COUNT(GA.team_id)AS row_cnt
				FROM(
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type
						,B.team_id
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}
					GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
				)GA
				GROUP BY GA.team_id
			)GB
		)GC
	</select>
	
	<!-- 보험사별 센터별  종결현황 좌측 row 계산 20230622 -->
	<select id="PtnrStatTeamEndLeftRow" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="integer">
		SELECT
			IFNULL(SUM(GC.row_sum),0) AS left_row
		FROM 
		(
			SELECT
				CASE
					WHEN (GB.row_cnt > 1)
					THEN (GB.row_cnt + 1)
					ELSE 1
				END AS row_sum
			FROM 
			(
				SELECT
					GA.team_id
					,COUNT(GA.team_id)AS row_cnt
				FROM(
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type
						,B.team_id
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}
					GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
				)GA
				GROUP BY GA.team_id
			)GB
		)GC
	</select>
	
	<!-- 보험사별 센터별  종결현황 좌측 row 계산 20230622 -->
	<select id="PtnrStatCenterEndLeftRow" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="integer">
		SELECT
			IFNULL(SUM(GC.row_sum),0) AS left_row
		FROM 
		(
			SELECT
				CASE
					WHEN (GB.row_cnt > 1)
					THEN (GB.row_cnt + 1)
					ELSE 1
				END AS row_sum
			FROM 
			(
				SELECT
					GA.team_center
					,COUNT(GA.team_center)AS row_cnt
				FROM(
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type
						,B.team_center
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}
					GROUP BY B.team_center, A.ptnr_id, A.ptnr_id_sub
				)GA
				GROUP BY GA.team_center
			)GB
		)GC
	
	</select>
	
	<!-- 보험사별 팀별 건당 일비 현황 신규 : 물보험 20230627-->
	<select id="PtnrStatMemberCntTime" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,TA.user_no
			,TA.user_name

			,IFNULL(ROUND(TA.TIME_12 / TA.END_12),0) AS CNT_TIME_12
			,IFNULL(ROUND(TA.TIME_11 / TA.END_11),0) AS CNT_TIME_11
			,IFNULL(ROUND(TA.TIME_10 / TA.END_10),0) AS CNT_TIME_10
			,IFNULL(ROUND(TA.TIME_09 / TA.END_09),0) AS CNT_TIME_09
			,IFNULL(ROUND(TA.TIME_08 / TA.END_08),0) AS CNT_TIME_08
			,IFNULL(ROUND(TA.TIME_07 / TA.END_07),0) AS CNT_TIME_07
			,IFNULL(ROUND(TA.TIME_06 / TA.END_06),0) AS CNT_TIME_06
			,IFNULL(ROUND(TA.TIME_05 / TA.END_05),0) AS CNT_TIME_05
			,IFNULL(ROUND(TA.TIME_04 / TA.END_04),0) AS CNT_TIME_04
			,IFNULL(ROUND(TA.TIME_03 / TA.END_03),0) AS CNT_TIME_03
			,IFNULL(ROUND(TA.TIME_02 / TA.END_02),0) AS CNT_TIME_02
			,IFNULL(ROUND(TA.TIME_01 / TA.END_01),0) AS CNT_TIME_01
			
			,TA.TIME_12
			,TA.TIME_11
			,TA.TIME_10
			,TA.TIME_09
			,TA.TIME_08
			,TA.TIME_07
			,TA.TIME_06
			,TA.TIME_05
			,TA.TIME_04
			,TA.TIME_03
			,TA.TIME_02
			,TA.TIME_01

			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order

				,GB.user_no			
				,TMB.user_name
				,TMB.work_level
				,TMB.join_date			
				,CASE TMB.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15
				END AS new_work_order

				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.TIME_12,0) AS TIME_12
				,IFNULL(GB.TIME_11,0) AS TIME_11
				,IFNULL(GB.TIME_10,0) AS TIME_10
				,IFNULL(GB.TIME_09,0) AS TIME_09
				,IFNULL(GB.TIME_08,0) AS TIME_08
				,IFNULL(GB.TIME_07,0) AS TIME_07
				,IFNULL(GB.TIME_06,0) AS TIME_06
				,IFNULL(GB.TIME_05,0) AS TIME_05
				,IFNULL(GB.TIME_04,0) AS TIME_04
				,IFNULL(GB.TIME_03,0) AS TIME_03
				,IFNULL(GB.TIME_02,0) AS TIME_02
				,IFNULL(GB.TIME_01,0) AS TIME_01

				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,GA.user_no
					,SUM(GA.TIME_12) AS TIME_12
					,SUM(GA.TIME_11) AS TIME_11
					,SUM(GA.TIME_10) AS TIME_10
					,SUM(GA.TIME_09) AS TIME_09
					,SUM(GA.TIME_08) AS TIME_08
					,SUM(GA.TIME_07) AS TIME_07
					,SUM(GA.TIME_06) AS TIME_06
					,SUM(GA.TIME_05) AS TIME_05
					,SUM(GA.TIME_04) AS TIME_04
					,SUM(GA.TIME_03) AS TIME_03
					,SUM(GA.TIME_02) AS TIME_02
					,SUM(GA.TIME_01) AS TIME_01

					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order
						,"" AS user_no
						,0 AS TIME_12
						,0 AS TIME_11
						,0 AS TIME_10
						,0 AS TIME_09
						,0 AS TIME_08
						,0 AS TIME_07
						,0 AS TIME_06
						,0 AS TIME_05
						,0 AS TIME_04
						,0 AS TIME_03
						,0 AS TIME_02
						,0 AS TIME_01

						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01	

						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01

						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.user_no, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			LEFT JOIN top_mbr_bsc TMB
			ON GB.user_no = TMB.user_no		
			ORDER BY new_work_order, TMB.work_level DESC, TMB.join_date, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.user_no
				,COUNT(GA.user_no) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,A.user_no	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_id = #{team_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.user_no
		)CNT
		ON TA.user_no = CNT.user_no
	</select>
	
	<!-- 보험사별 팀전체 건당 일비 현황 신규 : 물보험 20230630-->
	<select id="PtnrStatTeamAllCntTime" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,IFNULL(ROUND(TA.TIME_12 / TA.END_12),0) AS CNT_TIME_12
			,IFNULL(ROUND(TA.TIME_11 / TA.END_11),0) AS CNT_TIME_11
			,IFNULL(ROUND(TA.TIME_10 / TA.END_10),0) AS CNT_TIME_10
			,IFNULL(ROUND(TA.TIME_09 / TA.END_09),0) AS CNT_TIME_09
			,IFNULL(ROUND(TA.TIME_08 / TA.END_08),0) AS CNT_TIME_08
			,IFNULL(ROUND(TA.TIME_07 / TA.END_07),0) AS CNT_TIME_07
			,IFNULL(ROUND(TA.TIME_06 / TA.END_06),0) AS CNT_TIME_06
			,IFNULL(ROUND(TA.TIME_05 / TA.END_05),0) AS CNT_TIME_05
			,IFNULL(ROUND(TA.TIME_04 / TA.END_04),0) AS CNT_TIME_04
			,IFNULL(ROUND(TA.TIME_03 / TA.END_03),0) AS CNT_TIME_03
			,IFNULL(ROUND(TA.TIME_02 / TA.END_02),0) AS CNT_TIME_02
			,IFNULL(ROUND(TA.TIME_01 / TA.END_01),0) AS CNT_TIME_01
			
			,TA.TIME_12
			,TA.TIME_11
			,TA.TIME_10
			,TA.TIME_09
			,TA.TIME_08
			,TA.TIME_07
			,TA.TIME_06
			,TA.TIME_05
			,TA.TIME_04
			,TA.TIME_03
			,TA.TIME_02
			,TA.TIME_01

			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.TIME_12,0) AS TIME_12
				,IFNULL(GB.TIME_11,0) AS TIME_11
				,IFNULL(GB.TIME_10,0) AS TIME_10
				,IFNULL(GB.TIME_09,0) AS TIME_09
				,IFNULL(GB.TIME_08,0) AS TIME_08
				,IFNULL(GB.TIME_07,0) AS TIME_07
				,IFNULL(GB.TIME_06,0) AS TIME_06
				,IFNULL(GB.TIME_05,0) AS TIME_05
				,IFNULL(GB.TIME_04,0) AS TIME_04
				,IFNULL(GB.TIME_03,0) AS TIME_03
				,IFNULL(GB.TIME_02,0) AS TIME_02
				,IFNULL(GB.TIME_01,0) AS TIME_01

				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.TIME_12) AS TIME_12
					,SUM(GA.TIME_11) AS TIME_11
					,SUM(GA.TIME_10) AS TIME_10
					,SUM(GA.TIME_09) AS TIME_09
					,SUM(GA.TIME_08) AS TIME_08
					,SUM(GA.TIME_07) AS TIME_07
					,SUM(GA.TIME_06) AS TIME_06
					,SUM(GA.TIME_05) AS TIME_05
					,SUM(GA.TIME_04) AS TIME_04
					,SUM(GA.TIME_03) AS TIME_03
					,SUM(GA.TIME_02) AS TIME_02
					,SUM(GA.TIME_01) AS TIME_01

					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS TIME_12
						,0 AS TIME_11
						,0 AS TIME_10
						,0 AS TIME_09
						,0 AS TIME_08
						,0 AS TIME_07
						,0 AS TIME_06
						,0 AS TIME_05
						,0 AS TIME_04
						,0 AS TIME_03
						,0 AS TIME_02
						,0 AS TIME_01

						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01	

						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01

						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}				
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사별 팀별 건당 일비 현황 신규 : 물보험 20230626-->
	<select id="PtnrStatTeamCntTime" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,IFNULL(ROUND(TA.TIME_12 / TA.END_12),0) AS CNT_TIME_12
			,IFNULL(ROUND(TA.TIME_11 / TA.END_11),0) AS CNT_TIME_11
			,IFNULL(ROUND(TA.TIME_10 / TA.END_10),0) AS CNT_TIME_10
			,IFNULL(ROUND(TA.TIME_09 / TA.END_09),0) AS CNT_TIME_09
			,IFNULL(ROUND(TA.TIME_08 / TA.END_08),0) AS CNT_TIME_08
			,IFNULL(ROUND(TA.TIME_07 / TA.END_07),0) AS CNT_TIME_07
			,IFNULL(ROUND(TA.TIME_06 / TA.END_06),0) AS CNT_TIME_06
			,IFNULL(ROUND(TA.TIME_05 / TA.END_05),0) AS CNT_TIME_05
			,IFNULL(ROUND(TA.TIME_04 / TA.END_04),0) AS CNT_TIME_04
			,IFNULL(ROUND(TA.TIME_03 / TA.END_03),0) AS CNT_TIME_03
			,IFNULL(ROUND(TA.TIME_02 / TA.END_02),0) AS CNT_TIME_02
			,IFNULL(ROUND(TA.TIME_01 / TA.END_01),0) AS CNT_TIME_01
			
			,TA.TIME_12
			,TA.TIME_11
			,TA.TIME_10
			,TA.TIME_09
			,TA.TIME_08
			,TA.TIME_07
			,TA.TIME_06
			,TA.TIME_05
			,TA.TIME_04
			,TA.TIME_03
			,TA.TIME_02
			,TA.TIME_01

			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.TIME_12,0) AS TIME_12
				,IFNULL(GB.TIME_11,0) AS TIME_11
				,IFNULL(GB.TIME_10,0) AS TIME_10
				,IFNULL(GB.TIME_09,0) AS TIME_09
				,IFNULL(GB.TIME_08,0) AS TIME_08
				,IFNULL(GB.TIME_07,0) AS TIME_07
				,IFNULL(GB.TIME_06,0) AS TIME_06
				,IFNULL(GB.TIME_05,0) AS TIME_05
				,IFNULL(GB.TIME_04,0) AS TIME_04
				,IFNULL(GB.TIME_03,0) AS TIME_03
				,IFNULL(GB.TIME_02,0) AS TIME_02
				,IFNULL(GB.TIME_01,0) AS TIME_01

				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.TIME_12) AS TIME_12
					,SUM(GA.TIME_11) AS TIME_11
					,SUM(GA.TIME_10) AS TIME_10
					,SUM(GA.TIME_09) AS TIME_09
					,SUM(GA.TIME_08) AS TIME_08
					,SUM(GA.TIME_07) AS TIME_07
					,SUM(GA.TIME_06) AS TIME_06
					,SUM(GA.TIME_05) AS TIME_05
					,SUM(GA.TIME_04) AS TIME_04
					,SUM(GA.TIME_03) AS TIME_03
					,SUM(GA.TIME_02) AS TIME_02
					,SUM(GA.TIME_01) AS TIME_01

					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS TIME_12
						,0 AS TIME_11
						,0 AS TIME_10
						,0 AS TIME_09
						,0 AS TIME_08
						,0 AS TIME_07
						,0 AS TIME_06
						,0 AS TIME_05
						,0 AS TIME_04
						,0 AS TIME_03
						,0 AS TIME_02
						,0 AS TIME_01

						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01	

						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01

						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_center = #{team_center}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id		
	</select>
	
	<!-- 보험사 센터 팀내 직원별 건당 순수피 현황 신규 : 물보험 20230627-->
	<select id="PtnrStatMemberCntFee" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,TA.user_no
			,TA.user_name
			
			,IFNULL(ROUND(TA.FEE_12 / TA.END_12),0) AS CNT_FEE_12
			,IFNULL(ROUND(TA.FEE_11 / TA.END_11),0) AS CNT_FEE_11
			,IFNULL(ROUND(TA.FEE_10 / TA.END_10),0) AS CNT_FEE_10
			,IFNULL(ROUND(TA.FEE_09 / TA.END_09),0) AS CNT_FEE_09
			,IFNULL(ROUND(TA.FEE_08 / TA.END_08),0) AS CNT_FEE_08
			,IFNULL(ROUND(TA.FEE_07 / TA.END_07),0) AS CNT_FEE_07
			,IFNULL(ROUND(TA.FEE_06 / TA.END_06),0) AS CNT_FEE_06
			,IFNULL(ROUND(TA.FEE_05 / TA.END_05),0) AS CNT_FEE_05
			,IFNULL(ROUND(TA.FEE_04 / TA.END_04),0) AS CNT_FEE_04
			,IFNULL(ROUND(TA.FEE_03 / TA.END_03),0) AS CNT_FEE_03
			,IFNULL(ROUND(TA.FEE_02 / TA.END_02),0) AS CNT_FEE_02
			,IFNULL(ROUND(TA.FEE_01 / TA.END_01),0) AS CNT_FEE_01

			,TA.FEE_12
			,TA.FEE_11
			,TA.FEE_10
			,TA.FEE_09
			,TA.FEE_08
			,TA.FEE_07
			,TA.FEE_06
			,TA.FEE_05
			,TA.FEE_04
			,TA.FEE_03
			,TA.FEE_02
			,TA.FEE_01

			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order

				,GB.user_no			
				,TMB.user_name
				,TMB.work_level
				,TMB.join_date			
				,CASE TMB.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15
				END AS new_work_order

				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.FEE_12,0) AS FEE_12
				,IFNULL(GB.FEE_11,0) AS FEE_11
				,IFNULL(GB.FEE_10,0) AS FEE_10
				,IFNULL(GB.FEE_09,0) AS FEE_09
				,IFNULL(GB.FEE_08,0) AS FEE_08
				,IFNULL(GB.FEE_07,0) AS FEE_07
				,IFNULL(GB.FEE_06,0) AS FEE_06
				,IFNULL(GB.FEE_05,0) AS FEE_05
				,IFNULL(GB.FEE_04,0) AS FEE_04
				,IFNULL(GB.FEE_03,0) AS FEE_03
				,IFNULL(GB.FEE_02,0) AS FEE_02
				,IFNULL(GB.FEE_01,0) AS FEE_01

				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,GA.user_no
					,SUM(GA.FEE_12) AS FEE_12
					,SUM(GA.FEE_11) AS FEE_11
					,SUM(GA.FEE_10) AS FEE_10
					,SUM(GA.FEE_09) AS FEE_09
					,SUM(GA.FEE_08) AS FEE_08
					,SUM(GA.FEE_07) AS FEE_07
					,SUM(GA.FEE_06) AS FEE_06
					,SUM(GA.FEE_05) AS FEE_05
					,SUM(GA.FEE_04) AS FEE_04
					,SUM(GA.FEE_03) AS FEE_03
					,SUM(GA.FEE_02) AS FEE_02
					,SUM(GA.FEE_01) AS FEE_01
					
					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order
						,"" AS user_no
						,0 AS FEE_12
						,0 AS FEE_11
						,0 AS FEE_10
						,0 AS FEE_09
						,0 AS FEE_08
						,0 AS FEE_07
						,0 AS FEE_06
						,0 AS FEE_05
						,0 AS FEE_04
						,0 AS FEE_03
						,0 AS FEE_02
						,0 AS FEE_01

						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_01
						
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_basic ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_basic ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_basic ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_basic ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_basic ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_basic ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_basic ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_basic ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_basic ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_basic ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_basic ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_basic ELSE 0 END AS FEE_01

						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.user_no, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			LEFT JOIN top_mbr_bsc TMB
			ON GB.user_no = TMB.user_no		
			ORDER BY new_work_order, TMB.work_level DESC, TMB.join_date, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.user_no
				,COUNT(GA.user_no) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,A.user_no
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_id = #{team_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.user_no
		)CNT
		ON TA.user_no = CNT.user_no
	</select>
	
	<!-- 보험사별 팀전체 건당 순수피 현황 신규 : 물보험 20230630-->
	<select id="PtnrStatTeamAllCntFee" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,IFNULL(ROUND(TA.FEE_12 / TA.END_12),0) AS CNT_FEE_12
			,IFNULL(ROUND(TA.FEE_11 / TA.END_11),0) AS CNT_FEE_11
			,IFNULL(ROUND(TA.FEE_10 / TA.END_10),0) AS CNT_FEE_10
			,IFNULL(ROUND(TA.FEE_09 / TA.END_09),0) AS CNT_FEE_09
			,IFNULL(ROUND(TA.FEE_08 / TA.END_08),0) AS CNT_FEE_08
			,IFNULL(ROUND(TA.FEE_07 / TA.END_07),0) AS CNT_FEE_07
			,IFNULL(ROUND(TA.FEE_06 / TA.END_06),0) AS CNT_FEE_06
			,IFNULL(ROUND(TA.FEE_05 / TA.END_05),0) AS CNT_FEE_05
			,IFNULL(ROUND(TA.FEE_04 / TA.END_04),0) AS CNT_FEE_04
			,IFNULL(ROUND(TA.FEE_03 / TA.END_03),0) AS CNT_FEE_03
			,IFNULL(ROUND(TA.FEE_02 / TA.END_02),0) AS CNT_FEE_02
			,IFNULL(ROUND(TA.FEE_01 / TA.END_01),0) AS CNT_FEE_01

			,TA.FEE_12
			,TA.FEE_11
			,TA.FEE_10
			,TA.FEE_09
			,TA.FEE_08
			,TA.FEE_07
			,TA.FEE_06
			,TA.FEE_05
			,TA.FEE_04
			,TA.FEE_03
			,TA.FEE_02
			,TA.FEE_01

			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.FEE_12,0) AS FEE_12
				,IFNULL(GB.FEE_11,0) AS FEE_11
				,IFNULL(GB.FEE_10,0) AS FEE_10
				,IFNULL(GB.FEE_09,0) AS FEE_09
				,IFNULL(GB.FEE_08,0) AS FEE_08
				,IFNULL(GB.FEE_07,0) AS FEE_07
				,IFNULL(GB.FEE_06,0) AS FEE_06
				,IFNULL(GB.FEE_05,0) AS FEE_05
				,IFNULL(GB.FEE_04,0) AS FEE_04
				,IFNULL(GB.FEE_03,0) AS FEE_03
				,IFNULL(GB.FEE_02,0) AS FEE_02
				,IFNULL(GB.FEE_01,0) AS FEE_01

				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.FEE_12) AS FEE_12
					,SUM(GA.FEE_11) AS FEE_11
					,SUM(GA.FEE_10) AS FEE_10
					,SUM(GA.FEE_09) AS FEE_09
					,SUM(GA.FEE_08) AS FEE_08
					,SUM(GA.FEE_07) AS FEE_07
					,SUM(GA.FEE_06) AS FEE_06
					,SUM(GA.FEE_05) AS FEE_05
					,SUM(GA.FEE_04) AS FEE_04
					,SUM(GA.FEE_03) AS FEE_03
					,SUM(GA.FEE_02) AS FEE_02
					,SUM(GA.FEE_01) AS FEE_01
					
					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS FEE_12
						,0 AS FEE_11
						,0 AS FEE_10
						,0 AS FEE_09
						,0 AS FEE_08
						,0 AS FEE_07
						,0 AS FEE_06
						,0 AS FEE_05
						,0 AS FEE_04
						,0 AS FEE_03
						,0 AS FEE_02
						,0 AS FEE_01

						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_01
						
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_basic ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_basic ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_basic ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_basic ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_basic ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_basic ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_basic ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_basic ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_basic ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_basic ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_basic ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_basic ELSE 0 END AS FEE_01

						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}				
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사별 센터별 건당 순수피 현황 신규 : 물보험 20230626-->
	<select id="PtnrStatTeamCntFee" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,IFNULL(ROUND(TA.FEE_12 / TA.END_12),0) AS CNT_FEE_12
			,IFNULL(ROUND(TA.FEE_11 / TA.END_11),0) AS CNT_FEE_11
			,IFNULL(ROUND(TA.FEE_10 / TA.END_10),0) AS CNT_FEE_10
			,IFNULL(ROUND(TA.FEE_09 / TA.END_09),0) AS CNT_FEE_09
			,IFNULL(ROUND(TA.FEE_08 / TA.END_08),0) AS CNT_FEE_08
			,IFNULL(ROUND(TA.FEE_07 / TA.END_07),0) AS CNT_FEE_07
			,IFNULL(ROUND(TA.FEE_06 / TA.END_06),0) AS CNT_FEE_06
			,IFNULL(ROUND(TA.FEE_05 / TA.END_05),0) AS CNT_FEE_05
			,IFNULL(ROUND(TA.FEE_04 / TA.END_04),0) AS CNT_FEE_04
			,IFNULL(ROUND(TA.FEE_03 / TA.END_03),0) AS CNT_FEE_03
			,IFNULL(ROUND(TA.FEE_02 / TA.END_02),0) AS CNT_FEE_02
			,IFNULL(ROUND(TA.FEE_01 / TA.END_01),0) AS CNT_FEE_01

			,TA.FEE_12
			,TA.FEE_11
			,TA.FEE_10
			,TA.FEE_09
			,TA.FEE_08
			,TA.FEE_07
			,TA.FEE_06
			,TA.FEE_05
			,TA.FEE_04
			,TA.FEE_03
			,TA.FEE_02
			,TA.FEE_01

			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.FEE_12,0) AS FEE_12
				,IFNULL(GB.FEE_11,0) AS FEE_11
				,IFNULL(GB.FEE_10,0) AS FEE_10
				,IFNULL(GB.FEE_09,0) AS FEE_09
				,IFNULL(GB.FEE_08,0) AS FEE_08
				,IFNULL(GB.FEE_07,0) AS FEE_07
				,IFNULL(GB.FEE_06,0) AS FEE_06
				,IFNULL(GB.FEE_05,0) AS FEE_05
				,IFNULL(GB.FEE_04,0) AS FEE_04
				,IFNULL(GB.FEE_03,0) AS FEE_03
				,IFNULL(GB.FEE_02,0) AS FEE_02
				,IFNULL(GB.FEE_01,0) AS FEE_01

				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.FEE_12) AS FEE_12
					,SUM(GA.FEE_11) AS FEE_11
					,SUM(GA.FEE_10) AS FEE_10
					,SUM(GA.FEE_09) AS FEE_09
					,SUM(GA.FEE_08) AS FEE_08
					,SUM(GA.FEE_07) AS FEE_07
					,SUM(GA.FEE_06) AS FEE_06
					,SUM(GA.FEE_05) AS FEE_05
					,SUM(GA.FEE_04) AS FEE_04
					,SUM(GA.FEE_03) AS FEE_03
					,SUM(GA.FEE_02) AS FEE_02
					,SUM(GA.FEE_01) AS FEE_01
					
					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS FEE_12
						,0 AS FEE_11
						,0 AS FEE_10
						,0 AS FEE_09
						,0 AS FEE_08
						,0 AS FEE_07
						,0 AS FEE_06
						,0 AS FEE_05
						,0 AS FEE_04
						,0 AS FEE_03
						,0 AS FEE_02
						,0 AS FEE_01

						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_01
						
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_basic ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_basic ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_basic ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_basic ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_basic ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_basic ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_basic ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_basic ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_basic ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_basic ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_basic ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_basic ELSE 0 END AS FEE_01

						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_center = #{team_center}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사별 센터별 순수피 현황 신규 : 물보험 20230622-->
	<select id="PtnrStatCenterCntFee" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,IFNULL(ROUND(TA.FEE_12 / TA.END_12),0) AS CNT_FEE_12
			,IFNULL(ROUND(TA.FEE_11 / TA.END_11),0) AS CNT_FEE_11
			,IFNULL(ROUND(TA.FEE_10 / TA.END_10),0) AS CNT_FEE_10
			,IFNULL(ROUND(TA.FEE_09 / TA.END_09),0) AS CNT_FEE_09
			,IFNULL(ROUND(TA.FEE_08 / TA.END_08),0) AS CNT_FEE_08
			,IFNULL(ROUND(TA.FEE_07 / TA.END_07),0) AS CNT_FEE_07
			,IFNULL(ROUND(TA.FEE_06 / TA.END_06),0) AS CNT_FEE_06
			,IFNULL(ROUND(TA.FEE_05 / TA.END_05),0) AS CNT_FEE_05
			,IFNULL(ROUND(TA.FEE_04 / TA.END_04),0) AS CNT_FEE_04
			,IFNULL(ROUND(TA.FEE_03 / TA.END_03),0) AS CNT_FEE_03
			,IFNULL(ROUND(TA.FEE_02 / TA.END_02),0) AS CNT_FEE_02
			,IFNULL(ROUND(TA.FEE_01 / TA.END_01),0) AS CNT_FEE_01

			,TA.FEE_12
			,TA.FEE_11
			,TA.FEE_10
			,TA.FEE_09
			,TA.FEE_08
			,TA.FEE_07
			,TA.FEE_06
			,TA.FEE_05
			,TA.FEE_04
			,TA.FEE_03
			,TA.FEE_02
			,TA.FEE_01

			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.FEE_12,0) AS FEE_12
				,IFNULL(GB.FEE_11,0) AS FEE_11
				,IFNULL(GB.FEE_10,0) AS FEE_10
				,IFNULL(GB.FEE_09,0) AS FEE_09
				,IFNULL(GB.FEE_08,0) AS FEE_08
				,IFNULL(GB.FEE_07,0) AS FEE_07
				,IFNULL(GB.FEE_06,0) AS FEE_06
				,IFNULL(GB.FEE_05,0) AS FEE_05
				,IFNULL(GB.FEE_04,0) AS FEE_04
				,IFNULL(GB.FEE_03,0) AS FEE_03
				,IFNULL(GB.FEE_02,0) AS FEE_02
				,IFNULL(GB.FEE_01,0) AS FEE_01

				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.FEE_12) AS FEE_12
					,SUM(GA.FEE_11) AS FEE_11
					,SUM(GA.FEE_10) AS FEE_10
					,SUM(GA.FEE_09) AS FEE_09
					,SUM(GA.FEE_08) AS FEE_08
					,SUM(GA.FEE_07) AS FEE_07
					,SUM(GA.FEE_06) AS FEE_06
					,SUM(GA.FEE_05) AS FEE_05
					,SUM(GA.FEE_04) AS FEE_04
					,SUM(GA.FEE_03) AS FEE_03
					,SUM(GA.FEE_02) AS FEE_02
					,SUM(GA.FEE_01) AS FEE_01
					
					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS FEE_12
						,0 AS FEE_11
						,0 AS FEE_10
						,0 AS FEE_09
						,0 AS FEE_08
						,0 AS FEE_07
						,0 AS FEE_06
						,0 AS FEE_05
						,0 AS FEE_04
						,0 AS FEE_03
						,0 AS FEE_02
						,0 AS FEE_01

						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_01
						
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_basic ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_basic ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_basic ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_basic ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_basic ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_basic ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_basic ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_basic ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_basic ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_basic ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_basic ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_basic ELSE 0 END AS FEE_01

						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_center, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_center, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_center
				,COUNT(GA.team_center) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_center	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_center, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_center
		)CNT
		ON TA.team_center = CNT.team_center		
	</select>
	
	<!-- 보험사별 센터별 일비 현황 신규 : 물보험 20230622-->
	<select id="PtnrStatCenterCntTime" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,IFNULL(ROUND(TA.TIME_12 / TA.END_12),0) AS CNT_TIME_12
			,IFNULL(ROUND(TA.TIME_11 / TA.END_11),0) AS CNT_TIME_11
			,IFNULL(ROUND(TA.TIME_10 / TA.END_10),0) AS CNT_TIME_10
			,IFNULL(ROUND(TA.TIME_09 / TA.END_09),0) AS CNT_TIME_09
			,IFNULL(ROUND(TA.TIME_08 / TA.END_08),0) AS CNT_TIME_08
			,IFNULL(ROUND(TA.TIME_07 / TA.END_07),0) AS CNT_TIME_07
			,IFNULL(ROUND(TA.TIME_06 / TA.END_06),0) AS CNT_TIME_06
			,IFNULL(ROUND(TA.TIME_05 / TA.END_05),0) AS CNT_TIME_05
			,IFNULL(ROUND(TA.TIME_04 / TA.END_04),0) AS CNT_TIME_04
			,IFNULL(ROUND(TA.TIME_03 / TA.END_03),0) AS CNT_TIME_03
			,IFNULL(ROUND(TA.TIME_02 / TA.END_02),0) AS CNT_TIME_02
			,IFNULL(ROUND(TA.TIME_01 / TA.END_01),0) AS CNT_TIME_01
			
			,TA.TIME_12
			,TA.TIME_11
			,TA.TIME_10
			,TA.TIME_09
			,TA.TIME_08
			,TA.TIME_07
			,TA.TIME_06
			,TA.TIME_05
			,TA.TIME_04
			,TA.TIME_03
			,TA.TIME_02
			,TA.TIME_01

			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.TIME_12,0) AS TIME_12
				,IFNULL(GB.TIME_11,0) AS TIME_11
				,IFNULL(GB.TIME_10,0) AS TIME_10
				,IFNULL(GB.TIME_09,0) AS TIME_09
				,IFNULL(GB.TIME_08,0) AS TIME_08
				,IFNULL(GB.TIME_07,0) AS TIME_07
				,IFNULL(GB.TIME_06,0) AS TIME_06
				,IFNULL(GB.TIME_05,0) AS TIME_05
				,IFNULL(GB.TIME_04,0) AS TIME_04
				,IFNULL(GB.TIME_03,0) AS TIME_03
				,IFNULL(GB.TIME_02,0) AS TIME_02
				,IFNULL(GB.TIME_01,0) AS TIME_01

				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.TIME_12) AS TIME_12
					,SUM(GA.TIME_11) AS TIME_11
					,SUM(GA.TIME_10) AS TIME_10
					,SUM(GA.TIME_09) AS TIME_09
					,SUM(GA.TIME_08) AS TIME_08
					,SUM(GA.TIME_07) AS TIME_07
					,SUM(GA.TIME_06) AS TIME_06
					,SUM(GA.TIME_05) AS TIME_05
					,SUM(GA.TIME_04) AS TIME_04
					,SUM(GA.TIME_03) AS TIME_03
					,SUM(GA.TIME_02) AS TIME_02
					,SUM(GA.TIME_01) AS TIME_01

					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS TIME_12
						,0 AS TIME_11
						,0 AS TIME_10
						,0 AS TIME_09
						,0 AS TIME_08
						,0 AS TIME_07
						,0 AS TIME_06
						,0 AS TIME_05
						,0 AS TIME_04
						,0 AS TIME_03
						,0 AS TIME_02
						,0 AS TIME_01

						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01	

						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01

						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_center, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_center, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_center
				,COUNT(GA.team_center) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_center	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_center, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_center
		)CNT
		ON TA.team_center = CNT.team_center	
	</select>
	
	<!-- 보험사별 센터 팀내 직원별 총합계 현황 신규 : 물보험 20230627-->
	<select id="PtnrStatMemberEntire" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,TA.user_no
			,TA.user_name
			
			,TA.ENTIRE_12
			,TA.ENTIRE_11
			,TA.ENTIRE_10
			,TA.ENTIRE_09
			,TA.ENTIRE_08
			,TA.ENTIRE_07
			,TA.ENTIRE_06
			,TA.ENTIRE_05
			,TA.ENTIRE_04
			,TA.ENTIRE_03
			,TA.ENTIRE_02
			,TA.ENTIRE_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order

				,GB.user_no			
				,TMB.user_name
				,TMB.work_level
				,TMB.join_date			
				,CASE TMB.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15
				END AS new_work_order

				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.ENTIRE_12,0) AS ENTIRE_12
				,IFNULL(GB.ENTIRE_11,0) AS ENTIRE_11
				,IFNULL(GB.ENTIRE_10,0) AS ENTIRE_10
				,IFNULL(GB.ENTIRE_09,0) AS ENTIRE_09
				,IFNULL(GB.ENTIRE_08,0) AS ENTIRE_08
				,IFNULL(GB.ENTIRE_07,0) AS ENTIRE_07
				,IFNULL(GB.ENTIRE_06,0) AS ENTIRE_06
				,IFNULL(GB.ENTIRE_05,0) AS ENTIRE_05
				,IFNULL(GB.ENTIRE_04,0) AS ENTIRE_04
				,IFNULL(GB.ENTIRE_03,0) AS ENTIRE_03
				,IFNULL(GB.ENTIRE_02,0) AS ENTIRE_02
				,IFNULL(GB.ENTIRE_01,0) AS ENTIRE_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,GA.user_no
					,SUM(GA.ENTIRE_12) AS ENTIRE_12
					,SUM(GA.ENTIRE_11) AS ENTIRE_11
					,SUM(GA.ENTIRE_10) AS ENTIRE_10
					,SUM(GA.ENTIRE_09) AS ENTIRE_09
					,SUM(GA.ENTIRE_08) AS ENTIRE_08
					,SUM(GA.ENTIRE_07) AS ENTIRE_07
					,SUM(GA.ENTIRE_06) AS ENTIRE_06
					,SUM(GA.ENTIRE_05) AS ENTIRE_05
					,SUM(GA.ENTIRE_04) AS ENTIRE_04
					,SUM(GA.ENTIRE_03) AS ENTIRE_03
					,SUM(GA.ENTIRE_02) AS ENTIRE_02
					,SUM(GA.ENTIRE_01) AS ENTIRE_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order
						,"" AS user_no
						,0 AS ENTIRE_12
						,0 AS ENTIRE_11
						,0 AS ENTIRE_10
						,0 AS ENTIRE_09
						,0 AS ENTIRE_08
						,0 AS ENTIRE_07
						,0 AS ENTIRE_06
						,0 AS ENTIRE_05
						,0 AS ENTIRE_04
						,0 AS ENTIRE_03
						,0 AS ENTIRE_02
						,0 AS ENTIRE_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_total ELSE 0 END AS ENTIRE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_total ELSE 0 END AS ENTIRE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_total ELSE 0 END AS ENTIRE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_total ELSE 0 END AS ENTIRE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_total ELSE 0 END AS ENTIRE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_total ELSE 0 END AS ENTIRE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_total ELSE 0 END AS ENTIRE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_total ELSE 0 END AS ENTIRE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_total ELSE 0 END AS ENTIRE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_total ELSE 0 END AS ENTIRE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_total ELSE 0 END AS ENTIRE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_total ELSE 0 END AS ENTIRE_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_total ELSE 0 END AS ENTIRE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_total ELSE 0 END AS ENTIRE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_total ELSE 0 END AS ENTIRE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_total ELSE 0 END AS ENTIRE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_total ELSE 0 END AS ENTIRE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_total ELSE 0 END AS ENTIRE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_total ELSE 0 END AS ENTIRE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_total ELSE 0 END AS ENTIRE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_total ELSE 0 END AS ENTIRE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_total ELSE 0 END AS ENTIRE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_total ELSE 0 END AS ENTIRE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_total ELSE 0 END AS ENTIRE_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.user_no, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			LEFT JOIN top_mbr_bsc TMB
			ON GB.user_no = TMB.user_no		
			ORDER BY new_work_order, TMB.work_level DESC, TMB.join_date, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.user_no
				,COUNT(GA.user_no) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,A.user_no
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_id = #{team_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.user_no
		)CNT
		ON TA.user_no = CNT.user_no
	</select>
	
	<!-- 보험사별 센터 내 팀별 총합계 현황 신규 : 물보험 20230626-->
	<select id="PtnrStatTeamAllEntire" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.ENTIRE_12
			,TA.ENTIRE_11
			,TA.ENTIRE_10
			,TA.ENTIRE_09
			,TA.ENTIRE_08
			,TA.ENTIRE_07
			,TA.ENTIRE_06
			,TA.ENTIRE_05
			,TA.ENTIRE_04
			,TA.ENTIRE_03
			,TA.ENTIRE_02
			,TA.ENTIRE_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.ENTIRE_12,0) AS ENTIRE_12
				,IFNULL(GB.ENTIRE_11,0) AS ENTIRE_11
				,IFNULL(GB.ENTIRE_10,0) AS ENTIRE_10
				,IFNULL(GB.ENTIRE_09,0) AS ENTIRE_09
				,IFNULL(GB.ENTIRE_08,0) AS ENTIRE_08
				,IFNULL(GB.ENTIRE_07,0) AS ENTIRE_07
				,IFNULL(GB.ENTIRE_06,0) AS ENTIRE_06
				,IFNULL(GB.ENTIRE_05,0) AS ENTIRE_05
				,IFNULL(GB.ENTIRE_04,0) AS ENTIRE_04
				,IFNULL(GB.ENTIRE_03,0) AS ENTIRE_03
				,IFNULL(GB.ENTIRE_02,0) AS ENTIRE_02
				,IFNULL(GB.ENTIRE_01,0) AS ENTIRE_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.ENTIRE_12) AS ENTIRE_12
					,SUM(GA.ENTIRE_11) AS ENTIRE_11
					,SUM(GA.ENTIRE_10) AS ENTIRE_10
					,SUM(GA.ENTIRE_09) AS ENTIRE_09
					,SUM(GA.ENTIRE_08) AS ENTIRE_08
					,SUM(GA.ENTIRE_07) AS ENTIRE_07
					,SUM(GA.ENTIRE_06) AS ENTIRE_06
					,SUM(GA.ENTIRE_05) AS ENTIRE_05
					,SUM(GA.ENTIRE_04) AS ENTIRE_04
					,SUM(GA.ENTIRE_03) AS ENTIRE_03
					,SUM(GA.ENTIRE_02) AS ENTIRE_02
					,SUM(GA.ENTIRE_01) AS ENTIRE_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS ENTIRE_12
						,0 AS ENTIRE_11
						,0 AS ENTIRE_10
						,0 AS ENTIRE_09
						,0 AS ENTIRE_08
						,0 AS ENTIRE_07
						,0 AS ENTIRE_06
						,0 AS ENTIRE_05
						,0 AS ENTIRE_04
						,0 AS ENTIRE_03
						,0 AS ENTIRE_02
						,0 AS ENTIRE_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_total ELSE 0 END AS ENTIRE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_total ELSE 0 END AS ENTIRE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_total ELSE 0 END AS ENTIRE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_total ELSE 0 END AS ENTIRE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_total ELSE 0 END AS ENTIRE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_total ELSE 0 END AS ENTIRE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_total ELSE 0 END AS ENTIRE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_total ELSE 0 END AS ENTIRE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_total ELSE 0 END AS ENTIRE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_total ELSE 0 END AS ENTIRE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_total ELSE 0 END AS ENTIRE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_total ELSE 0 END AS ENTIRE_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_total ELSE 0 END AS ENTIRE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_total ELSE 0 END AS ENTIRE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_total ELSE 0 END AS ENTIRE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_total ELSE 0 END AS ENTIRE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_total ELSE 0 END AS ENTIRE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_total ELSE 0 END AS ENTIRE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_total ELSE 0 END AS ENTIRE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_total ELSE 0 END AS ENTIRE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_total ELSE 0 END AS ENTIRE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_total ELSE 0 END AS ENTIRE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_total ELSE 0 END AS ENTIRE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_total ELSE 0 END AS ENTIRE_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}				
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사별 센터 내 팀별 총합계 현황 신규 : 물보험 20230626-->
	<select id="PtnrStatTeamEntire" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.ENTIRE_12
			,TA.ENTIRE_11
			,TA.ENTIRE_10
			,TA.ENTIRE_09
			,TA.ENTIRE_08
			,TA.ENTIRE_07
			,TA.ENTIRE_06
			,TA.ENTIRE_05
			,TA.ENTIRE_04
			,TA.ENTIRE_03
			,TA.ENTIRE_02
			,TA.ENTIRE_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.ENTIRE_12,0) AS ENTIRE_12
				,IFNULL(GB.ENTIRE_11,0) AS ENTIRE_11
				,IFNULL(GB.ENTIRE_10,0) AS ENTIRE_10
				,IFNULL(GB.ENTIRE_09,0) AS ENTIRE_09
				,IFNULL(GB.ENTIRE_08,0) AS ENTIRE_08
				,IFNULL(GB.ENTIRE_07,0) AS ENTIRE_07
				,IFNULL(GB.ENTIRE_06,0) AS ENTIRE_06
				,IFNULL(GB.ENTIRE_05,0) AS ENTIRE_05
				,IFNULL(GB.ENTIRE_04,0) AS ENTIRE_04
				,IFNULL(GB.ENTIRE_03,0) AS ENTIRE_03
				,IFNULL(GB.ENTIRE_02,0) AS ENTIRE_02
				,IFNULL(GB.ENTIRE_01,0) AS ENTIRE_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.ENTIRE_12) AS ENTIRE_12
					,SUM(GA.ENTIRE_11) AS ENTIRE_11
					,SUM(GA.ENTIRE_10) AS ENTIRE_10
					,SUM(GA.ENTIRE_09) AS ENTIRE_09
					,SUM(GA.ENTIRE_08) AS ENTIRE_08
					,SUM(GA.ENTIRE_07) AS ENTIRE_07
					,SUM(GA.ENTIRE_06) AS ENTIRE_06
					,SUM(GA.ENTIRE_05) AS ENTIRE_05
					,SUM(GA.ENTIRE_04) AS ENTIRE_04
					,SUM(GA.ENTIRE_03) AS ENTIRE_03
					,SUM(GA.ENTIRE_02) AS ENTIRE_02
					,SUM(GA.ENTIRE_01) AS ENTIRE_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS ENTIRE_12
						,0 AS ENTIRE_11
						,0 AS ENTIRE_10
						,0 AS ENTIRE_09
						,0 AS ENTIRE_08
						,0 AS ENTIRE_07
						,0 AS ENTIRE_06
						,0 AS ENTIRE_05
						,0 AS ENTIRE_04
						,0 AS ENTIRE_03
						,0 AS ENTIRE_02
						,0 AS ENTIRE_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_total ELSE 0 END AS ENTIRE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_total ELSE 0 END AS ENTIRE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_total ELSE 0 END AS ENTIRE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_total ELSE 0 END AS ENTIRE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_total ELSE 0 END AS ENTIRE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_total ELSE 0 END AS ENTIRE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_total ELSE 0 END AS ENTIRE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_total ELSE 0 END AS ENTIRE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_total ELSE 0 END AS ENTIRE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_total ELSE 0 END AS ENTIRE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_total ELSE 0 END AS ENTIRE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_total ELSE 0 END AS ENTIRE_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_total ELSE 0 END AS ENTIRE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_total ELSE 0 END AS ENTIRE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_total ELSE 0 END AS ENTIRE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_total ELSE 0 END AS ENTIRE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_total ELSE 0 END AS ENTIRE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_total ELSE 0 END AS ENTIRE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_total ELSE 0 END AS ENTIRE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_total ELSE 0 END AS ENTIRE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_total ELSE 0 END AS ENTIRE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_total ELSE 0 END AS ENTIRE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_total ELSE 0 END AS ENTIRE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_total ELSE 0 END AS ENTIRE_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_center = #{team_center}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사별 센터별 총합계 현황 신규 : 물보험 20230622-->
	<select id="PtnrStatCenterEntire" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.ENTIRE_12
			,TA.ENTIRE_11
			,TA.ENTIRE_10
			,TA.ENTIRE_09
			,TA.ENTIRE_08
			,TA.ENTIRE_07
			,TA.ENTIRE_06
			,TA.ENTIRE_05
			,TA.ENTIRE_04
			,TA.ENTIRE_03
			,TA.ENTIRE_02
			,TA.ENTIRE_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.ENTIRE_12,0) AS ENTIRE_12
				,IFNULL(GB.ENTIRE_11,0) AS ENTIRE_11
				,IFNULL(GB.ENTIRE_10,0) AS ENTIRE_10
				,IFNULL(GB.ENTIRE_09,0) AS ENTIRE_09
				,IFNULL(GB.ENTIRE_08,0) AS ENTIRE_08
				,IFNULL(GB.ENTIRE_07,0) AS ENTIRE_07
				,IFNULL(GB.ENTIRE_06,0) AS ENTIRE_06
				,IFNULL(GB.ENTIRE_05,0) AS ENTIRE_05
				,IFNULL(GB.ENTIRE_04,0) AS ENTIRE_04
				,IFNULL(GB.ENTIRE_03,0) AS ENTIRE_03
				,IFNULL(GB.ENTIRE_02,0) AS ENTIRE_02
				,IFNULL(GB.ENTIRE_01,0) AS ENTIRE_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.ENTIRE_12) AS ENTIRE_12
					,SUM(GA.ENTIRE_11) AS ENTIRE_11
					,SUM(GA.ENTIRE_10) AS ENTIRE_10
					,SUM(GA.ENTIRE_09) AS ENTIRE_09
					,SUM(GA.ENTIRE_08) AS ENTIRE_08
					,SUM(GA.ENTIRE_07) AS ENTIRE_07
					,SUM(GA.ENTIRE_06) AS ENTIRE_06
					,SUM(GA.ENTIRE_05) AS ENTIRE_05
					,SUM(GA.ENTIRE_04) AS ENTIRE_04
					,SUM(GA.ENTIRE_03) AS ENTIRE_03
					,SUM(GA.ENTIRE_02) AS ENTIRE_02
					,SUM(GA.ENTIRE_01) AS ENTIRE_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS ENTIRE_12
						,0 AS ENTIRE_11
						,0 AS ENTIRE_10
						,0 AS ENTIRE_09
						,0 AS ENTIRE_08
						,0 AS ENTIRE_07
						,0 AS ENTIRE_06
						,0 AS ENTIRE_05
						,0 AS ENTIRE_04
						,0 AS ENTIRE_03
						,0 AS ENTIRE_02
						,0 AS ENTIRE_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_total ELSE 0 END AS ENTIRE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_total ELSE 0 END AS ENTIRE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_total ELSE 0 END AS ENTIRE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_total ELSE 0 END AS ENTIRE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_total ELSE 0 END AS ENTIRE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_total ELSE 0 END AS ENTIRE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_total ELSE 0 END AS ENTIRE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_total ELSE 0 END AS ENTIRE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_total ELSE 0 END AS ENTIRE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_total ELSE 0 END AS ENTIRE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_total ELSE 0 END AS ENTIRE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_total ELSE 0 END AS ENTIRE_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_total ELSE 0 END AS ENTIRE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_total ELSE 0 END AS ENTIRE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_total ELSE 0 END AS ENTIRE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_total ELSE 0 END AS ENTIRE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_total ELSE 0 END AS ENTIRE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_total ELSE 0 END AS ENTIRE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_total ELSE 0 END AS ENTIRE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_total ELSE 0 END AS ENTIRE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_total ELSE 0 END AS ENTIRE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_total ELSE 0 END AS ENTIRE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_total ELSE 0 END AS ENTIRE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_total ELSE 0 END AS ENTIRE_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_center, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_center, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_center
				,COUNT(GA.team_center) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_center	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_center, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_center
		)CNT
		ON TA.team_center = CNT.team_center
	</select>
	
	<!-- 보험사별 센터별 교통비 현황 신규 : 물보험 20230622-->
	<select id="PtnrStatCenterTraffic" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.TRAFFIC_12
			,TA.TRAFFIC_11
			,TA.TRAFFIC_10
			,TA.TRAFFIC_09
			,TA.TRAFFIC_08
			,TA.TRAFFIC_07
			,TA.TRAFFIC_06
			,TA.TRAFFIC_05
			,TA.TRAFFIC_04
			,TA.TRAFFIC_03
			,TA.TRAFFIC_02
			,TA.TRAFFIC_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.TRAFFIC_12,0) AS TRAFFIC_12
				,IFNULL(GB.TRAFFIC_11,0) AS TRAFFIC_11
				,IFNULL(GB.TRAFFIC_10,0) AS TRAFFIC_10
				,IFNULL(GB.TRAFFIC_09,0) AS TRAFFIC_09
				,IFNULL(GB.TRAFFIC_08,0) AS TRAFFIC_08
				,IFNULL(GB.TRAFFIC_07,0) AS TRAFFIC_07
				,IFNULL(GB.TRAFFIC_06,0) AS TRAFFIC_06
				,IFNULL(GB.TRAFFIC_05,0) AS TRAFFIC_05
				,IFNULL(GB.TRAFFIC_04,0) AS TRAFFIC_04
				,IFNULL(GB.TRAFFIC_03,0) AS TRAFFIC_03
				,IFNULL(GB.TRAFFIC_02,0) AS TRAFFIC_02
				,IFNULL(GB.TRAFFIC_01,0) AS TRAFFIC_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.TRAFFIC_12) AS TRAFFIC_12
					,SUM(GA.TRAFFIC_11) AS TRAFFIC_11
					,SUM(GA.TRAFFIC_10) AS TRAFFIC_10
					,SUM(GA.TRAFFIC_09) AS TRAFFIC_09
					,SUM(GA.TRAFFIC_08) AS TRAFFIC_08
					,SUM(GA.TRAFFIC_07) AS TRAFFIC_07
					,SUM(GA.TRAFFIC_06) AS TRAFFIC_06
					,SUM(GA.TRAFFIC_05) AS TRAFFIC_05
					,SUM(GA.TRAFFIC_04) AS TRAFFIC_04
					,SUM(GA.TRAFFIC_03) AS TRAFFIC_03
					,SUM(GA.TRAFFIC_02) AS TRAFFIC_02
					,SUM(GA.TRAFFIC_01) AS TRAFFIC_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS TRAFFIC_12
						,0 AS TRAFFIC_11
						,0 AS TRAFFIC_10
						,0 AS TRAFFIC_09
						,0 AS TRAFFIC_08
						,0 AS TRAFFIC_07
						,0 AS TRAFFIC_06
						,0 AS TRAFFIC_05
						,0 AS TRAFFIC_04
						,0 AS TRAFFIC_03
						,0 AS TRAFFIC_02
						,0 AS TRAFFIC_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_center, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_center, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_center
				,COUNT(GA.team_center) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_center	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_center, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_center
		)CNT
		ON TA.team_center = CNT.team_center
	</select>
	
	<!-- 보험사별 센터 팀내 자문료+기타 현황 신규 : 물보험 20230627-->
	<select id="PtnrStatMemberEtc" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,TA.user_no
			,TA.user_name
			
			,TA.ETC_12
			,TA.ETC_11
			,TA.ETC_10
			,TA.ETC_09
			,TA.ETC_08
			,TA.ETC_07
			,TA.ETC_06
			,TA.ETC_05
			,TA.ETC_04
			,TA.ETC_03
			,TA.ETC_02
			,TA.ETC_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order

				,GB.user_no			
				,TMB.user_name
				,TMB.work_level
				,TMB.join_date			
				,CASE TMB.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15
				END AS new_work_order

				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.ETC_12,0) AS ETC_12
				,IFNULL(GB.ETC_11,0) AS ETC_11
				,IFNULL(GB.ETC_10,0) AS ETC_10
				,IFNULL(GB.ETC_09,0) AS ETC_09
				,IFNULL(GB.ETC_08,0) AS ETC_08
				,IFNULL(GB.ETC_07,0) AS ETC_07
				,IFNULL(GB.ETC_06,0) AS ETC_06
				,IFNULL(GB.ETC_05,0) AS ETC_05
				,IFNULL(GB.ETC_04,0) AS ETC_04
				,IFNULL(GB.ETC_03,0) AS ETC_03
				,IFNULL(GB.ETC_02,0) AS ETC_02
				,IFNULL(GB.ETC_01,0) AS ETC_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,GA.user_no
					,SUM(GA.ETC_12) AS ETC_12
					,SUM(GA.ETC_11) AS ETC_11
					,SUM(GA.ETC_10) AS ETC_10
					,SUM(GA.ETC_09) AS ETC_09
					,SUM(GA.ETC_08) AS ETC_08
					,SUM(GA.ETC_07) AS ETC_07
					,SUM(GA.ETC_06) AS ETC_06
					,SUM(GA.ETC_05) AS ETC_05
					,SUM(GA.ETC_04) AS ETC_04
					,SUM(GA.ETC_03) AS ETC_03
					,SUM(GA.ETC_02) AS ETC_02
					,SUM(GA.ETC_01) AS ETC_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,"" AS user_no
						,0 AS ETC_12
						,0 AS ETC_11
						,0 AS ETC_10
						,0 AS ETC_09
						,0 AS ETC_08
						,0 AS ETC_07
						,0 AS ETC_06
						,0 AS ETC_05
						,0 AS ETC_04
						,0 AS ETC_03
						,0 AS ETC_02
						,0 AS ETC_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.user_no, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			LEFT JOIN top_mbr_bsc TMB
			ON GB.user_no = TMB.user_no		
			ORDER BY new_work_order, TMB.work_level DESC, TMB.join_date, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.user_no
				,COUNT(GA.user_no) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,A.user_no	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_id = #{team_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.user_no
		)CNT
		ON TA.user_no = CNT.user_no
	</select>
	
	<!-- 보험사별 팀 전체 자문료+기타 현황 신규 : 물보험 20230630-->
	<select id="PtnrStatTeamAllEtc" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.ETC_12
			,TA.ETC_11
			,TA.ETC_10
			,TA.ETC_09
			,TA.ETC_08
			,TA.ETC_07
			,TA.ETC_06
			,TA.ETC_05
			,TA.ETC_04
			,TA.ETC_03
			,TA.ETC_02
			,TA.ETC_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.ETC_12,0) AS ETC_12
				,IFNULL(GB.ETC_11,0) AS ETC_11
				,IFNULL(GB.ETC_10,0) AS ETC_10
				,IFNULL(GB.ETC_09,0) AS ETC_09
				,IFNULL(GB.ETC_08,0) AS ETC_08
				,IFNULL(GB.ETC_07,0) AS ETC_07
				,IFNULL(GB.ETC_06,0) AS ETC_06
				,IFNULL(GB.ETC_05,0) AS ETC_05
				,IFNULL(GB.ETC_04,0) AS ETC_04
				,IFNULL(GB.ETC_03,0) AS ETC_03
				,IFNULL(GB.ETC_02,0) AS ETC_02
				,IFNULL(GB.ETC_01,0) AS ETC_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.ETC_12) AS ETC_12
					,SUM(GA.ETC_11) AS ETC_11
					,SUM(GA.ETC_10) AS ETC_10
					,SUM(GA.ETC_09) AS ETC_09
					,SUM(GA.ETC_08) AS ETC_08
					,SUM(GA.ETC_07) AS ETC_07
					,SUM(GA.ETC_06) AS ETC_06
					,SUM(GA.ETC_05) AS ETC_05
					,SUM(GA.ETC_04) AS ETC_04
					,SUM(GA.ETC_03) AS ETC_03
					,SUM(GA.ETC_02) AS ETC_02
					,SUM(GA.ETC_01) AS ETC_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS ETC_12
						,0 AS ETC_11
						,0 AS ETC_10
						,0 AS ETC_09
						,0 AS ETC_08
						,0 AS ETC_07
						,0 AS ETC_06
						,0 AS ETC_05
						,0 AS ETC_04
						,0 AS ETC_03
						,0 AS ETC_02
						,0 AS ETC_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}				
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사별 센터내 팀별 자문료+기타 현황 신규 : 물보험 20230626-->
	<select id="PtnrStatTeamEtc" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.ETC_12
			,TA.ETC_11
			,TA.ETC_10
			,TA.ETC_09
			,TA.ETC_08
			,TA.ETC_07
			,TA.ETC_06
			,TA.ETC_05
			,TA.ETC_04
			,TA.ETC_03
			,TA.ETC_02
			,TA.ETC_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.ETC_12,0) AS ETC_12
				,IFNULL(GB.ETC_11,0) AS ETC_11
				,IFNULL(GB.ETC_10,0) AS ETC_10
				,IFNULL(GB.ETC_09,0) AS ETC_09
				,IFNULL(GB.ETC_08,0) AS ETC_08
				,IFNULL(GB.ETC_07,0) AS ETC_07
				,IFNULL(GB.ETC_06,0) AS ETC_06
				,IFNULL(GB.ETC_05,0) AS ETC_05
				,IFNULL(GB.ETC_04,0) AS ETC_04
				,IFNULL(GB.ETC_03,0) AS ETC_03
				,IFNULL(GB.ETC_02,0) AS ETC_02
				,IFNULL(GB.ETC_01,0) AS ETC_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.ETC_12) AS ETC_12
					,SUM(GA.ETC_11) AS ETC_11
					,SUM(GA.ETC_10) AS ETC_10
					,SUM(GA.ETC_09) AS ETC_09
					,SUM(GA.ETC_08) AS ETC_08
					,SUM(GA.ETC_07) AS ETC_07
					,SUM(GA.ETC_06) AS ETC_06
					,SUM(GA.ETC_05) AS ETC_05
					,SUM(GA.ETC_04) AS ETC_04
					,SUM(GA.ETC_03) AS ETC_03
					,SUM(GA.ETC_02) AS ETC_02
					,SUM(GA.ETC_01) AS ETC_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS ETC_12
						,0 AS ETC_11
						,0 AS ETC_10
						,0 AS ETC_09
						,0 AS ETC_08
						,0 AS ETC_07
						,0 AS ETC_06
						,0 AS ETC_05
						,0 AS ETC_04
						,0 AS ETC_03
						,0 AS ETC_02
						,0 AS ETC_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_center = #{team_center}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사별 센터별 자문료+기타 현황 신규 : 물보험 20230623-->
	<select id="PtnrStatCenterEtc" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.ETC_12
			,TA.ETC_11
			,TA.ETC_10
			,TA.ETC_09
			,TA.ETC_08
			,TA.ETC_07
			,TA.ETC_06
			,TA.ETC_05
			,TA.ETC_04
			,TA.ETC_03
			,TA.ETC_02
			,TA.ETC_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.ETC_12,0) AS ETC_12
				,IFNULL(GB.ETC_11,0) AS ETC_11
				,IFNULL(GB.ETC_10,0) AS ETC_10
				,IFNULL(GB.ETC_09,0) AS ETC_09
				,IFNULL(GB.ETC_08,0) AS ETC_08
				,IFNULL(GB.ETC_07,0) AS ETC_07
				,IFNULL(GB.ETC_06,0) AS ETC_06
				,IFNULL(GB.ETC_05,0) AS ETC_05
				,IFNULL(GB.ETC_04,0) AS ETC_04
				,IFNULL(GB.ETC_03,0) AS ETC_03
				,IFNULL(GB.ETC_02,0) AS ETC_02
				,IFNULL(GB.ETC_01,0) AS ETC_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.ETC_12) AS ETC_12
					,SUM(GA.ETC_11) AS ETC_11
					,SUM(GA.ETC_10) AS ETC_10
					,SUM(GA.ETC_09) AS ETC_09
					,SUM(GA.ETC_08) AS ETC_08
					,SUM(GA.ETC_07) AS ETC_07
					,SUM(GA.ETC_06) AS ETC_06
					,SUM(GA.ETC_05) AS ETC_05
					,SUM(GA.ETC_04) AS ETC_04
					,SUM(GA.ETC_03) AS ETC_03
					,SUM(GA.ETC_02) AS ETC_02
					,SUM(GA.ETC_01) AS ETC_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS ETC_12
						,0 AS ETC_11
						,0 AS ETC_10
						,0 AS ETC_09
						,0 AS ETC_08
						,0 AS ETC_07
						,0 AS ETC_06
						,0 AS ETC_05
						,0 AS ETC_04
						,0 AS ETC_03
						,0 AS ETC_02
						,0 AS ETC_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_counsel + C.amt_etc) ELSE 0 END AS ETC_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_center, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_center, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_center
				,COUNT(GA.team_center) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_center	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_center, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_center
		)CNT
		ON TA.team_center = CNT.team_center
	</select>
	
	<!-- 보험사별 센터 팀내 직원별 교통비 현황 신규 : 물보험 20230627-->
	<select id="PtnrStatMemberTraffic" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,TA.user_no
			,TA.user_name
			
			,TA.TRAFFIC_12
			,TA.TRAFFIC_11
			,TA.TRAFFIC_10
			,TA.TRAFFIC_09
			,TA.TRAFFIC_08
			,TA.TRAFFIC_07
			,TA.TRAFFIC_06
			,TA.TRAFFIC_05
			,TA.TRAFFIC_04
			,TA.TRAFFIC_03
			,TA.TRAFFIC_02
			,TA.TRAFFIC_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order

				,GB.user_no			
				,TMB.user_name
				,TMB.work_level
				,TMB.join_date			
				,CASE TMB.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15
				END AS new_work_order

				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.TRAFFIC_12,0) AS TRAFFIC_12
				,IFNULL(GB.TRAFFIC_11,0) AS TRAFFIC_11
				,IFNULL(GB.TRAFFIC_10,0) AS TRAFFIC_10
				,IFNULL(GB.TRAFFIC_09,0) AS TRAFFIC_09
				,IFNULL(GB.TRAFFIC_08,0) AS TRAFFIC_08
				,IFNULL(GB.TRAFFIC_07,0) AS TRAFFIC_07
				,IFNULL(GB.TRAFFIC_06,0) AS TRAFFIC_06
				,IFNULL(GB.TRAFFIC_05,0) AS TRAFFIC_05
				,IFNULL(GB.TRAFFIC_04,0) AS TRAFFIC_04
				,IFNULL(GB.TRAFFIC_03,0) AS TRAFFIC_03
				,IFNULL(GB.TRAFFIC_02,0) AS TRAFFIC_02
				,IFNULL(GB.TRAFFIC_01,0) AS TRAFFIC_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,GA.user_no
					,SUM(GA.TRAFFIC_12) AS TRAFFIC_12
					,SUM(GA.TRAFFIC_11) AS TRAFFIC_11
					,SUM(GA.TRAFFIC_10) AS TRAFFIC_10
					,SUM(GA.TRAFFIC_09) AS TRAFFIC_09
					,SUM(GA.TRAFFIC_08) AS TRAFFIC_08
					,SUM(GA.TRAFFIC_07) AS TRAFFIC_07
					,SUM(GA.TRAFFIC_06) AS TRAFFIC_06
					,SUM(GA.TRAFFIC_05) AS TRAFFIC_05
					,SUM(GA.TRAFFIC_04) AS TRAFFIC_04
					,SUM(GA.TRAFFIC_03) AS TRAFFIC_03
					,SUM(GA.TRAFFIC_02) AS TRAFFIC_02
					,SUM(GA.TRAFFIC_01) AS TRAFFIC_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order
						,"" AS user_no
						,0 AS TRAFFIC_12
						,0 AS TRAFFIC_11
						,0 AS TRAFFIC_10
						,0 AS TRAFFIC_09
						,0 AS TRAFFIC_08
						,0 AS TRAFFIC_07
						,0 AS TRAFFIC_06
						,0 AS TRAFFIC_05
						,0 AS TRAFFIC_04
						,0 AS TRAFFIC_03
						,0 AS TRAFFIC_02
						,0 AS TRAFFIC_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.user_no, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			LEFT JOIN top_mbr_bsc TMB
			ON GB.user_no = TMB.user_no		
			ORDER BY new_work_order, TMB.work_level DESC, TMB.join_date, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.user_no
				,COUNT(GA.user_no) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,A.user_no
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_id = #{team_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.user_no
		)CNT
		ON TA.user_no = CNT.user_no
	</select>
	
	<!-- 보험사별 팀 전체 교통비 현황 신규 : 물보험 20230630-->
	<select id="PtnrStatTeamAllTraffic" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.TRAFFIC_12
			,TA.TRAFFIC_11
			,TA.TRAFFIC_10
			,TA.TRAFFIC_09
			,TA.TRAFFIC_08
			,TA.TRAFFIC_07
			,TA.TRAFFIC_06
			,TA.TRAFFIC_05
			,TA.TRAFFIC_04
			,TA.TRAFFIC_03
			,TA.TRAFFIC_02
			,TA.TRAFFIC_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.TRAFFIC_12,0) AS TRAFFIC_12
				,IFNULL(GB.TRAFFIC_11,0) AS TRAFFIC_11
				,IFNULL(GB.TRAFFIC_10,0) AS TRAFFIC_10
				,IFNULL(GB.TRAFFIC_09,0) AS TRAFFIC_09
				,IFNULL(GB.TRAFFIC_08,0) AS TRAFFIC_08
				,IFNULL(GB.TRAFFIC_07,0) AS TRAFFIC_07
				,IFNULL(GB.TRAFFIC_06,0) AS TRAFFIC_06
				,IFNULL(GB.TRAFFIC_05,0) AS TRAFFIC_05
				,IFNULL(GB.TRAFFIC_04,0) AS TRAFFIC_04
				,IFNULL(GB.TRAFFIC_03,0) AS TRAFFIC_03
				,IFNULL(GB.TRAFFIC_02,0) AS TRAFFIC_02
				,IFNULL(GB.TRAFFIC_01,0) AS TRAFFIC_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.TRAFFIC_12) AS TRAFFIC_12
					,SUM(GA.TRAFFIC_11) AS TRAFFIC_11
					,SUM(GA.TRAFFIC_10) AS TRAFFIC_10
					,SUM(GA.TRAFFIC_09) AS TRAFFIC_09
					,SUM(GA.TRAFFIC_08) AS TRAFFIC_08
					,SUM(GA.TRAFFIC_07) AS TRAFFIC_07
					,SUM(GA.TRAFFIC_06) AS TRAFFIC_06
					,SUM(GA.TRAFFIC_05) AS TRAFFIC_05
					,SUM(GA.TRAFFIC_04) AS TRAFFIC_04
					,SUM(GA.TRAFFIC_03) AS TRAFFIC_03
					,SUM(GA.TRAFFIC_02) AS TRAFFIC_02
					,SUM(GA.TRAFFIC_01) AS TRAFFIC_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS TRAFFIC_12
						,0 AS TRAFFIC_11
						,0 AS TRAFFIC_10
						,0 AS TRAFFIC_09
						,0 AS TRAFFIC_08
						,0 AS TRAFFIC_07
						,0 AS TRAFFIC_06
						,0 AS TRAFFIC_05
						,0 AS TRAFFIC_04
						,0 AS TRAFFIC_03
						,0 AS TRAFFIC_02
						,0 AS TRAFFIC_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사별 센터내 팀별 교통비 현황 신규 : 물보험 20230626-->
	<select id="PtnrStatTeamTraffic" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.TRAFFIC_12
			,TA.TRAFFIC_11
			,TA.TRAFFIC_10
			,TA.TRAFFIC_09
			,TA.TRAFFIC_08
			,TA.TRAFFIC_07
			,TA.TRAFFIC_06
			,TA.TRAFFIC_05
			,TA.TRAFFIC_04
			,TA.TRAFFIC_03
			,TA.TRAFFIC_02
			,TA.TRAFFIC_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.TRAFFIC_12,0) AS TRAFFIC_12
				,IFNULL(GB.TRAFFIC_11,0) AS TRAFFIC_11
				,IFNULL(GB.TRAFFIC_10,0) AS TRAFFIC_10
				,IFNULL(GB.TRAFFIC_09,0) AS TRAFFIC_09
				,IFNULL(GB.TRAFFIC_08,0) AS TRAFFIC_08
				,IFNULL(GB.TRAFFIC_07,0) AS TRAFFIC_07
				,IFNULL(GB.TRAFFIC_06,0) AS TRAFFIC_06
				,IFNULL(GB.TRAFFIC_05,0) AS TRAFFIC_05
				,IFNULL(GB.TRAFFIC_04,0) AS TRAFFIC_04
				,IFNULL(GB.TRAFFIC_03,0) AS TRAFFIC_03
				,IFNULL(GB.TRAFFIC_02,0) AS TRAFFIC_02
				,IFNULL(GB.TRAFFIC_01,0) AS TRAFFIC_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.TRAFFIC_12) AS TRAFFIC_12
					,SUM(GA.TRAFFIC_11) AS TRAFFIC_11
					,SUM(GA.TRAFFIC_10) AS TRAFFIC_10
					,SUM(GA.TRAFFIC_09) AS TRAFFIC_09
					,SUM(GA.TRAFFIC_08) AS TRAFFIC_08
					,SUM(GA.TRAFFIC_07) AS TRAFFIC_07
					,SUM(GA.TRAFFIC_06) AS TRAFFIC_06
					,SUM(GA.TRAFFIC_05) AS TRAFFIC_05
					,SUM(GA.TRAFFIC_04) AS TRAFFIC_04
					,SUM(GA.TRAFFIC_03) AS TRAFFIC_03
					,SUM(GA.TRAFFIC_02) AS TRAFFIC_02
					,SUM(GA.TRAFFIC_01) AS TRAFFIC_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS TRAFFIC_12
						,0 AS TRAFFIC_11
						,0 AS TRAFFIC_10
						,0 AS TRAFFIC_09
						,0 AS TRAFFIC_08
						,0 AS TRAFFIC_07
						,0 AS TRAFFIC_06
						,0 AS TRAFFIC_05
						,0 AS TRAFFIC_04
						,0 AS TRAFFIC_03
						,0 AS TRAFFIC_02
						,0 AS TRAFFIC_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_traffic ELSE 0 END AS TRAFFIC_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_center = #{team_center}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사 센터 팀내 직원별 일비 현황 신규 : 물보험 20230627-->
	<select id="PtnrStatMemberTime" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,TA.user_no
			,TA.user_name
			
			,TA.TIME_12
			,TA.TIME_11
			,TA.TIME_10
			,TA.TIME_09
			,TA.TIME_08
			,TA.TIME_07
			,TA.TIME_06
			,TA.TIME_05
			,TA.TIME_04
			,TA.TIME_03
			,TA.TIME_02
			,TA.TIME_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order

				,GB.user_no			
				,TMB.user_name
				,TMB.work_level
				,TMB.join_date			
				,CASE TMB.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15
				END AS new_work_order

				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.TIME_12,0) AS TIME_12
				,IFNULL(GB.TIME_11,0) AS TIME_11
				,IFNULL(GB.TIME_10,0) AS TIME_10
				,IFNULL(GB.TIME_09,0) AS TIME_09
				,IFNULL(GB.TIME_08,0) AS TIME_08
				,IFNULL(GB.TIME_07,0) AS TIME_07
				,IFNULL(GB.TIME_06,0) AS TIME_06
				,IFNULL(GB.TIME_05,0) AS TIME_05
				,IFNULL(GB.TIME_04,0) AS TIME_04
				,IFNULL(GB.TIME_03,0) AS TIME_03
				,IFNULL(GB.TIME_02,0) AS TIME_02
				,IFNULL(GB.TIME_01,0) AS TIME_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,GA.user_no
					,SUM(GA.TIME_12) AS TIME_12
					,SUM(GA.TIME_11) AS TIME_11
					,SUM(GA.TIME_10) AS TIME_10
					,SUM(GA.TIME_09) AS TIME_09
					,SUM(GA.TIME_08) AS TIME_08
					,SUM(GA.TIME_07) AS TIME_07
					,SUM(GA.TIME_06) AS TIME_06
					,SUM(GA.TIME_05) AS TIME_05
					,SUM(GA.TIME_04) AS TIME_04
					,SUM(GA.TIME_03) AS TIME_03
					,SUM(GA.TIME_02) AS TIME_02
					,SUM(GA.TIME_01) AS TIME_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order
						,"" AS user_no
						,0 AS TIME_12
						,0 AS TIME_11
						,0 AS TIME_10
						,0 AS TIME_09
						,0 AS TIME_08
						,0 AS TIME_07
						,0 AS TIME_06
						,0 AS TIME_05
						,0 AS TIME_04
						,0 AS TIME_03
						,0 AS TIME_02
						,0 AS TIME_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.user_no, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			LEFT JOIN top_mbr_bsc TMB
			ON GB.user_no = TMB.user_no		
			ORDER BY new_work_order, TMB.work_level DESC, TMB.join_date, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.user_no
				,COUNT(GA.user_no) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,A.user_no
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_id = #{team_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.user_no
		)CNT
		ON TA.user_no = CNT.user_no
	</select>
	
	<!-- 보험사별 팀전체 일비 현황 신규 : 물보험 20230630-->
	<select id="PtnrStatTeamAllTime" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.TIME_12
			,TA.TIME_11
			,TA.TIME_10
			,TA.TIME_09
			,TA.TIME_08
			,TA.TIME_07
			,TA.TIME_06
			,TA.TIME_05
			,TA.TIME_04
			,TA.TIME_03
			,TA.TIME_02
			,TA.TIME_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.TIME_12,0) AS TIME_12
				,IFNULL(GB.TIME_11,0) AS TIME_11
				,IFNULL(GB.TIME_10,0) AS TIME_10
				,IFNULL(GB.TIME_09,0) AS TIME_09
				,IFNULL(GB.TIME_08,0) AS TIME_08
				,IFNULL(GB.TIME_07,0) AS TIME_07
				,IFNULL(GB.TIME_06,0) AS TIME_06
				,IFNULL(GB.TIME_05,0) AS TIME_05
				,IFNULL(GB.TIME_04,0) AS TIME_04
				,IFNULL(GB.TIME_03,0) AS TIME_03
				,IFNULL(GB.TIME_02,0) AS TIME_02
				,IFNULL(GB.TIME_01,0) AS TIME_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.TIME_12) AS TIME_12
					,SUM(GA.TIME_11) AS TIME_11
					,SUM(GA.TIME_10) AS TIME_10
					,SUM(GA.TIME_09) AS TIME_09
					,SUM(GA.TIME_08) AS TIME_08
					,SUM(GA.TIME_07) AS TIME_07
					,SUM(GA.TIME_06) AS TIME_06
					,SUM(GA.TIME_05) AS TIME_05
					,SUM(GA.TIME_04) AS TIME_04
					,SUM(GA.TIME_03) AS TIME_03
					,SUM(GA.TIME_02) AS TIME_02
					,SUM(GA.TIME_01) AS TIME_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS TIME_12
						,0 AS TIME_11
						,0 AS TIME_10
						,0 AS TIME_09
						,0 AS TIME_08
						,0 AS TIME_07
						,0 AS TIME_06
						,0 AS TIME_05
						,0 AS TIME_04
						,0 AS TIME_03
						,0 AS TIME_02
						,0 AS TIME_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}				
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사별 센터내 팁별 일비 현황 신규 : 물보험 20230626-->
	<select id="PtnrStatTeamTime" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.TIME_12
			,TA.TIME_11
			,TA.TIME_10
			,TA.TIME_09
			,TA.TIME_08
			,TA.TIME_07
			,TA.TIME_06
			,TA.TIME_05
			,TA.TIME_04
			,TA.TIME_03
			,TA.TIME_02
			,TA.TIME_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.TIME_12,0) AS TIME_12
				,IFNULL(GB.TIME_11,0) AS TIME_11
				,IFNULL(GB.TIME_10,0) AS TIME_10
				,IFNULL(GB.TIME_09,0) AS TIME_09
				,IFNULL(GB.TIME_08,0) AS TIME_08
				,IFNULL(GB.TIME_07,0) AS TIME_07
				,IFNULL(GB.TIME_06,0) AS TIME_06
				,IFNULL(GB.TIME_05,0) AS TIME_05
				,IFNULL(GB.TIME_04,0) AS TIME_04
				,IFNULL(GB.TIME_03,0) AS TIME_03
				,IFNULL(GB.TIME_02,0) AS TIME_02
				,IFNULL(GB.TIME_01,0) AS TIME_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.TIME_12) AS TIME_12
					,SUM(GA.TIME_11) AS TIME_11
					,SUM(GA.TIME_10) AS TIME_10
					,SUM(GA.TIME_09) AS TIME_09
					,SUM(GA.TIME_08) AS TIME_08
					,SUM(GA.TIME_07) AS TIME_07
					,SUM(GA.TIME_06) AS TIME_06
					,SUM(GA.TIME_05) AS TIME_05
					,SUM(GA.TIME_04) AS TIME_04
					,SUM(GA.TIME_03) AS TIME_03
					,SUM(GA.TIME_02) AS TIME_02
					,SUM(GA.TIME_01) AS TIME_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS TIME_12
						,0 AS TIME_11
						,0 AS TIME_10
						,0 AS TIME_09
						,0 AS TIME_08
						,0 AS TIME_07
						,0 AS TIME_06
						,0 AS TIME_05
						,0 AS TIME_04
						,0 AS TIME_03
						,0 AS TIME_02
						,0 AS TIME_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_center = #{team_center}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사별 센터별 일비 현황 신규 : 물보험 20230622-->
	<select id="PtnrStatCenterTime" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.TIME_12
			,TA.TIME_11
			,TA.TIME_10
			,TA.TIME_09
			,TA.TIME_08
			,TA.TIME_07
			,TA.TIME_06
			,TA.TIME_05
			,TA.TIME_04
			,TA.TIME_03
			,TA.TIME_02
			,TA.TIME_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.TIME_12,0) AS TIME_12
				,IFNULL(GB.TIME_11,0) AS TIME_11
				,IFNULL(GB.TIME_10,0) AS TIME_10
				,IFNULL(GB.TIME_09,0) AS TIME_09
				,IFNULL(GB.TIME_08,0) AS TIME_08
				,IFNULL(GB.TIME_07,0) AS TIME_07
				,IFNULL(GB.TIME_06,0) AS TIME_06
				,IFNULL(GB.TIME_05,0) AS TIME_05
				,IFNULL(GB.TIME_04,0) AS TIME_04
				,IFNULL(GB.TIME_03,0) AS TIME_03
				,IFNULL(GB.TIME_02,0) AS TIME_02
				,IFNULL(GB.TIME_01,0) AS TIME_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.TIME_12) AS TIME_12
					,SUM(GA.TIME_11) AS TIME_11
					,SUM(GA.TIME_10) AS TIME_10
					,SUM(GA.TIME_09) AS TIME_09
					,SUM(GA.TIME_08) AS TIME_08
					,SUM(GA.TIME_07) AS TIME_07
					,SUM(GA.TIME_06) AS TIME_06
					,SUM(GA.TIME_05) AS TIME_05
					,SUM(GA.TIME_04) AS TIME_04
					,SUM(GA.TIME_03) AS TIME_03
					,SUM(GA.TIME_02) AS TIME_02
					,SUM(GA.TIME_01) AS TIME_01
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS TIME_12
						,0 AS TIME_11
						,0 AS TIME_10
						,0 AS TIME_09
						,0 AS TIME_08
						,0 AS TIME_07
						,0 AS TIME_06
						,0 AS TIME_05
						,0 AS TIME_04
						,0 AS TIME_03
						,0 AS TIME_02
						,0 AS TIME_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_daily ELSE 0 END AS TIME_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_daily ELSE 0 END AS TIME_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_daily ELSE 0 END AS TIME_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_daily ELSE 0 END AS TIME_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_daily ELSE 0 END AS TIME_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_daily ELSE 0 END AS TIME_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_daily ELSE 0 END AS TIME_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_daily ELSE 0 END AS TIME_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_daily ELSE 0 END AS TIME_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_daily ELSE 0 END AS TIME_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_daily ELSE 0 END AS TIME_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_daily ELSE 0 END AS TIME_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_center, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_center, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_center
				,COUNT(GA.team_center) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_center	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_center, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_center
		)CNT
		ON TA.team_center = CNT.team_center		
	</select>
	
	<!-- 보험사 팀내 직원별 순수피 현황 신규 : 물보험 20230627-->
	<select id="PtnrStatMemberFee" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,TA.user_no
			,TA.user_name

			,TA.FEE_12
			,TA.FEE_11
			,TA.FEE_10
			,TA.FEE_09
			,TA.FEE_08
			,TA.FEE_07
			,TA.FEE_06
			,TA.FEE_05
			,TA.FEE_04
			,TA.FEE_03
			,TA.FEE_02
			,TA.FEE_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				
				,GB.user_no			
				,TMB.user_name
				,TMB.work_level
				,TMB.join_date			
				,CASE TMB.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15
				END AS new_work_order

				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.FEE_12,0) AS FEE_12
				,IFNULL(GB.FEE_11,0) AS FEE_11
				,IFNULL(GB.FEE_10,0) AS FEE_10
				,IFNULL(GB.FEE_09,0) AS FEE_09
				,IFNULL(GB.FEE_08,0) AS FEE_08
				,IFNULL(GB.FEE_07,0) AS FEE_07
				,IFNULL(GB.FEE_06,0) AS FEE_06
				,IFNULL(GB.FEE_05,0) AS FEE_05
				,IFNULL(GB.FEE_04,0) AS FEE_04
				,IFNULL(GB.FEE_03,0) AS FEE_03
				,IFNULL(GB.FEE_02,0) AS FEE_02
				,IFNULL(GB.FEE_01,0) AS FEE_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,GA.user_no
					,SUM(GA.FEE_12) AS FEE_12
					,SUM(GA.FEE_11) AS FEE_11
					,SUM(GA.FEE_10) AS FEE_10
					,SUM(GA.FEE_09) AS FEE_09
					,SUM(GA.FEE_08) AS FEE_08
					,SUM(GA.FEE_07) AS FEE_07
					,SUM(GA.FEE_06) AS FEE_06
					,SUM(GA.FEE_05) AS FEE_05
					,SUM(GA.FEE_04) AS FEE_04
					,SUM(GA.FEE_03) AS FEE_03
					,SUM(GA.FEE_02) AS FEE_02
					,SUM(GA.FEE_01) AS FEE_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order
						,"" AS user_no
						,0 AS FEE_12
						,0 AS FEE_11
						,0 AS FEE_10
						,0 AS FEE_09
						,0 AS FEE_08
						,0 AS FEE_07
						,0 AS FEE_06
						,0 AS FEE_05
						,0 AS FEE_04
						,0 AS FEE_03
						,0 AS FEE_02
						,0 AS FEE_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_basic ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_basic ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_basic ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_basic ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_basic ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_basic ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_basic ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_basic ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_basic ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_basic ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_basic ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_basic ELSE 0 END AS FEE_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.user_no, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			LEFT JOIN top_mbr_bsc TMB
			ON GB.user_no = TMB.user_no		
			ORDER BY new_work_order, TMB.work_level DESC, TMB.join_date, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.user_no
				,COUNT(GA.user_no) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,A.user_no	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_id = #{team_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.user_no
		)CNT
		ON TA.user_no = CNT.user_no
	</select>
	
	<!-- 보험사별 팀전체 순수피 현황 신규 : 물보험 20230630-->
	<select id="PtnrStatTeamAllFee" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.FEE_12
			,TA.FEE_11
			,TA.FEE_10
			,TA.FEE_09
			,TA.FEE_08
			,TA.FEE_07
			,TA.FEE_06
			,TA.FEE_05
			,TA.FEE_04
			,TA.FEE_03
			,TA.FEE_02
			,TA.FEE_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.FEE_12,0) AS FEE_12
				,IFNULL(GB.FEE_11,0) AS FEE_11
				,IFNULL(GB.FEE_10,0) AS FEE_10
				,IFNULL(GB.FEE_09,0) AS FEE_09
				,IFNULL(GB.FEE_08,0) AS FEE_08
				,IFNULL(GB.FEE_07,0) AS FEE_07
				,IFNULL(GB.FEE_06,0) AS FEE_06
				,IFNULL(GB.FEE_05,0) AS FEE_05
				,IFNULL(GB.FEE_04,0) AS FEE_04
				,IFNULL(GB.FEE_03,0) AS FEE_03
				,IFNULL(GB.FEE_02,0) AS FEE_02
				,IFNULL(GB.FEE_01,0) AS FEE_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.FEE_12) AS FEE_12
					,SUM(GA.FEE_11) AS FEE_11
					,SUM(GA.FEE_10) AS FEE_10
					,SUM(GA.FEE_09) AS FEE_09
					,SUM(GA.FEE_08) AS FEE_08
					,SUM(GA.FEE_07) AS FEE_07
					,SUM(GA.FEE_06) AS FEE_06
					,SUM(GA.FEE_05) AS FEE_05
					,SUM(GA.FEE_04) AS FEE_04
					,SUM(GA.FEE_03) AS FEE_03
					,SUM(GA.FEE_02) AS FEE_02
					,SUM(GA.FEE_01) AS FEE_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS FEE_12
						,0 AS FEE_11
						,0 AS FEE_10
						,0 AS FEE_09
						,0 AS FEE_08
						,0 AS FEE_07
						,0 AS FEE_06
						,0 AS FEE_05
						,0 AS FEE_04
						,0 AS FEE_03
						,0 AS FEE_02
						,0 AS FEE_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_basic ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_basic ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_basic ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_basic ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_basic ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_basic ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_basic ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_basic ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_basic ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_basic ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_basic ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_basic ELSE 0 END AS FEE_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}				
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사별 센터별 순수피 현황 신규 : 물보험 20230622-->
	<select id="PtnrStatTeamFee" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.FEE_12
			,TA.FEE_11
			,TA.FEE_10
			,TA.FEE_09
			,TA.FEE_08
			,TA.FEE_07
			,TA.FEE_06
			,TA.FEE_05
			,TA.FEE_04
			,TA.FEE_03
			,TA.FEE_02
			,TA.FEE_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.FEE_12,0) AS FEE_12
				,IFNULL(GB.FEE_11,0) AS FEE_11
				,IFNULL(GB.FEE_10,0) AS FEE_10
				,IFNULL(GB.FEE_09,0) AS FEE_09
				,IFNULL(GB.FEE_08,0) AS FEE_08
				,IFNULL(GB.FEE_07,0) AS FEE_07
				,IFNULL(GB.FEE_06,0) AS FEE_06
				,IFNULL(GB.FEE_05,0) AS FEE_05
				,IFNULL(GB.FEE_04,0) AS FEE_04
				,IFNULL(GB.FEE_03,0) AS FEE_03
				,IFNULL(GB.FEE_02,0) AS FEE_02
				,IFNULL(GB.FEE_01,0) AS FEE_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.FEE_12) AS FEE_12
					,SUM(GA.FEE_11) AS FEE_11
					,SUM(GA.FEE_10) AS FEE_10
					,SUM(GA.FEE_09) AS FEE_09
					,SUM(GA.FEE_08) AS FEE_08
					,SUM(GA.FEE_07) AS FEE_07
					,SUM(GA.FEE_06) AS FEE_06
					,SUM(GA.FEE_05) AS FEE_05
					,SUM(GA.FEE_04) AS FEE_04
					,SUM(GA.FEE_03) AS FEE_03
					,SUM(GA.FEE_02) AS FEE_02
					,SUM(GA.FEE_01) AS FEE_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS FEE_12
						,0 AS FEE_11
						,0 AS FEE_10
						,0 AS FEE_09
						,0 AS FEE_08
						,0 AS FEE_07
						,0 AS FEE_06
						,0 AS FEE_05
						,0 AS FEE_04
						,0 AS FEE_03
						,0 AS FEE_02
						,0 AS FEE_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_01	
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_basic ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_basic ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_basic ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_basic ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_basic ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_basic ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_basic ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_basic ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_basic ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_basic ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_basic ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_basic ELSE 0 END AS FEE_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_center = #{team_center}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사별 센터별 순수피 현황 신규 : 물보험 20230622-->
	<select id="PtnrStatCenterFee" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.FEE_12
			,TA.FEE_11
			,TA.FEE_10
			,TA.FEE_09
			,TA.FEE_08
			,TA.FEE_07
			,TA.FEE_06
			,TA.FEE_05
			,TA.FEE_04
			,TA.FEE_03
			,TA.FEE_02
			,TA.FEE_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.FEE_12,0) AS FEE_12
				,IFNULL(GB.FEE_11,0) AS FEE_11
				,IFNULL(GB.FEE_10,0) AS FEE_10
				,IFNULL(GB.FEE_09,0) AS FEE_09
				,IFNULL(GB.FEE_08,0) AS FEE_08
				,IFNULL(GB.FEE_07,0) AS FEE_07
				,IFNULL(GB.FEE_06,0) AS FEE_06
				,IFNULL(GB.FEE_05,0) AS FEE_05
				,IFNULL(GB.FEE_04,0) AS FEE_04
				,IFNULL(GB.FEE_03,0) AS FEE_03
				,IFNULL(GB.FEE_02,0) AS FEE_02
				,IFNULL(GB.FEE_01,0) AS FEE_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.FEE_12) AS FEE_12
					,SUM(GA.FEE_11) AS FEE_11
					,SUM(GA.FEE_10) AS FEE_10
					,SUM(GA.FEE_09) AS FEE_09
					,SUM(GA.FEE_08) AS FEE_08
					,SUM(GA.FEE_07) AS FEE_07
					,SUM(GA.FEE_06) AS FEE_06
					,SUM(GA.FEE_05) AS FEE_05
					,SUM(GA.FEE_04) AS FEE_04
					,SUM(GA.FEE_03) AS FEE_03
					,SUM(GA.FEE_02) AS FEE_02
					,SUM(GA.FEE_01) AS FEE_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS FEE_12
						,0 AS FEE_11
						,0 AS FEE_10
						,0 AS FEE_09
						,0 AS FEE_08
						,0 AS FEE_07
						,0 AS FEE_06
						,0 AS FEE_05
						,0 AS FEE_04
						,0 AS FEE_03
						,0 AS FEE_02
						,0 AS FEE_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						<!-- ,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_basic ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_basic ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_basic ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_basic ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_basic ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_basic ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_basic ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_basic ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_basic ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_basic ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_basic ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_basic ELSE 0 END AS FEE_01	 -->
						
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN (C.amt_basic+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ELSE 0 END AS FEE_01
					FROM v_top_rpt_head_type A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_rpt_invoice C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN C.amt_basic ELSE 0 END AS FEE_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN C.amt_basic ELSE 0 END AS FEE_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN C.amt_basic ELSE 0 END AS FEE_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN C.amt_basic ELSE 0 END AS FEE_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN C.amt_basic ELSE 0 END AS FEE_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN C.amt_basic ELSE 0 END AS FEE_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN C.amt_basic ELSE 0 END AS FEE_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN C.amt_basic ELSE 0 END AS FEE_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN C.amt_basic ELSE 0 END AS FEE_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN C.amt_basic ELSE 0 END AS FEE_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN C.amt_basic ELSE 0 END AS FEE_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN C.amt_basic ELSE 0 END AS FEE_01
					FROM top_prim_biz_rpt_head A
					INNER JOIN top_tm_bsc B
					ON A.team_id = B.team_id
					INNER JOIN top_prim_biz_inv C
					ON A.suim_rpt_no = C.suim_rpt_no
					WHERE 1=1					
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_center, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_center, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_center
				,COUNT(GA.team_center) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_center	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_center, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_center
		)CNT
		ON TA.team_center = CNT.team_center
	</select>
	
	<!-- 보험사 팀전체 종결현황 신규 : 20230628 -->
	<select id="PtnrStatTeamAllEnd" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01	
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}				
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사 센터 내 팀별 종결현황 신규 : 20230626 -->
	<select id="PtnrStatTeamEnd" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01	
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_center = #{team_center}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id
	</select>
	
	<!-- 보험사 전체직원 종결현황 신규 : 물보험 20230703-->
	<select id="PtnrStatMemberAllEnd" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,TA.user_no
			,TA.user_name
			
			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,TTM.team_id
				,TTM.team_name
				,TTM.team_center
				,TTM.team_group_order
				,TTM.team_order
				
				,GB.user_no			
				,TMB.user_name
				,TMB.work_level
				,TMB.join_date			
				,CASE TMB.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15
				END AS new_work_order

				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no					
					,GA.user_no
					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no						
						,"" AS user_no
						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no						
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01	
					FROM v_top_rpt_head_type A
					WHERE A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no						
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A
					WHERE A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.user_no, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			LEFT JOIN top_mbr_bsc TMB
			ON GB.user_no = TMB.user_no		
			LEFT JOIN top_tm_bsc TTM
			ON TMB.team_id_main = TTM.team_id		
			AND TTM.team_type != 4
			AND TTM.team_statistics1 = 0
			ORDER BY TTM.team_group_order DESC, TTM.team_order DESC, new_work_order, TMB.work_level DESC, TMB.join_date, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.user_no
				,COUNT(GA.user_no) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,A.user_no	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}				
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.user_no
		)CNT
		ON TA.user_no = CNT.user_no
	</select>
	
	<!-- 보험사 팀내 직원별 종결현황 신규 : 물보험 20230627-->
	<select id="PtnrStatMemberEnd" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,TA.user_no
			,TA.user_name
			
			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				
				,GB.user_no			
				,TMB.user_name
				,TMB.work_level
				,TMB.join_date			
				,CASE TMB.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15
				END AS new_work_order

				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,GA.user_no
					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order
						,"" AS user_no
						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01	
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.user_no, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			LEFT JOIN top_mbr_bsc TMB
			ON GB.user_no = TMB.user_no		
			ORDER BY new_work_order, TMB.work_level DESC, TMB.join_date, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.user_no
				,COUNT(GA.user_no) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,A.user_no	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_id = #{team_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.user_no
		)CNT
		ON TA.user_no = CNT.user_no
	</select>
	
	<!-- 보험사별 센터별 종결현황 신규 : 물보험 20230622-->
	<select id="PtnrStatCenterEnd" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.END_12
			,TA.END_11
			,TA.END_10
			,TA.END_09
			,TA.END_08
			,TA.END_07
			,TA.END_06
			,TA.END_05
			,TA.END_04
			,TA.END_03
			,TA.END_02
			,TA.END_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.END_12,0) AS END_12
				,IFNULL(GB.END_11,0) AS END_11
				,IFNULL(GB.END_10,0) AS END_10
				,IFNULL(GB.END_09,0) AS END_09
				,IFNULL(GB.END_08,0) AS END_08
				,IFNULL(GB.END_07,0) AS END_07
				,IFNULL(GB.END_06,0) AS END_06
				,IFNULL(GB.END_05,0) AS END_05
				,IFNULL(GB.END_04,0) AS END_04
				,IFNULL(GB.END_03,0) AS END_03
				,IFNULL(GB.END_02,0) AS END_02
				,IFNULL(GB.END_01,0) AS END_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.END_12) AS END_12
					,SUM(GA.END_11) AS END_11
					,SUM(GA.END_10) AS END_10
					,SUM(GA.END_09) AS END_09
					,SUM(GA.END_08) AS END_08
					,SUM(GA.END_07) AS END_07
					,SUM(GA.END_06) AS END_06
					,SUM(GA.END_05) AS END_05
					,SUM(GA.END_04) AS END_04
					,SUM(GA.END_03) AS END_03
					,SUM(GA.END_02) AS END_02
					,SUM(GA.END_01) AS END_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS END_12
						,0 AS END_11
						,0 AS END_10
						,0 AS END_09
						,0 AS END_08
						,0 AS END_07
						,0 AS END_06
						,0 AS END_05
						,0 AS END_04
						,0 AS END_03
						,0 AS END_02
						,0 AS END_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01	
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS END_12
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS END_11
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS END_10
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS END_09
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS END_08
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS END_07
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS END_06
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS END_05
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS END_04
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS END_03
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS END_02
						,CASE WHEN A.close_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS END_01
					FROM top_prim_biz_rpt_head A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_center, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_center, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_center
				,COUNT(GA.team_center) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_center	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND A.close_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.close_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_center, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_center
		)CNT
		ON TA.team_center = CNT.team_center
	</select>
	
	<!-- 보험사별 직원전체 수임현황 신규 : 물보험 20230703-->
	<select id="PtnrStatMemberAllReg" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,TA.user_no
			,TA.user_name
			
			,TA.REG_12
			,TA.REG_11
			,TA.REG_10
			,TA.REG_09
			,TA.REG_08
			,TA.REG_07
			,TA.REG_06
			,TA.REG_05
			,TA.REG_04
			,TA.REG_03
			,TA.REG_02
			,TA.REG_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,TTM.team_id
				,TTM.team_name
				,TTM.team_center
				,TTM.team_group_order
				,TTM.team_order
				
				,GB.user_no			
				,TMB.user_name
				,TMB.work_level
				,TMB.join_date			
				,CASE TMB.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15
				END AS new_work_order

				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.REG_12,0) AS REG_12
				,IFNULL(GB.REG_11,0) AS REG_11
				,IFNULL(GB.REG_10,0) AS REG_10
				,IFNULL(GB.REG_09,0) AS REG_09
				,IFNULL(GB.REG_08,0) AS REG_08
				,IFNULL(GB.REG_07,0) AS REG_07
				,IFNULL(GB.REG_06,0) AS REG_06
				,IFNULL(GB.REG_05,0) AS REG_05
				,IFNULL(GB.REG_04,0) AS REG_04
				,IFNULL(GB.REG_03,0) AS REG_03
				,IFNULL(GB.REG_02,0) AS REG_02
				,IFNULL(GB.REG_01,0) AS REG_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no										
					,GA.user_no
					,SUM(GA.REG_12) AS REG_12
					,SUM(GA.REG_11) AS REG_11
					,SUM(GA.REG_10) AS REG_10
					,SUM(GA.REG_09) AS REG_09
					,SUM(GA.REG_08) AS REG_08
					,SUM(GA.REG_07) AS REG_07
					,SUM(GA.REG_06) AS REG_06
					,SUM(GA.REG_05) AS REG_05
					,SUM(GA.REG_04) AS REG_04
					,SUM(GA.REG_03) AS REG_03
					,SUM(GA.REG_02) AS REG_02
					,SUM(GA.REG_01) AS REG_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no						
						,"" AS user_no
						,0 AS REG_12
						,0 AS REG_11
						,0 AS REG_10
						,0 AS REG_09
						,0 AS REG_08
						,0 AS REG_07
						,0 AS REG_06
						,0 AS REG_05
						,0 AS REG_04
						,0 AS REG_03
						,0 AS REG_02
						,0 AS REG_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no						
						,A.user_no
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS REG_12
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS REG_11
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS REG_10
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS REG_09
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS REG_08
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS REG_07
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS REG_06
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS REG_05
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS REG_04
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS REG_03
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS REG_02
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS REG_01	
					FROM v_top_rpt_head_type A
					WHERE A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no						
						,A.user_no
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS REG_12
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS REG_11
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS REG_10
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS REG_09
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS REG_08
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS REG_07
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS REG_06
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS REG_05
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS REG_04
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS REG_03
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS REG_02
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS REG_01
					FROM top_prim_biz_rpt_head A
					WHERE A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}					
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.user_no, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			LEFT JOIN top_mbr_bsc TMB
			ON GB.user_no = TMB.user_no		
			LEFT JOIN top_tm_bsc TTM
			ON TMB.team_id_main = TTM.team_id		
			AND TTM.team_type != 4
			AND TTM.team_statistics1 = 0
			ORDER BY TTM.team_group_order DESC, TTM.team_order DESC, new_work_order, TMB.work_level DESC, TMB.join_date, GB.ptnr_id_sub			
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.user_no				
				,COUNT(GA.user_no) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,A.user_no					
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}				
				AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.user_no
		)CNT
		ON TA.user_no = CNT.user_no		
	</select>
	
	<!-- 보험사별 팀내 직원별 수임현황 신규 : 물보험 20230627-->
	<select id="PtnrStatMemberReg" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">	
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name

			,TA.user_no
			,TA.user_name
			
			,TA.REG_12
			,TA.REG_11
			,TA.REG_10
			,TA.REG_09
			,TA.REG_08
			,TA.REG_07
			,TA.REG_06
			,TA.REG_05
			,TA.REG_04
			,TA.REG_03
			,TA.REG_02
			,TA.REG_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				
				,GB.user_no			
				,TMB.user_name
				,TMB.work_level
				,TMB.join_date			
				,CASE TMB.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15
				END AS new_work_order

				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.REG_12,0) AS REG_12
				,IFNULL(GB.REG_11,0) AS REG_11
				,IFNULL(GB.REG_10,0) AS REG_10
				,IFNULL(GB.REG_09,0) AS REG_09
				,IFNULL(GB.REG_08,0) AS REG_08
				,IFNULL(GB.REG_07,0) AS REG_07
				,IFNULL(GB.REG_06,0) AS REG_06
				,IFNULL(GB.REG_05,0) AS REG_05
				,IFNULL(GB.REG_04,0) AS REG_04
				,IFNULL(GB.REG_03,0) AS REG_03
				,IFNULL(GB.REG_02,0) AS REG_02
				,IFNULL(GB.REG_01,0) AS REG_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order					
					,GA.user_no
					,SUM(GA.REG_12) AS REG_12
					,SUM(GA.REG_11) AS REG_11
					,SUM(GA.REG_10) AS REG_10
					,SUM(GA.REG_09) AS REG_09
					,SUM(GA.REG_08) AS REG_08
					,SUM(GA.REG_07) AS REG_07
					,SUM(GA.REG_06) AS REG_06
					,SUM(GA.REG_05) AS REG_05
					,SUM(GA.REG_04) AS REG_04
					,SUM(GA.REG_03) AS REG_03
					,SUM(GA.REG_02) AS REG_02
					,SUM(GA.REG_01) AS REG_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order
						,"" AS user_no
						,0 AS REG_12
						,0 AS REG_11
						,0 AS REG_10
						,0 AS REG_09
						,0 AS REG_08
						,0 AS REG_07
						,0 AS REG_06
						,0 AS REG_05
						,0 AS REG_04
						,0 AS REG_03
						,0 AS REG_02
						,0 AS REG_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS REG_12
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS REG_11
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS REG_10
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS REG_09
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS REG_08
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS REG_07
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS REG_06
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS REG_05
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS REG_04
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS REG_03
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS REG_02
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS REG_01	
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,A.user_no
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS REG_12
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS REG_11
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS REG_10
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS REG_09
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS REG_08
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS REG_07
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS REG_06
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS REG_05
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS REG_04
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS REG_03
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS REG_02
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS REG_01
					FROM top_prim_biz_rpt_head A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_id = #{team_id}
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.user_no, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			LEFT JOIN top_mbr_bsc TMB
			ON GB.user_no = TMB.user_no		
			ORDER BY new_work_order, TMB.work_level DESC, TMB.join_date, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.user_no
				,COUNT(GA.user_no) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,A.user_no
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_id = #{team_id}
				AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY A.user_no, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.user_no
		)CNT
		ON TA.user_no = CNT.user_no
	</select>
	
	<select id="PtnrStatTeamReg" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.REG_12
			,TA.REG_11
			,TA.REG_10
			,TA.REG_09
			,TA.REG_08
			,TA.REG_07
			,TA.REG_06
			,TA.REG_05
			,TA.REG_04
			,TA.REG_03
			,TA.REG_02
			,TA.REG_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.REG_12,0) AS REG_12
				,IFNULL(GB.REG_11,0) AS REG_11
				,IFNULL(GB.REG_10,0) AS REG_10
				,IFNULL(GB.REG_09,0) AS REG_09
				,IFNULL(GB.REG_08,0) AS REG_08
				,IFNULL(GB.REG_07,0) AS REG_07
				,IFNULL(GB.REG_06,0) AS REG_06
				,IFNULL(GB.REG_05,0) AS REG_05
				,IFNULL(GB.REG_04,0) AS REG_04
				,IFNULL(GB.REG_03,0) AS REG_03
				,IFNULL(GB.REG_02,0) AS REG_02
				,IFNULL(GB.REG_01,0) AS REG_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.REG_12) AS REG_12
					,SUM(GA.REG_11) AS REG_11
					,SUM(GA.REG_10) AS REG_10
					,SUM(GA.REG_09) AS REG_09
					,SUM(GA.REG_08) AS REG_08
					,SUM(GA.REG_07) AS REG_07
					,SUM(GA.REG_06) AS REG_06
					,SUM(GA.REG_05) AS REG_05
					,SUM(GA.REG_04) AS REG_04
					,SUM(GA.REG_03) AS REG_03
					,SUM(GA.REG_02) AS REG_02
					,SUM(GA.REG_01) AS REG_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS REG_12
						,0 AS REG_11
						,0 AS REG_10
						,0 AS REG_09
						,0 AS REG_08
						,0 AS REG_07
						,0 AS REG_06
						,0 AS REG_05
						,0 AS REG_04
						,0 AS REG_03
						,0 AS REG_02
						,0 AS REG_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS REG_12
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS REG_11
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS REG_10
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS REG_09
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS REG_08
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS REG_07
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS REG_06
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS REG_05
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS REG_04
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS REG_03
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS REG_02
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS REG_01	
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS REG_12
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS REG_11
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS REG_10
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS REG_09
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS REG_08
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS REG_07
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS REG_06
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS REG_05
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS REG_04
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS REG_03
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS REG_02
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS REG_01
					FROM top_prim_biz_rpt_head A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND B.team_center = #{team_center}
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id)AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND B.team_center = #{team_center}
				AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id		
	</select>
	
	<!-- 보험사별 센터별 수입현황 신규 : 물보험 20230621-->
	<select id="PtnrStatCenterReg" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			,getTopTmBscCenterName(TA.team_id) AS center_name
			
			,TA.REG_12
			,TA.REG_11
			,TA.REG_10
			,TA.REG_09
			,TA.REG_08
			,TA.REG_07
			,TA.REG_06
			,TA.REG_05
			,TA.REG_04
			,TA.REG_03
			,TA.REG_02
			,TA.REG_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.REG_12,0) AS REG_12
				,IFNULL(GB.REG_11,0) AS REG_11
				,IFNULL(GB.REG_10,0) AS REG_10
				,IFNULL(GB.REG_09,0) AS REG_09
				,IFNULL(GB.REG_08,0) AS REG_08
				,IFNULL(GB.REG_07,0) AS REG_07
				,IFNULL(GB.REG_06,0) AS REG_06
				,IFNULL(GB.REG_05,0) AS REG_05
				,IFNULL(GB.REG_04,0) AS REG_04
				,IFNULL(GB.REG_03,0) AS REG_03
				,IFNULL(GB.REG_02,0) AS REG_02
				,IFNULL(GB.REG_01,0) AS REG_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.REG_12) AS REG_12
					,SUM(GA.REG_11) AS REG_11
					,SUM(GA.REG_10) AS REG_10
					,SUM(GA.REG_09) AS REG_09
					,SUM(GA.REG_08) AS REG_08
					,SUM(GA.REG_07) AS REG_07
					,SUM(GA.REG_06) AS REG_06
					,SUM(GA.REG_05) AS REG_05
					,SUM(GA.REG_04) AS REG_04
					,SUM(GA.REG_03) AS REG_03
					,SUM(GA.REG_02) AS REG_02
					,SUM(GA.REG_01) AS REG_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS REG_12
						,0 AS REG_11
						,0 AS REG_10
						,0 AS REG_09
						,0 AS REG_08
						,0 AS REG_07
						,0 AS REG_06
						,0 AS REG_05
						,0 AS REG_04
						,0 AS REG_03
						,0 AS REG_02
						,0 AS REG_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS REG_12
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS REG_11
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS REG_10
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS REG_09
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS REG_08
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS REG_07
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS REG_06
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS REG_05
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS REG_04
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS REG_03
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS REG_02
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS REG_01	
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS REG_12
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS REG_11
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS REG_10
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS REG_09
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS REG_08
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS REG_07
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS REG_06
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS REG_05
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS REG_04
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS REG_03
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS REG_02
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS REG_01
					FROM top_prim_biz_rpt_head A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_center, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_center, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_center
				,COUNT(GA.team_center) AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_center	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY B.team_center, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_center
		)CNT
		ON TA.team_center = CNT.team_center
	</select>
	
	<!-- 보험사별 팀(전체)별 수입현황 신규 : 물보험 20230621-->
	<select id="PtnrStatTeamAllReg" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">	
		SELECT
			TA.ptnr_id
			,TA.ptnr_id_sub
			,TA.div_type				
			,TA.suim_rpt_no
			,TA.team_id
			,TA.team_name
			,TA.team_center
			,getTopTmBscCenterName(TA.team_id) AS center_name
			,TA.team_group_order
			,TA.team_order
			,TA.ptnr_nick
			,TA.ptnr_id_sub_nm
			,CNT.row_cnt
			
			,TA.REG_12
			,TA.REG_11
			,TA.REG_10
			,TA.REG_09
			,TA.REG_08
			,TA.REG_07
			,TA.REG_06
			,TA.REG_05
			,TA.REG_04
			,TA.REG_03
			,TA.REG_02
			,TA.REG_01
			
		FROM(
	
			SELECT
				GB.ptnr_id
				,GB.ptnr_id_sub
				,GB.div_type				
				,GB.suim_rpt_no
				,GB.team_id
				,GB.team_name
				,GB.team_center
				,GB.team_group_order
				,GB.team_order
				,PA.ptnr_nick
				,PA.ptnr_id_sub_nm
				
				,IFNULL(GB.REG_12,0) AS REG_12
				,IFNULL(GB.REG_11,0) AS REG_11
				,IFNULL(GB.REG_10,0) AS REG_10
				,IFNULL(GB.REG_09,0) AS REG_09
				,IFNULL(GB.REG_08,0) AS REG_08
				,IFNULL(GB.REG_07,0) AS REG_07
				,IFNULL(GB.REG_06,0) AS REG_06
				,IFNULL(GB.REG_05,0) AS REG_05
				,IFNULL(GB.REG_04,0) AS REG_04
				,IFNULL(GB.REG_03,0) AS REG_03
				,IFNULL(GB.REG_02,0) AS REG_02
				,IFNULL(GB.REG_01,0) AS REG_01
					
			FROM 
			(
				SELECT
					GA.ptnr_id
					,GA.ptnr_id_sub
					,GA.div_type				
					,GA.suim_rpt_no
					,GA.team_id
					,GA.team_name
					,GA.team_center
					,GA.team_group_order
					,GA.team_order
					,SUM(GA.REG_12) AS REG_12
					,SUM(GA.REG_11) AS REG_11
					,SUM(GA.REG_10) AS REG_10
					,SUM(GA.REG_09) AS REG_09
					,SUM(GA.REG_08) AS REG_08
					,SUM(GA.REG_07) AS REG_07
					,SUM(GA.REG_06) AS REG_06
					,SUM(GA.REG_05) AS REG_05
					,SUM(GA.REG_04) AS REG_04
					,SUM(GA.REG_03) AS REG_03
					,SUM(GA.REG_02) AS REG_02
					,SUM(GA.REG_01) AS REG_01	
				FROM
				(	
				
					SELECT
						"" AS ptnr_id
						,"" AS ptnr_id_sub
						,"" AS div_type					
						,"" AS suim_rpt_no
						,"" AS team_id
						,"" AS team_name
						,"" AS team_center
						,"" AS team_group_order
						,"" AS team_order  			
						,0 AS REG_12
						,0 AS REG_11
						,0 AS REG_10
						,0 AS REG_09
						,0 AS REG_08
						,0 AS REG_07
						,0 AS REG_06
						,0 AS REG_05
						,0 AS REG_04
						,0 AS REG_03
						,0 AS REG_02
						,0 AS REG_01
					FROM  DUAL
					
					<if test='basicYN == "Y"'>					
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,A.div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS REG_12
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS REG_11
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS REG_10
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS REG_09
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS REG_08
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS REG_07
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS REG_06
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS REG_05
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS REG_04
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS REG_03
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS REG_02
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS REG_01	
					FROM v_top_rpt_head_type A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
					AND A.div_type = #{div_type}				
					</if>				
					<if test='primYN == "Y" and div_type == "5"'>				
					UNION ALL
					
					SELECT 	
						A.ptnr_id
						,A.ptnr_id_sub
						,"5" AS div_type					
						,A.suim_rpt_no
						,B.team_id
						,B.team_name
						,B.team_center
						,B.team_group_order
						,B.team_order
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS REG_12
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS REG_11
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS REG_10
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS REG_09
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS REG_08
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS REG_07
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS REG_06
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS REG_05
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS REG_04
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS REG_03
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS REG_02
						,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS REG_01
					FROM top_prim_biz_rpt_head A, top_tm_bsc B
					WHERE A.team_id = B.team_id
					<!-- AND B.team_type != 4 -->
					AND B.team_type IN (0,1)
					AND B.team_statistics1 = 0
					AND A.suim_rpt_state != 3
					AND A.ptnr_id = #{ptnr_id}
					AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
					AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})						
					</if>
				)GA
				WHERE GA.ptnr_id != ''	
				GROUP BY GA.team_id, GA.ptnr_id_sub
			)GB
			LEFT JOIN v_ptnr_stat_0 PA
			ON GB.ptnr_id = PA.ptnr_id
			AND GB.ptnr_id_sub = PA.ptnr_id_sub
			ORDER BY GB.team_group_order DESC, GB.team_order DESC, GB.team_id DESC, GB.ptnr_id_sub
		)TA
		
		LEFT JOIN
		(
			SELECT
				GA.team_id
				,COUNT(GA.team_id)AS row_cnt
			FROM(
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type						
					,B.team_id	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND B.team_statistics1 = 0
				AND A.suim_rpt_state != 3
				AND A.ptnr_id = #{ptnr_id}
				AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}
				GROUP BY A.team_id, A.ptnr_id, A.ptnr_id_sub
			)GA
			GROUP BY GA.team_id
		)CNT
		ON TA.team_id = CNT.team_id	
	</select>
	
	<!-- 보험사별 수입현황 신규 : 물보험 20230601-->
	<select id="PtnrStatReg" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
			PA.ptnr_id			
			,CAST(PA.ptnr_id_sub AS SIGNED INTEGER) AS ptnr_id_sub
			,PA.period_flag_code
			,PA.ptnr_nick
			,PA.ptnr_id_sub_nm
			,PA.period_flag_nm
			,PA.ptnr_row_cnt
			,IFNULL(GB.REG_12,0) AS REG_12
			,IFNULL(GB.REG_11,0) AS REG_11
			,IFNULL(GB.REG_10,0) AS REG_10
			,IFNULL(GB.REG_09,0) AS REG_09
			,IFNULL(GB.REG_08,0) AS REG_08
			,IFNULL(GB.REG_07,0) AS REG_07
			,IFNULL(GB.REG_06,0) AS REG_06
			,IFNULL(GB.REG_05,0) AS REG_05
			,IFNULL(GB.REG_04,0) AS REG_04
			,IFNULL(GB.REG_03,0) AS REG_03
			,IFNULL(GB.REG_02,0) AS REG_02
			,IFNULL(GB.REG_01,0) AS REG_01	
		FROM v_ptnr_stat PA
		LEFT JOIN
		(
			SELECT
				GA.ptnr_id
				,GA.ptnr_id_sub
				,GA.div_type
				,GA.period_flag
				,GA.suim_rpt_no
				,SUM(GA.REG_12) AS REG_12
				,SUM(GA.REG_11) AS REG_11
				,SUM(GA.REG_10) AS REG_10
				,SUM(GA.REG_09) AS REG_09
				,SUM(GA.REG_08) AS REG_08
				,SUM(GA.REG_07) AS REG_07
				,SUM(GA.REG_06) AS REG_06
				,SUM(GA.REG_05) AS REG_05
				,SUM(GA.REG_04) AS REG_04
				,SUM(GA.REG_03) AS REG_03
				,SUM(GA.REG_02) AS REG_02
				,SUM(GA.REG_01) AS REG_01	
			FROM
			(	
			
				SELECT
					"" AS ptnr_id
					,"" AS ptnr_id_sub
					,"" AS div_type
					,"" AS period_flag
					,"" AS suim_rpt_no  			
					,0 AS REG_12
					,0 AS REG_11
					,0 AS REG_10
					,0 AS REG_09
					,0 AS REG_08
					,0 AS REG_07
					,0 AS REG_06
					,0 AS REG_05
					,0 AS REG_04
					,0 AS REG_03
					,0 AS REG_02
					,0 AS REG_01
				FROM  DUAL
				
				<if test='basicYN == "Y"'>					
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,A.div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS REG_12
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS REG_11
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS REG_10
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS REG_09
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS REG_08
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS REG_07
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS REG_06
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS REG_05
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS REG_04
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS REG_03
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS REG_02
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS REG_01	
				FROM v_top_rpt_head_type A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				AND A.div_type = #{div_type}				
				</if>				
				<if test='primYN == "Y" and div_type == "5"'>				
				UNION ALL
				
				SELECT 	
					A.ptnr_id
					,A.ptnr_id_sub
					,"5" AS div_type
					,A.period_flag
					,A.suim_rpt_no
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore12}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS REG_12
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore11}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS REG_11
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore10}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS REG_10
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore9}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS REG_09
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore8}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS REG_08
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore7}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS REG_07
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore6}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS REG_06
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore5}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS REG_05
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore4}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS REG_04
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore3}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS REG_03
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore2}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS REG_02
					,CASE WHEN A.reg_date >= UNIX_TIMESTAMP(#{monBefore1}) AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS REG_01
				FROM top_prim_biz_rpt_head A, top_tm_bsc B
				WHERE A.team_id = B.team_id
				<!-- AND B.team_type != 4 -->
				AND B.team_type IN (0,1)
				AND A.suim_rpt_state != 3
				AND A.reg_date >= UNIX_TIMESTAMP(#{monBefore12})
				AND A.reg_date &lt; UNIX_TIMESTAMP(#{monBefore0})
				<!-- AND A.div_type = #{div_type} -->				
				</if>
			)GA
			GROUP BY GA.ptnr_id, GA.ptnr_id_sub, GA.period_flag
		)GB
		ON PA.ptnr_id = GB.ptnr_id
		AND PA.ptnr_id_sub = GB.ptnr_id_sub
		AND PA.period_flag_code = GB.period_flag	
	</select>

	<!-- 보험사별 종결현황 : 1종 조사 -->
	<select id="MisEndPtnr1Main" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT  GA.PTNR_ID 
               ,GA.PTNR_NICK
               ,GB.end_rid12 ,GB.end_rid11 ,GB.end_rid10 ,GB.end_rid9 ,GB.end_rid8 ,GB.end_rid7 ,GB.end_rid6 ,GB.end_rid5 ,GB.end_rid4 ,GB.end_rid3 ,GB.end_rid2 ,GB.end_rid
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.end_rid12) AS end_rid12
                             ,SUM(C.end_rid11) AS end_rid11
                             ,SUM(C.end_rid10) AS end_rid10
                             ,SUM(C.end_rid9) AS end_rid9
                             ,SUM(C.end_rid8) AS end_rid8
                             ,SUM(C.end_rid7) AS end_rid7
                             ,SUM(C.end_rid6) AS end_rid6
                             ,SUM(C.end_rid5) AS end_rid5
                             ,SUM(C.end_rid4) AS end_rid4
                             ,SUM(C.end_rid3) AS end_rid3
                             ,SUM(C.end_rid2) AS end_rid2
                             ,SUM(C.end_rid) AS end_rid
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS SUIM_RPT_NO
		                             ,0 AS end_rid12
		                             ,0 AS end_rid11
		                             ,0 AS end_rid10
		                             ,0 AS end_rid9
		                             ,0 AS end_rid8
		                             ,0 AS end_rid7
		                             ,0 AS end_rid6
		                             ,0 AS end_rid5
		                             ,0 AS end_rid4
		                             ,0 AS end_rid3
		                             ,0 AS end_rid2
		                             ,0 AS end_rid
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.SUIM_RPT_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS end_rid12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS end_rid11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS end_rid10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS end_rid9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS end_rid8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS end_rid7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS end_rid6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS end_rid5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS end_rid4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS end_rid3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS end_rid2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS end_rid
                                FROM  top_rpt_head A 
                               INNER  JOIN top_tm_bsc B
                                  ON  A.TEAM_ID = B.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE = '2'
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  B.TEAM_TYPE != 4
                                 AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13)
							</if>
                            <if test='primYN == "Y"'>
                              UNION ALL
                              SELECT  A.PTNR_ID
                                     ,A.SUIM_RPT_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS end_rid12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS end_rid11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS end_rid10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS end_rid9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS end_rid8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS end_rid7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS end_rid6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS end_rid5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS end_rid4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS end_rid3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS end_rid2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS end_rid
                                FROM  top_prim_biz_rpt_head A
                               INNER  JOIN top_tm_bsc B
                                  ON  A.TEAM_ID = B.TEAM_ID                                
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE = '2'
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  B.TEAM_TYPE != 4                                 
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID  
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC
	</select>
	
	<!-- 보험사별 종결현황 : 1종 심사 -->
	<select id="MisEndPtnr1Written" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT  GA.PTNR_ID 
               ,GA.PTNR_NICK
               ,GB.end_rid12 ,GB.end_rid11 ,GB.end_rid10 ,GB.end_rid9 ,GB.end_rid8 ,GB.end_rid7 ,GB.end_rid6 ,GB.end_rid5 ,GB.end_rid4 ,GB.end_rid3 ,GB.end_rid2 ,GB.end_rid
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.end_rid12) AS end_rid12
                             ,SUM(C.end_rid11) AS end_rid11
                             ,SUM(C.end_rid10) AS end_rid10
                             ,SUM(C.end_rid9) AS end_rid9
                             ,SUM(C.end_rid8) AS end_rid8
                             ,SUM(C.end_rid7) AS end_rid7
                             ,SUM(C.end_rid6) AS end_rid6
                             ,SUM(C.end_rid5) AS end_rid5
                             ,SUM(C.end_rid4) AS end_rid4
                             ,SUM(C.end_rid3) AS end_rid3
                             ,SUM(C.end_rid2) AS end_rid2
                             ,SUM(C.end_rid) AS end_rid
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS SUIM_RPT_NO
		                             ,0 AS end_rid12
		                             ,0 AS end_rid11
		                             ,0 AS end_rid10
		                             ,0 AS end_rid9
		                             ,0 AS end_rid8
		                             ,0 AS end_rid7
		                             ,0 AS end_rid6
		                             ,0 AS end_rid5
		                             ,0 AS end_rid4
		                             ,0 AS end_rid3
		                             ,0 AS end_rid2
		                             ,0 AS end_rid
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.SUIM_RPT_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS end_rid12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS end_rid11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS end_rid10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS end_rid9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS end_rid8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS end_rid7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS end_rid6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS end_rid5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS end_rid4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS end_rid3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS end_rid2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS end_rid
                                FROM  top_rpt_head A 
                               INNER  JOIN top_tm_bsc B
                                  ON  A.TEAM_ID = B.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE = '2'
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  B.TEAM_TYPE != 4
                                 AND  A.SUIM_RPT_TYPE1 IN(14, 15, 16, 17, 18, 19)
							</if>                            
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID  
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
           AND  GA.STATISTICS_WRITTEN_YN = 1
		 ORDER BY GA.statistics_order ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC
	</select>

	<!-- 보험사별 종결현황 - 보험사 - 절대건수 - 1종 -->
	<select id="MisEndPtnr1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
        SELECT  GA.PTNR_ID 
               ,GA.PTNR_NICK
               ,GB.end_rid12 ,GB.end_rid11 ,GB.end_rid10 ,GB.end_rid9 ,GB.end_rid8 ,GB.end_rid7 ,GB.end_rid6 ,GB.end_rid5 ,GB.end_rid4 ,GB.end_rid3 ,GB.end_rid2 ,GB.end_rid
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.end_rid12) AS end_rid12
                             ,SUM(C.end_rid11) AS end_rid11
                             ,SUM(C.end_rid10) AS end_rid10
                             ,SUM(C.end_rid9) AS end_rid9
                             ,SUM(C.end_rid8) AS end_rid8
                             ,SUM(C.end_rid7) AS end_rid7
                             ,SUM(C.end_rid6) AS end_rid6
                             ,SUM(C.end_rid5) AS end_rid5
                             ,SUM(C.end_rid4) AS end_rid4
                             ,SUM(C.end_rid3) AS end_rid3
                             ,SUM(C.end_rid2) AS end_rid2
                             ,SUM(C.end_rid) AS end_rid
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS SUIM_RPT_NO
		                             ,0 AS end_rid12
		                             ,0 AS end_rid11
		                             ,0 AS end_rid10
		                             ,0 AS end_rid9
		                             ,0 AS end_rid8
		                             ,0 AS end_rid7
		                             ,0 AS end_rid6
		                             ,0 AS end_rid5
		                             ,0 AS end_rid4
		                             ,0 AS end_rid3
		                             ,0 AS end_rid2
		                             ,0 AS end_rid
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.SUIM_RPT_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS end_rid12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS end_rid11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS end_rid10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS end_rid9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS end_rid8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS end_rid7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS end_rid6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS end_rid5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS end_rid4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS end_rid3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS end_rid2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS end_rid
                                FROM  top_rpt_head A 
                               INNER  JOIN top_tm_bsc B
                                  ON  A.TEAM_ID = B.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE = '2'
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  B.TEAM_TYPE != 4
							</if>
                            <if test='primYN == "Y"'>
                              UNION ALL
                              SELECT  A.PTNR_ID
                                     ,A.SUIM_RPT_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS end_rid12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS end_rid11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS end_rid10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS end_rid9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS end_rid8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS end_rid7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS end_rid6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS end_rid5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS end_rid4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS end_rid3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS end_rid2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS end_rid
                                FROM  top_prim_biz_rpt_head A
                               INNER  JOIN top_tm_bsc B
                                  ON  A.TEAM_ID = B.TEAM_ID                                
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE = '2'
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  B.TEAM_TYPE != 4
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID  
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.PTNR_ORDER DESC, GA.PTNR_ID ASC
	</select>
	
	<!-- 보험사별 종결현황 - 보험사 - 절대건수 - 4종 -->
	<select id="MisEndPtnr4" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
        SELECT  GA.PTNR_ID 
               ,GA.PTNR_NICK
               ,GB.end_rid12 ,GB.end_rid11 ,GB.end_rid10 ,GB.end_rid9 ,GB.end_rid8 ,GB.end_rid7 ,GB.end_rid6 ,GB.end_rid5 ,GB.end_rid4 ,GB.end_rid3 ,GB.end_rid2 ,GB.end_rid
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.end_rid12) AS end_rid12
                             ,SUM(C.end_rid11) AS end_rid11
                             ,SUM(C.end_rid10) AS end_rid10
                             ,SUM(C.end_rid9) AS end_rid9
                             ,SUM(C.end_rid8) AS end_rid8
                             ,SUM(C.end_rid7) AS end_rid7
                             ,SUM(C.end_rid6) AS end_rid6
                             ,SUM(C.end_rid5) AS end_rid5
                             ,SUM(C.end_rid4) AS end_rid4
                             ,SUM(C.end_rid3) AS end_rid3
                             ,SUM(C.end_rid2) AS end_rid2
                             ,SUM(C.end_rid) AS end_rid
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS SUIM_RPT_NO
		                             ,0 AS end_rid12
		                             ,0 AS end_rid11
		                             ,0 AS end_rid10
		                             ,0 AS end_rid9
		                             ,0 AS end_rid8
		                             ,0 AS end_rid7
		                             ,0 AS end_rid6
		                             ,0 AS end_rid5
		                             ,0 AS end_rid4
		                             ,0 AS end_rid3
		                             ,0 AS end_rid2
		                             ,0 AS end_rid
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.SUIM_RPT_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS end_rid12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS end_rid11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS end_rid10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS end_rid9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS end_rid8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS end_rid7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS end_rid6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS end_rid5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS end_rid4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS end_rid3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS end_rid2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS end_rid
                                FROM  top_rpt_head A 
                               INNER  JOIN top_tm_bsc B
                                  ON  A.TEAM_ID = B.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE = '2'
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  B.TEAM_TYPE = 4
							</if>
                            <if test='primYN == "Y"'>
                              UNION ALL
                              SELECT  A.PTNR_ID
                                     ,A.SUIM_RPT_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS end_rid12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS end_rid11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS end_rid10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS end_rid9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS end_rid8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS end_rid7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS end_rid6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS end_rid5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS end_rid4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS end_rid3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS end_rid2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS end_rid
                                FROM  top_prim_biz_rpt_head A
                               INNER  JOIN top_tm_bsc B
                                  ON  A.TEAM_ID = B.TEAM_ID                                
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE = '2'
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  B.TEAM_TYPE = 4
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID  
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1 
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC
	</select>
	
	<!-- 보험사별 종결현황 - 보험사 - 순수피 - 1종 심사-->
	<select id="MisEndPtnrAssess1Written" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_assess12, GB.price_assess11, GB.price_assess10, GB.price_assess9, GB.price_assess8, GB.price_assess7
			  ,GB.price_assess6, GB.price_assess5, GB.price_assess4, GB.price_assess3, GB.price_assess2, GB.price_assess
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_assess12) AS price_assess12
                             ,SUM(C.price_assess11) AS price_assess11
                             ,SUM(C.price_assess10) AS price_assess10
                             ,SUM(C.price_assess9) AS price_assess9
                             ,SUM(C.price_assess8) AS price_assess8
                             ,SUM(C.price_assess7) AS price_assess7
                             ,SUM(C.price_assess6) AS price_assess6
                             ,SUM(C.price_assess5) AS price_assess5
                             ,SUM(C.price_assess4) AS price_assess4
                             ,SUM(C.price_assess3) AS price_assess3
                             ,SUM(C.price_assess2) AS price_assess2
                             ,SUM(C.price_assess) AS price_assess
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_assess12
		                             ,0 AS price_assess11
		                             ,0 AS price_assess10
		                             ,0 AS price_assess9
		                             ,0 AS price_assess8
		                             ,0 AS price_assess7
		                             ,0 AS price_assess6
		                             ,0 AS price_assess5
		                             ,0 AS price_assess4
		                             ,0 AS price_assess3
		                             ,0 AS price_assess2
		                             ,0 AS price_assess
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN(14, 15, 16, 17, 18, 19)
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>							
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
           AND  GA.STATISTICS_WRITTEN_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>
	
	<!-- 보험사별 종결현황 - 보험사 - 순수피 - 1종 조사-->
	<select id="MisEndPtnrAssess1Main" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_assess12, GB.price_assess11, GB.price_assess10, GB.price_assess9, GB.price_assess8, GB.price_assess7
			  ,GB.price_assess6, GB.price_assess5, GB.price_assess4, GB.price_assess3, GB.price_assess2, GB.price_assess
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_assess12) AS price_assess12
                             ,SUM(C.price_assess11) AS price_assess11
                             ,SUM(C.price_assess10) AS price_assess10
                             ,SUM(C.price_assess9) AS price_assess9
                             ,SUM(C.price_assess8) AS price_assess8
                             ,SUM(C.price_assess7) AS price_assess7
                             ,SUM(C.price_assess6) AS price_assess6
                             ,SUM(C.price_assess5) AS price_assess5
                             ,SUM(C.price_assess4) AS price_assess4
                             ,SUM(C.price_assess3) AS price_assess3
                             ,SUM(C.price_assess2) AS price_assess2
                             ,SUM(C.price_assess) AS price_assess
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_assess12
		                             ,0 AS price_assess11
		                             ,0 AS price_assess10
		                             ,0 AS price_assess9
		                             ,0 AS price_assess8
		                             ,0 AS price_assess7
		                             ,0 AS price_assess6
		                             ,0 AS price_assess5
		                             ,0 AS price_assess4
		                             ,0 AS price_assess3
		                             ,0 AS price_assess2
		                             ,0 AS price_assess
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO                                     
                                     <!-- ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess -->
                                     
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13)
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>
	
	<!-- 보험사별 종결현황 - 보험사 - 순수피 - 1종 -->
	<select id="MisEndPtnrAssess1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_assess12, GB.price_assess11, GB.price_assess10, GB.price_assess9, GB.price_assess8, GB.price_assess7
			  ,GB.price_assess6, GB.price_assess5, GB.price_assess4, GB.price_assess3, GB.price_assess2, GB.price_assess
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_assess12) AS price_assess12
                             ,SUM(C.price_assess11) AS price_assess11
                             ,SUM(C.price_assess10) AS price_assess10
                             ,SUM(C.price_assess9) AS price_assess9
                             ,SUM(C.price_assess8) AS price_assess8
                             ,SUM(C.price_assess7) AS price_assess7
                             ,SUM(C.price_assess6) AS price_assess6
                             ,SUM(C.price_assess5) AS price_assess5
                             ,SUM(C.price_assess4) AS price_assess4
                             ,SUM(C.price_assess3) AS price_assess3
                             ,SUM(C.price_assess2) AS price_assess2
                             ,SUM(C.price_assess) AS price_assess
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_assess12
		                             ,0 AS price_assess11
		                             ,0 AS price_assess10
		                             ,0 AS price_assess9
		                             ,0 AS price_assess8
		                             ,0 AS price_assess7
		                             ,0 AS price_assess6
		                             ,0 AS price_assess5
		                             ,0 AS price_assess4
		                             ,0 AS price_assess3
		                             ,0 AS price_assess2
		                             ,0 AS price_assess
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 NOT IN( 3, 4 )
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>	

	<!-- 보험사별 종결현황 - 보험사 - 순수피 - 4종 -->
	<select id="MisEndPtnrAssess4" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_assess12, GB.price_assess11, GB.price_assess10, GB.price_assess9, GB.price_assess8, GB.price_assess7
			  ,GB.price_assess6, GB.price_assess5, GB.price_assess4, GB.price_assess3, GB.price_assess2, GB.price_assess
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_assess12) AS price_assess12
                             ,SUM(C.price_assess11) AS price_assess11
                             ,SUM(C.price_assess10) AS price_assess10
                             ,SUM(C.price_assess9) AS price_assess9
                             ,SUM(C.price_assess8) AS price_assess8
                             ,SUM(C.price_assess7) AS price_assess7
                             ,SUM(C.price_assess6) AS price_assess6
                             ,SUM(C.price_assess5) AS price_assess5
                             ,SUM(C.price_assess4) AS price_assess4
                             ,SUM(C.price_assess3) AS price_assess3
                             ,SUM(C.price_assess2) AS price_assess2
                             ,SUM(C.price_assess) AS price_assess
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_assess12
		                             ,0 AS price_assess11
		                             ,0 AS price_assess10
		                             ,0 AS price_assess9
		                             ,0 AS price_assess8
		                             ,0 AS price_assess7
		                             ,0 AS price_assess6
		                             ,0 AS price_assess5
		                             ,0 AS price_assess4
		                             ,0 AS price_assess3
		                             ,0 AS price_assess2
		                             ,0 AS price_assess
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN( 3, 4 )
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE = 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE = 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>
	
	<!-- 보험사별 종결현황 - 보험사 - 일비 - 1종 심사-->
	<select id="MisEndPtnrTime1Written" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_time12, GB.price_time11, GB.price_time10, GB.price_time9, GB.price_time8, GB.price_time7
			  ,GB.price_time6, GB.price_time5, GB.price_time4, GB.price_time3, GB.price_time2, GB.price_time
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_time12) AS price_time12
                             ,SUM(C.price_time11) AS price_time11
                             ,SUM(C.price_time10) AS price_time10
                             ,SUM(C.price_time9) AS price_time9
                             ,SUM(C.price_time8) AS price_time8
                             ,SUM(C.price_time7) AS price_time7
                             ,SUM(C.price_time6) AS price_time6
                             ,SUM(C.price_time5) AS price_time5
                             ,SUM(C.price_time4) AS price_time4
                             ,SUM(C.price_time3) AS price_time3
                             ,SUM(C.price_time2) AS price_time2
                             ,SUM(C.price_time) AS price_time
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_time12
		                             ,0 AS price_time11
		                             ,0 AS price_time10
		                             ,0 AS price_time9
		                             ,0 AS price_time8
		                             ,0 AS price_time7
		                             ,0 AS price_time6
		                             ,0 AS price_time5
		                             ,0 AS price_time4
		                             ,0 AS price_time3
		                             ,0 AS price_time2
		                             ,0 AS price_time
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN(14, 15, 16, 17, 18, 19)
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
           AND  GA.STATISTICS_WRITTEN_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>
	
	<!-- 보험사별 종결현황 - 보험사 - 일비 - 1종 조사-->
	<select id="MisEndPtnrTime1Main" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_time12, GB.price_time11, GB.price_time10, GB.price_time9, GB.price_time8, GB.price_time7
			  ,GB.price_time6, GB.price_time5, GB.price_time4, GB.price_time3, GB.price_time2, GB.price_time
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_time12) AS price_time12
                             ,SUM(C.price_time11) AS price_time11
                             ,SUM(C.price_time10) AS price_time10
                             ,SUM(C.price_time9) AS price_time9
                             ,SUM(C.price_time8) AS price_time8
                             ,SUM(C.price_time7) AS price_time7
                             ,SUM(C.price_time6) AS price_time6
                             ,SUM(C.price_time5) AS price_time5
                             ,SUM(C.price_time4) AS price_time4
                             ,SUM(C.price_time3) AS price_time3
                             ,SUM(C.price_time2) AS price_time2
                             ,SUM(C.price_time) AS price_time
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_time12
		                             ,0 AS price_time11
		                             ,0 AS price_time10
		                             ,0 AS price_time9
		                             ,0 AS price_time8
		                             ,0 AS price_time7
		                             ,0 AS price_time6
		                             ,0 AS price_time5
		                             ,0 AS price_time4
		                             ,0 AS price_time3
		                             ,0 AS price_time2
		                             ,0 AS price_time
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13)
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>			
	
	<!-- 보험사별 종결현황 - 보험사 - 일비 - 1종 -->
	<select id="MisEndPtnrTime1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_time12, GB.price_time11, GB.price_time10, GB.price_time9, GB.price_time8, GB.price_time7
			  ,GB.price_time6, GB.price_time5, GB.price_time4, GB.price_time3, GB.price_time2, GB.price_time
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_time12) AS price_time12
                             ,SUM(C.price_time11) AS price_time11
                             ,SUM(C.price_time10) AS price_time10
                             ,SUM(C.price_time9) AS price_time9
                             ,SUM(C.price_time8) AS price_time8
                             ,SUM(C.price_time7) AS price_time7
                             ,SUM(C.price_time6) AS price_time6
                             ,SUM(C.price_time5) AS price_time5
                             ,SUM(C.price_time4) AS price_time4
                             ,SUM(C.price_time3) AS price_time3
                             ,SUM(C.price_time2) AS price_time2
                             ,SUM(C.price_time) AS price_time
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_time12
		                             ,0 AS price_time11
		                             ,0 AS price_time10
		                             ,0 AS price_time9
		                             ,0 AS price_time8
		                             ,0 AS price_time7
		                             ,0 AS price_time6
		                             ,0 AS price_time5
		                             ,0 AS price_time4
		                             ,0 AS price_time3
		                             ,0 AS price_time2
		                             ,0 AS price_time
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 NOT IN( 3, 4 )
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>			

	<!-- 보험사별 종결현황 - 보험사 - 일비 - 4종 -->
	<select id="MisEndPtnrTime4" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_time12, GB.price_time11, GB.price_time10, GB.price_time9, GB.price_time8, GB.price_time7
			  ,GB.price_time6, GB.price_time5, GB.price_time4, GB.price_time3, GB.price_time2, GB.price_time
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_time12) AS price_time12
                             ,SUM(C.price_time11) AS price_time11
                             ,SUM(C.price_time10) AS price_time10
                             ,SUM(C.price_time9) AS price_time9
                             ,SUM(C.price_time8) AS price_time8
                             ,SUM(C.price_time7) AS price_time7
                             ,SUM(C.price_time6) AS price_time6
                             ,SUM(C.price_time5) AS price_time5
                             ,SUM(C.price_time4) AS price_time4
                             ,SUM(C.price_time3) AS price_time3
                             ,SUM(C.price_time2) AS price_time2
                             ,SUM(C.price_time) AS price_time
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_time12
		                             ,0 AS price_time11
		                             ,0 AS price_time10
		                             ,0 AS price_time9
		                             ,0 AS price_time8
		                             ,0 AS price_time7
		                             ,0 AS price_time6
		                             ,0 AS price_time5
		                             ,0 AS price_time4
		                             ,0 AS price_time3
		                             ,0 AS price_time2
		                             ,0 AS price_time
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN( 3, 4 )
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE = 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE = 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>
	
	<!-- 보험사별 종결현황 - 보험사 - 교통비 - 1종 심사 -->
	<select id="MisEndPtnrTraffic1Written" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_traffic12, GB.price_traffic11, GB.price_traffic10, GB.price_traffic9, GB.price_traffic8, GB.price_traffic7
			  ,GB.price_traffic6, GB.price_traffic5, GB.price_traffic4, GB.price_traffic3, GB.price_traffic2, GB.price_traffic
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_traffic12) AS price_traffic12
                             ,SUM(C.price_traffic11) AS price_traffic11
                             ,SUM(C.price_traffic10) AS price_traffic10
                             ,SUM(C.price_traffic9) AS price_traffic9
                             ,SUM(C.price_traffic8) AS price_traffic8
                             ,SUM(C.price_traffic7) AS price_traffic7
                             ,SUM(C.price_traffic6) AS price_traffic6
                             ,SUM(C.price_traffic5) AS price_traffic5
                             ,SUM(C.price_traffic4) AS price_traffic4
                             ,SUM(C.price_traffic3) AS price_traffic3
                             ,SUM(C.price_traffic2) AS price_traffic2
                             ,SUM(C.price_traffic) AS price_traffic
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_traffic12
		                             ,0 AS price_traffic11
		                             ,0 AS price_traffic10
		                             ,0 AS price_traffic9
		                             ,0 AS price_traffic8
		                             ,0 AS price_traffic7
		                             ,0 AS price_traffic6
		                             ,0 AS price_traffic5
		                             ,0 AS price_traffic4
		                             ,0 AS price_traffic3
		                             ,0 AS price_traffic2
		                             ,0 AS price_traffic
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN(14, 15, 16, 17, 18, 19) 
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
           AND  GA.STATISTICS_WRITTEN_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>

	<!-- 보험사별 종결현황 - 보험사 - 교통비 - 1종 조사 -->
	<select id="MisEndPtnrTraffic1Main" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_traffic12, GB.price_traffic11, GB.price_traffic10, GB.price_traffic9, GB.price_traffic8, GB.price_traffic7
			  ,GB.price_traffic6, GB.price_traffic5, GB.price_traffic4, GB.price_traffic3, GB.price_traffic2, GB.price_traffic
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_traffic12) AS price_traffic12
                             ,SUM(C.price_traffic11) AS price_traffic11
                             ,SUM(C.price_traffic10) AS price_traffic10
                             ,SUM(C.price_traffic9) AS price_traffic9
                             ,SUM(C.price_traffic8) AS price_traffic8
                             ,SUM(C.price_traffic7) AS price_traffic7
                             ,SUM(C.price_traffic6) AS price_traffic6
                             ,SUM(C.price_traffic5) AS price_traffic5
                             ,SUM(C.price_traffic4) AS price_traffic4
                             ,SUM(C.price_traffic3) AS price_traffic3
                             ,SUM(C.price_traffic2) AS price_traffic2
                             ,SUM(C.price_traffic) AS price_traffic
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_traffic12
		                             ,0 AS price_traffic11
		                             ,0 AS price_traffic10
		                             ,0 AS price_traffic9
		                             ,0 AS price_traffic8
		                             ,0 AS price_traffic7
		                             ,0 AS price_traffic6
		                             ,0 AS price_traffic5
		                             ,0 AS price_traffic4
		                             ,0 AS price_traffic3
		                             ,0 AS price_traffic2
		                             ,0 AS price_traffic
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13) 
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>

	<!-- 보험사별 종결현황 - 보험사 - 교통비 - 1종 -->
	<select id="MisEndPtnrTraffic1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_traffic12, GB.price_traffic11, GB.price_traffic10, GB.price_traffic9, GB.price_traffic8, GB.price_traffic7
			  ,GB.price_traffic6, GB.price_traffic5, GB.price_traffic4, GB.price_traffic3, GB.price_traffic2, GB.price_traffic
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_traffic12) AS price_traffic12
                             ,SUM(C.price_traffic11) AS price_traffic11
                             ,SUM(C.price_traffic10) AS price_traffic10
                             ,SUM(C.price_traffic9) AS price_traffic9
                             ,SUM(C.price_traffic8) AS price_traffic8
                             ,SUM(C.price_traffic7) AS price_traffic7
                             ,SUM(C.price_traffic6) AS price_traffic6
                             ,SUM(C.price_traffic5) AS price_traffic5
                             ,SUM(C.price_traffic4) AS price_traffic4
                             ,SUM(C.price_traffic3) AS price_traffic3
                             ,SUM(C.price_traffic2) AS price_traffic2
                             ,SUM(C.price_traffic) AS price_traffic
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_traffic12
		                             ,0 AS price_traffic11
		                             ,0 AS price_traffic10
		                             ,0 AS price_traffic9
		                             ,0 AS price_traffic8
		                             ,0 AS price_traffic7
		                             ,0 AS price_traffic6
		                             ,0 AS price_traffic5
		                             ,0 AS price_traffic4
		                             ,0 AS price_traffic3
		                             ,0 AS price_traffic2
		                             ,0 AS price_traffic
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 NOT IN( 3, 4 )
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>			

	<!-- 보험사별 종결현황 - 보험사 - 교통비 - 4종 -->
	<select id="MisEndPtnrTraffic4" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_traffic12, GB.price_traffic11, GB.price_traffic10, GB.price_traffic9, GB.price_traffic8, GB.price_traffic7
			  ,GB.price_traffic6, GB.price_traffic5, GB.price_traffic4, GB.price_traffic3, GB.price_traffic2, GB.price_traffic
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_traffic12) AS price_traffic12
                             ,SUM(C.price_traffic11) AS price_traffic11
                             ,SUM(C.price_traffic10) AS price_traffic10
                             ,SUM(C.price_traffic9) AS price_traffic9
                             ,SUM(C.price_traffic8) AS price_traffic8
                             ,SUM(C.price_traffic7) AS price_traffic7
                             ,SUM(C.price_traffic6) AS price_traffic6
                             ,SUM(C.price_traffic5) AS price_traffic5
                             ,SUM(C.price_traffic4) AS price_traffic4
                             ,SUM(C.price_traffic3) AS price_traffic3
                             ,SUM(C.price_traffic2) AS price_traffic2
                             ,SUM(C.price_traffic) AS price_traffic
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_traffic12
		                             ,0 AS price_traffic11
		                             ,0 AS price_traffic10
		                             ,0 AS price_traffic9
		                             ,0 AS price_traffic8
		                             ,0 AS price_traffic7
		                             ,0 AS price_traffic6
		                             ,0 AS price_traffic5
		                             ,0 AS price_traffic4
		                             ,0 AS price_traffic3
		                             ,0 AS price_traffic2
		                             ,0 AS price_traffic
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN( 3, 4 )
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE = 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE = 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>
	
	<!-- 보험사별 종결현황 - 보험사 - 자문료+기타 - 1종 심사 -->
	<select id="MisEndPtnrQr1Written" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_qr12, GB.price_qr11, GB.price_qr10, GB.price_qr9, GB.price_qr8, GB.price_qr7
			  ,GB.price_qr6, GB.price_qr5, GB.price_qr4, GB.price_qr3, GB.price_qr2, GB.price_qr
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_qr12) AS price_qr12
                             ,SUM(C.price_qr11) AS price_qr11
                             ,SUM(C.price_qr10) AS price_qr10
                             ,SUM(C.price_qr9) AS price_qr9
                             ,SUM(C.price_qr8) AS price_qr8
                             ,SUM(C.price_qr7) AS price_qr7
                             ,SUM(C.price_qr6) AS price_qr6
                             ,SUM(C.price_qr5) AS price_qr5
                             ,SUM(C.price_qr4) AS price_qr4
                             ,SUM(C.price_qr3) AS price_qr3
                             ,SUM(C.price_qr2) AS price_qr2
                             ,SUM(C.price_qr) AS price_qr
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_qr12
		                             ,0 AS price_qr11
		                             ,0 AS price_qr10
		                             ,0 AS price_qr9
		                             ,0 AS price_qr8
		                             ,0 AS price_qr7
		                             ,0 AS price_qr6
		                             ,0 AS price_qr5
		                             ,0 AS price_qr4
		                             ,0 AS price_qr3
		                             ,0 AS price_qr2
		                             ,0 AS price_qr
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN(14, 15, 16, 17, 18, 19)
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
           AND  GA.STATISTICS_WRITTEN_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>			
	
	<!-- 보험사별 종결현황 - 보험사 - 자문료+기타 - 1종 조사 -->
	<select id="MisEndPtnrQr1Main" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_qr12, GB.price_qr11, GB.price_qr10, GB.price_qr9, GB.price_qr8, GB.price_qr7
			  ,GB.price_qr6, GB.price_qr5, GB.price_qr4, GB.price_qr3, GB.price_qr2, GB.price_qr
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_qr12) AS price_qr12
                             ,SUM(C.price_qr11) AS price_qr11
                             ,SUM(C.price_qr10) AS price_qr10
                             ,SUM(C.price_qr9) AS price_qr9
                             ,SUM(C.price_qr8) AS price_qr8
                             ,SUM(C.price_qr7) AS price_qr7
                             ,SUM(C.price_qr6) AS price_qr6
                             ,SUM(C.price_qr5) AS price_qr5
                             ,SUM(C.price_qr4) AS price_qr4
                             ,SUM(C.price_qr3) AS price_qr3
                             ,SUM(C.price_qr2) AS price_qr2
                             ,SUM(C.price_qr) AS price_qr
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_qr12
		                             ,0 AS price_qr11
		                             ,0 AS price_qr10
		                             ,0 AS price_qr9
		                             ,0 AS price_qr8
		                             ,0 AS price_qr7
		                             ,0 AS price_qr6
		                             ,0 AS price_qr5
		                             ,0 AS price_qr4
		                             ,0 AS price_qr3
		                             ,0 AS price_qr2
		                             ,0 AS price_qr
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13)
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>

	<!-- 보험사별 종결현황 - 보험사 - 자문료+기타 - 1종 -->
	<select id="MisEndPtnrQr1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_qr12, GB.price_qr11, GB.price_qr10, GB.price_qr9, GB.price_qr8, GB.price_qr7
			  ,GB.price_qr6, GB.price_qr5, GB.price_qr4, GB.price_qr3, GB.price_qr2, GB.price_qr
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_qr12) AS price_qr12
                             ,SUM(C.price_qr11) AS price_qr11
                             ,SUM(C.price_qr10) AS price_qr10
                             ,SUM(C.price_qr9) AS price_qr9
                             ,SUM(C.price_qr8) AS price_qr8
                             ,SUM(C.price_qr7) AS price_qr7
                             ,SUM(C.price_qr6) AS price_qr6
                             ,SUM(C.price_qr5) AS price_qr5
                             ,SUM(C.price_qr4) AS price_qr4
                             ,SUM(C.price_qr3) AS price_qr3
                             ,SUM(C.price_qr2) AS price_qr2
                             ,SUM(C.price_qr) AS price_qr
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_qr12
		                             ,0 AS price_qr11
		                             ,0 AS price_qr10
		                             ,0 AS price_qr9
		                             ,0 AS price_qr8
		                             ,0 AS price_qr7
		                             ,0 AS price_qr6
		                             ,0 AS price_qr5
		                             ,0 AS price_qr4
		                             ,0 AS price_qr3
		                             ,0 AS price_qr2
		                             ,0 AS price_qr
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 NOT IN( 3, 4 )
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>			

	<!-- 보험사별 종결현황 - 보험사 - 자문료+기타 - 4종 -->
	<select id="MisEndPtnrQr4" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_qr12, GB.price_qr11, GB.price_qr10, GB.price_qr9, GB.price_qr8, GB.price_qr7
			  ,GB.price_qr6, GB.price_qr5, GB.price_qr4, GB.price_qr3, GB.price_qr2, GB.price_qr
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_qr12) AS price_qr12
                             ,SUM(C.price_qr11) AS price_qr11
                             ,SUM(C.price_qr10) AS price_qr10
                             ,SUM(C.price_qr9) AS price_qr9
                             ,SUM(C.price_qr8) AS price_qr8
                             ,SUM(C.price_qr7) AS price_qr7
                             ,SUM(C.price_qr6) AS price_qr6
                             ,SUM(C.price_qr5) AS price_qr5
                             ,SUM(C.price_qr4) AS price_qr4
                             ,SUM(C.price_qr3) AS price_qr3
                             ,SUM(C.price_qr2) AS price_qr2
                             ,SUM(C.price_qr) AS price_qr
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_qr12
		                             ,0 AS price_qr11
		                             ,0 AS price_qr10
		                             ,0 AS price_qr9
		                             ,0 AS price_qr8
		                             ,0 AS price_qr7
		                             ,0 AS price_qr6
		                             ,0 AS price_qr5
		                             ,0 AS price_qr4
		                             ,0 AS price_qr3
		                             ,0 AS price_qr2
		                             ,0 AS price_qr
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN( 3, 4 )
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE = 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE = 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>
	
	<!-- 보험사별 종결현황 - 보험사 - 총합계 - 1종 심사 -->
	<select id="MisEndPtnrTotal1Written" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_total12, GB.price_total11, GB.price_total10, GB.price_total9, GB.price_total8, GB.price_total7
			  ,GB.price_total6, GB.price_total5, GB.price_total4, GB.price_total3, GB.price_total2, GB.price_total
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_total12) AS price_total12
                             ,SUM(C.price_total11) AS price_total11
                             ,SUM(C.price_total10) AS price_total10
                             ,SUM(C.price_total9) AS price_total9
                             ,SUM(C.price_total8) AS price_total8
                             ,SUM(C.price_total7) AS price_total7
                             ,SUM(C.price_total6) AS price_total6
                             ,SUM(C.price_total5) AS price_total5
                             ,SUM(C.price_total4) AS price_total4
                             ,SUM(C.price_total3) AS price_total3
                             ,SUM(C.price_total2) AS price_total2
                             ,SUM(C.price_total) AS price_total
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_total12
		                             ,0 AS price_total11
		                             ,0 AS price_total10
		                             ,0 AS price_total9
		                             ,0 AS price_total8
		                             ,0 AS price_total7
		                             ,0 AS price_total6
		                             ,0 AS price_total5
		                             ,0 AS price_total4
		                             ,0 AS price_total3
		                             ,0 AS price_total2
		                             ,0 AS price_total
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN(14, 15, 16, 17, 18, 19)
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
           AND  GA.STATISTICS_WRITTEN_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>
	
	<!-- 보험사별 종결현황 - 보험사 - 총합계 - 1종 조사 -->
	<select id="MisEndPtnrTotal1Main" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_total12, GB.price_total11, GB.price_total10, GB.price_total9, GB.price_total8, GB.price_total7
			  ,GB.price_total6, GB.price_total5, GB.price_total4, GB.price_total3, GB.price_total2, GB.price_total
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_total12 + C.price_total12_PLUS - C.price_total12_MINUS) AS price_total12
                             ,SUM(C.price_total11 + C.price_total11_PLUS - C.price_total11_MINUS) AS price_total11
                             ,SUM(C.price_total10 + C.price_total10_PLUS - C.price_total10_MINUS) AS price_total10
                             ,SUM(C.price_total9 + C.price_total9_PLUS - C.price_total9_MINUS) AS price_total9
                             ,SUM(C.price_total8 + C.price_total8_PLUS - C.price_total8_MINUS) AS price_total8
                             ,SUM(C.price_total7 + C.price_total7_PLUS - C.price_total7_MINUS) AS price_total7
                             ,SUM(C.price_total6 + C.price_total6_PLUS - C.price_total6_MINUS) AS price_total6
                             ,SUM(C.price_total5 + C.price_total5_PLUS - C.price_total5_MINUS) AS price_total5
                             ,SUM(C.price_total4 + C.price_total4_PLUS - C.price_total4_MINUS) AS price_total4
                             ,SUM(C.price_total3 + C.price_total3_PLUS - C.price_total3_MINUS) AS price_total3
                             ,SUM(C.price_total2 + C.price_total2_PLUS - C.price_total2_MINUS) AS price_total2
                             ,SUM(C.price_total + C.price_total_PLUS - C.price_total_MINUS) AS price_total
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_total12
		                             ,0 AS price_total11
		                             ,0 AS price_total10
		                             ,0 AS price_total9
		                             ,0 AS price_total8
		                             ,0 AS price_total7
		                             ,0 AS price_total6
		                             ,0 AS price_total5
		                             ,0 AS price_total4
		                             ,0 AS price_total3
		                             ,0 AS price_total2
		                             ,0 AS price_total
		                             
		                             ,0 AS price_total12_PLUS
		                             ,0 AS price_total11_PLUS
		                             ,0 AS price_total10_PLUS
		                             ,0 AS price_total9_PLUS
		                             ,0 AS price_total8_PLUS
		                             ,0 AS price_total7_PLUS
		                             ,0 AS price_total6_PLUS
		                             ,0 AS price_total5_PLUS
		                             ,0 AS price_total4_PLUS
		                             ,0 AS price_total3_PLUS
		                             ,0 AS price_total2_PLUS
		                             ,0 AS price_total_PLUS

		                             ,0 AS price_total12_MINUS
		                             ,0 AS price_total11_MINUS
		                             ,0 AS price_total10_MINUS
		                             ,0 AS price_total9_MINUS
		                             ,0 AS price_total8_MINUS
		                             ,0 AS price_total7_MINUS
		                             ,0 AS price_total6_MINUS
		                             ,0 AS price_total5_MINUS
		                             ,0 AS price_total4_MINUS
		                             ,0 AS price_total3_MINUS
		                             ,0 AS price_total2_MINUS
		                             ,0 AS price_total_MINUS
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13)
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
                               
                               UNION ALL
                               
                              SELECT  A.PTNR_ID
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total12_PLUS                                     
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
                               	 AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13)
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
					           
					           UNION ALL
					           
                              SELECT   A.PTNR_ID
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total12_MINUS                                     
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total_MINUS
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
					             AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13)
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>	

	<!-- 보험사별 종결현황 - 보험사 - 총합계 - 1종 조사 -->
	<select id="MisEndPtnrTotal1Main_20240104" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_total12, GB.price_total11, GB.price_total10, GB.price_total9, GB.price_total8, GB.price_total7
			  ,GB.price_total6, GB.price_total5, GB.price_total4, GB.price_total3, GB.price_total2, GB.price_total
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_total12) AS price_total12
                             ,SUM(C.price_total11) AS price_total11
                             ,SUM(C.price_total10) AS price_total10
                             ,SUM(C.price_total9) AS price_total9
                             ,SUM(C.price_total8) AS price_total8
                             ,SUM(C.price_total7) AS price_total7
                             ,SUM(C.price_total6) AS price_total6
                             ,SUM(C.price_total5) AS price_total5
                             ,SUM(C.price_total4) AS price_total4
                             ,SUM(C.price_total3) AS price_total3
                             ,SUM(C.price_total2) AS price_total2
                             ,SUM(C.price_total) AS price_total
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_total12
		                             ,0 AS price_total11
		                             ,0 AS price_total10
		                             ,0 AS price_total9
		                             ,0 AS price_total8
		                             ,0 AS price_total7
		                             ,0 AS price_total6
		                             ,0 AS price_total5
		                             ,0 AS price_total4
		                             ,0 AS price_total3
		                             ,0 AS price_total2
		                             ,0 AS price_total
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13)
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>

	<!-- 보험사별 종결현황 - 보험사 - 총합계 - 1종 -->
	<select id="MisEndPtnrTotal1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_total12, GB.price_total11, GB.price_total10, GB.price_total9, GB.price_total8, GB.price_total7
			  ,GB.price_total6, GB.price_total5, GB.price_total4, GB.price_total3, GB.price_total2, GB.price_total
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_total12) AS price_total12
                             ,SUM(C.price_total11) AS price_total11
                             ,SUM(C.price_total10) AS price_total10
                             ,SUM(C.price_total9) AS price_total9
                             ,SUM(C.price_total8) AS price_total8
                             ,SUM(C.price_total7) AS price_total7
                             ,SUM(C.price_total6) AS price_total6
                             ,SUM(C.price_total5) AS price_total5
                             ,SUM(C.price_total4) AS price_total4
                             ,SUM(C.price_total3) AS price_total3
                             ,SUM(C.price_total2) AS price_total2
                             ,SUM(C.price_total) AS price_total
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_total12
		                             ,0 AS price_total11
		                             ,0 AS price_total10
		                             ,0 AS price_total9
		                             ,0 AS price_total8
		                             ,0 AS price_total7
		                             ,0 AS price_total6
		                             ,0 AS price_total5
		                             ,0 AS price_total4
		                             ,0 AS price_total3
		                             ,0 AS price_total2
		                             ,0 AS price_total
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 NOT IN( 3, 4 )
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE != 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>		

	<!-- 보험사별 종결현황 - 보험사 - 총합계 - 4종 -->
	<select id="MisEndPtnrTotal4" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.ptnr_id
              ,GA.ptnr_nick			  
			  ,GB.price_total12, GB.price_total11, GB.price_total10, GB.price_total9, GB.price_total8, GB.price_total7
			  ,GB.price_total6, GB.price_total5, GB.price_total4, GB.price_total3, GB.price_total2, GB.price_total
          FROM  top_ptnr_bsc GA
          LEFT  JOIN (
                      SELECT  C.PTNR_ID
                             ,SUM(C.price_total12) AS price_total12
                             ,SUM(C.price_total11) AS price_total11
                             ,SUM(C.price_total10) AS price_total10
                             ,SUM(C.price_total9) AS price_total9
                             ,SUM(C.price_total8) AS price_total8
                             ,SUM(C.price_total7) AS price_total7
                             ,SUM(C.price_total6) AS price_total6
                             ,SUM(C.price_total5) AS price_total5
                             ,SUM(C.price_total4) AS price_total4
                             ,SUM(C.price_total3) AS price_total3
                             ,SUM(C.price_total2) AS price_total2
                             ,SUM(C.price_total) AS price_total
                        FROM  (
							  SELECT  0 AS PTNR_ID
							  		 ,0 AS USER_NO
		                             ,0 AS price_total12
		                             ,0 AS price_total11
		                             ,0 AS price_total10
		                             ,0 AS price_total9
		                             ,0 AS price_total8
		                             ,0 AS price_total7
		                             ,0 AS price_total6
		                             ,0 AS price_total5
		                             ,0 AS price_total4
		                             ,0 AS price_total3
		                             ,0 AS price_total2
		                             ,0 AS price_total
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN( 3, 4 )
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE = 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.PTNR_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_tm_bsc C
                                  ON  A.TEAM_ID = C.TEAM_ID                                  
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                                 AND  C.TEAM_TYPE = 4
                               GROUP BY A.SUIM_RPT_NO, A.PTNR_ID
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.PTNR_ID  
                     ) GB
            ON  GA.PTNR_ID = GB.PTNR_ID 
         WHERE  1=1
           AND  GA.PTNR_LEVEL = 1
           AND  GA.STATISTICS_YN = 1
		 ORDER BY GA.STATISTICS_ORDER ASC, GA.PTNR_ORDER DESC, GA.PTNR_ID ASC	  
	</select>		


	<!-- 보험사별 종결현황 - 팀 - 절대건수 - 1종 -->
	<select id="MisEndPtnrTm1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
        SELECT  GA.team_id 
               ,GA.team_name
               ,getTopTmBscCenterName(GA.team_id) center_name
               ,GA.team_type
               ,getTopPtnrBscPtnrNick(#{ptnr_id}) ptnr_nick
               ,GB.end_rid12 ,GB.end_rid11 ,GB.end_rid10 ,GB.end_rid9 ,GB.end_rid8 ,GB.end_rid7 ,GB.end_rid6 ,GB.end_rid5 ,GB.end_rid4 ,GB.end_rid3 ,GB.end_rid2 ,GB.end_rid
          FROM  top_tm_bsc GA
          LEFT  JOIN (
                      SELECT  C.TEAM_ID
                             ,SUM(C.end_rid12) AS end_rid12
                             ,SUM(C.end_rid11) AS end_rid11
                             ,SUM(C.end_rid10) AS end_rid10
                             ,SUM(C.end_rid9) AS end_rid9
                             ,SUM(C.end_rid8) AS end_rid8
                             ,SUM(C.end_rid7) AS end_rid7
                             ,SUM(C.end_rid6) AS end_rid6
                             ,SUM(C.end_rid5) AS end_rid5
                             ,SUM(C.end_rid4) AS end_rid4
                             ,SUM(C.end_rid3) AS end_rid3
                             ,SUM(C.end_rid2) AS end_rid2
                             ,SUM(C.end_rid) AS end_rid
                        FROM  (
							  SELECT  0 AS TEAM_ID
							  		 ,0 AS SUIM_RPT_NO
		                             ,0 AS end_rid12
		                             ,0 AS end_rid11
		                             ,0 AS end_rid10
		                             ,0 AS end_rid9
		                             ,0 AS end_rid8
		                             ,0 AS end_rid7
		                             ,0 AS end_rid6
		                             ,0 AS end_rid5
		                             ,0 AS end_rid4
		                             ,0 AS end_rid3
		                             ,0 AS end_rid2
		                             ,0 AS end_rid
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.SUIM_RPT_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS end_rid12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS end_rid11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS end_rid10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS end_rid9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS end_rid8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS end_rid7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS end_rid6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS end_rid5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS end_rid4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS end_rid3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS end_rid2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS end_rid
                                FROM  top_rpt_head A 
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE = '2'
                                 AND  A.PTNR_ID = #{ptnr_id}
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
							</if>
                            <if test='primYN == "Y"'>
                              UNION ALL
                              SELECT  B.TEAM_ID
                                     ,B.SUIM_RPT_NO
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS end_rid12
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS end_rid11
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS end_rid10
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS end_rid9
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS end_rid8
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS end_rid7
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS end_rid6
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS end_rid5
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS end_rid4
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS end_rid3
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS end_rid2
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS end_rid
                                FROM  top_prim_biz_rpt_head B 
                               WHERE  1=1
                                 AND  B.PTNR_ID = #{ptnr_id}                                 
                                 AND  B.SUIM_RPT_STATE = '2'
                                 AND  B.SUIM_RPT_TYPE1 = 5
                                 AND  B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.team_id  
                     ) GB
            ON  GA.TEAM_ID = GB.TEAM_ID  
         WHERE  1=1
           <!-- AND  GA.TEAM_TYPE = 1 -->
           AND  GA.TEAM_TYPE IN (0,1)
           AND  GA.TEAM_STATISTICS1 = 0 
        ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC           
	</select>


	<!-- 보험사별 종결현황 - 팀 - 절대건수 - 4종 -->
	<select id="MisEndPtnrTm4" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
        SELECT  GA.team_id 
               ,GA.team_name
               ,getTopTmBscCenterName(GA.team_id) center_name
               ,GA.team_type
               ,getTopPtnrBscPtnrNick(#{ptnr_id}) ptnr_nick               
               ,GB.end_rid12 ,GB.end_rid11 ,GB.end_rid10 ,GB.end_rid9 ,GB.end_rid8 ,GB.end_rid7 ,GB.end_rid6 ,GB.end_rid5 ,GB.end_rid4 ,GB.end_rid3 ,GB.end_rid2 ,GB.end_rid
          FROM  top_tm_bsc GA
          LEFT  JOIN (
                      SELECT  C.TEAM_ID
                             ,SUM(C.end_rid12) AS end_rid12
                             ,SUM(C.end_rid11) AS end_rid11
                             ,SUM(C.end_rid10) AS end_rid10
                             ,SUM(C.end_rid9) AS end_rid9
                             ,SUM(C.end_rid8) AS end_rid8
                             ,SUM(C.end_rid7) AS end_rid7
                             ,SUM(C.end_rid6) AS end_rid6
                             ,SUM(C.end_rid5) AS end_rid5
                             ,SUM(C.end_rid4) AS end_rid4
                             ,SUM(C.end_rid3) AS end_rid3
                             ,SUM(C.end_rid2) AS end_rid2
                             ,SUM(C.end_rid) AS end_rid
                        FROM  (
							  SELECT  0 AS TEAM_ID
							  		 ,0 AS SUIM_RPT_NO
		                             ,0 AS end_rid12
		                             ,0 AS end_rid11
		                             ,0 AS end_rid10
		                             ,0 AS end_rid9
		                             ,0 AS end_rid8
		                             ,0 AS end_rid7
		                             ,0 AS end_rid6
		                             ,0 AS end_rid5
		                             ,0 AS end_rid4
		                             ,0 AS end_rid3
		                             ,0 AS end_rid2
		                             ,0 AS end_rid
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.SUIM_RPT_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS end_rid12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS end_rid11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS end_rid10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS end_rid9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS end_rid8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS end_rid7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS end_rid6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS end_rid5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS end_rid4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS end_rid3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS end_rid2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS end_rid
                                FROM  top_rpt_head A 
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE = '2'
                                 AND  A.PTNR_ID = #{ptnr_id}
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
							</if>
                            <if test='primYN == "Y"'>
                              UNION ALL
                              SELECT  B.TEAM_ID
                                     ,B.SUIM_RPT_NO
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN 1 ELSE 0 END AS end_rid12
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN 1 ELSE 0 END AS end_rid11
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN 1 ELSE 0 END AS end_rid10
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN 1 ELSE 0 END AS end_rid9
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN 1 ELSE 0 END AS end_rid8
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN 1 ELSE 0 END AS end_rid7
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN 1 ELSE 0 END AS end_rid6
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN 1 ELSE 0 END AS end_rid5
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN 1 ELSE 0 END AS end_rid4
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN 1 ELSE 0 END AS end_rid3
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN 1 ELSE 0 END AS end_rid2
                                     ,CASE WHEN B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN 1 ELSE 0 END AS end_rid
                                FROM  top_prim_biz_rpt_head B 
                               WHERE  1=1
                                 AND  B.PTNR_ID = #{ptnr_id}                                 
                                 AND  B.SUIM_RPT_STATE = '2'
                                 AND  B.SUIM_RPT_TYPE1 = 5
                                 AND  B.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  B.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.team_id  
                     ) GB
            ON  GA.TEAM_ID = GB.TEAM_ID  
         WHERE  1=1
           AND  GA.TEAM_TYPE = 4
           AND  GA.TEAM_STATISTICS1 = 0 
        ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC           
	</select>

<!-- 보험사별 종결현황 - 팀 - 순수피 - 1종 -->
	<select id="MisEndPtnrTmAssess1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.team_id
              ,getTopTmBscCenterName(GA.team_id) center_name		
			  ,GA.team_name
              ,GA.team_type			  
              ,getTopPtnrBscPtnrNick(#{ptnr_id}) ptnr_nick              
			  ,GB.price_assess12, GB.price_assess11, GB.price_assess10, GB.price_assess9, GB.price_assess8, GB.price_assess7
			  ,GB.price_assess6, GB.price_assess5, GB.price_assess4, GB.price_assess3, GB.price_assess2, GB.price_assess
          FROM  top_tm_bsc GA
          LEFT  JOIN (
                      SELECT  C.TEAM_ID
                             ,SUM(C.price_assess12 + C.price_assess12_PLUS - C.price_assess12_MINUS) AS price_assess12
                             ,SUM(C.price_assess11 + C.price_assess11_PLUS - C.price_assess11_MINUS) AS price_assess11
                             ,SUM(C.price_assess10 + C.price_assess10_PLUS - C.price_assess10_MINUS) AS price_assess10
                             ,SUM(C.price_assess9 + C.price_assess9_PLUS - C.price_assess9_MINUS) AS price_assess9
                             ,SUM(C.price_assess8 + C.price_assess8_PLUS - C.price_assess8_MINUS) AS price_assess8
                             ,SUM(C.price_assess7 + C.price_assess7_PLUS - C.price_assess7_MINUS) AS price_assess7
                             ,SUM(C.price_assess6 + C.price_assess6_PLUS - C.price_assess6_MINUS) AS price_assess6
                             ,SUM(C.price_assess5 + C.price_assess5_PLUS - C.price_assess5_MINUS) AS price_assess5
                             ,SUM(C.price_assess4 + C.price_assess4_PLUS - C.price_assess4_MINUS) AS price_assess4
                             ,SUM(C.price_assess3 + C.price_assess3_PLUS - C.price_assess3_MINUS) AS price_assess3
                             ,SUM(C.price_assess2 + C.price_assess2_PLUS - C.price_assess2_MINUS) AS price_assess2
                             ,SUM(C.price_assess + C.price_assess_PLUS - C.price_assess_MINUS) AS price_assess
                        FROM  (
							  SELECT  0 AS TEAM_ID
							  		 ,0 AS USER_NO
							  		 
		                             ,0 AS price_assess12
		                             ,0 AS price_assess11
		                             ,0 AS price_assess10
		                             ,0 AS price_assess9
		                             ,0 AS price_assess8
		                             ,0 AS price_assess7
		                             ,0 AS price_assess6
		                             ,0 AS price_assess5
		                             ,0 AS price_assess4
		                             ,0 AS price_assess3
		                             ,0 AS price_assess2
		                             ,0 AS price_assess
							  		 
		                             ,0 AS price_assess12_PLUS
		                             ,0 AS price_assess11_PLUS
		                             ,0 AS price_assess10_PLUS
		                             ,0 AS price_assess9_PLUS
		                             ,0 AS price_assess8_PLUS
		                             ,0 AS price_assess7_PLUS
		                             ,0 AS price_assess6_PLUS
		                             ,0 AS price_assess5_PLUS
		                             ,0 AS price_assess4_PLUS
		                             ,0 AS price_assess3_PLUS
		                             ,0 AS price_assess2_PLUS
		                             ,0 AS price_assess_PLUS

		                             ,0 AS price_assess12_MINUS
		                             ,0 AS price_assess11_MINUS
		                             ,0 AS price_assess10_MINUS
		                             ,0 AS price_assess9_MINUS
		                             ,0 AS price_assess8_MINUS
		                             ,0 AS price_assess7_MINUS
		                             ,0 AS price_assess6_MINUS
		                             ,0 AS price_assess5_MINUS
		                             ,0 AS price_assess4_MINUS
		                             ,0 AS price_assess3_MINUS
		                             ,0 AS price_assess2_MINUS
		                             ,0 AS price_assess_MINUS		                             		                             
		                             
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     <!-- ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess -->
                                     
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) ELSE 0 END AS price_assess
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 NOT IN( 3, 4 )
                                 AND  A.PTNR_ID = #{ptnr_id}
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     <!-- ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess12_PLUS                                     
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess_PLUS -->
                                                                          
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess12_PLUS                                     
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 NOT IN(3, 4)
                                 AND  A.PTNR_ID = #{ptnr_id}					             
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     <!-- ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess_MINUS -->
                                     
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) ELSE 0 END AS price_assess_MINUS
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_TYPE1 NOT IN(3, 4)
                                 AND  A.PTNR_ID = #{ptnr_id}					             						            
					             AND  A.SUIM_RPT_STATE != 3
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID				           
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.PTNR_ID = #{ptnr_id}                                 
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			  
                                 AND  A.PTNR_ID = #{ptnr_id}					                       
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess_MINUS
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5	
                                 AND  A.PTNR_ID = #{ptnr_id}					             		            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID	
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.team_id  
                     ) GB
            ON  GA.TEAM_ID = GB.TEAM_ID  
         WHERE  1=1
           <!-- AND  GA.TEAM_TYPE = 1 -->
           AND  GA.TEAM_TYPE IN (0,1)
           AND  GA.TEAM_STATISTICS1 = 0 
         ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC 			  
	</select>
	
	
	<!-- 보험사별 종결현황 - 팀 - 절대건수 - 4종 -->
	<select id="MisEndPtnrTmAssess4" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.team_id
              ,getTopTmBscCenterName(GA.team_id) center_name		
			  ,GA.team_name
              ,GA.team_type			  
              ,getTopPtnrBscPtnrNick(#{ptnr_id}) ptnr_nick              
			  ,GB.price_assess12, GB.price_assess11, GB.price_assess10, GB.price_assess9, GB.price_assess8, GB.price_assess7
			  ,GB.price_assess6, GB.price_assess5, GB.price_assess4, GB.price_assess3, GB.price_assess2, GB.price_assess
          FROM  top_tm_bsc GA
          LEFT  JOIN (
                      SELECT  C.TEAM_ID
                             ,SUM(C.price_assess12 + C.price_assess12_PLUS - C.price_assess12_MINUS) AS price_assess12
                             ,SUM(C.price_assess11 + C.price_assess11_PLUS - C.price_assess11_MINUS) AS price_assess11
                             ,SUM(C.price_assess10 + C.price_assess10_PLUS - C.price_assess10_MINUS) AS price_assess10
                             ,SUM(C.price_assess9 + C.price_assess9_PLUS - C.price_assess9_MINUS) AS price_assess9
                             ,SUM(C.price_assess8 + C.price_assess8_PLUS - C.price_assess8_MINUS) AS price_assess8
                             ,SUM(C.price_assess7 + C.price_assess7_PLUS - C.price_assess7_MINUS) AS price_assess7
                             ,SUM(C.price_assess6 + C.price_assess6_PLUS - C.price_assess6_MINUS) AS price_assess6
                             ,SUM(C.price_assess5 + C.price_assess5_PLUS - C.price_assess5_MINUS) AS price_assess5
                             ,SUM(C.price_assess4 + C.price_assess4_PLUS - C.price_assess4_MINUS) AS price_assess4
                             ,SUM(C.price_assess3 + C.price_assess3_PLUS - C.price_assess3_MINUS) AS price_assess3
                             ,SUM(C.price_assess2 + C.price_assess2_PLUS - C.price_assess2_MINUS) AS price_assess2
                             ,SUM(C.price_assess + C.price_assess_PLUS - C.price_assess_MINUS) AS price_assess
                        FROM  (
							  SELECT  0 AS TEAM_ID
							  		 ,0 AS USER_NO
							  		 
		                             ,0 AS price_assess12
		                             ,0 AS price_assess11
		                             ,0 AS price_assess10
		                             ,0 AS price_assess9
		                             ,0 AS price_assess8
		                             ,0 AS price_assess7
		                             ,0 AS price_assess6
		                             ,0 AS price_assess5
		                             ,0 AS price_assess4
		                             ,0 AS price_assess3
		                             ,0 AS price_assess2
		                             ,0 AS price_assess
							  		 
		                             ,0 AS price_assess12_PLUS
		                             ,0 AS price_assess11_PLUS
		                             ,0 AS price_assess10_PLUS
		                             ,0 AS price_assess9_PLUS
		                             ,0 AS price_assess8_PLUS
		                             ,0 AS price_assess7_PLUS
		                             ,0 AS price_assess6_PLUS
		                             ,0 AS price_assess5_PLUS
		                             ,0 AS price_assess4_PLUS
		                             ,0 AS price_assess3_PLUS
		                             ,0 AS price_assess2_PLUS
		                             ,0 AS price_assess_PLUS

		                             ,0 AS price_assess12_MINUS
		                             ,0 AS price_assess11_MINUS
		                             ,0 AS price_assess10_MINUS
		                             ,0 AS price_assess9_MINUS
		                             ,0 AS price_assess8_MINUS
		                             ,0 AS price_assess7_MINUS
		                             ,0 AS price_assess6_MINUS
		                             ,0 AS price_assess5_MINUS
		                             ,0 AS price_assess4_MINUS
		                             ,0 AS price_assess3_MINUS
		                             ,0 AS price_assess2_MINUS
		                             ,0 AS price_assess_MINUS		                             		                             
		                             
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN( 3, 4 )
                                 AND  A.PTNR_ID = #{ptnr_id}                                 
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_TYPE1 IN(3, 4)						            
					             AND  A.SUIM_RPT_STATE != 3
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_assess_MINUS
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_TYPE1 IN(3, 4)						            
					             AND  A.SUIM_RPT_STATE != 3
                                 AND  A.PTNR_ID = #{ptnr_id}					             
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID				           
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_BASIC) ELSE 0 END AS price_assess
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.PTNR_ID = #{ptnr_id}                                 
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5		
                                 AND  A.PTNR_ID = #{ptnr_id}					             	            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_BASIC) ELSE 0 END AS price_assess_MINUS
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			  
                                 AND  A.PTNR_ID = #{ptnr_id}					                       
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID	
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.team_id  
                     ) GB
            ON  GA.TEAM_ID = GB.TEAM_ID  
         WHERE  1=1
           AND  GA.TEAM_TYPE = 4
           AND  GA.TEAM_STATISTICS1 = 0 
         ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC 		
	</select>



	<!-- 보험사별 종결현황 - 팀 - 일비 - 1종 -->
	<select id="MisEndPtnrTmTime1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.team_id
              ,getTopTmBscCenterName(GA.team_id) center_name		
			  ,GA.team_name
              ,GA.team_type			  
              ,getTopPtnrBscPtnrNick(#{ptnr_id}) ptnr_nick              
			  ,GB.price_time12, GB.price_time11, GB.price_time10, GB.price_time9, GB.price_time8, GB.price_time7
			  ,GB.price_time6, GB.price_time5, GB.price_time4, GB.price_time3, GB.price_time2, GB.price_time
          FROM  top_tm_bsc GA
          LEFT  JOIN (
                      SELECT  C.TEAM_ID
                             ,SUM(C.price_time12 + C.price_time12_PLUS - C.price_time12_MINUS) AS price_time12
                             ,SUM(C.price_time11 + C.price_time11_PLUS - C.price_time11_MINUS) AS price_time11
                             ,SUM(C.price_time10 + C.price_time10_PLUS - C.price_time10_MINUS) AS price_time10
                             ,SUM(C.price_time9 + C.price_time9_PLUS - C.price_time9_MINUS) AS price_time9
                             ,SUM(C.price_time8 + C.price_time8_PLUS - C.price_time8_MINUS) AS price_time8
                             ,SUM(C.price_time7 + C.price_time7_PLUS - C.price_time7_MINUS) AS price_time7
                             ,SUM(C.price_time6 + C.price_time6_PLUS - C.price_time6_MINUS) AS price_time6
                             ,SUM(C.price_time5 + C.price_time5_PLUS - C.price_time5_MINUS) AS price_time5
                             ,SUM(C.price_time4 + C.price_time4_PLUS - C.price_time4_MINUS) AS price_time4
                             ,SUM(C.price_time3 + C.price_time3_PLUS - C.price_time3_MINUS) AS price_time3
                             ,SUM(C.price_time2 + C.price_time2_PLUS - C.price_time2_MINUS) AS price_time2
                             ,SUM(C.price_time + C.price_time_PLUS - C.price_time_MINUS) AS price_time
                        FROM  (
							  SELECT  0 AS TEAM_ID
							  		 ,0 AS USER_NO
							  		 
		                             ,0 AS price_time12
		                             ,0 AS price_time11
		                             ,0 AS price_time10
		                             ,0 AS price_time9
		                             ,0 AS price_time8
		                             ,0 AS price_time7
		                             ,0 AS price_time6
		                             ,0 AS price_time5
		                             ,0 AS price_time4
		                             ,0 AS price_time3
		                             ,0 AS price_time2
		                             ,0 AS price_time
							  		 
		                             ,0 AS price_time12_PLUS
		                             ,0 AS price_time11_PLUS
		                             ,0 AS price_time10_PLUS
		                             ,0 AS price_time9_PLUS
		                             ,0 AS price_time8_PLUS
		                             ,0 AS price_time7_PLUS
		                             ,0 AS price_time6_PLUS
		                             ,0 AS price_time5_PLUS
		                             ,0 AS price_time4_PLUS
		                             ,0 AS price_time3_PLUS
		                             ,0 AS price_time2_PLUS
		                             ,0 AS price_time_PLUS

		                             ,0 AS price_time12_MINUS
		                             ,0 AS price_time11_MINUS
		                             ,0 AS price_time10_MINUS
		                             ,0 AS price_time9_MINUS
		                             ,0 AS price_time8_MINUS
		                             ,0 AS price_time7_MINUS
		                             ,0 AS price_time6_MINUS
		                             ,0 AS price_time5_MINUS
		                             ,0 AS price_time4_MINUS
		                             ,0 AS price_time3_MINUS
		                             ,0 AS price_time2_MINUS
		                             ,0 AS price_time_MINUS		                             		                             
		                             
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 NOT IN( 3, 4 )
                                 AND  A.PTNR_ID = #{ptnr_id}                                 
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_TYPE1 NOT IN(3, 4)						            
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.PTNR_ID = #{ptnr_id}  
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) ELSE 0 END AS price_time_MINUS
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_TYPE1 NOT IN(3, 4)
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.PTNR_ID = #{ptnr_id}  
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID				           
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5	
					             AND  A.PTNR_ID = #{ptnr_id}  		            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time_MINUS
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5		
					             AND  A.PTNR_ID = #{ptnr_id}  	            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID	
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.team_id  
                     ) GB
            ON  GA.TEAM_ID = GB.TEAM_ID  
         WHERE  1=1
           <!-- AND  GA.TEAM_TYPE = 1 -->
           AND  GA.TEAM_TYPE IN (0,1)
           AND  GA.TEAM_STATISTICS1 = 0 
         ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC 			  
	</select>

	<!-- 보험사별 종결현황 - 팀 - 일비 - 4종 -->
	<select id="MisEndPtnrTmTime4" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.team_id
              ,getTopTmBscCenterName(GA.team_id) center_name		
			  ,GA.team_name
              ,GA.team_type			  
              ,getTopPtnrBscPtnrNick(#{ptnr_id}) ptnr_nick              
			  ,GB.price_time12, GB.price_time11, GB.price_time10, GB.price_time9, GB.price_time8, GB.price_time7
			  ,GB.price_time6, GB.price_time5, GB.price_time4, GB.price_time3, GB.price_time2, GB.price_time
          FROM  top_tm_bsc GA
          LEFT  JOIN (
                      SELECT  C.TEAM_ID
                             ,SUM(C.price_time12 + C.price_time12_PLUS - C.price_time12_MINUS) AS price_time12
                             ,SUM(C.price_time11 + C.price_time11_PLUS - C.price_time11_MINUS) AS price_time11
                             ,SUM(C.price_time10 + C.price_time10_PLUS - C.price_time10_MINUS) AS price_time10
                             ,SUM(C.price_time9 + C.price_time9_PLUS - C.price_time9_MINUS) AS price_time9
                             ,SUM(C.price_time8 + C.price_time8_PLUS - C.price_time8_MINUS) AS price_time8
                             ,SUM(C.price_time7 + C.price_time7_PLUS - C.price_time7_MINUS) AS price_time7
                             ,SUM(C.price_time6 + C.price_time6_PLUS - C.price_time6_MINUS) AS price_time6
                             ,SUM(C.price_time5 + C.price_time5_PLUS - C.price_time5_MINUS) AS price_time5
                             ,SUM(C.price_time4 + C.price_time4_PLUS - C.price_time4_MINUS) AS price_time4
                             ,SUM(C.price_time3 + C.price_time3_PLUS - C.price_time3_MINUS) AS price_time3
                             ,SUM(C.price_time2 + C.price_time2_PLUS - C.price_time2_MINUS) AS price_time2
                             ,SUM(C.price_time + C.price_time_PLUS - C.price_time_MINUS) AS price_time
                        FROM  (
							  SELECT  0 AS TEAM_ID
							  		 ,0 AS USER_NO
							  		 
		                             ,0 AS price_time12
		                             ,0 AS price_time11
		                             ,0 AS price_time10
		                             ,0 AS price_time9
		                             ,0 AS price_time8
		                             ,0 AS price_time7
		                             ,0 AS price_time6
		                             ,0 AS price_time5
		                             ,0 AS price_time4
		                             ,0 AS price_time3
		                             ,0 AS price_time2
		                             ,0 AS price_time
							  		 
		                             ,0 AS price_time12_PLUS
		                             ,0 AS price_time11_PLUS
		                             ,0 AS price_time10_PLUS
		                             ,0 AS price_time9_PLUS
		                             ,0 AS price_time8_PLUS
		                             ,0 AS price_time7_PLUS
		                             ,0 AS price_time6_PLUS
		                             ,0 AS price_time5_PLUS
		                             ,0 AS price_time4_PLUS
		                             ,0 AS price_time3_PLUS
		                             ,0 AS price_time2_PLUS
		                             ,0 AS price_time_PLUS

		                             ,0 AS price_time12_MINUS
		                             ,0 AS price_time11_MINUS
		                             ,0 AS price_time10_MINUS
		                             ,0 AS price_time9_MINUS
		                             ,0 AS price_time8_MINUS
		                             ,0 AS price_time7_MINUS
		                             ,0 AS price_time6_MINUS
		                             ,0 AS price_time5_MINUS
		                             ,0 AS price_time4_MINUS
		                             ,0 AS price_time3_MINUS
		                             ,0 AS price_time2_MINUS
		                             ,0 AS price_time_MINUS		                             		                             
		                             
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN( 3, 4 )
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_DAILY) ELSE 0 END AS price_time
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5
					             AND  A.PTNR_ID = #{ptnr_id}   
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_DAILY) ELSE 0 END AS price_time_MINUS
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5
					             AND  A.PTNR_ID = #{ptnr_id}  
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID	
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.team_id  
                     ) GB
            ON  GA.TEAM_ID = GB.TEAM_ID  
         WHERE  1=1
           AND  GA.TEAM_TYPE = 4
           AND  GA.TEAM_STATISTICS1 = 0 
         ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC 			  
	</select>


	<!-- 보험사별 종결현황 - 팀 - 교통비 - 1종 -->
	<select id="MisEndPtnrTmTraffic1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.team_id
              ,getTopTmBscCenterName(GA.team_id) center_name		
			  ,GA.team_name
              ,GA.team_type			  
              ,getTopPtnrBscPtnrNick(#{ptnr_id}) ptnr_nick              
			  ,GB.price_traffic12, GB.price_traffic11, GB.price_traffic10, GB.price_traffic9, GB.price_traffic8, GB.price_traffic7
			  ,GB.price_traffic6, GB.price_traffic5, GB.price_traffic4, GB.price_traffic3, GB.price_traffic2, GB.price_traffic
          FROM  top_tm_bsc GA
          LEFT  JOIN (
                      SELECT  C.TEAM_ID
                             ,SUM(C.price_traffic12 + C.price_traffic12_PLUS - C.price_traffic12_MINUS) AS price_traffic12
                             ,SUM(C.price_traffic11 + C.price_traffic11_PLUS - C.price_traffic11_MINUS) AS price_traffic11
                             ,SUM(C.price_traffic10 + C.price_traffic10_PLUS - C.price_traffic10_MINUS) AS price_traffic10
                             ,SUM(C.price_traffic9 + C.price_traffic9_PLUS - C.price_traffic9_MINUS) AS price_traffic9
                             ,SUM(C.price_traffic8 + C.price_traffic8_PLUS - C.price_traffic8_MINUS) AS price_traffic8
                             ,SUM(C.price_traffic7 + C.price_traffic7_PLUS - C.price_traffic7_MINUS) AS price_traffic7
                             ,SUM(C.price_traffic6 + C.price_traffic6_PLUS - C.price_traffic6_MINUS) AS price_traffic6
                             ,SUM(C.price_traffic5 + C.price_traffic5_PLUS - C.price_traffic5_MINUS) AS price_traffic5
                             ,SUM(C.price_traffic4 + C.price_traffic4_PLUS - C.price_traffic4_MINUS) AS price_traffic4
                             ,SUM(C.price_traffic3 + C.price_traffic3_PLUS - C.price_traffic3_MINUS) AS price_traffic3
                             ,SUM(C.price_traffic2 + C.price_traffic2_PLUS - C.price_traffic2_MINUS) AS price_traffic2
                             ,SUM(C.price_traffic + C.price_traffic_PLUS - C.price_traffic_MINUS) AS price_traffic
                        FROM  (
							  SELECT  0 AS TEAM_ID
							  		 ,0 AS USER_NO
							  		 
		                             ,0 AS price_traffic12
		                             ,0 AS price_traffic11
		                             ,0 AS price_traffic10
		                             ,0 AS price_traffic9
		                             ,0 AS price_traffic8
		                             ,0 AS price_traffic7
		                             ,0 AS price_traffic6
		                             ,0 AS price_traffic5
		                             ,0 AS price_traffic4
		                             ,0 AS price_traffic3
		                             ,0 AS price_traffic2
		                             ,0 AS price_traffic
							  		 
		                             ,0 AS price_traffic12_PLUS
		                             ,0 AS price_traffic11_PLUS
		                             ,0 AS price_traffic10_PLUS
		                             ,0 AS price_traffic9_PLUS
		                             ,0 AS price_traffic8_PLUS
		                             ,0 AS price_traffic7_PLUS
		                             ,0 AS price_traffic6_PLUS
		                             ,0 AS price_traffic5_PLUS
		                             ,0 AS price_traffic4_PLUS
		                             ,0 AS price_traffic3_PLUS
		                             ,0 AS price_traffic2_PLUS
		                             ,0 AS price_traffic_PLUS

		                             ,0 AS price_traffic12_MINUS
		                             ,0 AS price_traffic11_MINUS
		                             ,0 AS price_traffic10_MINUS
		                             ,0 AS price_traffic9_MINUS
		                             ,0 AS price_traffic8_MINUS
		                             ,0 AS price_traffic7_MINUS
		                             ,0 AS price_traffic6_MINUS
		                             ,0 AS price_traffic5_MINUS
		                             ,0 AS price_traffic4_MINUS
		                             ,0 AS price_traffic3_MINUS
		                             ,0 AS price_traffic2_MINUS
		                             ,0 AS price_traffic_MINUS		                             		                             
		                             
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 NOT IN( 3, 4 )
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_TYPE1 NOT IN(3, 4)						            
					             AND  A.SUIM_RPT_STATE != 3
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.COLLABO_TRAFFIC) ELSE 0 END AS price_traffic_MINUS
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_TYPE1 NOT IN(3, 4)						            
					             AND  A.SUIM_RPT_STATE != 3
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID				           
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic_MINUS
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID	
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.team_id  
                     ) GB
            ON  GA.TEAM_ID = GB.TEAM_ID  
         WHERE  1=1
           <!-- AND  GA.TEAM_TYPE = 1 -->
           AND  GA.TEAM_TYPE IN (0,1)
           AND  GA.TEAM_STATISTICS1 = 0 
         ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC 			  
	</select>

	<!-- 보험사별 종결현황 - 팀 - 교통비 - 4종 -->
	<select id="MisEndPtnrTmTraffic4" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.team_id
              ,getTopTmBscCenterName(GA.team_id) center_name		
			  ,GA.team_name
              ,GA.team_type			  
              ,getTopPtnrBscPtnrNick(#{ptnr_id}) ptnr_nick              
			  ,GB.price_traffic12, GB.price_traffic11, GB.price_traffic10, GB.price_traffic9, GB.price_traffic8, GB.price_traffic7
			  ,GB.price_traffic6, GB.price_traffic5, GB.price_traffic4, GB.price_traffic3, GB.price_traffic2, GB.price_traffic
          FROM  top_tm_bsc GA
          LEFT  JOIN (
                      SELECT  C.TEAM_ID
                             ,SUM(C.price_traffic12 + C.price_traffic12_PLUS - C.price_traffic12_MINUS) AS price_traffic12
                             ,SUM(C.price_traffic11 + C.price_traffic11_PLUS - C.price_traffic11_MINUS) AS price_traffic11
                             ,SUM(C.price_traffic10 + C.price_traffic10_PLUS - C.price_traffic10_MINUS) AS price_traffic10
                             ,SUM(C.price_traffic9 + C.price_traffic9_PLUS - C.price_traffic9_MINUS) AS price_traffic9
                             ,SUM(C.price_traffic8 + C.price_traffic8_PLUS - C.price_traffic8_MINUS) AS price_traffic8
                             ,SUM(C.price_traffic7 + C.price_traffic7_PLUS - C.price_traffic7_MINUS) AS price_traffic7
                             ,SUM(C.price_traffic6 + C.price_traffic6_PLUS - C.price_traffic6_MINUS) AS price_traffic6
                             ,SUM(C.price_traffic5 + C.price_traffic5_PLUS - C.price_traffic5_MINUS) AS price_traffic5
                             ,SUM(C.price_traffic4 + C.price_traffic4_PLUS - C.price_traffic4_MINUS) AS price_traffic4
                             ,SUM(C.price_traffic3 + C.price_traffic3_PLUS - C.price_traffic3_MINUS) AS price_traffic3
                             ,SUM(C.price_traffic2 + C.price_traffic2_PLUS - C.price_traffic2_MINUS) AS price_traffic2
                             ,SUM(C.price_traffic + C.price_traffic_PLUS - C.price_traffic_MINUS) AS price_traffic
                        FROM  (
							  SELECT  0 AS TEAM_ID
							  		 ,0 AS USER_NO
							  		 
		                             ,0 AS price_traffic12
		                             ,0 AS price_traffic11
		                             ,0 AS price_traffic10
		                             ,0 AS price_traffic9
		                             ,0 AS price_traffic8
		                             ,0 AS price_traffic7
		                             ,0 AS price_traffic6
		                             ,0 AS price_traffic5
		                             ,0 AS price_traffic4
		                             ,0 AS price_traffic3
		                             ,0 AS price_traffic2
		                             ,0 AS price_traffic
							  		 
		                             ,0 AS price_traffic12_PLUS
		                             ,0 AS price_traffic11_PLUS
		                             ,0 AS price_traffic10_PLUS
		                             ,0 AS price_traffic9_PLUS
		                             ,0 AS price_traffic8_PLUS
		                             ,0 AS price_traffic7_PLUS
		                             ,0 AS price_traffic6_PLUS
		                             ,0 AS price_traffic5_PLUS
		                             ,0 AS price_traffic4_PLUS
		                             ,0 AS price_traffic3_PLUS
		                             ,0 AS price_traffic2_PLUS
		                             ,0 AS price_traffic_PLUS

		                             ,0 AS price_traffic12_MINUS
		                             ,0 AS price_traffic11_MINUS
		                             ,0 AS price_traffic10_MINUS
		                             ,0 AS price_traffic9_MINUS
		                             ,0 AS price_traffic8_MINUS
		                             ,0 AS price_traffic7_MINUS
		                             ,0 AS price_traffic6_MINUS
		                             ,0 AS price_traffic5_MINUS
		                             ,0 AS price_traffic4_MINUS
		                             ,0 AS price_traffic3_MINUS
		                             ,0 AS price_traffic2_MINUS
		                             ,0 AS price_traffic_MINUS		                             		                             
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN( 3, 4 )
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
							</if>
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TRAFFIC) ELSE 0 END AS price_traffic
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_TRAFFIC) ELSE 0 END AS price_traffic_MINUS
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID	
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.team_id  
                     ) GB
            ON  GA.TEAM_ID = GB.TEAM_ID  
         WHERE  1=1
           AND  GA.TEAM_TYPE = 4
           AND  GA.TEAM_STATISTICS1 = 0 
         ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC 			  
	</select>


	<!-- 보험사별 종결현황 - 팀 - 자문료+기타 - 1종 -->
	<select id="MisEndPtnrTmQr1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.team_id
              ,getTopTmBscCenterName(GA.team_id) center_name		
			  ,GA.team_name
              ,GA.team_type
              ,getTopPtnrBscPtnrNick(#{ptnr_id}) ptnr_nick              			  
			  ,GB.price_qr12, GB.price_qr11, GB.price_qr10, GB.price_qr9, GB.price_qr8, GB.price_qr7
			  ,GB.price_qr6, GB.price_qr5, GB.price_qr4, GB.price_qr3, GB.price_qr2, GB.price_qr
          FROM  top_tm_bsc GA
          LEFT  JOIN (
                      SELECT  C.TEAM_ID
                             ,SUM(C.price_qr12 + C.price_qr12_PLUS - C.price_qr12_MINUS) AS price_qr12
                             ,SUM(C.price_qr11 + C.price_qr11_PLUS - C.price_qr11_MINUS) AS price_qr11
                             ,SUM(C.price_qr10 + C.price_qr10_PLUS - C.price_qr10_MINUS) AS price_qr10
                             ,SUM(C.price_qr9 + C.price_qr9_PLUS - C.price_qr9_MINUS) AS price_qr9
                             ,SUM(C.price_qr8 + C.price_qr8_PLUS - C.price_qr8_MINUS) AS price_qr8
                             ,SUM(C.price_qr7 + C.price_qr7_PLUS - C.price_qr7_MINUS) AS price_qr7
                             ,SUM(C.price_qr6 + C.price_qr6_PLUS - C.price_qr6_MINUS) AS price_qr6
                             ,SUM(C.price_qr5 + C.price_qr5_PLUS - C.price_qr5_MINUS) AS price_qr5
                             ,SUM(C.price_qr4 + C.price_qr4_PLUS - C.price_qr4_MINUS) AS price_qr4
                             ,SUM(C.price_qr3 + C.price_qr3_PLUS - C.price_qr3_MINUS) AS price_qr3
                             ,SUM(C.price_qr2 + C.price_qr2_PLUS - C.price_qr2_MINUS) AS price_qr2
                             ,SUM(C.price_qr + C.price_qr_PLUS - C.price_qr_MINUS) AS price_qr
                        FROM  (
							  SELECT  0 AS TEAM_ID
							  		 ,0 AS USER_NO
							  		 
		                             ,0 AS price_qr12
		                             ,0 AS price_qr11
		                             ,0 AS price_qr10
		                             ,0 AS price_qr9
		                             ,0 AS price_qr8
		                             ,0 AS price_qr7
		                             ,0 AS price_qr6
		                             ,0 AS price_qr5
		                             ,0 AS price_qr4
		                             ,0 AS price_qr3
		                             ,0 AS price_qr2
		                             ,0 AS price_qr
							  		 
		                             ,0 AS price_qr12_PLUS
		                             ,0 AS price_qr11_PLUS
		                             ,0 AS price_qr10_PLUS
		                             ,0 AS price_qr9_PLUS
		                             ,0 AS price_qr8_PLUS
		                             ,0 AS price_qr7_PLUS
		                             ,0 AS price_qr6_PLUS
		                             ,0 AS price_qr5_PLUS
		                             ,0 AS price_qr4_PLUS
		                             ,0 AS price_qr3_PLUS
		                             ,0 AS price_qr2_PLUS
		                             ,0 AS price_qr_PLUS

		                             ,0 AS price_qr12_MINUS
		                             ,0 AS price_qr11_MINUS
		                             ,0 AS price_qr10_MINUS
		                             ,0 AS price_qr9_MINUS
		                             ,0 AS price_qr8_MINUS
		                             ,0 AS price_qr7_MINUS
		                             ,0 AS price_qr6_MINUS
		                             ,0 AS price_qr5_MINUS
		                             ,0 AS price_qr4_MINUS
		                             ,0 AS price_qr3_MINUS
		                             ,0 AS price_qr2_MINUS
		                             ,0 AS price_qr_MINUS		                             		                             
		                             
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 NOT IN( 3, 4 )
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_COUNSEL  + B.AMT_ETC) ELSE 0 END AS price_qr9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr_MINUS
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID	
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.team_id  
                     ) GB
            ON  GA.TEAM_ID = GB.TEAM_ID  
         WHERE  1=1
           <!-- AND  GA.TEAM_TYPE = 1 -->
           AND  GA.TEAM_TYPE IN (0,1)
           AND  GA.TEAM_STATISTICS1 = 0 
         ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC 			  
	</select>

	<!-- 보험사별 종결현황 - 팀 - 자문료+기타 - 4종 -->
	<select id="MisEndPtnrTmQr4" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.team_id
              ,getTopTmBscCenterName(GA.team_id) center_name		
			  ,GA.team_name
              ,GA.team_type			  
              ,getTopPtnrBscPtnrNick(#{ptnr_id}) ptnr_nick              
			  ,GB.price_qr12, GB.price_qr11, GB.price_qr10, GB.price_qr9, GB.price_qr8, GB.price_qr7
			  ,GB.price_qr6, GB.price_qr5, GB.price_qr4, GB.price_qr3, GB.price_qr2, GB.price_qr
          FROM  top_tm_bsc GA
          LEFT  JOIN (
                      SELECT  C.TEAM_ID
                             ,SUM(C.price_qr12 + C.price_qr12_PLUS - C.price_qr12_MINUS) AS price_qr12
                             ,SUM(C.price_qr11 + C.price_qr11_PLUS - C.price_qr11_MINUS) AS price_qr11
                             ,SUM(C.price_qr10 + C.price_qr10_PLUS - C.price_qr10_MINUS) AS price_qr10
                             ,SUM(C.price_qr9 + C.price_qr9_PLUS - C.price_qr9_MINUS) AS price_qr9
                             ,SUM(C.price_qr8 + C.price_qr8_PLUS - C.price_qr8_MINUS) AS price_qr8
                             ,SUM(C.price_qr7 + C.price_qr7_PLUS - C.price_qr7_MINUS) AS price_qr7
                             ,SUM(C.price_qr6 + C.price_qr6_PLUS - C.price_qr6_MINUS) AS price_qr6
                             ,SUM(C.price_qr5 + C.price_qr5_PLUS - C.price_qr5_MINUS) AS price_qr5
                             ,SUM(C.price_qr4 + C.price_qr4_PLUS - C.price_qr4_MINUS) AS price_qr4
                             ,SUM(C.price_qr3 + C.price_qr3_PLUS - C.price_qr3_MINUS) AS price_qr3
                             ,SUM(C.price_qr2 + C.price_qr2_PLUS - C.price_qr2_MINUS) AS price_qr2
                             ,SUM(C.price_qr + C.price_qr_PLUS - C.price_qr_MINUS) AS price_qr
                        FROM  (
							  SELECT  0 AS TEAM_ID
							  		 ,0 AS USER_NO
							  		 
		                             ,0 AS price_qr12
		                             ,0 AS price_qr11
		                             ,0 AS price_qr10
		                             ,0 AS price_qr9
		                             ,0 AS price_qr8
		                             ,0 AS price_qr7
		                             ,0 AS price_qr6
		                             ,0 AS price_qr5
		                             ,0 AS price_qr4
		                             ,0 AS price_qr3
		                             ,0 AS price_qr2
		                             ,0 AS price_qr
							  		 
		                             ,0 AS price_qr12_PLUS
		                             ,0 AS price_qr11_PLUS
		                             ,0 AS price_qr10_PLUS
		                             ,0 AS price_qr9_PLUS
		                             ,0 AS price_qr8_PLUS
		                             ,0 AS price_qr7_PLUS
		                             ,0 AS price_qr6_PLUS
		                             ,0 AS price_qr5_PLUS
		                             ,0 AS price_qr4_PLUS
		                             ,0 AS price_qr3_PLUS
		                             ,0 AS price_qr2_PLUS
		                             ,0 AS price_qr_PLUS

		                             ,0 AS price_qr12_MINUS
		                             ,0 AS price_qr11_MINUS
		                             ,0 AS price_qr10_MINUS
		                             ,0 AS price_qr9_MINUS
		                             ,0 AS price_qr8_MINUS
		                             ,0 AS price_qr7_MINUS
		                             ,0 AS price_qr6_MINUS
		                             ,0 AS price_qr5_MINUS
		                             ,0 AS price_qr4_MINUS
		                             ,0 AS price_qr3_MINUS
		                             ,0 AS price_qr2_MINUS
		                             ,0 AS price_qr_MINUS		                             		                             
		                             
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN( 3, 4 )
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_COUNSEL  + B.AMT_ETC) ELSE 0 END AS price_qr9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_COUNSEL + B.AMT_ETC) ELSE 0 END AS price_qr
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_COUNSEL + B.SHARE_AMT_ETC) ELSE 0 END AS price_qr_MINUS
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID	
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.team_id  
                     ) GB
            ON  GA.TEAM_ID = GB.TEAM_ID  
         WHERE  1=1
           AND  GA.TEAM_TYPE = 4
           AND  GA.TEAM_STATISTICS1 = 0 
         ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC 			  
	</select>

	<!-- 보험사별 종결현황 - 팀 - 합계 - 1종 -->
	<select id="MisEndPtnrTmTotal1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.team_id
              ,getTopTmBscCenterName(GA.team_id) center_name		
			  ,GA.team_name
              ,GA.team_type			  
              ,getTopPtnrBscPtnrNick(#{ptnr_id}) ptnr_nick              
			  ,GB.price_total12, GB.price_total11, GB.price_total10, GB.price_total9, GB.price_total8, GB.price_total7
			  ,GB.price_total6, GB.price_total5, GB.price_total4, GB.price_total3, GB.price_total2, GB.price_total
          FROM  top_tm_bsc GA
          LEFT  JOIN (
                      SELECT  C.TEAM_ID
                             ,SUM(C.price_total12 + C.price_total12_PLUS - C.price_total12_MINUS) AS price_total12
                             ,SUM(C.price_total11 + C.price_total11_PLUS - C.price_total11_MINUS) AS price_total11
                             ,SUM(C.price_total10 + C.price_total10_PLUS - C.price_total10_MINUS) AS price_total10
                             ,SUM(C.price_total9 + C.price_total9_PLUS - C.price_total9_MINUS) AS price_total9
                             ,SUM(C.price_total8 + C.price_total8_PLUS - C.price_total8_MINUS) AS price_total8
                             ,SUM(C.price_total7 + C.price_total7_PLUS - C.price_total7_MINUS) AS price_total7
                             ,SUM(C.price_total6 + C.price_total6_PLUS - C.price_total6_MINUS) AS price_total6
                             ,SUM(C.price_total5 + C.price_total5_PLUS - C.price_total5_MINUS) AS price_total5
                             ,SUM(C.price_total4 + C.price_total4_PLUS - C.price_total4_MINUS) AS price_total4
                             ,SUM(C.price_total3 + C.price_total3_PLUS - C.price_total3_MINUS) AS price_total3
                             ,SUM(C.price_total2 + C.price_total2_PLUS - C.price_total2_MINUS) AS price_total2
                             ,SUM(C.price_total + C.price_total_PLUS - C.price_total_MINUS) AS price_total
                        FROM  (
							  SELECT  0 AS TEAM_ID
							  		 ,0 AS USER_NO
							  		 
		                             ,0 AS price_total12
		                             ,0 AS price_total11
		                             ,0 AS price_total10
		                             ,0 AS price_total9
		                             ,0 AS price_total8
		                             ,0 AS price_total7
		                             ,0 AS price_total6
		                             ,0 AS price_total5
		                             ,0 AS price_total4
		                             ,0 AS price_total3
		                             ,0 AS price_total2
		                             ,0 AS price_total
							  		 
		                             ,0 AS price_total12_PLUS
		                             ,0 AS price_total11_PLUS
		                             ,0 AS price_total10_PLUS
		                             ,0 AS price_total9_PLUS
		                             ,0 AS price_total8_PLUS
		                             ,0 AS price_total7_PLUS
		                             ,0 AS price_total6_PLUS
		                             ,0 AS price_total5_PLUS
		                             ,0 AS price_total4_PLUS
		                             ,0 AS price_total3_PLUS
		                             ,0 AS price_total2_PLUS
		                             ,0 AS price_total_PLUS

		                             ,0 AS price_total12_MINUS
		                             ,0 AS price_total11_MINUS
		                             ,0 AS price_total10_MINUS
		                             ,0 AS price_total9_MINUS
		                             ,0 AS price_total8_MINUS
		                             ,0 AS price_total7_MINUS
		                             ,0 AS price_total6_MINUS
		                             ,0 AS price_total5_MINUS
		                             ,0 AS price_total4_MINUS
		                             ,0 AS price_total3_MINUS
		                             ,0 AS price_total2_MINUS
		                             ,0 AS price_total_MINUS		                             		                             
		                             
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 NOT IN( 3, 4 )
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total12_PLUS                                     
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_TYPE1 NOT IN(3, 4)						            
					             AND  A.SUIM_RPT_STATE != 3
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total12_MINUS                                     
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM( IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC + getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE) + IFNULL(B.WRITTEN_BASIC,0) + (IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) + B.COLLABO_TRAFFIC ) ELSE 0 END AS price_total_MINUS
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
					             AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
					             AND  A.SUIM_RPT_TYPE1 NOT IN(3, 4)						            
					             AND  A.SUIM_RPT_STATE != 3
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID			                               
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total_MINUS
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			            
					             AND  A.PTNR_ID = #{ptnr_id}  
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID	
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.team_id  
                     ) GB
            ON  GA.TEAM_ID = GB.TEAM_ID  
         WHERE  1=1
           <!-- AND  GA.TEAM_TYPE = 1 -->
           AND  GA.TEAM_TYPE IN (0,1)
           AND  GA.TEAM_STATISTICS1 = 0 
         ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC 			  
	</select>

<!-- 보험사별 종결현황 - 팀 - 합계 - 4종 -->
	<select id="MisEndPtnrTmTotal4" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisEndTmVO">
		SELECT GA.team_id
              ,getTopTmBscCenterName(GA.team_id) center_name		
			  ,GA.team_name
              ,GA.team_type
              ,getTopPtnrBscPtnrNick(#{ptnr_id}) ptnr_nick              			  
			  ,GB.price_total12, GB.price_total11, GB.price_total10, GB.price_total9, GB.price_total8, GB.price_total7
			  ,GB.price_total6, GB.price_total5, GB.price_total4, GB.price_total3, GB.price_total2, GB.price_total
          FROM  top_tm_bsc GA
          LEFT  JOIN (
                      SELECT  C.TEAM_ID
                             ,SUM(C.price_total12 + C.price_total12_PLUS - C.price_total12_MINUS) AS price_total12
                             ,SUM(C.price_total11 + C.price_total11_PLUS - C.price_total11_MINUS) AS price_total11
                             ,SUM(C.price_total10 + C.price_total10_PLUS - C.price_total10_MINUS) AS price_total10
                             ,SUM(C.price_total9 + C.price_total9_PLUS - C.price_total9_MINUS) AS price_total9
                             ,SUM(C.price_total8 + C.price_total8_PLUS - C.price_total8_MINUS) AS price_total8
                             ,SUM(C.price_total7 + C.price_total7_PLUS - C.price_total7_MINUS) AS price_total7
                             ,SUM(C.price_total6 + C.price_total6_PLUS - C.price_total6_MINUS) AS price_total6
                             ,SUM(C.price_total5 + C.price_total5_PLUS - C.price_total5_MINUS) AS price_total5
                             ,SUM(C.price_total4 + C.price_total4_PLUS - C.price_total4_MINUS) AS price_total4
                             ,SUM(C.price_total3 + C.price_total3_PLUS - C.price_total3_MINUS) AS price_total3
                             ,SUM(C.price_total2 + C.price_total2_PLUS - C.price_total2_MINUS) AS price_total2
                             ,SUM(C.price_total + C.price_total_PLUS - C.price_total_MINUS) AS price_total
                        FROM  (
							  SELECT  0 AS TEAM_ID
							  		 ,0 AS USER_NO
							  		 
		                             ,0 AS price_total12
		                             ,0 AS price_total11
		                             ,0 AS price_total10
		                             ,0 AS price_total9
		                             ,0 AS price_total8
		                             ,0 AS price_total7
		                             ,0 AS price_total6
		                             ,0 AS price_total5
		                             ,0 AS price_total4
		                             ,0 AS price_total3
		                             ,0 AS price_total2
		                             ,0 AS price_total
							  		 
		                             ,0 AS price_total12_PLUS
		                             ,0 AS price_total11_PLUS
		                             ,0 AS price_total10_PLUS
		                             ,0 AS price_total9_PLUS
		                             ,0 AS price_total8_PLUS
		                             ,0 AS price_total7_PLUS
		                             ,0 AS price_total6_PLUS
		                             ,0 AS price_total5_PLUS
		                             ,0 AS price_total4_PLUS
		                             ,0 AS price_total3_PLUS
		                             ,0 AS price_total2_PLUS
		                             ,0 AS price_total_PLUS

		                             ,0 AS price_total12_MINUS
		                             ,0 AS price_total11_MINUS
		                             ,0 AS price_total10_MINUS
		                             ,0 AS price_total9_MINUS
		                             ,0 AS price_total8_MINUS
		                             ,0 AS price_total7_MINUS
		                             ,0 AS price_total6_MINUS
		                             ,0 AS price_total5_MINUS
		                             ,0 AS price_total4_MINUS
		                             ,0 AS price_total3_MINUS
		                             ,0 AS price_total2_MINUS
		                             ,0 AS price_total_MINUS		                             		                             
		                             
		                        FROM  DUAL          			
							<if test='basicYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_invoice B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != '3'
                                 AND  A.SUIM_RPT_TYPE1 IN( 3, 4 )
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_TYPE1 IN(3, 4)						            
					             AND  A.SUIM_RPT_STATE != 3
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.COLLABO_PP) ELSE 0 END AS price_total_MINUS
                                FROM  top_rpt_head A 
                               INNER  JOIN top_rpt_collabo B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               INNER  JOIN top_rpt_invoice C
                                  ON  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_TYPE1 IN(3, 4)						            
					             AND  A.SUIM_RPT_STATE != 3
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID	                               
							</if>
							
                            <if test='primYN == "Y"'>
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total12
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total11
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total10
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total9
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total8
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total7
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total6
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total5
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total4
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total3
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total2
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.AMT_TOTAL) ELSE 0 END AS price_total
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
                                 AND  A.SUIM_RPT_STATE != 3
                                 AND  A.SUIM_RPT_TYPE1 = 5
                                 AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
                               GROUP BY A.SUIM_RPT_NO, A.TEAM_ID
		          			   UNION ALL                        
                              SELECT  B.SHARE_TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total12_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total11_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total10_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total9_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total8_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total7_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total6_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total5_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total4_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total3_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total2_PLUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total_PLUS
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			            
					             AND  B.SHARE_TEAM_ID IS NOT NULL
					             AND  A.PTNR_ID = #{ptnr_id}  
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, B.SHARE_TEAM_ID		
		          			   UNION ALL                        
                              SELECT  A.TEAM_ID 
                                     ,A.USER_NO
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,0,0,0,0,0,0,0,0,0,0,0,0
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore11}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total12_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore11}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore10}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total11_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore10}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore9}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total10_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore9}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore8}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total9_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore8}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore7}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total8_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore7}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore6}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total7_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore6}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore5}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total6_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore5}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore4}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total5_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore4}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore3}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total4_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore3}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore2}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total3_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore2}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore1}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total2_MINUS
                                     ,CASE WHEN A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore1}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0}) THEN SUM(B.SHARE_AMT_TOTAL) ELSE 0 END AS price_total_MINUS
                                FROM  top_prim_biz_rpt_head A 
                               INNER  JOIN top_prim_biz_inv_share B
                                  ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                               WHERE  1=1
					             AND  A.SUIM_RPT_STATE != 3
					             AND  A.SUIM_RPT_TYPE1 = 5			            
					             AND  A.PTNR_ID = #{ptnr_id}  
					             AND  B.SHARE_TEAM_ID IS NOT NULL
                                 AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{monBefore12})
                                 AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{monBefore0})
					           GROUP BY A.SUIM_RPT_NO, A.TEAM_ID	
							</if>
                               ) C
                       WHERE  1=1
                      GROUP BY C.team_id  
                     ) GB
            ON  GA.TEAM_ID = GB.TEAM_ID  
         WHERE  1=1
           AND  GA.TEAM_TYPE = 4
           AND  GA.TEAM_STATISTICS1 = 0 
         ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC 			  
	</select>

</mapper>
