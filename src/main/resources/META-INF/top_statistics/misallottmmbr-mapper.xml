<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="MisAllotTmMbrMapper">

	<select id="selectMisAllotCenterList" parameterType="hashMap" resultType="AsraMap">
		SELECT
			GB.team_id
			,GB.ptnr_id_sub
			,GB.center_name
			,GB.ptnr_id_sub_name
			,GB.team_center
			,GB.team_group_order
			,GB.team_order
			,Tmp.row_cnt				
			,GB.REG01 ,GB.REG02, GB.REG03, GB.REG04, GB.REG05, GB.REG06, GB.REG07, GB.REG08, GB.REG09, GB.REG10 
			,GB.REG11 ,GB.REG12, GB.REG13, GB.REG14, GB.REG15, GB.REG16, GB.REG17, GB.REG18, GB.REG19, GB.REG20
			,GB.REG21 ,GB.REG22, GB.REG23, GB.REG24, GB.REG25, GB.REG26, GB.REG27, GB.REG28, GB.REG29, GB.REG30
			
			,GB.END01 ,GB.END02, GB.END03, GB.END04, GB.END05, GB.END06, GB.END07, GB.END08, GB.END09, GB.END10 
			,GB.END11 ,GB.END12, GB.END13, GB.END14, GB.END15, GB.END16, GB.END17, GB.END18, GB.END19, GB.END20
			,GB.END21 ,GB.END22, GB.END23, GB.END24, GB.END25, GB.END26, GB.END27, GB.END28, GB.END29, GB.END30
			
			,GB.regYearSum
			,GB.endYearSum
			,GB.endMonthSum	
			,GB.regMiSum
			
		FROM
		(
			SELECT
				GA.team_id
				,GA.ptnr_id_sub
				,(SELECT col_val FROM sysadm_codedic WHERE tbl_nm = 'top_tm_bsc' AND col_nm = 'team_center' AND col_cd = GA.team_center) AS center_name	
				,(SELECT col_val FROM sysadm_codedic2 WHERE tbl_nm = 'top_rpt_head' AND col_nm = 'ptnr_id_sub' AND col_cd1 = GA.ptnr_id AND col_cd2 = GA.ptnr_id_sub) AS ptnr_id_sub_name
				,GA.team_center
				,GA.team_group_order
				,GA.team_order
				,SUM(GA.REG01) AS REG01 ,SUM(GA.REG02) AS REG02 ,SUM(GA.REG03) AS REG03 ,SUM(GA.REG04) AS REG04 ,SUM(GA.REG05) AS REG05
				,SUM(GA.REG06) AS REG06 ,SUM(GA.REG07) AS REG07 ,SUM(GA.REG08) AS REG08 ,SUM(GA.REG09) AS REG09 ,SUM(GA.REG10) AS REG10
				,SUM(GA.REG11) AS REG11 ,SUM(GA.REG12) AS REG12 ,SUM(GA.REG13) AS REG13 ,SUM(GA.REG14) AS REG14 ,SUM(GA.REG15) AS REG15
				,SUM(GA.REG16) AS REG16 ,SUM(GA.REG17) AS REG17 ,SUM(GA.REG18) AS REG18 ,SUM(GA.REG19) AS REG19 ,SUM(GA.REG20) AS REG20
				,SUM(GA.REG21) AS REG21 ,SUM(GA.REG22) AS REG22 ,SUM(GA.REG23) AS REG23 ,SUM(GA.REG24) AS REG24 ,SUM(GA.REG25) AS REG25
				,SUM(GA.REG26) AS REG26 ,SUM(GA.REG27) AS REG27 ,SUM(GA.REG28) AS REG28 ,SUM(GA.REG29) AS REG29 ,SUM(GA.REG30) AS REG30
				
				,SUM(GA.END01) AS END01 ,SUM(GA.END02) AS END02 ,SUM(GA.END03) AS END03 ,SUM(GA.END04) AS END04 ,SUM(GA.END05) AS END05
				,SUM(GA.END06) AS END06 ,SUM(GA.END07) AS END07 ,SUM(GA.END08) AS END08 ,SUM(GA.END09) AS END09 ,SUM(GA.END10) AS END10
				,SUM(GA.END11) AS END11 ,SUM(GA.END12) AS END12 ,SUM(GA.END13) AS END13 ,SUM(GA.END14) AS END14 ,SUM(GA.END15) AS END15
				,SUM(GA.END16) AS END16 ,SUM(GA.END17) AS END17 ,SUM(GA.END18) AS END18 ,SUM(GA.END19) AS END19 ,SUM(GA.END20) AS END20
				,SUM(GA.END21) AS END21 ,SUM(GA.END22) AS END22 ,SUM(GA.END23) AS END23 ,SUM(GA.END24) AS END24 ,SUM(GA.END25) AS END25
				,SUM(GA.END26) AS END26 ,SUM(GA.END27) AS END27 ,SUM(GA.END28) AS END28 ,SUM(GA.END29) AS END29 ,SUM(GA.END30) AS END30
				
				,SUM(GA.regYearSum) AS regYearSum
				,SUM(GA.endYearSum) AS endYearSum
				,SUM(GA.endMonthSum) AS endMonthSum
				,SUM(GA.regMiSum) AS regMiSum				
			FROM(
				SELECT 
					a.ptnr_id
					,a.ptnr_id_sub	
					,a.team_id
					,b.team_name
					,b.team_center
					,b.team_group_order
					,b.team_order
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG01
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG02
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG03
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG04
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG05
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG06
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG07
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG08
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG09
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG10
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG11
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG12
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG13
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG14
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG15
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG16
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG17
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG18
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG19
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG20
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG21
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG22
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG23
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG24
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG25
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG26
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG27
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG28
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG29
					,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG30
					
					,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
					,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
					,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
					
					,0 AS regYearSum
					,0 AS endYearSum
					,0 AS endMonthSum
					,0 AS regMiSum					
				FROM top_rpt_head a, top_tm_bsc b
				WHERE 1=1
				AND a.team_id = b.team_id
				AND a.ptnr_id = #{ptnr_id}
				AND a.suim_rpt_state != 3
				AND b.team_type != 4
				AND a.reg_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
				AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
				AND b.team_center NOT IN (999, 51, 52, 101, 102, 103)
				
				UNION ALL
				
				SELECT 
					a.ptnr_id
					,a.ptnr_id_sub	
					,a.team_id
					,b.team_name
					,b.team_center
					,b.team_group_order
					,b.team_order
					,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
					,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
					,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
					
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END01
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END02
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END03
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END04
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END05
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END06
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END07
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END08
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END09
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END10
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END11
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END12
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END13
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END14
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END15
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END16
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END17
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END18
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END19
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END20
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END21
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END22
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END23
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END24
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END25
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END26
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END27
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END28
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END29
					,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END30
					
					,0 AS regYearSum
					,0 AS endYearSum
					,0 AS endMonthSum
					,0 AS regMiSum					
				FROM top_rpt_head a, top_tm_bsc b
				WHERE 1=1
				AND a.team_id = b.team_id
				AND a.ptnr_id = #{ptnr_id}
				AND a.suim_rpt_state = 2
				AND b.team_type != 4
				AND a.close_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
				AND a.close_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
				AND b.team_center NOT IN (999, 51, 52, 101, 102, 103)
				
				UNION ALL
				
				SELECT 
					a.ptnr_id
					,a.ptnr_id_sub	
					,a.team_id
					,b.team_name
					,b.team_center
					,b.team_group_order
					,b.team_order
					,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
					,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
					,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
					
					,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
					,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
					,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
					
					,COUNT(a.suim_rpt_no) AS regYearSum
					,0 AS endYearSum
					,0 AS endMonthSum
					,0 AS regMiSum					
				FROM top_rpt_head a, top_tm_bsc b
				WHERE 1=1
				AND a.team_id = b.team_id
				AND a.ptnr_id = #{ptnr_id}
				AND a.suim_rpt_state != 3
				AND b.team_type != 4
				AND a.reg_date >= UNIX_TIMESTAMP(#{bgnYearDe})
				AND a.reg_date &lt; UNIX_TIMESTAMP(#{endYearDe})				
				AND b.team_center NOT IN (999, 51, 52, 101, 102, 103)
				GROUP BY a.ptnr_id_sub, b.team_center
				
				UNION ALL
				
				SELECT 
					a.ptnr_id
					,a.ptnr_id_sub	
					,a.team_id
					,b.team_name
					,b.team_center
					,b.team_group_order
					,b.team_order
					,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
					,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
					,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
					
					,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
					,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
					,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
					
					,0 AS regYearSum
					,COUNT(a.suim_rpt_no) AS endYearSum
					,0 AS endMonthSum
					,0 AS regMiSum					
				FROM top_rpt_head a, top_tm_bsc b
				WHERE 1=1
				AND a.team_id = b.team_id
				AND a.ptnr_id = #{ptnr_id}
				AND a.suim_rpt_state = 2
				AND b.team_type != 4
				AND a.close_date >= UNIX_TIMESTAMP(#{bgnYearDe})
				AND a.close_date &lt; UNIX_TIMESTAMP(#{endYearDe})
				AND b.team_center NOT IN (999, 51, 52, 101, 102, 103)
				GROUP BY a.ptnr_id_sub, b.team_center
				
				UNION ALL
				
				SELECT 
					a.ptnr_id
					,a.ptnr_id_sub	
					,a.team_id
					,b.team_name
					,b.team_center
					,b.team_group_order
					,b.team_order
					,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
					,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
					,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
					
					,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
					,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
					,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
					
					,0 AS regYearSum
					,0 AS endYearSum
					,COUNT(a.suim_rpt_no) AS endMonthSum
					,0 AS regMiSum					
				FROM top_rpt_head a, top_tm_bsc b
				WHERE 1=1
				AND a.team_id = b.team_id
				AND a.ptnr_id = #{ptnr_id}
				AND a.suim_rpt_state = 2
				AND b.team_type != 4
				AND a.close_date >= UNIX_TIMESTAMP(#{sMonthSdate})
				AND a.close_date &lt;= UNIX_TIMESTAMP(#{sMonthEdate})
				AND b.team_center NOT IN (999, 51, 52, 101, 102, 103)
				GROUP BY a.ptnr_id_sub, b.team_center
				
				UNION ALL
				
				SELECT 
					a.ptnr_id
					,a.ptnr_id_sub	
					,a.team_id
					,b.team_name
					,b.team_center
					,b.team_group_order
					,b.team_order
					,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
					,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
					,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
					
					,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
					,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
					,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
					
					,0 AS regYearSum
					,0 AS endYearSum
					,0 AS endMonthSum
					,COUNT(a.suim_rpt_no) AS regMiSum					
				FROM top_rpt_head a, top_tm_bsc b
				WHERE 1=1
				AND a.team_id = b.team_id
				AND a.ptnr_id = #{ptnr_id}
				AND a.suim_rpt_state in (0,1,11)
				AND b.team_type != 4
				AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
				AND b.team_center NOT IN (999, 51, 52, 101, 102, 103)
				GROUP BY a.ptnr_id_sub, b.team_center
				
			)GA
			WHERE 1=1
			GROUP BY GA.team_center, GA.ptnr_id_sub
			ORDER BY GA.ptnr_id_sub, GA.team_group_order DESC, GA.team_order DESC
		)GB
		
		LEFT JOIN
		
		(
			SELECT
				GC.ptnr_id_sub	
				,COUNT(*) AS row_cnt
			FROM 
			(
				SELECT	
					a.ptnr_id_sub
					,b.team_center	
				FROM top_rpt_head a, top_tm_bsc b
				WHERE 1=1
				AND a.team_id = b.team_id
				AND a.ptnr_id = #{ptnr_id}
				<!-- AND a.suim_rpt_state != 3 -->
				AND a.suim_rpt_state in (0,1,11)
				AND b.team_type != 4
				<!-- AND a.reg_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d')) -->
				AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
				AND b.team_center NOT IN (999, 51, 52, 101, 102, 103)
				GROUP BY a.ptnr_id_sub, b.team_center
			)GC			
			GROUP BY GC.ptnr_id_sub			
		)Tmp
		
		ON GB.ptnr_id_sub = Tmp.ptnr_id_sub
	</select>

	<select id="selectMisAllotTeamList" parameterType="hashMap" resultType="AsraMap">
		SELECT
			GA.team_id
			,GA.ptnr_id_sub
			,GA.team_name
			,GA.team_center
			,GA.team_group_order
			,GA.team_order
			,SUM(GA.REG01) AS REG01 ,SUM(GA.REG02) AS REG02 ,SUM(GA.REG03) AS REG03 ,SUM(GA.REG04) AS REG04 ,SUM(GA.REG05) AS REG05
			,SUM(GA.REG06) AS REG06 ,SUM(GA.REG07) AS REG07 ,SUM(GA.REG08) AS REG08 ,SUM(GA.REG09) AS REG09 ,SUM(GA.REG10) AS REG10
			,SUM(GA.REG11) AS REG11 ,SUM(GA.REG12) AS REG12 ,SUM(GA.REG13) AS REG13 ,SUM(GA.REG14) AS REG14 ,SUM(GA.REG15) AS REG15
			,SUM(GA.REG16) AS REG16 ,SUM(GA.REG17) AS REG17 ,SUM(GA.REG18) AS REG18 ,SUM(GA.REG19) AS REG19 ,SUM(GA.REG20) AS REG20
			,SUM(GA.REG21) AS REG21 ,SUM(GA.REG22) AS REG22 ,SUM(GA.REG23) AS REG23 ,SUM(GA.REG24) AS REG24 ,SUM(GA.REG25) AS REG25
			,SUM(GA.REG26) AS REG26 ,SUM(GA.REG27) AS REG27 ,SUM(GA.REG28) AS REG28 ,SUM(GA.REG29) AS REG29 ,SUM(GA.REG30) AS REG30
		FROM(
			SELECT 
				a.ptnr_id
				,a.ptnr_id_sub	
				,a.team_id
				,b.team_name
				,b.team_center
				,b.team_group_order
				,b.team_order
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG01
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG02
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG03
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG04
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG05
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG06
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG07
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG08
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG09
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG10
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG11
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG12
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG13
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG14
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG15
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG16
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG17
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG18
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG19
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG20
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG21
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG22
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG23
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG24
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG25
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG26
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG27
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG28
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG29
				,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG30
			FROM top_rpt_head a, top_tm_bsc b
			WHERE 1=1
			AND a.team_id = b.team_id
			AND a.ptnr_id = #{ptnr_id}
			AND a.suim_rpt_state != 3
			AND b.team_type != 4
			AND a.reg_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
			AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
		)GA
		GROUP BY GA.team_id, GA.ptnr_id_sub
		ORDER BY GA.ptnr_id_sub, GA.team_group_order DESC, GA.team_order DESC
	</select>
	
	<select id="selectMisAllotPtnrListByCenter_20250408" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
				GB.ptnr_nick
				,GB.ptnr_id_sub_name
				,GB.ptnr_id
				,GB.ptnr_id_sub
				,Tmp.row_cnt				
				,GB.REG01 ,GB.REG02, GB.REG03, GB.REG04, GB.REG05, GB.REG06, GB.REG07, GB.REG08, GB.REG09, GB.REG10 
				,GB.REG11 ,GB.REG12, GB.REG13, GB.REG14, GB.REG15, GB.REG16, GB.REG17, GB.REG18, GB.REG19, GB.REG20
				,GB.REG21 ,GB.REG22, GB.REG23, GB.REG24, GB.REG25, GB.REG26, GB.REG27, GB.REG28, GB.REG29, GB.REG30
				
				,GB.END01 ,GB.END02, GB.END03, GB.END04, GB.END05, GB.END06, GB.END07, GB.END08, GB.END09, GB.END10 
				,GB.END11 ,GB.END12, GB.END13, GB.END14, GB.END15, GB.END16, GB.END17, GB.END18, GB.END19, GB.END20
				,GB.END21 ,GB.END22, GB.END23, GB.END24, GB.END25, GB.END26, GB.END27, GB.END28, GB.END29, GB.END30
				
				,GB.regYearSum
				,GB.endYearSum
				,GB.endMonthSum	
				,GB.regMiSum
		FROM(
			SELECT
				GA.ptnr_nick
				,(SELECT col_val FROM sysadm_codedic2 WHERE tbl_nm = 'top_rpt_head' AND col_nm = 'ptnr_id_sub' AND col_cd1 = GA.ptnr_id AND col_cd2 = GA.ptnr_id_sub) AS ptnr_id_sub_name
				,GA.ptnr_id	
				,GA.ptnr_id_sub		
				,SUM(GA.REG01) AS REG01 ,SUM(GA.REG02) AS REG02 ,SUM(GA.REG03) AS REG03 ,SUM(GA.REG04) AS REG04 ,SUM(GA.REG05) AS REG05
				,SUM(GA.REG06) AS REG06 ,SUM(GA.REG07) AS REG07 ,SUM(GA.REG08) AS REG08 ,SUM(GA.REG09) AS REG09 ,SUM(GA.REG10) AS REG10
				,SUM(GA.REG11) AS REG11 ,SUM(GA.REG12) AS REG12 ,SUM(GA.REG13) AS REG13 ,SUM(GA.REG14) AS REG14 ,SUM(GA.REG15) AS REG15
				,SUM(GA.REG16) AS REG16 ,SUM(GA.REG17) AS REG17 ,SUM(GA.REG18) AS REG18 ,SUM(GA.REG19) AS REG19 ,SUM(GA.REG20) AS REG20
				,SUM(GA.REG21) AS REG21 ,SUM(GA.REG22) AS REG22 ,SUM(GA.REG23) AS REG23 ,SUM(GA.REG24) AS REG24 ,SUM(GA.REG25) AS REG25
				,SUM(GA.REG26) AS REG26 ,SUM(GA.REG27) AS REG27 ,SUM(GA.REG28) AS REG28 ,SUM(GA.REG29) AS REG29 ,SUM(GA.REG30) AS REG30
				
				,SUM(GA.END01) AS END01 ,SUM(GA.END02) AS END02 ,SUM(GA.END03) AS END03 ,SUM(GA.END04) AS END04 ,SUM(GA.END05) AS END05
				,SUM(GA.END06) AS END06 ,SUM(GA.END07) AS END07 ,SUM(GA.END08) AS END08 ,SUM(GA.END09) AS END09 ,SUM(GA.END10) AS END10
				,SUM(GA.END11) AS END11 ,SUM(GA.END12) AS END12 ,SUM(GA.END13) AS END13 ,SUM(GA.END14) AS END14 ,SUM(GA.END15) AS END15
				,SUM(GA.END16) AS END16 ,SUM(GA.END17) AS END17 ,SUM(GA.END18) AS END18 ,SUM(GA.END19) AS END19 ,SUM(GA.END20) AS END20
				,SUM(GA.END21) AS END21 ,SUM(GA.END22) AS END22 ,SUM(GA.END23) AS END23 ,SUM(GA.END24) AS END24 ,SUM(GA.END25) AS END25
				,SUM(GA.END26) AS END26 ,SUM(GA.END27) AS END27 ,SUM(GA.END28) AS END28 ,SUM(GA.END29) AS END29 ,SUM(GA.END30) AS END30
				
				,SUM(GA.regYearSum) AS regYearSum
				,SUM(GA.endYearSum) AS endYearSum
				,SUM(GA.endMonthSum) AS endMonthSum
				,SUM(GA.regMiSum) AS regMiSum
			FROM
				(
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG01
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG02
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG03
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG04
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG05
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG06
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG07
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG08
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG09
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG10
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG11
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG12
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG13
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG14
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG15
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG16
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG17
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG18
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG19
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG20
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG21
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG22
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG23
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG24
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG25
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG26
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG27
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG28
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG29
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG30
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						,0 AS regYearSum
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.team_id = c.team_id
					AND c.team_center = #{team_center}
					AND a.suim_rpt_state != 3
					AND a.suim_rpt_type1 in (1,2,11,12,13,14,15,16,17,18,19)
					AND a.reg_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
					AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					
					UNION ALL

					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END01
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END02
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END03
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END04
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END05
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END06
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END07
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END08
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END09
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END10
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END11
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END12
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END13
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END14
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END15
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END16
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END17
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END18
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END19
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END20
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END21
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END22
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END23
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END24
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END25
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END26
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END27
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END28
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END29
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END30
						,0 AS regYearSum
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.team_id = c.team_id
					AND c.team_center = #{team_center}
					AND a.suim_rpt_state = 2
					AND a.suim_rpt_type1 in (1,2,11,12,13,14,15,16,17,18,19)
					AND a.close_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
					AND a.close_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,COUNT(a.suim_rpt_no) AS regYearSum		
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.team_id = c.team_id
					AND c.team_center = #{team_center}
					AND a.suim_rpt_state != 3
					AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
					AND a.reg_date >= UNIX_TIMESTAMP(#{bgnYearDe})
					AND a.reg_date &lt; UNIX_TIMESTAMP(#{endYearDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub					
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,COUNT(a.suim_rpt_no) AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.team_id = c.team_id
					AND c.team_center = #{team_center}
					AND a.suim_rpt_state = 2
					AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
					AND a.close_date >= UNIX_TIMESTAMP(#{bgnYearDe})
					AND a.close_date &lt; UNIX_TIMESTAMP(#{endYearDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,0 AS endYearSum
						,COUNT(a.suim_rpt_no) AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.team_id = c.team_id
					AND c.team_center = #{team_center}
					AND a.suim_rpt_state = 2
					AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
					AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
					AND a.close_date &lt;= UNIX_TIMESTAMP(#{endDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,0 AS endYearSum
						,0 AS endMonthSum
						,COUNT(a.suim_rpt_no) AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.team_id = c.team_id
					AND c.team_center = #{team_center}		
					AND a.suim_rpt_state in (0,1,11)
					AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)					
					AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					GROUP BY a.ptnr_id, a.ptnr_id_sub
									
				)GA
			GROUP BY GA.ptnr_id, GA.ptnr_id_sub
			ORDER BY GA.statistics_order, GA.ptnr_id_sub
		)GB
				
		LEFT JOIN 

		(
			SELECT
				GC.ptnr_id
				,COUNT(*) AS row_cnt
			FROM
			(
				SELECT 
					a.ptnr_id
					,a.ptnr_id_sub
				FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
				WHERE 1=1
				AND a.ptnr_id = b.ptnr_id
				AND a.team_id = c.team_id
				AND c.team_center = #{team_center}
				AND a.suim_rpt_state != 3				
				AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
				AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)				
				GROUP BY a.ptnr_id, a.ptnr_id_sub
			)GC
			GROUP BY GC.ptnr_id
		) Tmp
		
		ON GB.ptnr_id = Tmp.ptnr_id		
	</select>
	
	<select id="selectMisAllotPtnrListByCenter" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
				GB.ptnr_nick
				,GB.ptnr_id_sub_name
				,GB.ptnr_id
				,GB.ptnr_id_sub
								
				,GB.REG01 ,GB.REG02, GB.REG03, GB.REG04, GB.REG05, GB.REG06, GB.REG07, GB.REG08, GB.REG09, GB.REG10 
				,GB.REG11 ,GB.REG12, GB.REG13, GB.REG14, GB.REG15, GB.REG16, GB.REG17, GB.REG18, GB.REG19, GB.REG20
				,GB.REG21 ,GB.REG22, GB.REG23, GB.REG24, GB.REG25, GB.REG26, GB.REG27, GB.REG28, GB.REG29, GB.REG30
				
				,GB.END01 ,GB.END02, GB.END03, GB.END04, GB.END05, GB.END06, GB.END07, GB.END08, GB.END09, GB.END10 
				,GB.END11 ,GB.END12, GB.END13, GB.END14, GB.END15, GB.END16, GB.END17, GB.END18, GB.END19, GB.END20
				,GB.END21 ,GB.END22, GB.END23, GB.END24, GB.END25, GB.END26, GB.END27, GB.END28, GB.END29, GB.END30
				
				,GB.regYearSum
				,GB.endYearSum
				,GB.endMonthSum	
				,GB.regMiSum
				
				,GF.row_cnt
		FROM(
			SELECT
				GA.ptnr_nick
				,(SELECT col_val FROM sysadm_codedic2 WHERE tbl_nm = 'top_rpt_head' AND col_nm = 'ptnr_id_sub' AND col_cd1 = GA.ptnr_id AND col_cd2 = GA.ptnr_id_sub) AS ptnr_id_sub_name
				,GA.ptnr_id	
				,GA.ptnr_id_sub		
				,SUM(GA.REG01) AS REG01 ,SUM(GA.REG02) AS REG02 ,SUM(GA.REG03) AS REG03 ,SUM(GA.REG04) AS REG04 ,SUM(GA.REG05) AS REG05
				,SUM(GA.REG06) AS REG06 ,SUM(GA.REG07) AS REG07 ,SUM(GA.REG08) AS REG08 ,SUM(GA.REG09) AS REG09 ,SUM(GA.REG10) AS REG10
				,SUM(GA.REG11) AS REG11 ,SUM(GA.REG12) AS REG12 ,SUM(GA.REG13) AS REG13 ,SUM(GA.REG14) AS REG14 ,SUM(GA.REG15) AS REG15
				,SUM(GA.REG16) AS REG16 ,SUM(GA.REG17) AS REG17 ,SUM(GA.REG18) AS REG18 ,SUM(GA.REG19) AS REG19 ,SUM(GA.REG20) AS REG20
				,SUM(GA.REG21) AS REG21 ,SUM(GA.REG22) AS REG22 ,SUM(GA.REG23) AS REG23 ,SUM(GA.REG24) AS REG24 ,SUM(GA.REG25) AS REG25
				,SUM(GA.REG26) AS REG26 ,SUM(GA.REG27) AS REG27 ,SUM(GA.REG28) AS REG28 ,SUM(GA.REG29) AS REG29 ,SUM(GA.REG30) AS REG30
				
				,SUM(GA.END01) AS END01 ,SUM(GA.END02) AS END02 ,SUM(GA.END03) AS END03 ,SUM(GA.END04) AS END04 ,SUM(GA.END05) AS END05
				,SUM(GA.END06) AS END06 ,SUM(GA.END07) AS END07 ,SUM(GA.END08) AS END08 ,SUM(GA.END09) AS END09 ,SUM(GA.END10) AS END10
				,SUM(GA.END11) AS END11 ,SUM(GA.END12) AS END12 ,SUM(GA.END13) AS END13 ,SUM(GA.END14) AS END14 ,SUM(GA.END15) AS END15
				,SUM(GA.END16) AS END16 ,SUM(GA.END17) AS END17 ,SUM(GA.END18) AS END18 ,SUM(GA.END19) AS END19 ,SUM(GA.END20) AS END20
				,SUM(GA.END21) AS END21 ,SUM(GA.END22) AS END22 ,SUM(GA.END23) AS END23 ,SUM(GA.END24) AS END24 ,SUM(GA.END25) AS END25
				,SUM(GA.END26) AS END26 ,SUM(GA.END27) AS END27 ,SUM(GA.END28) AS END28 ,SUM(GA.END29) AS END29 ,SUM(GA.END30) AS END30
				
				,SUM(GA.regYearSum) AS regYearSum
				,SUM(GA.endYearSum) AS endYearSum
				,SUM(GA.endMonthSum) AS endMonthSum
				,SUM(GA.regMiSum) AS regMiSum
			FROM
				(
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG01
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG02
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG03
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG04
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG05
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG06
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG07
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG08
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG09
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG10
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG11
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG12
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG13
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG14
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG15
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG16
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG17
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG18
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG19
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG20
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG21
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG22
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG23
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG24
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG25
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG26
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG27
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG28
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG29
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG30
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						,0 AS regYearSum
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.team_id = c.team_id
					AND c.team_center = #{team_center}
					AND a.suim_rpt_state != 3
					AND a.suim_rpt_type1 in (1,2,11,12,13,14,15,16,17,18,19)
					AND a.reg_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
					AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					
					UNION ALL

					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END01
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END02
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END03
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END04
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END05
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END06
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END07
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END08
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END09
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END10
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END11
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END12
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END13
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END14
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END15
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END16
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END17
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END18
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END19
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END20
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END21
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END22
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END23
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END24
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END25
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END26
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END27
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END28
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END29
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END30
						,0 AS regYearSum
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.team_id = c.team_id
					AND c.team_center = #{team_center}
					AND a.suim_rpt_state = 2
					AND a.suim_rpt_type1 in (1,2,11,12,13,14,15,16,17,18,19)
					AND a.close_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
					AND a.close_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,COUNT(a.suim_rpt_no) AS regYearSum		
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.team_id = c.team_id
					AND c.team_center = #{team_center}
					AND a.suim_rpt_state != 3
					AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
					AND a.reg_date >= UNIX_TIMESTAMP(#{bgnYearDe})
					AND a.reg_date &lt; UNIX_TIMESTAMP(#{endYearDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub					
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,COUNT(a.suim_rpt_no) AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.team_id = c.team_id
					AND c.team_center = #{team_center}
					AND a.suim_rpt_state = 2
					AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
					AND a.close_date >= UNIX_TIMESTAMP(#{bgnYearDe})
					AND a.close_date &lt; UNIX_TIMESTAMP(#{endYearDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,0 AS endYearSum
						,COUNT(a.suim_rpt_no) AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.team_id = c.team_id
					AND c.team_center = #{team_center}
					AND a.suim_rpt_state = 2
					AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
					AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
					AND a.close_date &lt;= UNIX_TIMESTAMP(#{endDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,0 AS endYearSum
						,0 AS endMonthSum
						,COUNT(a.suim_rpt_no) AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.team_id = c.team_id
					AND c.team_center = #{team_center}		
					AND a.suim_rpt_state in (0,1,11)
					AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)					
					AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					GROUP BY a.ptnr_id, a.ptnr_id_sub
									
				)GA
			GROUP BY GA.ptnr_id, GA.ptnr_id_sub
			ORDER BY GA.statistics_order, GA.ptnr_id_sub
		)GB
				
		LEFT JOIN 

		(
			SELECT
				GD.ptnr_id
				,COUNT(GD.ptnr_id) AS row_cnt		
			FROM
			(
				SELECT				
					GC.ptnr_id	
					,GC.ptnr_id_sub						
				FROM
					(
						SELECT 
							a.ptnr_id
							,a.ptnr_id_sub						
						FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
						WHERE 1=1
						AND a.ptnr_id = b.ptnr_id
						AND a.team_id = c.team_id
						AND c.team_center = #{team_center}
						AND a.suim_rpt_state != 3
						AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
						AND a.reg_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
						AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
						
						UNION ALL

						SELECT 
							a.ptnr_id
							,a.ptnr_id_sub						
						FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
						WHERE 1=1
						AND a.ptnr_id = b.ptnr_id
						AND a.team_id = c.team_id
						AND c.team_center = #{team_center}
						AND a.suim_rpt_state = 2
						AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
						AND a.close_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
						AND a.close_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
						
						UNION ALL
						
						SELECT 
							a.ptnr_id
							,a.ptnr_id_sub						
						FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
						WHERE 1=1
						AND a.ptnr_id = b.ptnr_id
						AND a.team_id = c.team_id
						AND c.team_center = #{team_center}
						AND a.suim_rpt_state != 3
						AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
						AND a.reg_date >= UNIX_TIMESTAMP(#{bgnYearDe})
						AND a.reg_date &lt; UNIX_TIMESTAMP(#{endYearDe})
						GROUP BY a.ptnr_id, a.ptnr_id_sub					
						
						UNION ALL
						
						SELECT 
							a.ptnr_id
							,a.ptnr_id_sub						
						FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
						WHERE 1=1
						AND a.ptnr_id = b.ptnr_id
						AND a.team_id = c.team_id
						AND c.team_center = #{team_center}
						AND a.suim_rpt_state = 2
						AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
						AND a.close_date >= UNIX_TIMESTAMP(#{bgnYearDe})
						AND a.close_date &lt; UNIX_TIMESTAMP(#{endYearDe})
						GROUP BY a.ptnr_id, a.ptnr_id_sub
						
						UNION ALL
						
						SELECT 
							a.ptnr_id
							,a.ptnr_id_sub						
						FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
						WHERE 1=1
						AND a.ptnr_id = b.ptnr_id
						AND a.team_id = c.team_id
						AND c.team_center = #{team_center}
						AND a.suim_rpt_state = 2
						AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
						AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
						AND a.close_date &lt;= UNIX_TIMESTAMP(#{endDe})
						GROUP BY a.ptnr_id, a.ptnr_id_sub
						
						UNION ALL
						
						SELECT 
							a.ptnr_id
							,a.ptnr_id_sub						
						FROM top_rpt_head a, top_ptnr_bsc b, top_tm_bsc c
						WHERE 1=1
						AND a.ptnr_id = b.ptnr_id
						AND a.team_id = c.team_id
						AND c.team_center = #{team_center}		
						AND a.suim_rpt_state IN (0,1,11)
						AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)					
						AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
						GROUP BY a.ptnr_id, a.ptnr_id_sub
										
					)GC
				GROUP BY GC.ptnr_id, GC.ptnr_id_sub
			)GD
			GROUP BY GD.ptnr_id
		) GF
		
		ON GB.ptnr_id = GF.ptnr_id		
	</select>
	
	<select id="selectMisAllotPtnrListNew" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
				GB.ptnr_nick
				,GB.ptnr_id_sub_name
				,GB.ptnr_id
				,GB.ptnr_id_sub
												
				,GB.REG01 ,GB.REG02, GB.REG03, GB.REG04, GB.REG05, GB.REG06, GB.REG07, GB.REG08, GB.REG09, GB.REG10 
				,GB.REG11 ,GB.REG12, GB.REG13, GB.REG14, GB.REG15, GB.REG16, GB.REG17, GB.REG18, GB.REG19, GB.REG20
				,GB.REG21 ,GB.REG22, GB.REG23, GB.REG24, GB.REG25, GB.REG26, GB.REG27, GB.REG28, GB.REG29, GB.REG30
				
				,GB.END01 ,GB.END02, GB.END03, GB.END04, GB.END05, GB.END06, GB.END07, GB.END08, GB.END09, GB.END10 
				,GB.END11 ,GB.END12, GB.END13, GB.END14, GB.END15, GB.END16, GB.END17, GB.END18, GB.END19, GB.END20
				,GB.END21 ,GB.END22, GB.END23, GB.END24, GB.END25, GB.END26, GB.END27, GB.END28, GB.END29, GB.END30
				
				,GB.regYearSum
				,GB.endYearSum
				,GB.endMonthSum	
				,GB.regMiSum
				
				,GF.row_cnt
		FROM(
			SELECT
				PA.ptnr_nick
				,(SELECT col_val FROM sysadm_codedic2 WHERE tbl_nm = 'top_rpt_head' AND col_nm = 'ptnr_id_sub' AND col_cd1 = GA.ptnr_id AND col_cd2 = GA.ptnr_id_sub) AS ptnr_id_sub_name
				,GA.ptnr_id	
				,GA.ptnr_id_sub
				,PA.statistics_order
				,SUM(GA.REG01) AS REG01 ,SUM(GA.REG02) AS REG02 ,SUM(GA.REG03) AS REG03 ,SUM(GA.REG04) AS REG04 ,SUM(GA.REG05) AS REG05
				,SUM(GA.REG06) AS REG06 ,SUM(GA.REG07) AS REG07 ,SUM(GA.REG08) AS REG08 ,SUM(GA.REG09) AS REG09 ,SUM(GA.REG10) AS REG10
				,SUM(GA.REG11) AS REG11 ,SUM(GA.REG12) AS REG12 ,SUM(GA.REG13) AS REG13 ,SUM(GA.REG14) AS REG14 ,SUM(GA.REG15) AS REG15
				,SUM(GA.REG16) AS REG16 ,SUM(GA.REG17) AS REG17 ,SUM(GA.REG18) AS REG18 ,SUM(GA.REG19) AS REG19 ,SUM(GA.REG20) AS REG20
				,SUM(GA.REG21) AS REG21 ,SUM(GA.REG22) AS REG22 ,SUM(GA.REG23) AS REG23 ,SUM(GA.REG24) AS REG24 ,SUM(GA.REG25) AS REG25
				,SUM(GA.REG26) AS REG26 ,SUM(GA.REG27) AS REG27 ,SUM(GA.REG28) AS REG28 ,SUM(GA.REG29) AS REG29 ,SUM(GA.REG30) AS REG30
				
				,SUM(GA.END01) AS END01 ,SUM(GA.END02) AS END02 ,SUM(GA.END03) AS END03 ,SUM(GA.END04) AS END04 ,SUM(GA.END05) AS END05
				,SUM(GA.END06) AS END06 ,SUM(GA.END07) AS END07 ,SUM(GA.END08) AS END08 ,SUM(GA.END09) AS END09 ,SUM(GA.END10) AS END10
				,SUM(GA.END11) AS END11 ,SUM(GA.END12) AS END12 ,SUM(GA.END13) AS END13 ,SUM(GA.END14) AS END14 ,SUM(GA.END15) AS END15
				,SUM(GA.END16) AS END16 ,SUM(GA.END17) AS END17 ,SUM(GA.END18) AS END18 ,SUM(GA.END19) AS END19 ,SUM(GA.END20) AS END20
				,SUM(GA.END21) AS END21 ,SUM(GA.END22) AS END22 ,SUM(GA.END23) AS END23 ,SUM(GA.END24) AS END24 ,SUM(GA.END25) AS END25
				,SUM(GA.END26) AS END26 ,SUM(GA.END27) AS END27 ,SUM(GA.END28) AS END28 ,SUM(GA.END29) AS END29 ,SUM(GA.END30) AS END30
				
				,SUM(GA.regYearSum) AS regYearSum
				,SUM(GA.endYearSum) AS endYearSum
				,SUM(GA.endMonthSum) AS endMonthSum
				,SUM(GA.regMiSum) AS regMiSum
			FROM
				(
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG01
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG02
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG03
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG04
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG05
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG06
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG07
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG08
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG09
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG10
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG11
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG12
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG13
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG14
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG15
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG16
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG17
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG18
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG19
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG20
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG21
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG22
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG23
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG24
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG25
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG26
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG27
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG28
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG29
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG30
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						,0 AS regYearSum
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state != 3
					AND a.div_type = #{div_type}
					AND a.reg_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
					AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					
					UNION ALL

					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END01
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END02
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END03
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END04
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END05
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END06
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END07
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END08
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END09
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END10
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END11
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END12
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END13
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END14
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END15
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END16
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END17
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END18
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END19
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END20
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END21
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END22
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END23
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END24
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END25
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END26
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END27
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END28
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END29
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END30
						,0 AS regYearSum
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state = 2
					AND a.div_type = #{div_type}
					AND a.close_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
					AND a.close_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub						
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,COUNT(a.suim_rpt_no) AS regYearSum		
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state != 3
					AND a.div_type = #{div_type}
					AND a.reg_date >= UNIX_TIMESTAMP(#{bgnYearDe})
					AND a.reg_date &lt; UNIX_TIMESTAMP(#{endYearDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub					
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,COUNT(a.suim_rpt_no) AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state = 2
					AND a.div_type = #{div_type}
					AND a.close_date >= UNIX_TIMESTAMP(#{bgnYearDe})
					AND a.close_date &lt; UNIX_TIMESTAMP(#{endYearDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub						
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,0 AS endYearSum
						,COUNT(a.suim_rpt_no) AS endMonthSum
						,0 AS regMiSum
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state = 2
					AND a.div_type = #{div_type}
					AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
					AND a.close_date &lt;= UNIX_TIMESTAMP(#{endDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub						
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,0 AS endYearSum
						,0 AS endMonthSum
						,COUNT(a.suim_rpt_no) AS regMiSum
					FROM v_top_rpt_head_type a
					WHERE 1=1										
					AND a.suim_rpt_state in (0,1,11)
					AND a.div_type = #{div_type}
					AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					GROUP BY a.ptnr_id, a.ptnr_id_sub
									
				)GA
				LEFT JOIN top_ptnr_bsc PA
				ON GA.ptnr_id = PA.ptnr_id

			GROUP BY GA.ptnr_id, GA.ptnr_id_sub
			ORDER BY PA.statistics_order, GA.ptnr_id_sub
		)GB
				
		LEFT JOIN 

		(
			SELECT
				GD.ptnr_id
				,COUNT(GD.ptnr_id) AS row_cnt	
			FROM(
				SELECT
					GC.ptnr_id
					,GC.ptnr_id_sub
				FROM(
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub						
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state != 3
					AND a.div_type = #{div_type}
					AND a.reg_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
					AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					
					UNION ALL

					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub						
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state = 2
					AND a.div_type = #{div_type}
					AND a.close_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
					AND a.close_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state != 3
					AND a.div_type = #{div_type}
					AND a.reg_date >= UNIX_TIMESTAMP(#{bgnYearDe})
					AND a.reg_date &lt; UNIX_TIMESTAMP(#{endYearDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub					
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub						
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state = 2
					AND a.div_type = #{div_type}
					AND a.close_date >= UNIX_TIMESTAMP(#{bgnYearDe})
					AND a.close_date &lt; UNIX_TIMESTAMP(#{endYearDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub						
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state = 2
					AND a.div_type = #{div_type}
					AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
					AND a.close_date &lt;= UNIX_TIMESTAMP(#{endDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
					FROM v_top_rpt_head_type a
					WHERE 1=1										
					AND a.suim_rpt_state IN (0,1,11)
					AND a.div_type = #{div_type}
					AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					GROUP BY a.ptnr_id, a.ptnr_id_sub
				)GC
				GROUP BY GC.ptnr_id, GC.ptnr_id_sub
			)GD
			GROUP BY GD.ptnr_id
		)GF
		
		ON GB.ptnr_id = GF.ptnr_id
	</select>
		
	
	<select id="selectMisAllotPtnrListNew_20250408" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
				GB.ptnr_nick
				,GB.ptnr_id_sub_name
				,GB.ptnr_id
				,GB.ptnr_id_sub
				,Tmp.row_cnt				
				,GB.REG01 ,GB.REG02, GB.REG03, GB.REG04, GB.REG05, GB.REG06, GB.REG07, GB.REG08, GB.REG09, GB.REG10 
				,GB.REG11 ,GB.REG12, GB.REG13, GB.REG14, GB.REG15, GB.REG16, GB.REG17, GB.REG18, GB.REG19, GB.REG20
				,GB.REG21 ,GB.REG22, GB.REG23, GB.REG24, GB.REG25, GB.REG26, GB.REG27, GB.REG28, GB.REG29, GB.REG30
				
				,GB.END01 ,GB.END02, GB.END03, GB.END04, GB.END05, GB.END06, GB.END07, GB.END08, GB.END09, GB.END10 
				,GB.END11 ,GB.END12, GB.END13, GB.END14, GB.END15, GB.END16, GB.END17, GB.END18, GB.END19, GB.END20
				,GB.END21 ,GB.END22, GB.END23, GB.END24, GB.END25, GB.END26, GB.END27, GB.END28, GB.END29, GB.END30
				
				,GB.regYearSum
				,GB.endYearSum
				,GB.endMonthSum	
				,GB.regMiSum
		FROM(
			SELECT
				PA.ptnr_nick
				,(SELECT col_val FROM sysadm_codedic2 WHERE tbl_nm = 'top_rpt_head' AND col_nm = 'ptnr_id_sub' AND col_cd1 = GA.ptnr_id AND col_cd2 = GA.ptnr_id_sub) AS ptnr_id_sub_name
				,GA.ptnr_id	
				,GA.ptnr_id_sub
				,PA.statistics_order
				,SUM(GA.REG01) AS REG01 ,SUM(GA.REG02) AS REG02 ,SUM(GA.REG03) AS REG03 ,SUM(GA.REG04) AS REG04 ,SUM(GA.REG05) AS REG05
				,SUM(GA.REG06) AS REG06 ,SUM(GA.REG07) AS REG07 ,SUM(GA.REG08) AS REG08 ,SUM(GA.REG09) AS REG09 ,SUM(GA.REG10) AS REG10
				,SUM(GA.REG11) AS REG11 ,SUM(GA.REG12) AS REG12 ,SUM(GA.REG13) AS REG13 ,SUM(GA.REG14) AS REG14 ,SUM(GA.REG15) AS REG15
				,SUM(GA.REG16) AS REG16 ,SUM(GA.REG17) AS REG17 ,SUM(GA.REG18) AS REG18 ,SUM(GA.REG19) AS REG19 ,SUM(GA.REG20) AS REG20
				,SUM(GA.REG21) AS REG21 ,SUM(GA.REG22) AS REG22 ,SUM(GA.REG23) AS REG23 ,SUM(GA.REG24) AS REG24 ,SUM(GA.REG25) AS REG25
				,SUM(GA.REG26) AS REG26 ,SUM(GA.REG27) AS REG27 ,SUM(GA.REG28) AS REG28 ,SUM(GA.REG29) AS REG29 ,SUM(GA.REG30) AS REG30
				
				,SUM(GA.END01) AS END01 ,SUM(GA.END02) AS END02 ,SUM(GA.END03) AS END03 ,SUM(GA.END04) AS END04 ,SUM(GA.END05) AS END05
				,SUM(GA.END06) AS END06 ,SUM(GA.END07) AS END07 ,SUM(GA.END08) AS END08 ,SUM(GA.END09) AS END09 ,SUM(GA.END10) AS END10
				,SUM(GA.END11) AS END11 ,SUM(GA.END12) AS END12 ,SUM(GA.END13) AS END13 ,SUM(GA.END14) AS END14 ,SUM(GA.END15) AS END15
				,SUM(GA.END16) AS END16 ,SUM(GA.END17) AS END17 ,SUM(GA.END18) AS END18 ,SUM(GA.END19) AS END19 ,SUM(GA.END20) AS END20
				,SUM(GA.END21) AS END21 ,SUM(GA.END22) AS END22 ,SUM(GA.END23) AS END23 ,SUM(GA.END24) AS END24 ,SUM(GA.END25) AS END25
				,SUM(GA.END26) AS END26 ,SUM(GA.END27) AS END27 ,SUM(GA.END28) AS END28 ,SUM(GA.END29) AS END29 ,SUM(GA.END30) AS END30
				
				,SUM(GA.regYearSum) AS regYearSum
				,SUM(GA.endYearSum) AS endYearSum
				,SUM(GA.endMonthSum) AS endMonthSum
				,SUM(GA.regMiSum) AS regMiSum
			FROM
				(
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG01
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG02
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG03
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG04
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG05
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG06
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG07
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG08
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG09
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG10
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG11
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG12
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG13
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG14
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG15
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG16
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG17
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG18
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG19
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG20
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG21
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG22
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG23
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG24
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG25
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG26
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG27
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG28
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG29
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG30
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						,0 AS regYearSum
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state != 3
					AND a.div_type = #{div_type}
					AND a.reg_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
					AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					
					UNION ALL

					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END01
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END02
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END03
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END04
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END05
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END06
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END07
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END08
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END09
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END10
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END11
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END12
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END13
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END14
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END15
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END16
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END17
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END18
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END19
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END20
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END21
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END22
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END23
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END24
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END25
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END26
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END27
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END28
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END29
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END30
						,0 AS regYearSum
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state = 2
					AND a.div_type = #{div_type}
					AND a.close_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
					AND a.close_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub						
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,COUNT(a.suim_rpt_no) AS regYearSum		
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state != 3
					AND a.div_type = #{div_type}
					AND a.reg_date >= UNIX_TIMESTAMP(#{bgnYearDe})
					AND a.reg_date &lt; UNIX_TIMESTAMP(#{endYearDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub					
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,COUNT(a.suim_rpt_no) AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state = 2
					AND a.div_type = #{div_type}
					AND a.close_date >= UNIX_TIMESTAMP(#{bgnYearDe})
					AND a.close_date &lt; UNIX_TIMESTAMP(#{endYearDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub						
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,0 AS endYearSum
						,COUNT(a.suim_rpt_no) AS endMonthSum
						,0 AS regMiSum
					FROM v_top_rpt_head_type a
					WHERE 1=1					
					AND a.suim_rpt_state = 2
					AND a.div_type = #{div_type}
					AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
					AND a.close_date &lt;= UNIX_TIMESTAMP(#{endDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub						
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,0 AS endYearSum
						,0 AS endMonthSum
						,COUNT(a.suim_rpt_no) AS regMiSum
					FROM v_top_rpt_head_type a
					WHERE 1=1										
					AND a.suim_rpt_state in (0,1,11)
					AND a.div_type = #{div_type}
					AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					GROUP BY a.ptnr_id, a.ptnr_id_sub
									
				)GA
				LEFT JOIN top_ptnr_bsc PA
				ON GA.ptnr_id = PA.ptnr_id

			GROUP BY GA.ptnr_id, GA.ptnr_id_sub
			ORDER BY PA.statistics_order, GA.ptnr_id_sub
		)GB
				
		LEFT JOIN 

		(
			SELECT
				GC.ptnr_id
				,COUNT(*) AS row_cnt
			FROM
			(
				SELECT 
					a.ptnr_id
					,a.ptnr_id_sub
				FROM top_rpt_head a, top_rpt_type b
				WHERE 1=1
				AND a.suim_rpt_type1 = b.suim_rpt_type1
				AND a.workload_type = b.workload_type	
				AND a.suim_rpt_state != 3
				AND b.div_type = #{div_type}
				AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
				GROUP BY a.ptnr_id, a.ptnr_id_sub
			)GC
			GROUP BY GC.ptnr_id
		) Tmp
		
		ON GB.ptnr_id = Tmp.ptnr_id
	</select>

	<select id="selectMisAllotPtnrList" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT
				GB.ptnr_nick
				,GB.ptnr_id_sub_name
				,GB.ptnr_id
				,GB.ptnr_id_sub
				,Tmp.row_cnt				
				,GB.REG01 ,GB.REG02, GB.REG03, GB.REG04, GB.REG05, GB.REG06, GB.REG07, GB.REG08, GB.REG09, GB.REG10 
				,GB.REG11 ,GB.REG12, GB.REG13, GB.REG14, GB.REG15, GB.REG16, GB.REG17, GB.REG18, GB.REG19, GB.REG20
				,GB.REG21 ,GB.REG22, GB.REG23, GB.REG24, GB.REG25, GB.REG26, GB.REG27, GB.REG28, GB.REG29, GB.REG30
				
				,GB.END01 ,GB.END02, GB.END03, GB.END04, GB.END05, GB.END06, GB.END07, GB.END08, GB.END09, GB.END10 
				,GB.END11 ,GB.END12, GB.END13, GB.END14, GB.END15, GB.END16, GB.END17, GB.END18, GB.END19, GB.END20
				,GB.END21 ,GB.END22, GB.END23, GB.END24, GB.END25, GB.END26, GB.END27, GB.END28, GB.END29, GB.END30
				
				,GB.regYearSum
				,GB.endYearSum
				,GB.endMonthSum	
				,GB.regMiSum
		FROM(
			SELECT
				GA.ptnr_nick
				,(SELECT col_val FROM sysadm_codedic2 WHERE tbl_nm = 'top_rpt_head' AND col_nm = 'ptnr_id_sub' AND col_cd1 = GA.ptnr_id AND col_cd2 = GA.ptnr_id_sub) AS ptnr_id_sub_name
				,GA.ptnr_id	
				,GA.ptnr_id_sub		
				,SUM(GA.REG01) AS REG01 ,SUM(GA.REG02) AS REG02 ,SUM(GA.REG03) AS REG03 ,SUM(GA.REG04) AS REG04 ,SUM(GA.REG05) AS REG05
				,SUM(GA.REG06) AS REG06 ,SUM(GA.REG07) AS REG07 ,SUM(GA.REG08) AS REG08 ,SUM(GA.REG09) AS REG09 ,SUM(GA.REG10) AS REG10
				,SUM(GA.REG11) AS REG11 ,SUM(GA.REG12) AS REG12 ,SUM(GA.REG13) AS REG13 ,SUM(GA.REG14) AS REG14 ,SUM(GA.REG15) AS REG15
				,SUM(GA.REG16) AS REG16 ,SUM(GA.REG17) AS REG17 ,SUM(GA.REG18) AS REG18 ,SUM(GA.REG19) AS REG19 ,SUM(GA.REG20) AS REG20
				,SUM(GA.REG21) AS REG21 ,SUM(GA.REG22) AS REG22 ,SUM(GA.REG23) AS REG23 ,SUM(GA.REG24) AS REG24 ,SUM(GA.REG25) AS REG25
				,SUM(GA.REG26) AS REG26 ,SUM(GA.REG27) AS REG27 ,SUM(GA.REG28) AS REG28 ,SUM(GA.REG29) AS REG29 ,SUM(GA.REG30) AS REG30
				
				,SUM(GA.END01) AS END01 ,SUM(GA.END02) AS END02 ,SUM(GA.END03) AS END03 ,SUM(GA.END04) AS END04 ,SUM(GA.END05) AS END05
				,SUM(GA.END06) AS END06 ,SUM(GA.END07) AS END07 ,SUM(GA.END08) AS END08 ,SUM(GA.END09) AS END09 ,SUM(GA.END10) AS END10
				,SUM(GA.END11) AS END11 ,SUM(GA.END12) AS END12 ,SUM(GA.END13) AS END13 ,SUM(GA.END14) AS END14 ,SUM(GA.END15) AS END15
				,SUM(GA.END16) AS END16 ,SUM(GA.END17) AS END17 ,SUM(GA.END18) AS END18 ,SUM(GA.END19) AS END19 ,SUM(GA.END20) AS END20
				,SUM(GA.END21) AS END21 ,SUM(GA.END22) AS END22 ,SUM(GA.END23) AS END23 ,SUM(GA.END24) AS END24 ,SUM(GA.END25) AS END25
				,SUM(GA.END26) AS END26 ,SUM(GA.END27) AS END27 ,SUM(GA.END28) AS END28 ,SUM(GA.END29) AS END29 ,SUM(GA.END30) AS END30
				
				,SUM(GA.regYearSum) AS regYearSum
				,SUM(GA.endYearSum) AS endYearSum
				,SUM(GA.endMonthSum) AS endMonthSum
				,SUM(GA.regMiSum) AS regMiSum
			FROM
				(
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG01
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG02
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG03
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG04
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG05
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG06
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG07
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG08
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG09
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG10
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG11
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG12
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG13
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG14
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG15
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG16
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG17
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG18
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG19
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG20
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG21
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG22
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG23
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG24
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG25
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG26
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG27
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG28
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG29
						,CASE WHEN FROM_UNIXTIME(a.reg_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG30
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						,0 AS regYearSum
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.suim_rpt_state != 3
					AND a.suim_rpt_type1 in (1,2,11,12,13,14,15,16,17,18,19)
					AND a.reg_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
					AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					
					UNION ALL

					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END01
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END02
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END03
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END04
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END05
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END06
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END07
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END08
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END09
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END10
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END11
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END12
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END13
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END14
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END15
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END16
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END17
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END18
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END19
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END20
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END21
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END22
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END23
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END24
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END25
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END26
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END27
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END28
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END29
						,CASE WHEN FROM_UNIXTIME(a.close_date,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS END30
						,0 AS regYearSum
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.suim_rpt_state = 2
					AND a.suim_rpt_type1 in (1,2,11,12,13,14,15,16,17,18,19)
					AND a.close_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
					AND a.close_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,COUNT(a.suim_rpt_no) AS regYearSum		
						,0 AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.suim_rpt_state != 3
					AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
					AND a.reg_date >= UNIX_TIMESTAMP(#{bgnYearDe})
					AND a.reg_date &lt; UNIX_TIMESTAMP(#{endYearDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub					
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,COUNT(a.suim_rpt_no) AS endYearSum
						,0 AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.suim_rpt_state = 2
					AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
					AND a.close_date >= UNIX_TIMESTAMP(#{bgnYearDe})
					AND a.close_date &lt; UNIX_TIMESTAMP(#{endYearDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,0 AS endYearSum
						,COUNT(a.suim_rpt_no) AS endMonthSum
						,0 AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id
					AND a.suim_rpt_state = 2
					AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)
					AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
					AND a.close_date &lt;= UNIX_TIMESTAMP(#{endDe})
					GROUP BY a.ptnr_id, a.ptnr_id_sub
					
					UNION ALL
					
					SELECT 
						a.ptnr_id
						,a.ptnr_id_sub
						,b.ptnr_nick
						,b.statistics_order
						,0 AS REG01 ,0 AS REG02 ,0 AS REG03 ,0 AS REG04 ,0 AS REG05 ,0 AS REG06, 0 AS REG07, 0 AS REG08 ,0 AS REG09, 0 AS REG10
						,0 AS REG11, 0 AS REG12 ,0 AS REG13 ,0 AS REG14 ,0 AS REG15 ,0 AS REG16, 0 AS REG17, 0 AS REG18, 0 AS REG19, 0 AS REG20
						,0 AS REG21, 0 AS REG22 ,0 AS REG23 ,0 AS REG24 ,0 AS REG25 ,0 AS REG26 ,0 AS REG27, 0 AS REG28, 0 AS REG29, 0 AS REG30
						
						,0 AS END01 ,0 AS END02 ,0 AS END03 ,0 AS END04 ,0 AS END05 ,0 AS END06, 0 AS END07, 0 AS END08 ,0 AS END09, 0 AS END10
						,0 AS END11, 0 AS END12 ,0 AS END13 ,0 AS END14 ,0 AS END15 ,0 AS END16, 0 AS END17, 0 AS END18, 0 AS END19, 0 AS END20
						,0 AS END21, 0 AS END22 ,0 AS END23 ,0 AS END24 ,0 AS END25 ,0 AS END26 ,0 AS END27, 0 AS END28, 0 AS END29, 0 AS END30
						
						,0 AS regYearSum		
						,0 AS endYearSum
						,0 AS endMonthSum
						,COUNT(a.suim_rpt_no) AS regMiSum
					FROM top_rpt_head a, top_ptnr_bsc b
					WHERE 1=1
					AND a.ptnr_id = b.ptnr_id					
					AND a.suim_rpt_state in (0,1,11)
					AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)					
					AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
					GROUP BY a.ptnr_id, a.ptnr_id_sub
									
				)GA
			GROUP BY GA.ptnr_id, GA.ptnr_id_sub
			ORDER BY GA.statistics_order, GA.ptnr_id_sub
		)GB
				
		LEFT JOIN 

		(
			SELECT
				GC.ptnr_id
				,COUNT(*) AS row_cnt
			FROM
			(
				SELECT 
					a.ptnr_id
					,a.ptnr_id_sub
				FROM top_rpt_head a, top_ptnr_bsc b
				WHERE 1=1
				AND a.ptnr_id = b.ptnr_id
				AND a.suim_rpt_state != 3
				<!-- AND a.reg_date >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d')) -->
				AND a.reg_date &lt;= UNIX_TIMESTAMP(DATE_FORMAT(NOW(),'%Y%m%d'))
				AND a.suim_rpt_type1 IN (1,2,11,12,13,14,15,16,17,18,19)				
				GROUP BY a.ptnr_id, a.ptnr_id_sub
			)GC
			GROUP BY GC.ptnr_id
		) Tmp
		
		ON GB.ptnr_id = Tmp.ptnr_id		
	</select>

	<select id="newGetMisAllotTmMbr1Written" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisRegTmVO">
		SELECT a.user_no
				, a.user_name
				, a.team_id_main
				, getTopTmBscTeamName(a.team_id_main) team_name				
				,CASE a.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15	
				END AS new_work_order
		FROM  top_mbr_bsc a, top_tm_bsc b		
		WHERE a.team_id_main = b.team_id
		AND a.user_state != 1
		AND b.team_id = #{team_id}
		ORDER BY new_work_order, a.work_level DESC, a.user_no ASC
	</select>
	
	<select id="newGetMisAllotTmMbr1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisRegTmVO"> 
		SELECT   GB.user_no, GB.user_name, GB.team_id_main, getTopTmBscTeamName(GB.team_id_main) team_name
				,SUM(GA.reg_30) AS reg_30, SUM(GA.reg_29) AS reg_29, SUM(GA.reg_28) AS reg_28, SUM(GA.reg_27) AS reg_27, SUM(GA.reg_26) AS reg_26
				,SUM(GA.reg_25) AS reg_25, SUM(GA.reg_24) AS reg_24, SUM(GA.reg_23) AS reg_23, SUM(GA.reg_22) AS reg_22, SUM(GA.reg_21) AS reg_21
				,SUM(GA.reg_20) AS reg_20, SUM(GA.reg_19) AS reg_19, SUM(GA.reg_18) AS reg_18, SUM(GA.reg_17) AS reg_17, SUM(GA.reg_16) AS reg_16
				,SUM(GA.reg_15) AS reg_15, SUM(GA.reg_14) AS reg_14, SUM(GA.reg_13) AS reg_13, SUM(GA.reg_12) AS reg_12, SUM(GA.reg_11) AS reg_11
				,SUM(GA.reg_10) AS reg_10, SUM(GA.reg_09) AS reg_09, SUM(GA.reg_08) AS reg_08, SUM(GA.reg_07) AS reg_07, SUM(GA.reg_06) AS reg_06
				,SUM(GA.reg_05) AS reg_05, SUM(GA.reg_04) AS reg_04, SUM(GA.reg_03) AS reg_03, SUM(GA.reg_02) AS reg_02, SUM(GA.reg_01) AS reg_01, SUM(GA.reg_00) AS reg_00
				,SUM(GA.day_30) AS day_30, SUM(GA.day_29) AS day_29, SUM(GA.day_28) AS day_28, SUM(GA.day_27) AS day_27, SUM(GA.day_26) AS day_26
				,SUM(GA.day_25) AS day_25, SUM(GA.day_24) AS day_24, SUM(GA.day_23) AS day_23, SUM(GA.day_22) AS day_22, SUM(GA.day_21) AS day_21
				,SUM(GA.day_20) AS day_20, SUM(GA.day_19) AS day_19, SUM(GA.day_18) AS day_18, SUM(GA.day_17) AS day_17, SUM(GA.day_16) AS day_16
				,SUM(GA.day_15) AS day_15, SUM(GA.day_14) AS day_14, SUM(GA.day_13) AS day_13, SUM(GA.day_12) AS day_12, SUM(GA.day_11) AS day_11
				,SUM(GA.day_10) AS day_10, SUM(GA.day_09) AS day_09, SUM(GA.day_08) AS day_08, SUM(GA.day_07) AS day_07, SUM(GA.day_06) AS day_06
				,SUM(GA.day_05) AS day_05, SUM(GA.day_04) AS day_04, SUM(GA.day_03) AS day_03, SUM(GA.day_02) AS day_02, SUM(GA.day_01) AS day_01, SUM(GA.day_00) AS day_00
				,SUM(GA.reg_y) AS reg_y, SUM(GA.cls_m) AS cls_m, SUM(GA.cls_y) AS cls_y, SUM(GA.reg_mi) AS reg_mi
				,CASE GB.work_type
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15	
				END AS new_work_order 
		  FROM (
		  			 -- 30 
					SELECT user_no
							,count(suim_rpt_no) AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
							,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
							,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
							,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
							,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
							,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00							
							,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore30})
					   AND reg_date &lt; unix_timestamp(#{dayBefore29})
					 GROUP BY user_no		
					 UNION ALL
					 -- 29 
					SELECT user_no
							,0,count(suim_rpt_no) AS reg_29,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore29})
					   AND reg_date &lt; unix_timestamp(#{dayBefore28})
					 GROUP BY user_no		
					 UNION ALL
					 -- 28 
					SELECT user_no
							,0,0,count(suim_rpt_no) AS reg_28,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore28})
					   AND reg_date &lt; unix_timestamp(#{dayBefore27})
					 GROUP BY user_no
					 UNION ALL		
					 -- 27 
					SELECT user_no
							,0,0,0,count(suim_rpt_no) AS reg_27,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore27})
					   AND reg_date &lt; unix_timestamp(#{dayBefore26})
					 GROUP BY user_no
					 UNION ALL		
					 -- 26 
					SELECT user_no
							,0,0,0,0,count(suim_rpt_no) AS reg_26,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore26})
					   AND reg_date &lt; unix_timestamp(#{dayBefore25})
					 GROUP BY user_no					
					 UNION ALL		
					 -- 25 
					SELECT user_no
							,0,0,0,0,0,count(suim_rpt_no) AS reg_25,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore25})
					   AND reg_date &lt; unix_timestamp(#{dayBefore24})
					 GROUP BY user_no
					 UNION ALL		
					 -- 24 
					SELECT user_no
							,0,0,0,0,0,0,count(suim_rpt_no) AS reg_24,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore24})
					   AND reg_date &lt; unix_timestamp(#{dayBefore23})
					 GROUP BY user_no					 
					 UNION ALL		
					 -- 23 
					SELECT user_no
							,0,0,0,0,0,0,0,count(suim_rpt_no) AS reg_23,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore23})
					   AND reg_date &lt; unix_timestamp(#{dayBefore22})
					 GROUP BY user_no					 
					 UNION ALL		
					 -- 22 
					SELECT user_no
							,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS reg_22,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore22})
					   AND reg_date &lt; unix_timestamp(#{dayBefore21})
					 GROUP BY user_no
					 UNION ALL		
					 -- 21 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS reg_21
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore21})
					   AND reg_date &lt; unix_timestamp(#{dayBefore20})
					 GROUP BY user_no					
					 UNION ALL		
					 -- 20 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,count(suim_rpt_no) AS reg_20,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore20})
					   AND reg_date &lt; unix_timestamp(#{dayBefore19})
					 GROUP BY user_no
					 UNION ALL		
					 -- 19 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,count(suim_rpt_no) AS reg_19,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore19})
					   AND reg_date &lt; unix_timestamp(#{dayBefore18})
					 GROUP BY user_no
					 UNION ALL		
					 -- 18 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,count(suim_rpt_no) AS reg_18,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore18})
					   AND reg_date &lt; unix_timestamp(#{dayBefore17})
					 GROUP BY user_no					 								  					 					 
					 UNION ALL		
					 -- 17 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,count(suim_rpt_no) AS reg_17,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore17})
					   AND reg_date &lt; unix_timestamp(#{dayBefore16})
					 GROUP BY user_no					 									 					 		 				  		 
					 UNION ALL		
					 -- 16 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,count(suim_rpt_no) AS reg_16,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore16})
					   AND reg_date &lt; unix_timestamp(#{dayBefore15})
					 GROUP BY user_no
					 UNION ALL		
					 -- 15 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,count(suim_rpt_no) AS reg_15,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore15})
					   AND reg_date &lt; unix_timestamp(#{dayBefore14})
					 GROUP BY user_no
					 UNION ALL		
					 -- 14 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,count(suim_rpt_no) AS reg_14,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore14})
					   AND reg_date &lt; unix_timestamp(#{dayBefore13})
					 GROUP BY user_no
					 UNION ALL		
					 -- 13 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,count(suim_rpt_no) AS reg_13,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore13})
					   AND reg_date &lt; unix_timestamp(#{dayBefore12})
					 GROUP BY user_no
					 UNION ALL		
					 -- 12 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS reg_12,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore12})
					   AND reg_date &lt; unix_timestamp(#{dayBefore11})
					 GROUP BY user_no
					 UNION ALL		
					 -- 11 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS reg_11
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore11})
					   AND reg_date &lt; unix_timestamp(#{dayBefore10})
					 GROUP BY user_no
					 UNION ALL		
					 -- 10 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,count(suim_rpt_no) AS reg_10,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore10})
					   AND reg_date &lt; unix_timestamp(#{dayBefore9})
					 GROUP BY user_no
					 UNION ALL		
					 -- 9 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,count(suim_rpt_no) AS reg_9,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore9})
					   AND reg_date &lt; unix_timestamp(#{dayBefore8})
					 GROUP BY user_no
					 UNION ALL		
					  -- 8 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,count(suim_rpt_no) AS reg_8,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore8})
					   AND reg_date &lt; unix_timestamp(#{dayBefore7})
					 GROUP BY user_no					 
					 UNION ALL		
					  -- 7 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,count(suim_rpt_no) AS reg_7,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore7})
					   AND reg_date &lt; unix_timestamp(#{dayBefore6})
					 GROUP BY user_no
					 UNION ALL		
					  -- 6 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,count(suim_rpt_no) AS reg_6,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore6})
					   AND reg_date &lt; unix_timestamp(#{dayBefore5})
					 GROUP BY user_no
					 UNION ALL		
					  -- 5 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,count(suim_rpt_no) AS reg_5,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore5})
					   AND reg_date &lt; unix_timestamp(#{dayBefore4})
					 GROUP BY user_no
					 UNION ALL		
					  -- 4 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,count(suim_rpt_no) AS reg_4,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore4})
					   AND reg_date &lt; unix_timestamp(#{dayBefore3})
					 GROUP BY user_no
					 UNION ALL		
					  -- 3 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,count(suim_rpt_no) AS reg_3,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore3})
					   AND reg_date &lt; unix_timestamp(#{dayBefore2})
					 GROUP BY user_no
					 UNION ALL		
					  -- 2 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS reg_2,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore2})
					   AND reg_date &lt; unix_timestamp(#{dayBefore1})
					 GROUP BY user_no
					 UNION ALL		
					  -- 1 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS reg_1,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore1})
					   AND reg_date &lt; unix_timestamp(#{dayBefore0})
					 GROUP BY user_no		
					 UNION ALL		
					  -- 0 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS reg_00
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state != 3
					   AND reg_date >= unix_timestamp(#{dayBefore0})
					 GROUP BY user_no				
					 UNION ALL		  
		  			 -- 30 
					SELECT user_no 
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,count(suim_rpt_no) AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
							,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
							,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
							,0 AS reg_m, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore30})
					   AND close_date &lt; unix_timestamp(#{dayBefore29})
					 GROUP BY user_no		
					 UNION ALL
					 -- 29 
					SELECT user_no 
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,count(suim_rpt_no) AS day_29,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore29})
					   AND close_date &lt; unix_timestamp(#{dayBefore28})
					 GROUP BY user_no		
					 UNION ALL
					 -- 28 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,count(suim_rpt_no) AS day_28,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0							
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore28})
					   AND close_date &lt; unix_timestamp(#{dayBefore27})
					 GROUP BY user_no
					 UNION ALL		
					 -- 27 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,count(suim_rpt_no) AS day_27,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore27})
					   AND close_date &lt; unix_timestamp(#{dayBefore26})
					 GROUP BY user_no
					 UNION ALL		
					 -- 26 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,count(suim_rpt_no) AS day_26,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore26})
					   AND close_date &lt; unix_timestamp(#{dayBefore25})
					 GROUP BY user_no					
					 UNION ALL		
					 -- 25 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,count(suim_rpt_no) AS day_25,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore25})
					   AND close_date &lt; unix_timestamp(#{dayBefore24})
					 GROUP BY user_no
					 UNION ALL		
					 -- 24 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,count(suim_rpt_no) AS day_24,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore24})
					   AND close_date &lt; unix_timestamp(#{dayBefore23})
					 GROUP BY user_no					 
					 UNION ALL		
					 -- 23 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,count(suim_rpt_no) AS day_23,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore23})
					   AND close_date &lt; unix_timestamp(#{dayBefore22})
					 GROUP BY user_no					 
					 UNION ALL		
					 -- 22 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS day_22,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore22})
					   AND close_date &lt; unix_timestamp(#{dayBefore21})
					 GROUP BY user_no
					 UNION ALL		
					 -- 21 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS day_21
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore21})
					   AND close_date &lt; unix_timestamp(#{dayBefore20})
					 GROUP BY user_no					
					 UNION ALL		
					 -- 20 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,count(suim_rpt_no) AS day_20,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore20})
					   AND close_date &lt; unix_timestamp(#{dayBefore19})
					 GROUP BY user_no
					 UNION ALL		
					 -- 19 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,count(suim_rpt_no) AS day_19,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore19})
					   AND close_date &lt; unix_timestamp(#{dayBefore18})
					 GROUP BY user_no
					 UNION ALL		
					 -- 18 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,count(suim_rpt_no) AS day_18,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore18})
					   AND close_date &lt; unix_timestamp(#{dayBefore17})
					 GROUP BY user_no					 								  					 					 
					 UNION ALL		
					 -- 17 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,count(suim_rpt_no) AS day_17,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore17})
					   AND close_date &lt; unix_timestamp(#{dayBefore16})
					 GROUP BY user_no					 									 					 		 				  		 
					 UNION ALL		
					 -- 16 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,count(suim_rpt_no) AS day_16,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore16})
					   AND close_date &lt; unix_timestamp(#{dayBefore15})
					 GROUP BY user_no
					 UNION ALL		
					 -- 15 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,count(suim_rpt_no) AS day_15,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore15})
					   AND close_date &lt; unix_timestamp(#{dayBefore14})
					 GROUP BY user_no
					 UNION ALL		
					 -- 14 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,count(suim_rpt_no) AS day_14,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore14})
					   AND close_date &lt; unix_timestamp(#{dayBefore13})
					 GROUP BY user_no
					 UNION ALL		
					 -- 13 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,count(suim_rpt_no) AS day_13,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore13})
					   AND close_date &lt; unix_timestamp(#{dayBefore12})
					 GROUP BY user_no
					 UNION ALL		
					 -- 12 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS day_12,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore12})
					   AND close_date &lt; unix_timestamp(#{dayBefore11})
					 GROUP BY user_no
					 UNION ALL		
					 -- 11 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS day_11
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore11})
					   AND close_date &lt; unix_timestamp(#{dayBefore10})
					 GROUP BY user_no
					 UNION ALL		
					 -- 10 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,count(suim_rpt_no) AS day_10,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore10})
					   AND close_date &lt; unix_timestamp(#{dayBefore9})
					 GROUP BY user_no
					 UNION ALL		
					 -- 9 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,count(suim_rpt_no) AS day_9,0,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore9})
					   AND close_date &lt; unix_timestamp(#{dayBefore8})
					 GROUP BY user_no
					 UNION ALL		
					  -- 8 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,count(suim_rpt_no) AS day_8,0,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore8})
					   AND close_date &lt; unix_timestamp(#{dayBefore7})
					 GROUP BY user_no					 
					 UNION ALL		
					  -- 7 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,count(suim_rpt_no) AS day_7,0,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore7})
					   AND close_date &lt; unix_timestamp(#{dayBefore6})
					 GROUP BY user_no
					 UNION ALL		
					  -- 6 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,count(suim_rpt_no) AS day_6,0,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore6})
					   AND close_date &lt; unix_timestamp(#{dayBefore5})
					 GROUP BY user_no
					 UNION ALL		
					  -- 5 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,count(suim_rpt_no) AS day_5,0,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore5})
					   AND close_date &lt; unix_timestamp(#{dayBefore4})
					 GROUP BY user_no
					 UNION ALL		
					  -- 4 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,count(suim_rpt_no) AS day_4,0,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore4})
					   AND close_date &lt; unix_timestamp(#{dayBefore3})
					 GROUP BY user_no
					 UNION ALL		
					  -- 3 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,count(suim_rpt_no) AS day_3,0,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore3})
					   AND close_date &lt; unix_timestamp(#{dayBefore2})
					 GROUP BY user_no
					 UNION ALL		
					  -- 2 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS day_2,0,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore2})
					   AND close_date &lt; unix_timestamp(#{dayBefore1})
					 GROUP BY user_no
					 UNION ALL		
					  -- 1 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS day_1,0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore1})
					   AND close_date &lt; unix_timestamp(#{dayBefore0})
					 GROUP BY user_no		
					 UNION ALL		
					  -- 0 
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,count(suim_rpt_no) AS day_0
							,0,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state = 2
					   AND close_date >= unix_timestamp(#{dayBefore0})
					 GROUP BY user_no		
					 UNION ALL
					 --  
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,count(suim_rpt_no) AS reg_y,0,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state &lt; '3'
					   AND reg_date >= unix_timestamp(#{year_from})
					   AND reg_date &lt; unix_timestamp(#{year_to})
					 GROUP BY user_no
					 UNION ALL
					 --  
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,count(suim_rpt_no) AS cls_m,0,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND close_date >= unix_timestamp(#{now_from})
					   AND close_date &lt; unix_timestamp(#{now_to})
 					 GROUP BY user_no
 					 UNION ALL
					 --  
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,count(suim_rpt_no) AS cls_y,0
					  FROM top_rpt_head
					 WHERE 1=1
					   AND close_date >= unix_timestamp(#{year_from})
					   AND close_date &lt; unix_timestamp(#{year_to})
 					 GROUP BY user_no 					 
 					 UNION ALL
					 --  
					SELECT user_no
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0					
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0
							,0,0,0,0,0,0,0,0,0,0,0
							,0,0,0,count(suim_rpt_no) reg_mi
					  FROM top_rpt_head
					 WHERE 1=1
					   AND suim_rpt_state in (0,1,11)
					 GROUP BY user_no				  					 
				) GA
		 LEFT OUTER JOIN top_mbr_bsc GB
		   ON GA.user_no = GB.user_no
		WHERE GB.team_id_main = #{team_id}
		  AND ( 
		  		(GB.user_state ='1' AND GB.out_date >= UNIX_TIMESTAMP(#{dayBefore30}))
				OR (GB.user_state !='1' AND GB.join_date &lt; UNIX_TIMESTAMP(DATE_ADD(#{dayBefore0},INTERVAL 1 day)))
			  )		   
		GROUP BY GA.user_no
		ORDER BY new_work_order, GB.work_level DESC, GB.user_no ASC
	</select>





	<select id="getMisAllotTmMbr1" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="kr.co.toplac.topstatistics.MisRegTmVO">
		SELECT tmMbr.user_no, tmMbr.user_name, tmMbr.team_id, getTopTmBscTeamName(tmMbr.team_id) team_name
			, reg_30, reg_29, reg_28, reg_27, reg_26, reg_25, reg_24, reg_23, reg_22, reg_21
			, reg_20, reg_19, reg_18, reg_17, reg_16, reg_15, reg_14, reg_13, reg_12, reg_11
			, reg_10, reg_9, reg_8, reg_7, reg_6, reg_5, reg_4, reg_3, reg_2, reg_1, reg_0
			, reg_y, cls_m, cls_y, reg_mi
		FROM
			(SELECT mbrBsc.team_id_main team_id, mbrBsc.user_no, mbrBsc.user_name
			FROM top_mbr_bsc mbrBsc
			WHERE mbrBsc.team_id_main = #{team_id}
			AND ((mbrBsc.user_state='1' AND mbrBsc.out_date >= UNIX_TIMESTAMP(#{dayBefore30}))
				OR (mbrBsc.user_state!='1' AND mbrBsc.join_date &lt; UNIX_TIMESTAMP(DATE_ADD(#{dayBefore0},INTERVAL 1 day))))
			ORDER BY mbrBsc.work_type, mbrBsc.work_level DESC, mbrBsc.user_no ASC) tmMbr
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_30
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore30})
						AND reg_date &lt; unix_timestamp(#{dayBefore29})
						GROUP BY user_no) a30 ON tmMbr.user_no = a30.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_29
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore29})
						AND reg_date &lt; unix_timestamp(#{dayBefore28})
						GROUP BY user_no) a29 ON tmMbr.user_no = a29.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_28
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore28})
						AND reg_date &lt; unix_timestamp(#{dayBefore27})
						GROUP BY user_no) a28 ON tmMbr.user_no = a28.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_27
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore27})
						AND reg_date &lt; unix_timestamp(#{dayBefore26})
						GROUP BY user_no) a27 ON tmMbr.user_no = a27.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_26
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore26})
						AND reg_date &lt; unix_timestamp(#{dayBefore25})
						GROUP BY user_no) a26 ON tmMbr.user_no = a26.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_25
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore25})
						AND reg_date &lt; unix_timestamp(#{dayBefore24})
						GROUP BY user_no) a25 ON tmMbr.user_no = a25.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_24
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore24})
						AND reg_date &lt; unix_timestamp(#{dayBefore23})
						GROUP BY user_no) a24 ON tmMbr.user_no = a24.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_23
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore23})
						AND reg_date &lt; unix_timestamp(#{dayBefore22})
						GROUP BY user_no) a23 ON tmMbr.user_no = a23.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_22
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore22})
						AND reg_date &lt; unix_timestamp(#{dayBefore21})
						GROUP BY user_no) a22 ON tmMbr.user_no = a22.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_21
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore21})
						AND reg_date &lt; unix_timestamp(#{dayBefore20})
						GROUP BY user_no) a21 ON tmMbr.user_no = a21.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_20
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore20})
						AND reg_date &lt; unix_timestamp(#{dayBefore19})
						GROUP BY user_no) a20 ON tmMbr.user_no = a20.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_19
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore19})
						AND reg_date &lt; unix_timestamp(#{dayBefore18})
						GROUP BY user_no) a19 ON tmMbr.user_no = a19.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_18
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore18})
						AND reg_date &lt; unix_timestamp(#{dayBefore17})
						GROUP BY user_no) a18 ON tmMbr.user_no = a18.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_17
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore17})
						AND reg_date &lt; unix_timestamp(#{dayBefore16})
						GROUP BY user_no) a17 ON tmMbr.user_no = a17.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_16
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore16})
						AND reg_date &lt; unix_timestamp(#{dayBefore15})
						GROUP BY user_no) a16 ON tmMbr.user_no = a16.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_15
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore15})
						AND reg_date &lt; unix_timestamp(#{dayBefore14})
						GROUP BY user_no) a15 ON tmMbr.user_no = a15.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_14
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore14})
						AND reg_date &lt; unix_timestamp(#{dayBefore13})
						GROUP BY user_no) a14 ON tmMbr.user_no = a14.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_13
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore13})
						AND reg_date &lt; unix_timestamp(#{dayBefore12})
						GROUP BY user_no) a13 ON tmMbr.user_no = a13.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_12
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore12})
						AND reg_date &lt; unix_timestamp(#{dayBefore11})
						GROUP BY user_no) a12 ON tmMbr.user_no = a12.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_11
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore11})
						AND reg_date &lt; unix_timestamp(#{dayBefore10})
						GROUP BY user_no) a11 ON tmMbr.user_no = a11.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_10
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore10})
						AND reg_date &lt; unix_timestamp(#{dayBefore9})
						GROUP BY user_no) a10 ON tmMbr.user_no = a10.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_9
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore9})
						AND reg_date &lt; unix_timestamp(#{dayBefore8})
						GROUP BY user_no) a9 ON tmMbr.user_no = a9.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_8
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore8})
						AND reg_date &lt; unix_timestamp(#{dayBefore7})
						GROUP BY user_no) a8 ON tmMbr.user_no = a8.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_7
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore7})
						AND reg_date &lt; unix_timestamp(#{dayBefore6})
						GROUP BY user_no) a7 ON tmMbr.user_no = a7.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_6
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore6})
						AND reg_date &lt; unix_timestamp(#{dayBefore5})
						GROUP BY user_no) a6 ON tmMbr.user_no = a6.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_5
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore5})
						AND reg_date &lt; unix_timestamp(#{dayBefore4})
						GROUP BY user_no) a5 ON tmMbr.user_no = a5.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_4
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore4})
						AND reg_date &lt; unix_timestamp(#{dayBefore3})
						GROUP BY user_no) a4 ON tmMbr.user_no = a4.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_3
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore3})
						AND reg_date &lt; unix_timestamp(#{dayBefore2})
						GROUP BY user_no) a3 ON tmMbr.user_no = a3.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_2
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore2})
						AND reg_date &lt; unix_timestamp(#{dayBefore1})
						GROUP BY user_no) a2 ON tmMbr.user_no = a2.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_1
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore1})
						AND reg_date &lt; unix_timestamp(#{dayBefore0})
						GROUP BY user_no) a1 ON tmMbr.user_no = a1.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_0
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state!='3'
						AND reg_date >= unix_timestamp(#{dayBefore0})
						GROUP BY user_no) a0 ON tmMbr.user_no = a0.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_y
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state &lt; '3'
						AND reg_date >= unix_timestamp(#{year_from})
						AND reg_date &lt; unix_timestamp(#{year_to})
						GROUP BY user_no) ayear ON tmMbr.user_no = ayear.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) cls_m
						FROM top_rpt_head
						WHERE 1=1
						AND close_date >= unix_timestamp(#{now_from})
						AND close_date &lt; unix_timestamp(#{now_to})
						GROUP BY user_no) bmonth ON tmMbr.user_no = bmonth.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) cls_y
						FROM top_rpt_head
						WHERE 1=1
						AND close_date >= unix_timestamp(#{year_from})
						AND close_date &lt; unix_timestamp(#{year_to})
						GROUP BY user_no) byear ON tmMbr.user_no = byear.user_no
			LEFT JOIN (SELECT user_no, count(suim_rpt_no) reg_mi
						FROM top_rpt_head
						WHERE 1=1
						AND suim_rpt_state in (0,1,11)
						GROUP BY user_no) ami ON tmMbr.user_no = ami.user_no
	</select>
	
	<!--      -->
	<select id="selectMisAllotTmTeam1PrimUserList" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT 
			SUM(GA.reg_30) AS reg_30, SUM(GA.reg_29) AS reg_29, SUM(GA.reg_28) AS reg_28, SUM(GA.reg_27) AS reg_27, SUM(GA.reg_26) AS reg_26
			,SUM(GA.reg_25) AS reg_25, SUM(GA.reg_24) AS reg_24, SUM(GA.reg_23) AS reg_23, SUM(GA.reg_22) AS reg_22, SUM(GA.reg_21) AS reg_21
			,SUM(GA.reg_20) AS reg_20, SUM(GA.reg_19) AS reg_19, SUM(GA.reg_18) AS reg_18, SUM(GA.reg_17) AS reg_17, SUM(GA.reg_16) AS reg_16
			,SUM(GA.reg_15) AS reg_15, SUM(GA.reg_14) AS reg_14, SUM(GA.reg_13) AS reg_13, SUM(GA.reg_12) AS reg_12, SUM(GA.reg_11) AS reg_11
			,SUM(GA.reg_10) AS reg_10, SUM(GA.reg_09) AS reg_09, SUM(GA.reg_08) AS reg_08, SUM(GA.reg_07) AS reg_07, SUM(GA.reg_06) AS reg_06
			,SUM(GA.reg_05) AS reg_05, SUM(GA.reg_04) AS reg_04, SUM(GA.reg_03) AS reg_03, SUM(GA.reg_02) AS reg_02, SUM(GA.reg_01) AS reg_01, SUM(GA.reg_00) AS reg_00
		
			,SUM(GA.day_30) AS day_30, SUM(GA.day_29) AS day_29, SUM(GA.day_28) AS day_28, SUM(GA.day_27) AS day_27, SUM(GA.day_26) AS day_26
			,SUM(GA.day_25) AS day_25, SUM(GA.day_24) AS day_24, SUM(GA.day_23) AS day_23, SUM(GA.day_22) AS day_22, SUM(GA.day_21) AS day_21
			,SUM(GA.day_20) AS day_20, SUM(GA.day_19) AS day_19, SUM(GA.day_18) AS day_18, SUM(GA.day_17) AS day_17, SUM(GA.day_16) AS day_16
			,SUM(GA.day_15) AS day_15, SUM(GA.day_14) AS day_14, SUM(GA.day_13) AS day_13, SUM(GA.day_12) AS day_12, SUM(GA.day_11) AS day_11
			,SUM(GA.day_10) AS day_10, SUM(GA.day_09) AS day_09, SUM(GA.day_08) AS day_08, SUM(GA.day_07) AS day_07, SUM(GA.day_06) AS day_06
			,SUM(GA.day_05) AS day_05, SUM(GA.day_04) AS day_04, SUM(GA.day_03) AS day_03, SUM(GA.day_02) AS day_02, SUM(GA.day_01) AS day_01, SUM(GA.day_00) AS day_00
		
			,SUM(GA.reg_y) AS reg_y, SUM(GA.cls_m) AS cls_m, SUM(GA.cls_y) AS cls_y, SUM(GA.reg_mi) AS reg_mi
		
		FROM (
			(
			
			SELECT 			
				COUNT(suim_rpt_no) AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore30})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore29})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,COUNT(suim_rpt_no) AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore29})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore28})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,COUNT(suim_rpt_no) AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore28})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore27})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,COUNT(suim_rpt_no) AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore27})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore26})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,COUNT(suim_rpt_no) AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore26})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore25})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,COUNT(suim_rpt_no) AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore25})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore24})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, COUNT(suim_rpt_no) AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore24})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore23})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,COUNT(suim_rpt_no) AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore23})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore22})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,COUNT(suim_rpt_no) AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore22})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore21})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, COUNT(suim_rpt_no) AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore21})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore20})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,COUNT(suim_rpt_no) AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore20})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore19})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,COUNT(suim_rpt_no) AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore19})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore18})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,COUNT(suim_rpt_no) AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore18})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore17})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,COUNT(suim_rpt_no) AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore17})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore16})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,COUNT(suim_rpt_no) AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore16})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore15})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,COUNT(suim_rpt_no) AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore15})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore14})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, COUNT(suim_rpt_no) AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore14})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore13})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,COUNT(suim_rpt_no) AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore13})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore12})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,COUNT(suim_rpt_no) AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore12})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore11})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, COUNT(suim_rpt_no) AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore11})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore10})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,COUNT(suim_rpt_no) AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore10})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore9})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,COUNT(suim_rpt_no) AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore9})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore8})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,COUNT(suim_rpt_no) AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore8})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore7})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,COUNT(suim_rpt_no) AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore7})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore6})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,COUNT(suim_rpt_no) AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore6})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore5})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,COUNT(suim_rpt_no) AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore5})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore4})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, COUNT(suim_rpt_no) AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore4})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore3})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,COUNT(suim_rpt_no) AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore3})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore2})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,COUNT(suim_rpt_no) AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore2})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore1})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, COUNT(suim_rpt_no) AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore1})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore0})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, COUNT(suim_rpt_no) AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore0})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,COUNT(suim_rpt_no) AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore30})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore29})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,COUNT(suim_rpt_no) AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore29})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore28})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,COUNT(suim_rpt_no) AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore28})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore27})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,COUNT(suim_rpt_no) AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore27})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore26})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,COUNT(suim_rpt_no) AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore26})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore25})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,COUNT(suim_rpt_no) AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore25})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore24})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, COUNT(suim_rpt_no) AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore24})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore23})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,COUNT(suim_rpt_no) AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore23})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore22})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,COUNT(suim_rpt_no) AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore22})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore21})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, COUNT(suim_rpt_no) AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore21})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore20})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,COUNT(suim_rpt_no) AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore20})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore19})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,COUNT(suim_rpt_no) AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore19})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore18})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,COUNT(suim_rpt_no) AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore18})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore17})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,COUNT(suim_rpt_no) AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore17})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore16})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,COUNT(suim_rpt_no) AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore16})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore15})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,COUNT(suim_rpt_no) AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore15})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore14})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, COUNT(suim_rpt_no) AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore14})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore13})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,COUNT(suim_rpt_no) AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore13})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore12})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,COUNT(suim_rpt_no) AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore12})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore11})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, COUNT(suim_rpt_no) AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore11})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore10})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,COUNT(suim_rpt_no) AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore10})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore9})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,COUNT(suim_rpt_no) AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore9})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore8})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,COUNT(suim_rpt_no) AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore8})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore7})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,COUNT(suim_rpt_no) AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore7})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore6})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,COUNT(suim_rpt_no) AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore6})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore5})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,COUNT(suim_rpt_no) AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore5})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore4})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, COUNT(suim_rpt_no) AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore4})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore3})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,COUNT(suim_rpt_no) AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore3})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore2})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,COUNT(suim_rpt_no) AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore2})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore1})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, COUNT(suim_rpt_no) AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore1})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore0})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, COUNT(suim_rpt_no) AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore0})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,COUNT(suim_rpt_no) AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state &lt; 2
			AND reg_date >= UNIX_TIMESTAMP(#{year_from})
			AND reg_date &lt; UNIX_TIMESTAMP(#{year_to})
			AND user_no = #{user_no}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, COUNT(suim_rpt_no) AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state &lt; 2
			AND close_date >= UNIX_TIMESTAMP(#{now_from})
			AND close_date &lt; UNIX_TIMESTAMP(#{now_to})
			AND user_no = #{user_no}
			
		   	) UNION ALL (	
		   	
		   	SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, COUNT(suim_rpt_no) AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND reg_date >= UNIX_TIMESTAMP(#{year_from})
			AND reg_date &lt; UNIX_TIMESTAMP(#{year_to})
			AND user_no = #{user_no}	
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, COUNT(suim_rpt_no) AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state IN (0,1,11)			
			AND user_no = #{user_no}
			)
		)GA
	
	</select>
	
	<!--     -->
	<select id="selectMisAllotTmTeam1PrimList" parameterType="kr.co.toplac.topstatistics.StatisticsNowVO" resultType="AsraMap">
		SELECT 
			SUM(GA.reg_30) AS reg_30, SUM(GA.reg_29) AS reg_29, SUM(GA.reg_28) AS reg_28, SUM(GA.reg_27) AS reg_27, SUM(GA.reg_26) AS reg_26
			,SUM(GA.reg_25) AS reg_25, SUM(GA.reg_24) AS reg_24, SUM(GA.reg_23) AS reg_23, SUM(GA.reg_22) AS reg_22, SUM(GA.reg_21) AS reg_21
			,SUM(GA.reg_20) AS reg_20, SUM(GA.reg_19) AS reg_19, SUM(GA.reg_18) AS reg_18, SUM(GA.reg_17) AS reg_17, SUM(GA.reg_16) AS reg_16
			,SUM(GA.reg_15) AS reg_15, SUM(GA.reg_14) AS reg_14, SUM(GA.reg_13) AS reg_13, SUM(GA.reg_12) AS reg_12, SUM(GA.reg_11) AS reg_11
			,SUM(GA.reg_10) AS reg_10, SUM(GA.reg_09) AS reg_09, SUM(GA.reg_08) AS reg_08, SUM(GA.reg_07) AS reg_07, SUM(GA.reg_06) AS reg_06
			,SUM(GA.reg_05) AS reg_05, SUM(GA.reg_04) AS reg_04, SUM(GA.reg_03) AS reg_03, SUM(GA.reg_02) AS reg_02, SUM(GA.reg_01) AS reg_01, SUM(GA.reg_00) AS reg_00
		
			,SUM(GA.day_30) AS day_30, SUM(GA.day_29) AS day_29, SUM(GA.day_28) AS day_28, SUM(GA.day_27) AS day_27, SUM(GA.day_26) AS day_26
			,SUM(GA.day_25) AS day_25, SUM(GA.day_24) AS day_24, SUM(GA.day_23) AS day_23, SUM(GA.day_22) AS day_22, SUM(GA.day_21) AS day_21
			,SUM(GA.day_20) AS day_20, SUM(GA.day_19) AS day_19, SUM(GA.day_18) AS day_18, SUM(GA.day_17) AS day_17, SUM(GA.day_16) AS day_16
			,SUM(GA.day_15) AS day_15, SUM(GA.day_14) AS day_14, SUM(GA.day_13) AS day_13, SUM(GA.day_12) AS day_12, SUM(GA.day_11) AS day_11
			,SUM(GA.day_10) AS day_10, SUM(GA.day_09) AS day_09, SUM(GA.day_08) AS day_08, SUM(GA.day_07) AS day_07, SUM(GA.day_06) AS day_06
			,SUM(GA.day_05) AS day_05, SUM(GA.day_04) AS day_04, SUM(GA.day_03) AS day_03, SUM(GA.day_02) AS day_02, SUM(GA.day_01) AS day_01, SUM(GA.day_00) AS day_00
		
			,SUM(GA.reg_y) AS reg_y, SUM(GA.cls_m) AS cls_m, SUM(GA.cls_y) AS cls_y, SUM(GA.reg_mi) AS reg_mi
		
		FROM (
			(
			
			SELECT 			
				COUNT(suim_rpt_no) AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore30})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore29})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,COUNT(suim_rpt_no) AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore29})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore28})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,COUNT(suim_rpt_no) AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore28})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore27})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,COUNT(suim_rpt_no) AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore27})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore26})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,COUNT(suim_rpt_no) AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore26})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore25})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,COUNT(suim_rpt_no) AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore25})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore24})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, COUNT(suim_rpt_no) AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore24})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore23})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,COUNT(suim_rpt_no) AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore23})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore22})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,COUNT(suim_rpt_no) AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore22})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore21})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, COUNT(suim_rpt_no) AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore21})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore20})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,COUNT(suim_rpt_no) AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore20})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore19})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,COUNT(suim_rpt_no) AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore19})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore18})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,COUNT(suim_rpt_no) AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore18})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore17})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,COUNT(suim_rpt_no) AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore17})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore16})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,COUNT(suim_rpt_no) AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore16})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore15})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,COUNT(suim_rpt_no) AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore15})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore14})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, COUNT(suim_rpt_no) AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore14})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore13})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,COUNT(suim_rpt_no) AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore13})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore12})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,COUNT(suim_rpt_no) AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore12})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore11})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, COUNT(suim_rpt_no) AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore11})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore10})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,COUNT(suim_rpt_no) AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore10})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore9})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,COUNT(suim_rpt_no) AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore9})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore8})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,COUNT(suim_rpt_no) AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore8})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore7})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,COUNT(suim_rpt_no) AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore7})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore6})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,COUNT(suim_rpt_no) AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore6})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore5})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,COUNT(suim_rpt_no) AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore5})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore4})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, COUNT(suim_rpt_no) AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore4})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore3})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,COUNT(suim_rpt_no) AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore3})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore2})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,COUNT(suim_rpt_no) AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore2})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore1})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, COUNT(suim_rpt_no) AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore1})
			AND reg_date &lt; UNIX_TIMESTAMP(#{dayBefore0})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, COUNT(suim_rpt_no) AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state != 3
			AND reg_date >= UNIX_TIMESTAMP(#{dayBefore0})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,COUNT(suim_rpt_no) AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore30})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore29})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,COUNT(suim_rpt_no) AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore29})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore28})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,COUNT(suim_rpt_no) AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore28})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore27})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,COUNT(suim_rpt_no) AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore27})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore26})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,COUNT(suim_rpt_no) AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore26})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore25})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,COUNT(suim_rpt_no) AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore25})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore24})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, COUNT(suim_rpt_no) AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore24})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore23})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,COUNT(suim_rpt_no) AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore23})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore22})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,COUNT(suim_rpt_no) AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore22})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore21})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, COUNT(suim_rpt_no) AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore21})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore20})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,COUNT(suim_rpt_no) AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore20})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore19})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,COUNT(suim_rpt_no) AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore19})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore18})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,COUNT(suim_rpt_no) AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore18})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore17})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,COUNT(suim_rpt_no) AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore17})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore16})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,COUNT(suim_rpt_no) AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore16})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore15})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,COUNT(suim_rpt_no) AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore15})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore14})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, COUNT(suim_rpt_no) AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore14})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore13})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,COUNT(suim_rpt_no) AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore13})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore12})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,COUNT(suim_rpt_no) AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore12})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore11})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, COUNT(suim_rpt_no) AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore11})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore10})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,COUNT(suim_rpt_no) AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore10})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore9})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,COUNT(suim_rpt_no) AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore9})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore8})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,COUNT(suim_rpt_no) AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi				
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore8})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore7})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,COUNT(suim_rpt_no) AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore7})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore6})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,COUNT(suim_rpt_no) AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore6})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore5})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,COUNT(suim_rpt_no) AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore5})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore4})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, COUNT(suim_rpt_no) AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore4})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore3})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,COUNT(suim_rpt_no) AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore3})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore2})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,COUNT(suim_rpt_no) AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore2})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore1})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, COUNT(suim_rpt_no) AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore1})
			AND close_date &lt; UNIX_TIMESTAMP(#{dayBefore0})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, COUNT(suim_rpt_no) AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND close_date >= UNIX_TIMESTAMP(#{dayBefore0})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,COUNT(suim_rpt_no) AS reg_y, 0 AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state &lt; 2
			AND reg_date >= UNIX_TIMESTAMP(#{year_from})
			AND reg_date &lt; UNIX_TIMESTAMP(#{year_to})
			AND team_id = #{team_id}
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, COUNT(suim_rpt_no) AS cls_m, 0 AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state &lt; 2
			AND close_date >= UNIX_TIMESTAMP(#{now_from})
			AND close_date &lt; UNIX_TIMESTAMP(#{now_to})
			AND team_id = #{team_id}
			
		   	) UNION ALL (	
		   	
		   	SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, COUNT(suim_rpt_no) AS cls_y, 0 AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state = 2
			AND reg_date >= UNIX_TIMESTAMP(#{year_from})
			AND reg_date &lt; UNIX_TIMESTAMP(#{year_to})
			AND team_id = #{team_id}	
		   		
			) UNION ALL (
			
			SELECT 			
				0 AS reg_30,0 AS reg_29,0 AS reg_28,0 AS reg_27,0 AS reg_26,0 AS reg_25, 0 AS reg_24,0 AS reg_23,0 AS reg_22, 0 AS reg_21
				,0 AS reg_20,0 AS reg_19,0 AS reg_18,0 AS reg_17,0 AS reg_16,0 AS reg_15, 0 AS reg_14,0 AS reg_13,0 AS reg_12, 0 AS reg_11
				,0 AS reg_10,0 AS reg_09,0 AS reg_08,0 AS reg_07,0 AS reg_06,0 AS reg_05, 0 AS reg_04,0 AS reg_03,0 AS reg_02, 0 AS reg_01, 0 AS reg_00
											
				,0 AS day_30,0 AS day_29,0 AS day_28,0 AS day_27,0 AS day_26,0 AS day_25, 0 AS day_24,0 AS day_23,0 AS day_22, 0 AS day_21
				,0 AS day_20,0 AS day_19,0 AS day_18,0 AS day_17,0 AS day_16,0 AS day_15, 0 AS day_14,0 AS day_13,0 AS day_12, 0 AS day_11
				,0 AS day_10,0 AS day_09,0 AS day_08,0 AS day_07,0 AS day_06,0 AS day_05, 0 AS day_04,0 AS day_03,0 AS day_02, 0 AS day_01, 0 AS day_00
											
				,0 AS reg_y, 0 AS cls_m, 0 AS cls_y, COUNT(suim_rpt_no) AS reg_mi
				
			FROM top_prim_biz_rpt_head
			WHERE suim_rpt_type1 = 5
			AND suim_rpt_state IN (0,1,11)			
			AND team_id = #{team_id}
			)
		)GA
	
	</select>
	
	
	<!--       -->
	<select id="selectMisAllotTmTeam1WrittenList" parameterType="hashmap" resultType="AsraMap">
		SELECT
			GA.month_end_cnt AS cls_m
			,IFNULL(SUM(GA.year_suim_cnt),0) AS reg_y			
			,IFNULL(SUM(GA.year_end_cnt),0) AS cls_y
			,IFNULL(SUM(GA.unsolve_cnt),0) AS reg_mi
			,IFNULL(SUM(GA.reg02),0) AS reg02
			,IFNULL(SUM(GA.reg03),0) AS reg03
			,IFNULL(SUM(GA.reg04),0) AS reg04
			,IFNULL(SUM(GA.reg05),0) AS reg05
			,IFNULL(SUM(GA.reg06),0) AS reg06
			,IFNULL(SUM(GA.reg07),0) AS reg07
			,IFNULL(SUM(GA.reg08),0) AS reg08
			,IFNULL(SUM(GA.reg09),0) AS reg09
			,IFNULL(SUM(GA.reg10),0) AS reg10
			,IFNULL(SUM(GA.reg11),0) AS reg11
			,IFNULL(SUM(GA.reg12),0) AS reg12
			,IFNULL(SUM(GA.reg13),0) AS reg13
			,IFNULL(SUM(GA.reg14),0) AS reg14
			,IFNULL(SUM(GA.reg15),0) AS reg15
			,IFNULL(SUM(GA.reg16),0) AS reg16
			,IFNULL(SUM(GA.reg17),0) AS reg17
			,IFNULL(SUM(GA.reg18),0) AS reg18
			,IFNULL(SUM(GA.reg19),0) AS reg19
			,IFNULL(SUM(GA.reg20),0) AS reg20
			,IFNULL(SUM(GA.reg21),0) AS reg21
			,IFNULL(SUM(GA.reg22),0) AS reg22
			,IFNULL(SUM(GA.reg23),0) AS reg23
			,IFNULL(SUM(GA.reg24),0) AS reg24
			,IFNULL(SUM(GA.reg25),0) AS reg25
			,IFNULL(SUM(GA.reg26),0) AS reg26
			,IFNULL(SUM(GA.reg27),0) AS reg27
			,IFNULL(SUM(GA.reg28),0) AS reg28
			,IFNULL(SUM(GA.reg29),0) AS reg29
			,IFNULL(SUM(GA.reg30),0) AS reg30
			,IFNULL(SUM(GA.reg31),0) AS reg31
		
			,IFNULL(SUM(GA.day02),0) AS day02
			,IFNULL(SUM(GA.day03),0) AS day03
			,IFNULL(SUM(GA.day04),0) AS day04
			,IFNULL(SUM(GA.day05),0) AS day05
			,IFNULL(SUM(GA.day06),0) AS day06
			,IFNULL(SUM(GA.day07),0) AS day07
			,IFNULL(SUM(GA.day08),0) AS day08
			,IFNULL(SUM(GA.day09),0) AS day09
			,IFNULL(SUM(GA.day10),0) AS day10
			,IFNULL(SUM(GA.day11),0) AS day11
			,IFNULL(SUM(GA.day12),0) AS day12
			,IFNULL(SUM(GA.day13),0) AS day13
			,IFNULL(SUM(GA.day14),0) AS day14
			,IFNULL(SUM(GA.day15),0) AS day15
			,IFNULL(SUM(GA.day16),0) AS day16
			,IFNULL(SUM(GA.day17),0) AS day17
			,IFNULL(SUM(GA.day18),0) AS day18
			,IFNULL(SUM(GA.day19),0) AS day19
			,IFNULL(SUM(GA.day20),0) AS day20
			,IFNULL(SUM(GA.day21),0) AS day21
			,IFNULL(SUM(GA.day22),0) AS day22
			,IFNULL(SUM(GA.day23),0) AS day23
			,IFNULL(SUM(GA.day24),0) AS day24
			,IFNULL(SUM(GA.day25),0) AS day25
			,IFNULL(SUM(GA.day26),0) AS day26
			,IFNULL(SUM(GA.day27),0) AS day27
			,IFNULL(SUM(GA.day28),0) AS day28
			,IFNULL(SUM(GA.day29),0) AS day29
			,IFNULL(SUM(GA.day30),0) AS day30
			,IFNULL(SUM(GA.day31),0) AS day31
		
		FROM
		(
			(
		
			SELECT 
				IFNULL(SUM(end_cnt),0) AS month_end_cnt
				,0 AS year_suim_cnt
				,0 AS year_cancel_cnt
				,0 AS year_end_cnt
				,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
		
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date >= #{now_from}
			AND base_date &lt;= #{now_to}
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt
				,IFNULL(SUM(suim_cnt),0) AS year_suim_cnt
				,IFNULL(SUM(cancel_cnt),0) AS year_cancel_cnt
				,IFNULL(SUM(end_cnt),0) AS year_end_cnt
				,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
		
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date > #{bgnYearDe}
			AND base_date &lt;= #{endYearDe}
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt
				,IFNULL(SUM(SB.unsolve_cnt),0) AS unsolve_cnt
				,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
		
			FROM
		
				(
		
					SELECT
						SA.unsolve_cnt
						,SA.user_no	
					FROM
						(
							SELECT		
								unsolve_cnt
								,user_no		
							FROM top_rpt_written_info
							WHERE 1=1	
							AND team_id = #{team_id}
							ORDER BY base_date DESC
						)SA
					GROUP BY user_no
				)SB
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt
				,suim_cnt AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,end_cnt AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,suim_cnt AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,end_cnt AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,suim_cnt AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,end_cnt AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,suim_cnt AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,end_cnt AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,suim_cnt AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,end_cnt AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,suim_cnt AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,end_cnt AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,suim_cnt AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,end_cnt AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,suim_cnt AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,end_cnt AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,suim_cnt AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,end_cnt AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,suim_cnt AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,end_cnt AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,suim_cnt AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,end_cnt AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,suim_cnt AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,end_cnt AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,suim_cnt AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,end_cnt AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,suim_cnt AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,end_cnt AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,suim_cnt AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,end_cnt AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,suim_cnt AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,end_cnt AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,suim_cnt AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,end_cnt AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,suim_cnt AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,end_cnt AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,suim_cnt AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,end_cnt AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,suim_cnt AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,end_cnt AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,suim_cnt AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,end_cnt AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 9 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,suim_cnt AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,end_cnt AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 8 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,suim_cnt AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,end_cnt AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 7 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,suim_cnt AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,end_cnt AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 6 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,suim_cnt AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,end_cnt AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 5 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,suim_cnt AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,end_cnt AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 4 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,suim_cnt AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,end_cnt AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 3 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,suim_cnt AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,end_cnt AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 2 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,suim_cnt AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,end_cnt AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 1 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,suim_cnt AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,end_cnt AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 0 DAY),'%Y-%m-%d')
		
			)
		
		)GA
	</select>
	
	
	<!--      -->
	<select id="selectMisAllotTmTeam1WrittenList_20200518" parameterType="hashmap" resultType="AsraMap">
		SELECT
			GA.month_end_cnt AS cls_m
			,(IFNULL(SUM(GA.year_suim_cnt),0) - IFNULL(SUM(GA.year_cancel_cnt),0) ) AS reg_y			
			,IFNULL(SUM(GA.year_end_cnt),0) AS cls_y
			,IFNULL(SUM(GA.unsolve_cnt),0) AS reg_mi
			,IFNULL(SUM(GA.reg02),0) AS reg02
			,IFNULL(SUM(GA.reg03),0) AS reg03
			,IFNULL(SUM(GA.reg04),0) AS reg04
			,IFNULL(SUM(GA.reg05),0) AS reg05
			,IFNULL(SUM(GA.reg06),0) AS reg06
			,IFNULL(SUM(GA.reg07),0) AS reg07
			,IFNULL(SUM(GA.reg08),0) AS reg08
			,IFNULL(SUM(GA.reg09),0) AS reg09
			,IFNULL(SUM(GA.reg10),0) AS reg10
			,IFNULL(SUM(GA.reg11),0) AS reg11
			,IFNULL(SUM(GA.reg12),0) AS reg12
			,IFNULL(SUM(GA.reg13),0) AS reg13
			,IFNULL(SUM(GA.reg14),0) AS reg14
			,IFNULL(SUM(GA.reg15),0) AS reg15
			,IFNULL(SUM(GA.reg16),0) AS reg16
			,IFNULL(SUM(GA.reg17),0) AS reg17
			,IFNULL(SUM(GA.reg18),0) AS reg18
			,IFNULL(SUM(GA.reg19),0) AS reg19
			,IFNULL(SUM(GA.reg20),0) AS reg20
			,IFNULL(SUM(GA.reg21),0) AS reg21
			,IFNULL(SUM(GA.reg22),0) AS reg22
			,IFNULL(SUM(GA.reg23),0) AS reg23
			,IFNULL(SUM(GA.reg24),0) AS reg24
			,IFNULL(SUM(GA.reg25),0) AS reg25
			,IFNULL(SUM(GA.reg26),0) AS reg26
			,IFNULL(SUM(GA.reg27),0) AS reg27
			,IFNULL(SUM(GA.reg28),0) AS reg28
			,IFNULL(SUM(GA.reg29),0) AS reg29
			,IFNULL(SUM(GA.reg30),0) AS reg30
			,IFNULL(SUM(GA.reg31),0) AS reg31
		
			,IFNULL(SUM(GA.day02),0) AS day02
			,IFNULL(SUM(GA.day03),0) AS day03
			,IFNULL(SUM(GA.day04),0) AS day04
			,IFNULL(SUM(GA.day05),0) AS day05
			,IFNULL(SUM(GA.day06),0) AS day06
			,IFNULL(SUM(GA.day07),0) AS day07
			,IFNULL(SUM(GA.day08),0) AS day08
			,IFNULL(SUM(GA.day09),0) AS day09
			,IFNULL(SUM(GA.day10),0) AS day10
			,IFNULL(SUM(GA.day11),0) AS day11
			,IFNULL(SUM(GA.day12),0) AS day12
			,IFNULL(SUM(GA.day13),0) AS day13
			,IFNULL(SUM(GA.day14),0) AS day14
			,IFNULL(SUM(GA.day15),0) AS day15
			,IFNULL(SUM(GA.day16),0) AS day16
			,IFNULL(SUM(GA.day17),0) AS day17
			,IFNULL(SUM(GA.day18),0) AS day18
			,IFNULL(SUM(GA.day19),0) AS day19
			,IFNULL(SUM(GA.day20),0) AS day20
			,IFNULL(SUM(GA.day21),0) AS day21
			,IFNULL(SUM(GA.day22),0) AS day22
			,IFNULL(SUM(GA.day23),0) AS day23
			,IFNULL(SUM(GA.day24),0) AS day24
			,IFNULL(SUM(GA.day25),0) AS day25
			,IFNULL(SUM(GA.day26),0) AS day26
			,IFNULL(SUM(GA.day27),0) AS day27
			,IFNULL(SUM(GA.day28),0) AS day28
			,IFNULL(SUM(GA.day29),0) AS day29
			,IFNULL(SUM(GA.day30),0) AS day30
			,IFNULL(SUM(GA.day31),0) AS day31
		
		FROM
		(
			(
		
			SELECT 
				IFNULL(SUM(end_cnt),0) AS month_end_cnt
				,0 AS year_suim_cnt
				,0 AS year_cancel_cnt
				,0 AS year_end_cnt
				,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
		
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date > #{bgnDe}
			AND base_date &lt;= #{endDe}
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt
				,IFNULL(SUM(suim_cnt),0) AS year_suim_cnt
				,IFNULL(SUM(cancel_cnt),0) AS year_cancel_cnt
				,IFNULL(SUM(end_cnt),0) AS year_end_cnt
				,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
		
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date > #{bgnYearDe}
			AND base_date &lt;= #{endYearDe}
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt
				,IFNULL(SUM(SB.unsolve_cnt),0) AS unsolve_cnt
				,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
		
			FROM
		
				(
		
					SELECT
						SA.unsolve_cnt
						,SA.user_no	
					FROM
						(
							SELECT		
								unsolve_cnt
								,user_no		
							FROM top_rpt_written_info
							WHERE 1=1	
							AND team_id = #{team_id}
							ORDER BY base_date DESC
						)SA
					GROUP BY user_no
				)SB
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt
				,(suim_cnt-cancel_cnt) AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,end_cnt AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,(suim_cnt-cancel_cnt) AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,end_cnt AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,(suim_cnt-cancel_cnt) AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,end_cnt AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,(suim_cnt-cancel_cnt) AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,end_cnt AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,(suim_cnt-cancel_cnt) AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,end_cnt AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,(suim_cnt-cancel_cnt) AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,end_cnt AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,(suim_cnt-cancel_cnt) AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,end_cnt AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,(suim_cnt-cancel_cnt) AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,end_cnt AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,(suim_cnt-cancel_cnt) AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,end_cnt AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,(suim_cnt-cancel_cnt) AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,end_cnt AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,(suim_cnt-cancel_cnt) AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,end_cnt AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,(suim_cnt-cancel_cnt) AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,end_cnt AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,(suim_cnt-cancel_cnt) AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,end_cnt AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,(suim_cnt-cancel_cnt) AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,end_cnt AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,(suim_cnt-cancel_cnt) AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,end_cnt AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,(suim_cnt-cancel_cnt) AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,end_cnt AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,(suim_cnt-cancel_cnt) AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,end_cnt AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,(suim_cnt-cancel_cnt) AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,end_cnt AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,(suim_cnt-cancel_cnt) AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,end_cnt AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,(suim_cnt-cancel_cnt) AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,end_cnt AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,(suim_cnt-cancel_cnt) AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,end_cnt AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 9 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,(suim_cnt-cancel_cnt) AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,end_cnt AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 8 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,(suim_cnt-cancel_cnt) AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,end_cnt AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 7 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,(suim_cnt-cancel_cnt) AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,end_cnt AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 6 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,(suim_cnt-cancel_cnt) AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,end_cnt AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 5 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,(suim_cnt-cancel_cnt) AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,end_cnt AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 4 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,(suim_cnt-cancel_cnt) AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,end_cnt AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 3 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,(suim_cnt-cancel_cnt) AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,end_cnt AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 2 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,(suim_cnt-cancel_cnt) AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,end_cnt AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 1 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,(suim_cnt-cancel_cnt) AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,end_cnt AS day31
				
			FROM top_rpt_written_info
			WHERE team_id = #{team_id}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 0 DAY),'%Y-%m-%d')
		
			)
		
		)GA
	</select>

	<!--        -->
	<select id="selectMisAllotTmMbr1WrittenList" parameterType="hashmap" resultType="AsraMap">
		SELECT
			GA.month_end_cnt AS clsMonthCnt
			,IFNULL(SUM(GA.year_suim_cnt),0) AS regYearCnt
			,IFNULL(SUM(GA.year_end_cnt),0) AS clsYearCnt
			,IFNULL(SUM(GA.unsolve_cnt),0) AS pendingCnt
			,IFNULL(SUM(GA.reg02),0) AS reg02
			,IFNULL(SUM(GA.reg03),0) AS reg03
			,IFNULL(SUM(GA.reg04),0) AS reg04
			,IFNULL(SUM(GA.reg05),0) AS reg05
			,IFNULL(SUM(GA.reg06),0) AS reg06
			,IFNULL(SUM(GA.reg07),0) AS reg07
			,IFNULL(SUM(GA.reg08),0) AS reg08
			,IFNULL(SUM(GA.reg09),0) AS reg09
			,IFNULL(SUM(GA.reg10),0) AS reg10
			,IFNULL(SUM(GA.reg11),0) AS reg11
			,IFNULL(SUM(GA.reg12),0) AS reg12
			,IFNULL(SUM(GA.reg13),0) AS reg13
			,IFNULL(SUM(GA.reg14),0) AS reg14
			,IFNULL(SUM(GA.reg15),0) AS reg15
			,IFNULL(SUM(GA.reg16),0) AS reg16
			,IFNULL(SUM(GA.reg17),0) AS reg17
			,IFNULL(SUM(GA.reg18),0) AS reg18
			,IFNULL(SUM(GA.reg19),0) AS reg19
			,IFNULL(SUM(GA.reg20),0) AS reg20
			,IFNULL(SUM(GA.reg21),0) AS reg21
			,IFNULL(SUM(GA.reg22),0) AS reg22
			,IFNULL(SUM(GA.reg23),0) AS reg23
			,IFNULL(SUM(GA.reg24),0) AS reg24
			,IFNULL(SUM(GA.reg25),0) AS reg25
			,IFNULL(SUM(GA.reg26),0) AS reg26
			,IFNULL(SUM(GA.reg27),0) AS reg27
			,IFNULL(SUM(GA.reg28),0) AS reg28
			,IFNULL(SUM(GA.reg29),0) AS reg29
			,IFNULL(SUM(GA.reg30),0) AS reg30
			,IFNULL(SUM(GA.reg31),0) AS reg31
		
			,IFNULL(SUM(GA.day02),0) AS day02
			,IFNULL(SUM(GA.day03),0) AS day03
			,IFNULL(SUM(GA.day04),0) AS day04
			,IFNULL(SUM(GA.day05),0) AS day05
			,IFNULL(SUM(GA.day06),0) AS day06
			,IFNULL(SUM(GA.day07),0) AS day07
			,IFNULL(SUM(GA.day08),0) AS day08
			,IFNULL(SUM(GA.day09),0) AS day09
			,IFNULL(SUM(GA.day10),0) AS day10
			,IFNULL(SUM(GA.day11),0) AS day11
			,IFNULL(SUM(GA.day12),0) AS day12
			,IFNULL(SUM(GA.day13),0) AS day13
			,IFNULL(SUM(GA.day14),0) AS day14
			,IFNULL(SUM(GA.day15),0) AS day15
			,IFNULL(SUM(GA.day16),0) AS day16
			,IFNULL(SUM(GA.day17),0) AS day17
			,IFNULL(SUM(GA.day18),0) AS day18
			,IFNULL(SUM(GA.day19),0) AS day19
			,IFNULL(SUM(GA.day20),0) AS day20
			,IFNULL(SUM(GA.day21),0) AS day21
			,IFNULL(SUM(GA.day22),0) AS day22
			,IFNULL(SUM(GA.day23),0) AS day23
			,IFNULL(SUM(GA.day24),0) AS day24
			,IFNULL(SUM(GA.day25),0) AS day25
			,IFNULL(SUM(GA.day26),0) AS day26
			,IFNULL(SUM(GA.day27),0) AS day27
			,IFNULL(SUM(GA.day28),0) AS day28
			,IFNULL(SUM(GA.day29),0) AS day29
			,IFNULL(SUM(GA.day30),0) AS day30
			,IFNULL(SUM(GA.day31),0) AS day31
		
		FROM
		(
			(
		
			SELECT 
				IFNULL(SUM(end_cnt),0) AS month_end_cnt
				,0 AS year_suim_cnt
				,0 AS year_cancel_cnt
				,0 AS year_end_cnt
				,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
		
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date >= #{now_from}
			AND base_date &lt;= #{now_to}
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt
				,IFNULL(SUM(suim_cnt),0) AS year_suim_cnt
				,IFNULL(SUM(cancel_cnt),0) AS year_cancel_cnt
				,IFNULL(SUM(end_cnt),0) AS year_end_cnt
				,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
		
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date > #{bgnYearDe}
			AND base_date &lt;= #{endYearDe}
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt
				,unsolve_cnt
				,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
		
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			ORDER BY base_date DESC LIMIT 1
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt
				,suim_cnt AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,end_cnt AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,suim_cnt AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,end_cnt AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,suim_cnt AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,end_cnt AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,suim_cnt AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,end_cnt AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,suim_cnt AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,end_cnt AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,suim_cnt AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,end_cnt AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,suim_cnt AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,end_cnt AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,suim_cnt AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,end_cnt AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,suim_cnt AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,end_cnt AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,suim_cnt AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,end_cnt AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,suim_cnt AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,end_cnt AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,suim_cnt AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,end_cnt AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,suim_cnt AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,end_cnt AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,suim_cnt AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,end_cnt AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,suim_cnt AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,end_cnt AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,suim_cnt AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,end_cnt AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,suim_cnt AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,end_cnt AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,suim_cnt AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,end_cnt AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,suim_cnt AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,end_cnt AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,suim_cnt AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,end_cnt AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,suim_cnt AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,end_cnt AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 9 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,suim_cnt AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,end_cnt AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 8 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,suim_cnt AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,end_cnt AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 7 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,suim_cnt AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,end_cnt AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 6 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,suim_cnt AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,end_cnt AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 5 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,suim_cnt AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,end_cnt AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 4 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,suim_cnt AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,end_cnt AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 3 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,suim_cnt AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,end_cnt AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 2 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,suim_cnt AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,end_cnt AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 1 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,suim_cnt AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,end_cnt AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 0 DAY),'%Y-%m-%d')
		
			)
		
		)GA
	</select>
		
	
	<!--     -->
	<select id="selectMisAllotTmMbr1WrittenList_20200518" parameterType="hashmap" resultType="AsraMap">
		SELECT
			GA.month_end_cnt AS clsMonthCnt
			,(IFNULL(SUM(GA.year_suim_cnt),0) - IFNULL(SUM(GA.year_cancel_cnt),0) ) AS regYearCnt
			,IFNULL(SUM(GA.year_end_cnt),0) AS clsYearCnt
			,IFNULL(SUM(GA.unsolve_cnt),0) AS pendingCnt
			,IFNULL(SUM(GA.reg02),0) AS reg02
			,IFNULL(SUM(GA.reg03),0) AS reg03
			,IFNULL(SUM(GA.reg04),0) AS reg04
			,IFNULL(SUM(GA.reg05),0) AS reg05
			,IFNULL(SUM(GA.reg06),0) AS reg06
			,IFNULL(SUM(GA.reg07),0) AS reg07
			,IFNULL(SUM(GA.reg08),0) AS reg08
			,IFNULL(SUM(GA.reg09),0) AS reg09
			,IFNULL(SUM(GA.reg10),0) AS reg10
			,IFNULL(SUM(GA.reg11),0) AS reg11
			,IFNULL(SUM(GA.reg12),0) AS reg12
			,IFNULL(SUM(GA.reg13),0) AS reg13
			,IFNULL(SUM(GA.reg14),0) AS reg14
			,IFNULL(SUM(GA.reg15),0) AS reg15
			,IFNULL(SUM(GA.reg16),0) AS reg16
			,IFNULL(SUM(GA.reg17),0) AS reg17
			,IFNULL(SUM(GA.reg18),0) AS reg18
			,IFNULL(SUM(GA.reg19),0) AS reg19
			,IFNULL(SUM(GA.reg20),0) AS reg20
			,IFNULL(SUM(GA.reg21),0) AS reg21
			,IFNULL(SUM(GA.reg22),0) AS reg22
			,IFNULL(SUM(GA.reg23),0) AS reg23
			,IFNULL(SUM(GA.reg24),0) AS reg24
			,IFNULL(SUM(GA.reg25),0) AS reg25
			,IFNULL(SUM(GA.reg26),0) AS reg26
			,IFNULL(SUM(GA.reg27),0) AS reg27
			,IFNULL(SUM(GA.reg28),0) AS reg28
			,IFNULL(SUM(GA.reg29),0) AS reg29
			,IFNULL(SUM(GA.reg30),0) AS reg30
			,IFNULL(SUM(GA.reg31),0) AS reg31
		
			,IFNULL(SUM(GA.day02),0) AS day02
			,IFNULL(SUM(GA.day03),0) AS day03
			,IFNULL(SUM(GA.day04),0) AS day04
			,IFNULL(SUM(GA.day05),0) AS day05
			,IFNULL(SUM(GA.day06),0) AS day06
			,IFNULL(SUM(GA.day07),0) AS day07
			,IFNULL(SUM(GA.day08),0) AS day08
			,IFNULL(SUM(GA.day09),0) AS day09
			,IFNULL(SUM(GA.day10),0) AS day10
			,IFNULL(SUM(GA.day11),0) AS day11
			,IFNULL(SUM(GA.day12),0) AS day12
			,IFNULL(SUM(GA.day13),0) AS day13
			,IFNULL(SUM(GA.day14),0) AS day14
			,IFNULL(SUM(GA.day15),0) AS day15
			,IFNULL(SUM(GA.day16),0) AS day16
			,IFNULL(SUM(GA.day17),0) AS day17
			,IFNULL(SUM(GA.day18),0) AS day18
			,IFNULL(SUM(GA.day19),0) AS day19
			,IFNULL(SUM(GA.day20),0) AS day20
			,IFNULL(SUM(GA.day21),0) AS day21
			,IFNULL(SUM(GA.day22),0) AS day22
			,IFNULL(SUM(GA.day23),0) AS day23
			,IFNULL(SUM(GA.day24),0) AS day24
			,IFNULL(SUM(GA.day25),0) AS day25
			,IFNULL(SUM(GA.day26),0) AS day26
			,IFNULL(SUM(GA.day27),0) AS day27
			,IFNULL(SUM(GA.day28),0) AS day28
			,IFNULL(SUM(GA.day29),0) AS day29
			,IFNULL(SUM(GA.day30),0) AS day30
			,IFNULL(SUM(GA.day31),0) AS day31
		
		FROM
		(
			(
		
			SELECT 
				IFNULL(SUM(end_cnt),0) AS month_end_cnt
				,0 AS year_suim_cnt
				,0 AS year_cancel_cnt
				,0 AS year_end_cnt
				,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
		
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date > #{bgnDe}
			AND base_date &lt;= #{endDe}
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt
				,IFNULL(SUM(suim_cnt),0) AS year_suim_cnt
				,IFNULL(SUM(cancel_cnt),0) AS year_cancel_cnt
				,IFNULL(SUM(end_cnt),0) AS year_end_cnt
				,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
		
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date > #{bgnYearDe}
			AND base_date &lt;= #{endYearDe}
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt
				,unsolve_cnt
				,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
		
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			ORDER BY base_date DESC LIMIT 1
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt
				,(suim_cnt-cancel_cnt) AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,end_cnt AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,(suim_cnt-cancel_cnt) AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,end_cnt AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,(suim_cnt-cancel_cnt) AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,end_cnt AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,(suim_cnt-cancel_cnt) AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,end_cnt AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,(suim_cnt-cancel_cnt) AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,end_cnt AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,(suim_cnt-cancel_cnt) AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,end_cnt AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,(suim_cnt-cancel_cnt) AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,end_cnt AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,(suim_cnt-cancel_cnt) AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,end_cnt AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,(suim_cnt-cancel_cnt) AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,end_cnt AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,(suim_cnt-cancel_cnt) AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,end_cnt AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,(suim_cnt-cancel_cnt) AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,end_cnt AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,(suim_cnt-cancel_cnt) AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,end_cnt AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,(suim_cnt-cancel_cnt) AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,end_cnt AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,(suim_cnt-cancel_cnt) AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,end_cnt AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,(suim_cnt-cancel_cnt) AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,end_cnt AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,(suim_cnt-cancel_cnt) AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,end_cnt AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,(suim_cnt-cancel_cnt) AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,end_cnt AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,(suim_cnt-cancel_cnt) AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,end_cnt AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,(suim_cnt-cancel_cnt) AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,end_cnt AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,(suim_cnt-cancel_cnt) AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,end_cnt AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,(suim_cnt-cancel_cnt) AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,end_cnt AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 9 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,(suim_cnt-cancel_cnt) AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,end_cnt AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 8 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,(suim_cnt-cancel_cnt) AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,end_cnt AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 7 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,(suim_cnt-cancel_cnt) AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,end_cnt AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 6 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,(suim_cnt-cancel_cnt) AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,end_cnt AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 5 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,(suim_cnt-cancel_cnt) AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,end_cnt AS day27,0 AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 4 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,(suim_cnt-cancel_cnt) AS reg28,0 AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,end_cnt AS day28,0 AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 3 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,(suim_cnt-cancel_cnt) AS reg29,0 AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,end_cnt AS day29,0 AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 2 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,(suim_cnt-cancel_cnt) AS reg30,0 AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,end_cnt AS day30,0 AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 1 DAY),'%Y-%m-%d')
		
			) UNION ALL (
		
			SELECT 
				0 AS month_end_cnt,0 AS year_suim_cnt,0 AS year_cancel_cnt,0 AS year_end_cnt,0 AS unsolve_cnt,0 AS reg02
				,0 AS reg03,0 AS reg04,0 AS reg05,0 AS reg06,0 AS reg07,0 AS reg08,0 AS reg09,0 AS reg10
				,0 AS reg11,0 AS reg12,0 AS reg13,0 AS reg14,0 AS reg15,0 AS reg16,0 AS reg17,0 AS reg18,0 AS reg19
				,0 AS reg20,0 AS reg21,0 AS reg22,0 AS reg23,0 AS reg24,0 AS reg25,0 AS reg26,0 AS reg27,0 AS reg28,0 AS reg29,0 AS reg30,(suim_cnt-cancel_cnt) AS reg31
		
				,0 AS day02
				,0 AS day03,0 AS day04,0 AS day05,0 AS day06,0 AS day07,0 AS day08,0 AS day09,0 AS day10
				,0 AS day11,0 AS day12,0 AS day13,0 AS day14,0 AS day15,0 AS day16,0 AS day17,0 AS day18,0 AS day19
				,0 AS day20,0 AS day21,0 AS day22,0 AS day23,0 AS day24,0 AS day25,0 AS day26,0 AS day27,0 AS day28,0 AS day29,0 AS day30,end_cnt AS day31
				
			FROM top_rpt_written_info
			WHERE user_no = #{user_no}
			AND base_date = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 0 DAY),'%Y-%m-%d')
		
			)
		
		)GA
	</select>
	
	<select id="selectMisAllotTmMbr1List" parameterType="hashmap" resultType="AsraMap">
		SELECT  A.TEAM_ID 
		       ,A.TEAM_NAME
		       ,D.ROW_SPAN 
		       ,B.USER_NO 
		       ,B.USER_NAME
		       ,B.USER_STATE
		       ,IFNULL(C.REG01, 0) AS REG01 ,IFNULL(C.REG02, 0) AS REG02 ,IFNULL(C.REG03, 0) AS REG03 ,IFNULL(C.REG04, 0) AS REG04 ,IFNULL(C.REG05, 0) AS REG05
		       ,IFNULL(C.REG06, 0) AS REG06 ,IFNULL(C.REG07, 0) AS REG07 ,IFNULL(C.REG08, 0) AS REG08 ,IFNULL(C.REG09, 0) AS REG09 ,IFNULL(C.REG10, 0) AS REG10
		       ,IFNULL(C.REG11, 0) AS REG11 ,IFNULL(C.REG12, 0) AS REG12 ,IFNULL(C.REG13, 0) AS REG13 ,IFNULL(C.REG14, 0) AS REG14 ,IFNULL(C.REG15, 0) AS REG15 
		       ,IFNULL(C.REG16, 0) AS REG16 ,IFNULL(C.REG17, 0) AS REG17 ,IFNULL(C.REG18, 0) AS REG18 ,IFNULL(C.REG19, 0) AS REG19 ,IFNULL(C.REG20, 0) AS REG20
		       ,IFNULL(C.REG21, 0) AS REG21 ,IFNULL(C.REG22, 0) AS REG22 ,IFNULL(C.REG23, 0) AS REG23 ,IFNULL(C.REG24, 0) AS REG24 ,IFNULL(C.REG25, 0) AS REG25
		       ,IFNULL(C.REG26, 0) AS REG26 ,IFNULL(C.REG27, 0) AS REG27 ,IFNULL(C.REG28, 0) AS REG28 ,IFNULL(C.REG29, 0) AS REG29 ,IFNULL(C.REG30, 0) AS REG30 ,IFNULL(C.REG31, 0) AS REG31
		       ,IFNULL(C.DAY01, 0) AS DAY01 ,IFNULL(C.DAY02, 0) AS DAY02 ,IFNULL(C.DAY03, 0) AS DAY03 ,IFNULL(C.DAY04, 0) AS DAY04 ,IFNULL(C.DAY05, 0) AS DAY05
		       ,IFNULL(C.DAY06, 0) AS DAY06 ,IFNULL(C.DAY07, 0) AS DAY07 ,IFNULL(C.DAY08, 0) AS DAY08 ,IFNULL(C.DAY09, 0) AS DAY09 ,IFNULL(C.DAY10, 0) AS DAY10
		       ,IFNULL(C.DAY11, 0) AS DAY11 ,IFNULL(C.DAY12, 0) AS DAY12 ,IFNULL(C.DAY13, 0) AS DAY13 ,IFNULL(C.DAY14, 0) AS DAY14 ,IFNULL(C.DAY15, 0) AS DAY15 
		       ,IFNULL(C.DAY16, 0) AS DAY16 ,IFNULL(C.DAY17, 0) AS DAY17 ,IFNULL(C.DAY18, 0) AS DAY18 ,IFNULL(C.DAY19, 0) AS DAY19 ,IFNULL(C.DAY20, 0) AS DAY20
		       ,IFNULL(C.DAY21, 0) AS DAY21 ,IFNULL(C.DAY22, 0) AS DAY22 ,IFNULL(C.DAY23, 0) AS DAY23 ,IFNULL(C.DAY24, 0) AS DAY24 ,IFNULL(C.DAY25, 0) AS DAY25
		       ,IFNULL(C.DAY26, 0) AS DAY26 ,IFNULL(C.DAY27, 0) AS DAY27 ,IFNULL(C.DAY28, 0) AS DAY28 ,IFNULL(C.DAY29, 0) AS DAY29 ,IFNULL(C.DAY30, 0) AS DAY30 ,IFNULL(C.DAY31, 0) AS DAY31
		       ,IFNULL(C.REG_YEAR_CNT, 0) AS REG_YEAR_CNT
		       ,IFNULL(C.CLS_MONTH_CNT, 0) AS CLS_MONTH_CNT
		       ,IFNULL(C.CLS_YEAR_CNT, 0) AS CLS_YEAR_CNT
		       ,IFNULL(C.PENDING_CNT, 0) AS PENDING_CNT
		       ,CASE B.WORK_TYPE
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15	
				END AS NEW_WORK_ORDER
				,A.TEAM_WRITTEN 
		  FROM  top_tm_bsc A 
		 INNER  JOIN top_mbr_bsc B
		    ON  A.TEAM_ID = B.TEAM_ID_MAIN
		 INNER  JOIN (
		               SELECT  A.TEAM_ID 
		                     ,COUNT(*) AS ROW_SPAN 
		                FROM  top_tm_bsc A 
		                     ,top_mbr_bsc B
		               WHERE  1=1
		                 AND  A.TEAM_ID = B.TEAM_ID_MAIN
		                 <!-- AND  A.TEAM_TYPE = 1 -->
		                 AND  A.TEAM_TYPE IN (0,1) 
		                 AND  A.TEAM_STATISTICS1 = 0 
		                 AND  ((B.USER_STATE = 1 AND B.OUT_DATE >= UNIX_TIMESTAMP(#{bgnDe})) OR (B.USER_STATE !=1 AND B.JOIN_DATE &lt; UNIX_TIMESTAMP(#{endDe})))
		              GROUP BY A.TEAM_ID   
		             ) D
		    ON  A.TEAM_ID = D.TEAM_ID            
		  LEFT  JOIN (
		              SELECT  GA.USER_NO
		                     ,SUM(GA.REG01) AS REG01 ,SUM(GA.REG02) AS REG02 ,SUM(GA.REG03) AS REG03 ,SUM(GA.REG04) AS REG04 ,SUM(GA.REG05) AS REG05
		                     ,SUM(GA.REG06) AS REG06 ,SUM(GA.REG07) AS REG07 ,SUM(GA.REG08) AS REG08 ,SUM(GA.REG09) AS REG09 ,SUM(GA.REG10) AS REG10
		                     ,SUM(GA.REG11) AS REG11 ,SUM(GA.REG12) AS REG12 ,SUM(GA.REG13) AS REG13 ,SUM(GA.REG14) AS REG14 ,SUM(GA.REG15) AS REG15
		                     ,SUM(GA.REG16) AS REG16 ,SUM(GA.REG17) AS REG17 ,SUM(GA.REG18) AS REG18 ,SUM(GA.REG19) AS REG19 ,SUM(GA.REG20) AS REG20
		                     ,SUM(GA.REG21) AS REG21 ,SUM(GA.REG22) AS REG22 ,SUM(GA.REG23) AS REG23 ,SUM(GA.REG24) AS REG24 ,SUM(GA.REG25) AS REG25
		                     ,SUM(GA.REG26) AS REG26 ,SUM(GA.REG27) AS REG27 ,SUM(GA.REG28) AS REG28 ,SUM(GA.REG29) AS REG29 ,SUM(GA.REG30) AS REG30 ,SUM(GA.REG31) AS REG31
		                     ,SUM(GA.DAY01) AS DAY01 ,SUM(GA.DAY02) AS DAY02 ,SUM(GA.DAY03) AS DAY03 ,SUM(GA.DAY04) AS DAY04 ,SUM(GA.DAY05) AS DAY05
		                     ,SUM(GA.DAY06) AS DAY06 ,SUM(GA.DAY07) AS DAY07 ,SUM(GA.DAY08) AS DAY08 ,SUM(GA.DAY09) AS DAY09 ,SUM(GA.DAY10) AS DAY10
		                     ,SUM(GA.DAY11) AS DAY11 ,SUM(GA.DAY12) AS DAY12 ,SUM(GA.DAY13) AS DAY13 ,SUM(GA.DAY14) AS DAY14 ,SUM(GA.DAY15) AS DAY15
		                     ,SUM(GA.DAY16) AS DAY16 ,SUM(GA.DAY17) AS DAY17 ,SUM(GA.DAY18) AS DAY18 ,SUM(GA.DAY19) AS DAY19 ,SUM(GA.DAY20) AS DAY20
		                     ,SUM(GA.DAY21) AS DAY21 ,SUM(GA.DAY22) AS DAY22 ,SUM(GA.DAY23) AS DAY23 ,SUM(GA.DAY24) AS DAY24 ,SUM(GA.DAY25) AS DAY25
		                     ,SUM(GA.DAY26) AS DAY26 ,SUM(GA.DAY27) AS DAY27 ,SUM(GA.DAY28) AS DAY28 ,SUM(GA.DAY29) AS DAY29 ,SUM(GA.DAY30) AS DAY30 ,SUM(GA.DAY31) AS DAY31		                     
		                     ,SUM(GA.REG_YEAR_CNT) AS REG_YEAR_CNT
		                     ,SUM(GA.CLS_MONTH_CNT) AS CLS_MONTH_CNT
		                     ,SUM(GA.CLS_YEAR_CNT) AS CLS_YEAR_CNT
		                     ,SUM(GA.PENDING_CNT) AS PENDING_CNT
		                FROM  (
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG01
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG02
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG03
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG04
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG05
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG06
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG07
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG08
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG09
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG10
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG11
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG12
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG13
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG14
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG15
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG16
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG17
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG18
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG19
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG20
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG21
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG22
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG23
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG24
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG25
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG26
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG27
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG28
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG29
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG30
		                               ,CASE WHEN FROM_UNIXTIME(A.REG_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS REG31
		                               ,0 AS DAY01 ,0 AS DAY02 ,0 AS DAY03 ,0 AS DAY04 ,0 AS DAY05 ,0 AS DAY06 ,0 AS DAY07 ,0 AS DAY08 ,0 AS DAY09 ,0 AS DAY10 
		                               ,0 AS DAY11 ,0 AS DAY12 ,0 AS DAY13 ,0 AS DAY14 ,0 AS DAY15 ,0 AS DAY16 ,0 AS DAY17 ,0 AS DAY18 ,0 AS DAY19 ,0 AS DAY20
		                               ,0 AS DAY21 ,0 AS DAY22 ,0 AS DAY23 ,0 AS DAY24 ,0 AS DAY25 ,0 AS DAY26 ,0 AS DAY27 ,0 AS DAY28 ,0 AS DAY29 ,0 AS DAY30 ,0 AS DAY31 
		                               ,0 AS REG_YEAR_CNT
		                               ,0 AS CLS_MONTH_CNT
		                               ,0 AS CLS_YEAR_CNT
		                               ,0 AS PENDING_CNT        
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_STATE !=3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL 1 DAY),'%Y%m%d'))
								UNION ALL
								
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY01
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 29 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY02
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 28 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY03
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 27 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY04
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 26 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY05
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 25 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY06
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 24 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY07
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 23 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY08
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 22 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY09
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 21 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY10
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 20 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY11
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 19 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY12
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 18 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY13
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 17 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY14
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 16 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY15
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 15 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY16
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 14 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY17
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 13 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY18
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 12 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY19
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 11 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY20
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 10 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY21
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  9 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY22
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  8 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY23
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  7 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY24
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  6 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY25
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  5 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY26
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  4 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY27
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  3 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY28
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  2 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY29
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  1 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY30
		                               ,CASE WHEN FROM_UNIXTIME(A.CLOSE_DATE,'%Y%m%d') = DATE_FORMAT(DATE_SUB(NOW(), INTERVAL  0 DAY),'%Y%m%d') THEN 1 ELSE 0 END AS DAY31
		                               ,0 AS REG_YEAR_CNT
		                               ,0 AS CLS_MONTH_CNT
		                               ,0 AS CLS_YEAR_CNT
		                               ,0 AS PENDING_CNT        
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_STATE = 2 
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(DATE_FORMAT(DATE_SUB(NOW(), INTERVAL 30 DAY),'%Y%m%d'))
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(DATE_FORMAT(DATE_ADD(NOW(), INTERVAL 1 DAY),'%Y%m%d'))								
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO 
		                               ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0
		                               ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0
		                               ,COUNT(A.SUIM_RPT_NO) AS REG_YEAR_CNT
		                               ,0 ,0 ,0
		                          FROM  top_rpt_head A 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_STATE !=3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL
                                SELECT  A.TEAM_ID
                                       ,A.USER_NO 
		                               ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0
		                               ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0
		                               ,0 
		                               ,COUNT(A.SUIM_RPT_NO) AS CLS_MONTH_CNT
		                               ,0 ,0
		                          FROM  top_rpt_head A 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_STATE = 2
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{now_from})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{now_to})
                                GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL
                                SELECT  A.TEAM_ID
                                       ,A.USER_NO 
		                               ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0
		                               ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0
		                               ,0 ,0 
		                               ,COUNT(A.SUIM_RPT_NO) AS CLS_YEAR_CNT
		                               ,0 
		                          FROM  top_rpt_head A 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_STATE = 2
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
                                SELECT  A.TEAM_ID
                                       ,A.USER_NO 
		                               ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0
		                               ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0 ,0
		                               ,0 ,0 ,0 
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CNT
		                          FROM  top_rpt_head A 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_STATE IN(0, 1, 11)
                                GROUP BY A.TEAM_ID, A.USER_NO 
		                       ) GA
		               WHERE  1=1
		              GROUP BY GA.USER_NO
		             ) C
		    ON  B.USER_NO = C.USER_NO
		 WHERE  1=1
		   <!-- AND  A.TEAM_TYPE = 1 -->
		   AND  A.TEAM_TYPE IN (0,1) 
		   AND  A.TEAM_STATISTICS1 = 0 
		   AND  ((B.USER_STATE = 1 AND B.OUT_DATE >= UNIX_TIMESTAMP(#{bgnDe})) OR (B.USER_STATE !=1 AND B.JOIN_DATE &lt; UNIX_TIMESTAMP(#{endDe})))
		ORDER BY A.TEAM_GROUP_ORDER DESC, A.TEAM_ORDER DESC, A.TEAM_ID DESC, NEW_WORK_ORDER, B.WORK_LEVEL DESC, B.USER_NO ASC  	
	</select>

</mapper>
