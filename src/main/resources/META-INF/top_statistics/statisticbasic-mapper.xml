<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="StatisticBasic">
	
	<!-- 특정기간 사용연차 합산 -->
	<select id="sumVacationUse" parameterType="HashMap" resultType="double">
		SELECT 
			IFNULL(SUM(vacation_interval),0) AS vacationUse			
		FROM top_vacation_info 
		WHERE user_no = #{user_no}
		AND sdate >= #{join_date}
		AND edate &lt;= #{base_date}
		AND (vacation_type = 100 OR vacation_type = 200 OR vacation_type = 210 )
		AND approval_state = 31				
	</select>
	
	<!-- 기존 입력값이 있는지 확인 조회 -->
	<select id="chkVacationUse" parameterType="HashMap" resultType="int">
		SELECT 
			count(*) as cnt
		FROM 
			top_vacation_use
		WHERE 
			user_no = #{user_no}
		AND base_year = #{base_year}		
	</select>
	
	<!-- 연차계산을 위한 대상자 목록 조회 (퇴사자가 아닌경우는 전부 해당됨)-->
	<select id="selectVacationMemberList" parameterType="HashMap" resultType="AsraMap">
		SELECT 
			user_no			
			,DATE_FORMAT(FROM_UNIXTIME(join_date), '%Y-%m-%d') as join_date
		FROM 
			top_mbr_bsc
		WHERE 
			user_state != 1
	</select>
	
	<select id="appointChk" parameterType="HashMap" resultType="int">
		SELECT 
			SUM(GA.cnt)AS cnt 
		FROM
			(
				(
				SELECT COUNT(*) AS cnt FROM top_mbr_appoint
				WHERE user_no = #{user_no}
				AND appoint_team_id = #{team_id} 
				AND appoint_date >= UNIX_TIMESTAMP(#{bgnDe})
				AND appoint_date &lt;  UNIX_TIMESTAMP(#{endDe})
				AND (appoint_work_level != '수습' or appoint_work_level is null)
				)		
			UNION ALL
				(
		
				SELECT COUNT(*) AS cnt FROM top_mbr_appoint
				WHERE user_no = #{user_no}
				AND appoint_team_id = #{team_id}
				AND appoint_date &lt; UNIX_TIMESTAMP(#{bgnDe})
				AND (appoint_work_level != '수습' or appoint_work_level is null)
				ORDER BY appoint_date DESC LIMIT 1
				)
			)GA
	</select>
	
	<select id="sumPersonWorkload" parameterType="HashMap" resultType="String">
		SELECT		
			IFNULL(SUM(GA.CALC_WORKLOAD),0) AS CALC_WORKLOAD
		FROM (
			SELECT 
				(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * A.WORKLOAD_EA * (100 - (SELECT IFNULL(SUM(COLLABO_PP),0) FROM top_rpt_collabo WHERE SUIM_RPT_NO = A.SUIM_RPT_NO)) * 0.01,3) ) 
				+ (SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * (SELECT IFNULL(SUM(WRITTEN_CNT),0) FROM top_rpt_collabo WHERE SUIM_RPT_NO = A.SUIM_RPT_NO) ,3))
				AS CALC_WORKLOAD
			FROM  top_rpt_head A
			    LEFT OUTER JOIN 
				 (
				   SELECT  SUIM_RPT_NO 
					  ,SUM(COLLABO_PP) AS COLLABO_PP
					  ,SUM(COLLABO_DAILY) AS COLLABO_DAILY_RATIO
					  ,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
					  ,COUNT(*) AS COLLABO_CNT
					  ,SUM(WRITTEN_BASIC) AS WRITTEN_BASIC
					  ,SUM(WRITTEN_CNT) AS WRITTEN_CNT 
				     FROM  top_rpt_collabo
				    WHERE  COLLABO_DAILY_TYPE = 0 
				    GROUP BY SUIM_RPT_NO  
				 ) B
			      ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
			   INNER JOIN top_rpt_invoice C
			      ON A.SUIM_RPT_NO = C.SUIM_RPT_NO
			    LEFT OUTER JOIN
							 (
				   SELECT  SUIM_RPT_NO
						  ,SUM(COLLABO_PP) AS COLLABO_PP
						  ,SUM(COLLABO_DAILY) AS COLLABO_DAILY_MONEY
						  ,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
				     FROM  top_rpt_collabo
				    WHERE  COLLABO_DAILY_TYPE = 1 
				    GROUP BY SUIM_RPT_NO  
				 ) D
			      ON D.SUIM_RPT_NO = C.SUIM_RPT_NO
			   WHERE  1=1
			     AND  A.USER_NO = #{user_no}
			     AND  A.SUIM_RPT_STATE = 2
			     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
			     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
			
			UNION ALL
			
				SELECT    
					(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * A.WORKLOAD_EA * B.COLLABO_PP * 0.01,3) )
					+ (SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * IFNULL(B.WRITTEN_CNT,0),3) ) 
					AS CALC_WORKLOAD			  
				FROM  top_rpt_head A
				 ,top_rpt_collabo B
				 ,top_rpt_invoice C 
				WHERE  1=1
				AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
				AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
				AND  B.USER_ID = #{user_no}
				AND  A.SUIM_RPT_STATE = 2
				AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
				AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		
		<if test='primYN == "Y"'>
		  UNION ALL

          SELECT
                 (SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.suim_rpt_type1) * B.share_workload_ea,3) ) AS CALC_WORKLOAD                 
 			 FROM  top_prim_biz_rpt_head A
 			 , top_prim_biz_inv_share B 
             WHERE A.SUIM_RPT_NO = B.SUIM_RPT_NO			      
             AND  A.SUIM_RPT_TYPE1 = 5
             AND  A.USER_NO = #{user_no}
             AND  B.SHARE_USER_NO = A.USER_NO
             AND  A.SUIM_RPT_STATE = 2
             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
				
			UNION ALL
			
			SELECT				
				(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.suim_rpt_type1) * B.share_workload_ea,3) ) AS CALC_WORKLOAD
			FROM  
				top_prim_biz_rpt_head A ,top_prim_biz_inv_share B  
			WHERE  1=1
			AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
			AND  A.USER_NO != B.SHARE_USER_NO  
			AND  A.SUIM_RPT_TYPE1 = 5
			AND  B.SHARE_USER_NO = #{user_no}
			AND  A.SUIM_RPT_STATE = 2
			AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
			AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		</if>
		)GA	
	</select>	
	
	
	<select id="sumPersonWorkload_20191021" parameterType="HashMap" resultType="String">
		SELECT		
			IFNULL(SUM(GA.CALC_WORKLOAD),0) AS CALC_WORKLOAD
		FROM (
			SELECT 
				(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * A.WORKLOAD_EA * (100 - (SELECT IFNULL(SUM(COLLABO_PP),0) FROM top_rpt_collabo WHERE SUIM_RPT_NO = A.SUIM_RPT_NO)) * 0.01,3) ) AS CALC_WORKLOAD
			FROM  top_rpt_head A
			    LEFT OUTER JOIN 
				 (
				   SELECT  SUIM_RPT_NO 
					  ,SUM(COLLABO_PP) AS COLLABO_PP
					  ,SUM(COLLABO_DAILY) AS COLLABO_DAILY_RATIO
					  ,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
					  ,COUNT(*) AS COLLABO_CNT 
				     FROM  top_rpt_collabo
				    WHERE  COLLABO_DAILY_TYPE = 0 
				    GROUP BY SUIM_RPT_NO  
				 ) B
			      ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
			   INNER JOIN top_rpt_invoice C
			      ON A.SUIM_RPT_NO = C.SUIM_RPT_NO
			    LEFT OUTER JOIN
							 (
				   SELECT  SUIM_RPT_NO
						  ,SUM(COLLABO_PP) AS COLLABO_PP
						  ,SUM(COLLABO_DAILY) AS COLLABO_DAILY_MONEY
						  ,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
				     FROM  top_rpt_collabo
				    WHERE  COLLABO_DAILY_TYPE = 1 
				    GROUP BY SUIM_RPT_NO  
				 ) D
			      ON D.SUIM_RPT_NO = C.SUIM_RPT_NO
			   WHERE  1=1
			     AND  A.USER_NO = #{user_no}
			     AND  A.SUIM_RPT_STATE = 2
			     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
			     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
			
			UNION ALL
			
				SELECT    
					(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * A.WORKLOAD_EA * B.COLLABO_PP * 0.01,3) )  AS CALC_WORKLOAD			  
				FROM  top_rpt_head A
				 ,top_rpt_collabo B
				 ,top_rpt_invoice C 
				WHERE  1=1
				AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
				AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
				AND  B.USER_ID = #{user_no}
				AND  A.SUIM_RPT_STATE = 2
				AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
				AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		
		<if test='primYN == "Y"'>
		  UNION ALL

          SELECT
                 (SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.suim_rpt_type1) * B.share_workload_ea,3) ) AS CALC_WORKLOAD                 
 			 FROM  top_prim_biz_rpt_head A
 			 , top_prim_biz_inv_share B 
             WHERE A.SUIM_RPT_NO = B.SUIM_RPT_NO			      
             AND  A.SUIM_RPT_TYPE1 = 5
             AND  A.USER_NO = #{user_no}
             AND  B.SHARE_USER_NO = A.USER_NO
             AND  A.SUIM_RPT_STATE = 2
             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
				
			UNION ALL
			
			SELECT				
				(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.suim_rpt_type1) * B.share_workload_ea,3) ) AS CALC_WORKLOAD
			FROM  
				top_prim_biz_rpt_head A ,top_prim_biz_inv_share B  
			WHERE  1=1
			AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
			AND  A.USER_NO != B.SHARE_USER_NO  
			AND  A.SUIM_RPT_TYPE1 = 5
			AND  B.SHARE_USER_NO = #{user_no}
			AND  A.SUIM_RPT_STATE = 2
			AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
			AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		</if>
		)GA	
	</select>
	
	<select id="selectPersonYearCnt" parameterType="HashMap" resultType="integer">
		SELECT count(*) as nCnt
		  FROM top_mbr_appoint 
		 WHERE user_no = #{user_no}
		   AND appoint_date >= UNIX_TIMESTAMP(#{bgnDe})
		   AND appoint_date &lt; UNIX_TIMESTAMP(#{endDe})
		   AND appoint_team_id IS NOT NULL
	</select> 	
	
	<select id="selectPersonYearEa" parameterType="HashMap" resultType="String">
		 SELECT IFNULL(getCodeValue("top_rpt_head", CONCAT("workload_job_code_",#{year}), appoint_work_job_cd),0) yearEa
		  FROM top_mbr_appoint 
		 WHERE user_no = #{user_no}
		   AND appoint_date >= UNIX_TIMESTAMP(#{bgnDe})
		   AND appoint_date &lt; UNIX_TIMESTAMP(#{endDe})
		   AND appoint_team_id IS NOT NULL
		   ORDER BY appoint_date DESC
		   LIMIT 0, 1 
	</select>
	
	<select id="selectPersonYearEaNull" parameterType="HashMap" resultType="String">
		 SELECT IFNULL(getCodeValue("top_rpt_head", CONCAT("workload_job_code_",#{year}), appoint_work_job_cd),0) yearEa
		  FROM top_mbr_appoint 
		 WHERE user_no = #{user_no}		   
		   AND appoint_date &lt; UNIX_TIMESTAMP(#{endDe})  
		   AND appoint_team_id IS NOT NULL
		   ORDER BY appoint_date DESC
		 LIMIT 0, 1 
	</select>
	
	<!-- 기준 날짜 직전의 발령정보를 가져온다.  -->
	<select id="selectPersonBeforeAppointInfo" parameterType="HashMap" resultType="AsraMap">
		SELECT 
			appoint_date
			,FROM_UNIXTIME(appoint_date,'%Y%m%d') AS appoint_date_fmt
			,appoint_work_job_cd
		  FROM top_mbr_appoint 
		 WHERE user_no = #{user_no}		   
		   AND appoint_date &lt; UNIX_TIMESTAMP(#{base_date})
		   AND appoint_team_id IS NOT NULL
		   ORDER BY appoint_date DESC
		 LIMIT 0, 1  
	</select>
	
	<select id="selectPersonAppointInfo" parameterType="HashMap" resultType="AsraMap">
		SELECT 
			appoint_date
			,FROM_UNIXTIME(appoint_date,'%Y%m%d') AS appoint_date_fmt
			,appoint_work_job_cd
		  FROM top_mbr_appoint 
		 WHERE user_no = #{user_no}
		   AND appoint_date >= UNIX_TIMESTAMP(#{bgnDe})
		   AND appoint_date &lt; UNIX_TIMESTAMP(#{endDe})
		   AND appoint_team_id IS NOT NULL
	</select>
	
	<select id="getPurposeWorkloadCode" parameterType="HashMap" resultType="String">
		SELECT 
			IFNULL(getCodeValue("top_rpt_head", CONCAT("workload_job_code_",#{year}), #{appoint_work_job_cd}),0) as yearEa
		FROM DUAL
	</select>
	
	<update id="updateExpenseTeamCnt" parameterType="HashMap">
		UPDATE top_member_cnt_daily SET
			member_cnt = #{member_cnt}
		WHERE team_id = #{team_id}
			AND	base_date = #{base_date}
	</update>
	
	<select id="selectExpenseTeamList" parameterType="HashMap" resultType="AsraMap">
		SELECT			
			team_id
			,team_group_order
			,team_order
			,team_name
			,getToptmBscCenterName(team_id) as center_name
			,IF( team_manager = 0, '-', getTopMbrBscUserName(team_manager) ) as team_manager_name
			,team_level	
			,date_format(base_date,'%Y-%m-%d') as base_date		
		FROM
			top_member_cnt_daily
		WHERE
			team_center != 999
			AND base_date >= #{stdBgnde}
			AND base_date &lt;= #{stdEndde}
			<if test="s_team_id != 9999"> 
				AND team_id = #{s_team_id}
			</if>
			GROUP BY team_id
			ORDER BY team_group_order DESC, team_order DESC, team_level;
	</select>
	
	<select id="selectExpenseTeamChk" parameterType="HashMap" resultType="Integer">
		SELECT 
			count(*)
		FROM top_member_cnt_daily
		WHERE team_id = #{team_id}
		AND base_date = #{base_date}		
	</select>
	
	<select id="selectExpenseTeamCnt" parameterType="HashMap" resultType="Integer">
		SELECT 
			IFNULL(member_cnt,0) 
		FROM top_member_cnt_daily
		WHERE team_id = #{team_id}
		AND base_date = #{base_date}		
	</select>
	
	<select id="selectExpenseInfoList" parameterType="HashMap" resultType="AsraMap">
		SELECT
			a.base_year      
			,a.base_month     
			,a.user_no        
			,a.user_name      
			,a.team_id
			,a.team_name
			,a.center_name    
			,a.work_type_nm
			,a.work_type   
			,a.work_level_nm  
			,a.work_job       
			,a.work_job_cd    
			,a.workload_year  
			,a.workload_month 
			,a.workload_cal   
			,a.workload_per   
			,a.member_avg
			,a.amt_daily      
			,a.share_amt_daily
			,a.sum_amt_daily
			,a.amt_basic      
			,a.share_amt_basic
			,a.sum_amt_basic
			,a.mc_cost
			,a.wc_cost
			,a.ss_cost
			,a.extra_cost
			,a.inside_cost  
			,a.center_manage_cost
			,a.suhyp_cost
			,a.cow_cost
			,a.traffic_cost			
			,a.reg_date	
			,CASE a.work_type
				WHEN 1 THEN 1
				WHEN 2 THEN 2
				WHEN 6 THEN 3
				WHEN 14 THEN 4
				WHEN 15 THEN 5
				WHEN 3 THEN 6
				WHEN 7 THEN 7
				WHEN 4 THEN 8
				WHEN 8 THEN 9
				WHEN 5 THEN 10
				WHEN 9 THEN 11
				WHEN 10 THEN 12
				WHEN 12 THEN 13
				WHEN 11 THEN 14
				WHEN 13 THEN 15	
			END AS new_work_order
			,(SELECT IFNULL(MAX(nonghyp_cost),0) FROM top_expense_extra_info WHERE base_year = #{base_year} AND base_month = #{base_month} AND a.user_no = user_no) AS nonghyp_cost
			,(SELECT IFNULL(MAX(dispatch_cost),0) FROM top_expense_extra_info WHERE base_year = #{base_year} AND base_month = #{base_month} AND a.user_no = user_no) AS dispatch_cost
			,(SELECT IFNULL(MAX(elegance_cost),0) FROM top_expense_extra_info WHERE base_year = #{base_year} AND base_month = #{base_month} AND a.user_no = user_no) AS elegance_cost
			,(SELECT IFNULL(MAX(deduction_cost),0) FROM top_expense_extra_info WHERE base_year = #{base_year} AND base_month = #{base_month} AND a.user_no = user_no) AS deduction_cost			
		FROM top_expense_info a
		INNER JOIN top_tm_bsc b
		    ON a.team_id = b.team_id
		WHERE 1=1
			AND a.base_year = #{base_year}
			AND a.base_month = #{base_month}
		ORDER BY b.team_group_order desc, b.team_order desc, new_work_order, a.work_type asc, a.work_level desc, a.user_no asc
	</select>
	
	<select id="selectExpenseMemberList" parameterType="HashMap" resultType="AsraMap">
 		SELECT a.user_no
 			  ,a.user_name
 			  ,b.team_name
 			  ,b.team_id
 			  ,a.work_type
 			  ,a.work_level
 			  ,getTopTmBscCenterName(b.team_id) as center_name
 			  ,getCodeValue('top_mbr_bsc','work_type',a.work_type) as work_type_nm
			  ,getCodeValue('top_mbr_bsc','work_level',a.work_level) as work_level_nm
			  ,getCode2Value('top_mbr_bsc','work_job',IF(b.team_type!=4,1,4),a.work_job) as work_job
			  ,a.work_job AS work_job_cd
			  ,IFNULL(getCodeValue('top_rpt_head', CONCAT('workload_job_code_',#{year}), a.work_job), 0) as workload_year
			  ,CASE a.work_type
				WHEN 1 THEN 1
				WHEN 2 THEN 2
				WHEN 6 THEN 3
				WHEN 14 THEN 4
				WHEN 15 THEN 5
				WHEN 3 THEN 6
				WHEN 7 THEN 7
				WHEN 4 THEN 8
				WHEN 8 THEN 9
				WHEN 5 THEN 10
				WHEN 9 THEN 11
				WHEN 10 THEN 12
				WHEN 12 THEN 13
				WHEN 11 THEN 14
				WHEN 13 THEN 15	
			END AS new_work_order
		  FROM top_mbr_bsc a
		 INNER JOIN top_tm_bsc b
		    ON a.team_id_main = b.team_id
		    <!-- a.user_state = 0 -->
		 WHERE	(a.user_state != 1 OR (a.user_state = 1 AND a.out_date >= UNIX_TIMESTAMP(#{stdBgnde}) AND a.out_date &lt;= UNIX_TIMESTAMP(#{stdEndde}) ) )
		 <!-- AND b.team_type != 4 -->
		 AND b.team_type = 1
		 ORDER BY b.team_group_order DESC, b.team_order DESC, new_work_order ASC, a.work_level DESC, a.user_no ASC	
	</select>
	
	<delete id="deleteExpenseExtraInfo" parameterType="HashMap">
		DELETE FROM top_expense_extra_info WHERE base_year = #{v_baseYear} and base_month = #{v_baseMonth} and user_no = #{v_userNo}
	</delete>
	
	<delete id="deleteExpenseInfo" parameterType="HashMap">
		DELETE FROM top_expense_info WHERE base_year = #{baseYear} and base_month = #{baseMonth}
	</delete>
	
	<insert id="insertExpenseExtraInfo" parameterType="HashMap">
		INSERT INTO top_expense_extra_info (
			base_year
			,base_month
			,user_no
			,nonghyp_cost
			,dispatch_cost
			,elegance_cost
			,deduction_cost
		) VALUES (
			#{v_baseYear}
			,#{v_baseMonth}
			,#{v_userNo}
			,#{v_nonghypCost}
			,#{v_dispatchCost}
			,#{v_eleganceCost}
			,#{v_deductionCost}
		)
	</insert>
	
	<insert id="insertExpenseInfo" parameterType="java.util.List">
		INSERT INTO top_expense_info (
			base_year      
			,base_month     
			,user_no        
			,user_name      
			,team_id
			,team_name        
			,center_name    
			,work_type_nm
			,work_type   
			,work_level
			,work_level_nm  
			,work_job       
			,work_job_cd    
			,workload_year  
			,workload_month 
			,workload_cal   
			,workload_per 
			,member_avg  
			,amt_daily      
			,share_amt_daily
			,sum_amt_daily
			,amt_basic      
			,share_amt_basic
			,sum_amt_basic  
			,mc_cost
			,wc_cost
			,ss_cost
			,extra_cost
			,inside_cost
			,center_manage_cost
			,suhyp_cost
			,cow_cost
			,traffic_cost
			,reg_date
		) VALUES
		<foreach collection="list" item="item" separator=",">
		(
			#{item.baseYear}
			,#{item.baseMonth}
			,#{item.userNo}        
			,#{item.userName}      
			,#{item.teamId}
			,#{item.teamName}
			,#{item.centerName}			    
			,#{item.workTypeNm}
			,#{item.workType}
			,#{item.workLevel}   
			,#{item.workLevelNm}  
			,#{item.workJob}
			,#{item.workJobCd}
			,#{item.workloadYear}
			,#{item.workloadMonth} 
			,#{item.workloadCal}
			,#{item.workloadPer}
			,#{item.memberAvg}
			,#{item.amtDaily}
			,#{item.shareAmtDaily}
			,#{item.sumAmtDaily}
			,#{item.amtBasic}      
			,#{item.shareAmtBasic}
			,#{item.sumAmtBasic}  
			,#{item.mcCost}
			,#{item.wcCost}
			,#{item.ssCost}
			,#{item.extraCost}
			,#{item.insideCost}
			,#{item.centerManageCost}
			,#{item.extraSuhypCost}
			,#{item.extraCowCost}
			,#{item.sumAmtTraffic}
			,now()
		)
		</foreach>	
	</insert>
	
	<select id="selectExpenseTeamMemberAvg" parameterType="HashMap" resultType="String">
		SELECT 
			IFNULL(ROUND(AVG(member_cnt),1),0) AS member_avg
		FROM top_member_cnt_daily 
		WHERE team_id = #{team_id}
		AND base_date >= #{bgnDe}
		AND base_date &lt; #{endDe}	
	</select>
	
	<select id="selectExpenseTeamMemberLastCnt" parameterType="HashMap" resultType="integer">
		SELECT 
			count(*) as member_cnt
		FROM top_member_cnt_daily 
		WHERE team_id = #{team_id}		
		AND base_date &lt; #{endDe}		
	</select>
	
	<select id="selectExpenseTeamMemberLast" parameterType="HashMap" resultType="integer">
		SELECT 
			ifnull(member_cnt, 0) as member_cnt
		FROM top_member_cnt_daily 
		WHERE team_id = #{team_id}		
		AND base_date &lt; #{endDe}
		ORDER BY base_date desc limit 1
	</select>
	
	<select id="selectCenterId" parameterType="HashMap" resultType="String">
		SELECT team_id as center_id
		FROM top_tm_bsc
		WHERE team_level = 0 
			AND team_group_order = (SELECT team_group_order FROM top_tm_bsc WHERE team_id = #{team_id});	
	</select>
	
	<!-- 가축재해이재조사관련 기준업무량 계산 공동수행 포함계산-->
	<select id="sumCowWLCnt" parameterType="HashMap" resultType="double">
		SELECT
			(SUM(GA.baseCnt) - SUM(GA.minusCnt) + SUM(GA.plusCnt)) AS workload_ea				
		FROM
			(	
				SELECT
					0 AS baseCnt	
					,0 AS minusCnt
					,0 AS plusCnt
				FROM DUAL
			
				UNION ALL
				
				SELECT 
					<!-- 종결건수에서 기준업무량 종결건수로 변경 -->
					<!-- 1 AS baseCnt -->
					workload_ea as baseCnt
					,0 AS minusCnt
					,0 AS plusCnt
				FROM top_rpt_head 
				WHERE suim_rpt_type1 = 2 
				AND user_no = #{user_no}				
				AND workload_type IN (20,25)
				AND suim_rpt_state = 2 
				AND close_date >= UNIX_TIMESTAMP(#{bgnDe})
				AND close_date &lt; UNIX_TIMESTAMP(#{endDe})
		
				UNION ALL
		
				SELECT 
					0 AS baseCnt
					,((b.collabo_pp / 100) * a.workload_ea) AS minusCnt
					,0 AS plusCnt
				FROM top_rpt_head a, top_rpt_collabo b
				WHERE a.suim_rpt_no = b.suim_rpt_no
				AND a.suim_rpt_type1 = 2
				AND a.user_no = #{user_no}
				AND a.workload_type IN (20,25)
				AND a.suim_rpt_state = 2 
				AND b.collabo_pp != 0				
				AND b.user_id != #{user_no}
				AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
				AND a.close_date &lt; UNIX_TIMESTAMP(#{endDe})
				
				UNION ALL
				
				SELECT 
					0 AS baseCnt
					,0 AS minusCnt
					,((b.collabo_pp / 100) * a.workload_ea) AS plusCnt			
				FROM top_rpt_head a, top_rpt_collabo b
				WHERE a.suim_rpt_no = b.suim_rpt_no
				AND a.suim_rpt_type1 = 2 		
				AND a.workload_type IN (20,25)
				AND a.suim_rpt_state = 2 
				AND b.collabo_pp != 0
				AND b.user_id = #{user_no}		
				AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
				AND a.close_date &lt; UNIX_TIMESTAMP(#{endDe})
				
			)GA
	</select>
	
	<!-- 가축재해이재조사관련 기준업무량 계산 -->
	<select id="sumCowWLCnt_20200327" parameterType="HashMap" resultType="double">
		SELECT 
			IFNULL(SUM(workload_ea),0) AS workload_ea 
		FROM top_rpt_head
		WHERE suim_rpt_type1 = 2
		AND workload_type IN (20,25)
		AND suim_rpt_state = 2
		AND user_no = #{user_no}
		AND close_date >= UNIX_TIMESTAMP(#{bgnDe})
		AND close_date &lt; UNIX_TIMESTAMP(#{endDe})
	</select>
	
	<!-- 수협(양식보험, 인수조사) 기준업무량 계산 공동수행 포함계산-->
	<select id="sumSuhypWLCnt" parameterType="HashMap" resultType="double">
		SELECT
			(SUM(GA.baseCnt) - SUM(GA.minusCnt) + SUM(GA.plusCnt)) AS workload_ea
			<!-- ,SUM(GA.baseCnt) AS baseCnt	
			,SUM(GA.minusCnt) AS minusCnt
			,SUM(GA.plusCnt) AS plusCnt -->	
		FROM
			(	
				SELECT
					0 AS baseCnt	
					,0 AS minusCnt
					,0 AS plusCnt
				FROM DUAL
			
				UNION ALL
				
				SELECT 
					<!-- 종결건수에서 기준업무량 종결건수로 변경 -->
					<!-- 1 AS baseCnt -->
					workload_ea as baseCnt	
					,0 AS minusCnt
					,0 AS plusCnt
				FROM top_rpt_head 
				WHERE suim_rpt_type1 = 2 
				AND user_no = #{user_no}				
				AND workload_type IN (45,50)
				AND suim_rpt_state = 2 
				AND close_date >= UNIX_TIMESTAMP(#{bgnDe})
				AND close_date &lt; UNIX_TIMESTAMP(#{endDe})
		
				UNION ALL
		
				SELECT 
					0 AS baseCnt
					,((b.collabo_pp / 100) * a.workload_ea) AS minusCnt
					,0 AS plusCnt
				FROM top_rpt_head a, top_rpt_collabo b
				WHERE a.suim_rpt_no = b.suim_rpt_no
				AND a.suim_rpt_type1 = 2
				AND a.user_no = #{user_no}
				AND a.workload_type IN (45,50)
				AND a.suim_rpt_state = 2 
				AND b.collabo_pp != 0				
				AND b.user_id != #{user_no}
				AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
				AND a.close_date &lt; UNIX_TIMESTAMP(#{endDe})
				
				UNION ALL
				
				SELECT 
					0 AS baseCnt
					,0 AS minusCnt
					,((b.collabo_pp / 100) * a.workload_ea) AS plusCnt			
				FROM top_rpt_head a, top_rpt_collabo b
				WHERE a.suim_rpt_no = b.suim_rpt_no
				AND a.suim_rpt_type1 = 2 		
				AND a.workload_type IN (45,50)
				AND a.suim_rpt_state = 2 
				AND b.collabo_pp != 0
				AND b.user_id = #{user_no}		
				AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
				AND a.close_date &lt; UNIX_TIMESTAMP(#{endDe})
				
			)GA
	</select>
	
	<select id="sumSuhypWLCnt_20200327" parameterType="HashMap" resultType="double">
		SELECT 
			IFNULL(SUM(workload_ea),0) AS workload_ea 
		FROM top_rpt_head
		WHERE suim_rpt_type1 = 2 
		AND workload_type IN (45,50)
		AND suim_rpt_state = 2
		AND user_no = #{user_no}
		AND close_date >= UNIX_TIMESTAMP(#{bgnDe})
		AND close_date &lt; UNIX_TIMESTAMP(#{endDe})
	</select>
	
	<select id="sumExtraWc" parameterType="HashMap" resultType="double">
		SELECT 
			IFNULL(SUM( GA.amt_basic), 0) AS total_amt
		FROM
			(
				<!-- 이랜드구내치료비 -->
				SELECT
					IFNULL(b.amt_basic,0) AS amt_basic
				FROM top_rpt_head a, top_rpt_invoice b
				WHERE 1=1
				AND a.suim_rpt_no = b.suim_rpt_no
				AND a.suim_rpt_type1 = 11 
				AND a.workload_type = 10
				AND a.suim_rpt_state = 2
				AND a.user_no = #{user_no}
				AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
				AND a.close_date &lt; UNIX_TIMESTAMP(#{endDe})	
				
				<!-- 정책(가축재해-소서면심사) -->
				UNION ALL
				
				SELECT
					IFNULL(b.amt_basic,0) AS amt_basic
				FROM top_rpt_head a, top_rpt_invoice b
				WHERE 1=1
				AND a.suim_rpt_no = b.suim_rpt_no
				AND a.suim_rpt_type1 = 2 
				AND a.workload_type = 30
				AND a.suim_rpt_state = 2
				AND a.user_no = #{user_no}
				AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
				AND a.close_date &lt; UNIX_TIMESTAMP(#{endDe})	
				
				<!-- 정책(농기계-간편심사) -->
				UNION ALL
				
				SELECT
					IFNULL(b.amt_basic,0) AS amt_basic
				FROM top_rpt_head a, top_rpt_invoice b
				WHERE 1=1
				AND a.suim_rpt_no = b.suim_rpt_no
				AND a.suim_rpt_type1 = 2 
				AND a.workload_type = 35
				AND a.suim_rpt_state = 2
				AND a.user_no = #{user_no}
				AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
				AND a.close_date &lt; UNIX_TIMESTAMP(#{endDe})	
				
				<!-- 서면심사(로지소프트) -->
				UNION ALL
				
				SELECT
					IFNULL(b.amt_basic,0) AS amt_basic
				FROM top_rpt_head a, top_rpt_invoice b
				WHERE 1=1
				AND a.suim_rpt_no = b.suim_rpt_no
				AND a.suim_rpt_type1 = 12 
				AND a.workload_type = 35
				AND a.suim_rpt_state = 2
				AND a.user_no = #{user_no}
				AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
				AND a.close_date &lt; UNIX_TIMESTAMP(#{endDe})
				
				<!-- 서면심사(스마트스코어) -->
				UNION ALL
				
				SELECT
					IFNULL(b.amt_basic,0) AS amt_basic
				FROM top_rpt_head a, top_rpt_invoice b
				WHERE 1=1
				AND a.suim_rpt_no = b.suim_rpt_no
				AND a.suim_rpt_type1 = 12 
				AND a.workload_type = 40
				AND a.suim_rpt_state = 2
				AND a.user_no = #{user_no}
				AND a.close_date >= UNIX_TIMESTAMP(#{bgnDe})
				AND a.close_date &lt; UNIX_TIMESTAMP(#{endDe})	
			)GA
	</select>
	
	<select id="countMcHead" parameterType="HashMap" resultType="integer">		
		SELECT 
			IFNULL(SUM( GA.Cnt), 0) AS Cnt
		FROM
			(		
			SELECT count(*) Cnt 
			FROM top_rpt_head 
			WHERE suim_rpt_type1 = 11 
			AND workload_type = 30
			AND suim_rpt_state = 2 
			AND user_no = #{user_no}
			AND close_date >= UNIX_TIMESTAMP(#{bgnDe})
			AND close_date &lt; UNIX_TIMESTAMP(#{endDe})		
			
			UNION ALL
		
			SELECT count(*) Cnt 
			FROM top_rpt_head 
			WHERE suim_rpt_type1 = 12 
			AND workload_type = 30
			AND suim_rpt_state = 2 
			AND user_no = #{user_no}
			AND close_date >= UNIX_TIMESTAMP(#{bgnDe})
			AND close_date &lt; UNIX_TIMESTAMP(#{endDe})
		)GA 
	</select>
	
	<select id="countMcHead_20200810" parameterType="HashMap" resultType="integer">
		SELECT count(*) Cnt 
		FROM top_rpt_head 
		WHERE suim_rpt_type1 = 11 
		AND workload_type = 30
		AND suim_rpt_state = 2 
		AND user_no = #{user_no}
		AND close_date >= UNIX_TIMESTAMP(#{bgnDe})
		AND close_date &lt; UNIX_TIMESTAMP(#{endDe}) 
	</select>
	
	<select id="countWcHead" parameterType="HashMap" resultType="integer">
		SELECT count(*) Cnt 
		FROM top_rpt_head 
		WHERE suim_rpt_type1 = 11 
		AND workload_type = 25
		AND suim_rpt_state = 2 
		AND user_no = #{user_no}
		AND close_date >= UNIX_TIMESTAMP(#{bgnDe})
		AND close_date &lt; UNIX_TIMESTAMP(#{endDe}) 
	</select>
	
	<select id="countSsHead" parameterType="HashMap" resultType="integer">
		SELECT count(*) Cnt 
		FROM top_rpt_head 
		WHERE suim_rpt_type1 = 12 
		AND workload_type = 40
		AND suim_rpt_state = 2 
		AND user_no = #{user_no}
		AND close_date >= UNIX_TIMESTAMP(#{bgnDe})
		AND close_date &lt; UNIX_TIMESTAMP(#{endDe}) 
	</select>	

	<select id="selectAmtDailyPerson" parameterType="HashMap" resultType="AsraMap">
	SELECT
		IFNULL(SUM(GB.AMT_BASIC),0) AS amt_basic
		,IFNULL(SUM(GB.SHARE_PLUS_AMT_BASIC - GB.SHARE_MINUS_AMT_BASIC),0) AS share_amt_basic
	
		,IFNULL(SUM(GB.AMT_DAILY),0) AS amt_daily
		,IFNULL(SUM(GB.SHARE_PLUS_AMT_DAILY - GB.SHARE_MINUS_AMT_DAILY),0) AS share_amt_daily

		,IFNULL(SUM(GB.AMT_TRAFFIC),0) AS amt_traffic
		,IFNULL(SUM(GB.SHARE_PLUS_AMT_TRAFFIC - GB.SHARE_MINUS_AMT_TRAFFIC),0) AS share_amt_traffic
	FROM
	(	
		SELECT  GA.GUBUN               
			,GA.SUIM_RPT_NO
			
			,IFNULL(SUM(GA.AMT_BASIC),0) AS AMT_BASIC               
			,IFNULL(SUM(GA.SHARE_MINUS_AMT_BASIC),0) AS SHARE_MINUS_AMT_BASIC               
			,IFNULL(SUM(GA.SHARE_PLUS_AMT_BASIC),0) AS SHARE_PLUS_AMT_BASIC
			
			,IFNULL(SUM(GA.AMT_DAILY),0) AS AMT_DAILY               
			,IFNULL(SUM(GA.SHARE_MINUS_AMT_DAILY),0) AS SHARE_MINUS_AMT_DAILY               
			,IFNULL(SUM(GA.SHARE_PLUS_AMT_DAILY),0) AS SHARE_PLUS_AMT_DAILY
			
			,IFNULL(SUM(GA.AMT_TRAFFIC),0) AS AMT_TRAFFIC               
			,IFNULL(SUM(GA.SHARE_MINUS_AMT_TRAFFIC),0) AS SHARE_MINUS_AMT_TRAFFIC               
			,IFNULL(SUM(GA.SHARE_PLUS_AMT_TRAFFIC),0) AS SHARE_PLUS_AMT_TRAFFIC
			
			FROM  (
				SELECT  '-1' AS GUBUN
					,'' AS SUIM_RPT_NO
					
					,0 AS AMT_BASIC                          
					,0 AS SHARE_MINUS_AMT_BASIC                         
					,0 AS SHARE_PLUS_AMT_BASIC
					                        
					,0 AS AMT_DAILY                          
					,0 AS SHARE_MINUS_AMT_DAILY                         
					,0 AS SHARE_PLUS_AMT_DAILY                         

					,0 AS AMT_TRAFFIC                          
					,0 AS SHARE_MINUS_AMT_TRAFFIC                         
					,0 AS SHARE_PLUS_AMT_TRAFFIC 
				FROM  DUAL
	
				UNION ALL
				    
				SELECT  '1' AS GUBUN
					,A.SUIM_RPT_NO
					
					,B.AMT_BASIC                          
					,0 AS SHARE_MINUS_AMT_BASIC                         
					,0 AS SHARE_PLUS_AMT_BASIC
					
					,B.AMT_DAILY                          
					,0 AS SHARE_MINUS_AMT_DAILY                         
					,0 AS SHARE_PLUS_AMT_DAILY                         

					,B.AMT_TRAFFIC                          
					,0 AS SHARE_MINUS_AMT_TRAFFIC                         
					,0 AS SHARE_PLUS_AMT_TRAFFIC 
				FROM  top_rpt_head A
					,top_rpt_invoice B
				WHERE  1=1
					AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO                                          
					AND A.SUIM_RPT_STATE = 2 
					AND  A.USER_NO = #{user_no}
					AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
					AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
	
				UNION ALL
				   
				SELECT  '1' AS GUBUN
					,A.SUIM_RPT_NO
					
					,0 AS AMT_BASIC
					<!-- ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_BASIC * IFNULL(B.COLLABO_PP,0) * 0.01) + (C.AMT_BASIC * IFNULL(D.COLLABO_PP,0) * 0.01) + IFNULL(B.WRITTEN_BASIC,0) -->
					,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_BASIC * IFNULL(E.COLLABO_PP,0) * 0.01) + IFNULL(F.COLLABO_PRICE_MONEY,0) + IFNULL(B.WRITTEN_BASIC,0)			 
					ELSE B.COLLABO_PP 
					END AS SHARE_MINUS_AMT_BASIC
					,0 AS SHARE_PLUS_AMT_BASIC
							         
					,0 AS AMT_DAILY 		                 
					,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_DAILY * IFNULL(B.COLLABO_DAILY_RATIO,0) * 0.01) + IFNULL(D.COLLABO_DAILY_MONEY,0)
					ELSE 0
					END AS SHARE_MINUS_AMT_DAILY                         
					,0 AS SHARE_PLUS_AMT_DAILY
					
					,0 AS AMT_TRAFFIC 		                 
					,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_TRAFFIC,0) + IFNULL(D.COLLABO_TRAFFIC,0))
					ELSE 0
					END AS SHARE_MINUS_AMT_TRAFFIC                        
					,0 AS SHARE_PLUS_AMT_TRAFFIC

				FROM  top_rpt_head A
				LEFT OUTER JOIN 
				(
				SELECT  SUIM_RPT_NO 
					,SUM(COLLABO_PP) AS COLLABO_PP					
					,SUM(COLLABO_DAILY) AS COLLABO_DAILY_RATIO
					,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
					,COUNT(*) AS COLLABO_CNT 
					,SUM(WRITTEN_BASIC) AS WRITTEN_BASIC
					,SUM(WRITTEN_CNT) AS WRITTEN_CNT
				FROM  top_rpt_collabo
				WHERE  COLLABO_DAILY_TYPE = 0 
					GROUP BY SUIM_RPT_NO  
					) B
				ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
				INNER JOIN top_rpt_invoice C
					ON A.SUIM_RPT_NO = C.SUIM_RPT_NO
				LEFT OUTER JOIN						 (
				SELECT  SUIM_RPT_NO
					,SUM(COLLABO_PP) AS COLLABO_PP					
					,SUM(COLLABO_DAILY) AS COLLABO_DAILY_MONEY
					,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
				FROM  top_rpt_collabo
				WHERE  COLLABO_DAILY_TYPE = 1 
					GROUP BY SUIM_RPT_NO  
					) D
				ON D.SUIM_RPT_NO = C.SUIM_RPT_NO
				
				LEFT OUTER JOIN 
					 (
					   SELECT  SUIM_RPT_NO 
						  ,SUM(COLLABO_PP) AS COLLABO_PP
					     FROM  top_rpt_collabo
					    WHERE  COLLABO_PRICE_TYPE = 0 
					    GROUP BY SUIM_RPT_NO  
					 ) E
			      ON A.SUIM_RPT_NO = E.SUIM_RPT_NO                   
			   
			   LEFT OUTER JOIN 
					 (
					   SELECT  SUIM_RPT_NO 
						  ,SUM(COLLABO_PRICE) AS COLLABO_PRICE_MONEY
					     FROM  top_rpt_collabo
					    WHERE  COLLABO_PRICE_TYPE = 1 
					    GROUP BY SUIM_RPT_NO  
					 ) F
			      ON A.SUIM_RPT_NO = F.SUIM_RPT_NO
				
				WHERE  1=1
					AND  A.USER_NO = #{user_no}
					AND  A.SUIM_RPT_STATE = 2
					AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
					AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
	
				UNION ALL
				
				SELECT  '4' AS GUBUN
					,A.SUIM_RPT_NO
					
					,0 AS AMT_BASIC
					,0 AS SHARE_MINUS_AMT_BASIC
					<!-- ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_BASIC * B.COLLABO_PP * 0.01) + IFNULL(B.WRITTEN_BASIC,0) -->
					,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_PRICE_TYPE = 0 THEN (C.AMT_BASIC * B.COLLABO_PP * 0.01) + IFNULL(B.WRITTEN_BASIC,0)
							 WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15 ,16, 17, 18) AND B.COLLABO_PRICE_TYPE = 1 THEN B.COLLABO_PRICE
					ELSE B.COLLABO_PP
					END AS SHARE_PLUS_AMT_BASIC
					                          
					,0 AS AMT_DAILY                          
					,0 AS SHARE_MINUS_AMT_DAILY                         
					,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_DAILY_TYPE = 0 THEN (C.AMT_DAILY * B.COLLABO_DAILY * 0.01)
					WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15 ,16, 17, 18) AND B.COLLABO_DAILY_TYPE = 1 THEN B.COLLABO_DAILY 
					ELSE 0
					END AS SHARE_PLUS_AMT_DAILY                         

					,0 AS AMT_TRAFFIC                          
					,0 AS SHARE_MINUS_AMT_TRAFFIC
					,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN B.COLLABO_TRAFFIC
					ELSE 0
					END AS SHARE_PLUS_TRAFFIC

				FROM  top_rpt_head A
					,top_rpt_collabo B
					,top_rpt_invoice C 
				WHERE  1=1
					AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
					AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
					AND  B.USER_ID = #{user_no}
					AND  A.SUIM_RPT_STATE = 2
					AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
					AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
	
				UNION ALL
					
				SELECT '2' AS GUBUN
					,A.SUIM_RPT_NO
					
					,SUM(B.SHARE_AMT_BASIC) AS AMT_BASIC
					,0 AS SHARE_MINUS_AMT_BASIC
					,0 AS SHARE_PLUS_AMT_BASIC
										
					,SUM(B.SHARE_AMT_DAILY) AS AMT_DAILY                       
					,0 AS SHARE_MINUS_AMT_DAILY                                                  
					,0 AS SHARE_PLUS_AMT_DAILY                         

					,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC                       
					,0 AS SHARE_MINUS_AMT_TRAFFIC                                                  
					,0 AS SHARE_PLUS_AMT_TRAFFIC
				FROM  top_prim_biz_rpt_head A
					INNER JOIN  top_prim_biz_inv_share B 
				ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
				WHERE  1=1     
					AND  A.SUIM_RPT_TYPE1 = 5
					AND  A.USER_NO = #{user_no}
					AND  B.SHARE_USER_NO = A.USER_NO
					AND  A.SUIM_RPT_STATE = 2
					AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
					AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
				GROUP BY SUIM_RPT_NO
	
				UNION ALL                 
	
				SELECT '2' AS GUBUN                         
					,A.SUIM_RPT_NO
					
					,0 AS AMT_BASIC                         
					<!-- ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC  농작물은 공동수행 마이너스제거 -->
					,0 AS SHARE_MINUS_AMT_BASIC                         
					,0 AS SHARE_PLUS_AMT_BASIC
					
					,0 AS AMT_DAILY                         
					<!-- ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY 농작물은 공동수행 마이너스제거-->
					,0 AS SHARE_MINUS_AMT_DAILY                         
					,0 AS SHARE_PLUS_AMT_DAILY                         

					,0 AS AMT_TRAFFIC                         
					<!-- ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC 농작물은 공동수행 마이너스제거-->
					,0 AS SHARE_MINUS_AMT_TRAFFIC                         
					,0 AS SHARE_PLUS_AMT_TRAFFIC
				FROM  top_prim_biz_rpt_head A
				INNER JOIN  top_prim_biz_inv_share B 
					ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
				WHERE  1=1     
					AND  A.SUIM_RPT_TYPE1 = 5
					AND  A.USER_NO = #{user_no}
					AND  B.SHARE_USER_NO != A.USER_NO
					AND  A.SUIM_RPT_STATE = 2
					AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
					AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
				GROUP BY SUIM_RPT_NO			
	
				UNION ALL
				
				SELECT  '5' AS GUBUN  
					,A.SUIM_RPT_NO
					
					,0 AS AMT_BASIC                          
					,0 AS SHARE_MINUS_AMT_BASIC                         
					,B.SHARE_AMT_BASIC AS SHARE_PLUS_AMT_BASIC
					                       
					,0 AS AMT_DAILY                          
					,0 AS SHARE_MINUS_AMT_DAILY                         
					,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_DAILY                         

					,0 AS AMT_TRAFFIC                          
					,0 AS SHARE_MINUS_AMT_TRAFFIC                         
					,B.SHARE_AMT_TRAFFIC AS SHARE_PLUS_AMT_TRAFFIC
				FROM  top_prim_biz_rpt_head A
					,top_prim_biz_inv_share B  
				WHERE  1=1
					AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
					AND  A.USER_NO != B.SHARE_USER_NO  
					AND  A.SUIM_RPT_TYPE1 = 5
					AND  B.SHARE_USER_NO = #{user_no}
					AND  A.SUIM_RPT_STATE = 2
					AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
					AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
	
				UNION ALL 
	
				SELECT '3' AS GUBUN        
					,A.SUIM_RPT_NO
					 
					,B.AMT_BASIC                         
					,0 AS SHARE_MINUS_AMT_BASIC                         
					,0 AS SHARE_PLUS_AMT_BASIC     
					           
					,B.AMT_DAILY                         
					,0 AS SHARE_MINUS_AMT_DAILY                         
					,0 AS SHARE_PLUS_AMT_DAILY                         

					,B.AMT_TRAFFIC                         
					,0 AS SHARE_MINUS_AMT_TRAFFIC                         
					,0 AS SHARE_PLUS_AMT_TRAFFIC
				FROM  top_prim_biz_rpt_head A
				INNER JOIN  top_prim_biz_inv B 
					ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
				WHERE  1=1     
					AND  A.SUIM_RPT_TYPE1 IN (6, 7, 8, 9, 10, 99)
					AND  A.USER_NO = #{user_no}
					AND  A.SUIM_RPT_STATE = 2
					AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
					AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
				
				UNION ALL
	
				SELECT '3' AS GUBUN   
					,A.SUIM_RPT_NO
					
					,0 AS AMT_BASIC
					,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC                         
					,0 AS SHARE_PLUS_AMT_BASIC
											
					,0 AS AMT_DAILY                         
					,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY                         
					,0 AS SHARE_PLUS_AMT_DAILY
					
					,0 AS AMT_TRAFFIC                         
					,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC                         
					,0 AS SHARE_PLUS_AMT_TRAFFIC
				FROM  top_prim_biz_rpt_head A
				INNER JOIN  top_prim_biz_inv_share B 
					ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
				WHERE  1=1     
					AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
					AND  A.USER_NO = #{user_no}
					AND  B.SHARE_USER_NO != A.USER_NO
					AND  A.SUIM_RPT_STATE = 2
					AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
					AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
				GROUP BY SUIM_RPT_NO
				                   
				UNION ALL
	
				SELECT '3' AS GUBUN      
					,A.SUIM_RPT_NO
					
					,0 AS AMT_BASIC
					,0 AS SHARE_MINUS_AMT_BASIC                         
					,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
					           
					,0 AS AMT_DAILY                         
					,0 AS SHARE_MINUS_AMT_DAILY                         
					,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
					
					,0 AS AMT_TRAFFIC                         
					,0 AS SHARE_MINUS_AMT_TRAFFIC                         
					,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
				FROM  top_prim_biz_rpt_head A
				INNER JOIN  top_prim_biz_inv_share B 
					ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
				WHERE  1=1     
					AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
					AND  A.USER_NO = #{user_no}
					AND  B.SHARE_USER_NO = A.USER_NO
					AND  A.SUIM_RPT_STATE = 2
					AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
					AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
				GROUP BY SUIM_RPT_NO                           
	
				UNION ALL
				
				SELECT  '6' AS GUBUN
					,A.SUIM_RPT_NO
					
					,0 AS AMT_BASIC                          
					,0 AS SHARE_MINUS_AMT_BASIC                                                   
					,B.SHARE_AMT_BASIC AS SHARE_PLUS_AMT_BASIC
					
					,0 AS AMT_DAILY                          
					,0 AS SHARE_MINUS_AMT_DAILY                                                   
					,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_DAILY
					
					,0 AS AMT_TRAFFIC                          
					,0 AS SHARE_MINUS_AMT_TRAFFIC                                                   
					,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_TRAFFIC
				FROM  top_prim_biz_rpt_head A
					,top_prim_biz_inv_share B  
				WHERE  1=1
					AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
					AND  A.USER_NO != B.SHARE_USER_NO  
					AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
					AND  B.SHARE_USER_NO = #{user_no}
					AND  A.SUIM_RPT_STATE = 2
					AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
					AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
			) GA
			WHERE  1=1
				AND  GA.GUBUN > 0
			GROUP BY GA.GUBUN, GA.SUIM_RPT_NO
	)GB
	
	</select>	

	<select id="selectTopMemberListByApprovalAmt" parameterType="HashMap" resultType="AsraMap">
 		SELECT a.user_no
 			  ,a.user_name
 			  ,b.team_name
 			  ,b.team_id
		  FROM top_mbr_bsc a
		 INNER JOIN top_tm_bsc b
		    ON a.team_id_main = b.team_id
		 WHERE user_state != 1
		 	AND a.approval_amt_auth = 1 
		 ORDER BY b.team_group_order DESC, b.team_order DESC, a.WORK_TYPE ASC, a.WORK_LEVEL DESC, a.USER_NO ASC	
	</select>

	<select id="selectTopMemberList" parameterType="HashMap" resultType="AsraMap">
 		SELECT a.user_no
 			  ,a.user_name
 			  ,b.team_name
 			  ,b.team_id
		  FROM top_mbr_bsc a
		 INNER JOIN top_tm_bsc b
		    ON a.team_id_main = b.team_id
		 WHERE user_state != 1
		 ORDER BY b.team_group_order DESC, b.team_order DESC, a.WORK_TYPE ASC, a.WORK_LEVEL DESC, a.USER_NO ASC	
	</select>

	<select id="selectStatisticTeamList" parameterType="hashmap" resultType="AsraMap">
        SELECT  A.TEAM_ID
               ,A.TEAM_NAME
               ,A.TEAM_TYPE
               ,A.TEAM_LEVEL
               ,A.TEAM_WRITTEN
          FROM  top_tm_bsc A
         WHERE  1=1
           AND  ((A.TEAM_TYPE = 1 AND  A.TEAM_STATISTICS1 = 0) OR (A.TEAM_TYPE = 4 AND  A.TEAM_STATISTICS4 = 0))
        ORDER BY A.TEAM_GROUP_ORDER DESC, A.TEAM_ORDER DESC, A.TEAM_ID DESC
    </select>

	<select id="selectStatisticMember" parameterType="hashmap" resultType="AsraMap">
		SELECT  A.USER_NO
			   ,A.USER_ID
			   ,A.USER_NAME
			   ,A.USER_STATE
		  FROM  top_mbr_bsc A
		 WHERE  1=1
		   AND  A.USER_NO = #{user_no}
    </select>
	<select id="selectStatisticMemberList" parameterType="hashmap" resultType="AsraMap">
		SELECT  A.USER_NO 
		       ,A.USER_ID 
		       ,A.USER_NAME 
		       ,A.USER_STATE
		  FROM  top_mbr_bsc A 
		 WHERE  1=1
		   AND  A.USER_NO IN(
		                      SELECT  C.USER_NO
		                        FROM  (
		                                  SELECT  A.USER_NO              
		                                    FROM  top_rpt_head A
		                                   WHERE  1=1
		                                     AND  A.TEAM_ID = #{team_id}
		                                     AND  ( 
		                                              (A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe}))
		                                           OR (A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe}))
		                                           OR (A.SUIM_RPT_STATE IN(0, 1, 4, 11))
		                                          )
										  UNION
		                                  SELECT  B.USER_ID
		                                    FROM  top_rpt_head A
												 ,top_rpt_collabo B
		                                   WHERE  1=1
		                                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                                     AND  B.SHARE_TEAM_ID = #{team_id}
		                                     AND  (
		                                              (A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe}))
		                                           OR (A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe}))
		                                           OR (A.SUIM_RPT_STATE IN(0, 1, 4, 11))
		                                          )
		                                  UNION
		                                  SELECT  A.USER_NO
		                                    FROM  top_rpt_head A 
		                                         ,top_rpt_invoice B
		                                   WHERE  1=1
		                                     AND  A.TEAM_ID = #{team_id}
                                             AND  ( 
                                                      (A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe}))
                                                   OR (A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe}))
                                                  )
		                                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                                     AND  A.CLOSE_DATE > 0
		                                     AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                                  UNION
		                                  SELECT  A.USER_NO             
		                                    FROM  top_prim_biz_rpt_head A
		                                   WHERE  1=1
		                                     AND  A.TEAM_ID = #{team_id}
		                                     AND  ( 
		                                               (A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe}))
		                                            OR (A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe}))
		                                            OR (A.SUIM_RPT_STATE IN(0, 1, 4, 11))
		                                          )
		                                  UNION
		                                  SELECT  B.SHARE_USER_NO AS USER_NO
		                                    FROM  top_prim_biz_rpt_head A
		                                         ,top_prim_biz_inv_share B
		                                   WHERE  1=1
		                                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                                     AND  B.SHARE_TEAM_ID = #{team_id}
		                                     AND  (
		                                               (A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe}))
		                                            OR (A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe}))
		                                            OR (A.SUIM_RPT_STATE IN(0, 1, 4, 11))
		                                          )
		                                  UNION
		                                  SELECT  A.USER_NO
		                                    FROM  top_prim_biz_rpt_head A 
		                                         ,top_prim_biz_inv B
		                                   WHERE  1=1
		                                     AND  A.TEAM_ID = #{team_id}
		                                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                             AND  ( 
                                                       (A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe}))
                                                    OR (A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe}))
                                                  )
		                                     AND  A.CLOSE_DATE > 0
		                                     AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                                  UNION    
		                                  SELECT  A.USER_NO
		                                    FROM  top_mbr_bsc A 
		                                   WHERE  1=1
		                                     AND  A.TEAM_ID_MAIN = #{team_id}
		                                     AND  A.USER_STATE != 1                             
		                                                                                                 
		                              ) C
		                       WHERE  1=1                     
		                    )
		GROUP BY A.WORK_TYPE, A.WORK_LEVEL DESC, A.USER_NO ASC                     
	    <!--  
		SELECT  A.USER_NO
			   ,A.USER_ID
			   ,A.USER_NAME
			   ,A.USER_STATE
		  FROM  top_mbr_bsc A
		 WHERE  1=1
		   AND  A.TEAM_ID_MAIN = #{team_id}
		   AND  ((A.USER_STATE = 1 AND A.OUT_DATE >= UNIX_TIMESTAMP(#{bgnDe})) OR (A.USER_STATE !=1 AND A.JOIN_DATE &lt; UNIX_TIMESTAMP(#{endDe})))
		ORDER BY A.WORK_LEVEL DESC, A.USER_NO ASC
		-->
    </select>
    
    <!-- 서면심사 팀 조건 확인 -->
    <select id="selectCountMemberWrittenList" parameterType="hashmap" resultType="Integer">
    	SELECT 
			COUNT(*) as cnt 		
		FROM 
			top_rpt_written_info 
		WHERE 1=1 		
		AND user_no = #{user_no}
		AND team_id = #{team_id}
		AND base_date >= #{sdate}
		AND base_date &lt; #{edate}
    </select>
    
    <!-- 서면심사 팀 조건 확인 -->
    <select id="selectCountWrittenList" parameterType="hashmap" resultType="Integer">
    	SELECT 
			COUNT(*) as cnt 		
		FROM 
			top_mbr_bsc a, top_rpt_written_info b 
		WHERE a.user_no = b.user_no
		AND a.user_state != 1
		AND a.team_id_main = #{team_id}
		AND b.base_date >= #{sdate}
		AND b.base_date &lt; #{edate}
    </select>
    
    <select id="selectSumMemberWrittenList" parameterType="hashmap" resultType="AsraMap">
    	SELECT
			IFNULL(SUM(GA.suim_cnt),0) AS suim_cnt
			,IFNULL(SUM(GA.end_cnt),0) AS end_cnt	
			,IFNULL(GA.unsolve_cnt,0) AS unsolve_cnt
			,IFNULL(GA.cancel_cnt,0) AS cancel_cnt			
		FROM
		(		
			SELECT 
				suim_cnt
				,end_cnt
				,unsolve_cnt
				,cancel_cnt				
			FROM 
				top_rpt_written_info
			WHERE 1=1		
			AND user_no = #{user_no}
			AND team_id = #{team_id}
			AND base_date >= #{sdate}
			AND base_date &lt; #{edate}
			ORDER BY base_date DESC
		)GA    
    </select>
    
    <select id="selectSumMemberWrittenList_20200513" parameterType="hashmap" resultType="AsraMap">
    	SELECT 
			SUM(IFNULL(suim_cnt,0)) AS suim_cnt 	
			,SUM(IFNULL(end_cnt,0)) AS end_cnt 	
			,SUM(IFNULL(unsolve_cnt,0)) AS unsolve_cnt 		
		FROM 
			top_rpt_written_info
		WHERE 1=1		
		AND user_no = #{user_no}
		AND base_date >= #{sdate}
		AND base_date &lt; #{edate}    
    </select>
    
    <select id="selectSumPtnrWrittenList" parameterType="hashmap" resultType="AsraMap">
    	SELECT	
			IFNULL(SUM(GB.suim_cnt),0) AS suim_cnt
			,IFNULL(SUM(GB.end_cnt),0) AS end_cnt
			,IFNULL(SUM(GB.unsolve_cnt),0) AS unsolve_cnt
			,IFNULL(SUM(GB.cancel_cnt),0) AS cancel_cnt
			,IFNULL(SUM(GB.trans_cnt),0) AS trans_cnt			
		FROM (
					(
						SELECT
							0 AS suim_cnt
							,0 AS end_cnt
							,GA.unsolve_cnt
							,0 AS cancel_cnt
							,0 AS trans_cnt									
						FROM
							(
				
								SELECT
									user_no
									,team_id
									,0 AS suim_cnt
									,0 AS end_cnt
									,unsolve_cnt
									,0 AS cancel_cnt
									,0 AS trans_cnt
								FROM top_rpt_written_info
								WHERE 1=1
								AND base_date >= #{sdate}								
								AND base_date &lt; #{base_date}								
								AND ptnr_id = #{ptnr_id}
								ORDER BY base_date DESC			
							)GA
						GROUP BY GA.user_no
					)
		
				UNION ALL
			
					(
				
						SELECT		
							suim_cnt
							,end_cnt
							,0 AS unsolve_cnt
							,cancel_cnt
							,trans_cnt
						FROM top_rpt_written_info
						WHERE 1=1						
						AND base_date >= #{sdate}
						AND base_date &lt; #{edate}						
						AND ptnr_id = #{ptnr_id}
						ORDER BY base_date DESC
					)
			)GB    
    </select>
    
    <select id="selectSumWrittenList" parameterType="hashmap" resultType="AsraMap">
    	SELECT	
			IFNULL(SUM(GB.suim_cnt),0) AS suim_cnt
			,IFNULL(SUM(GB.end_cnt),0) AS end_cnt
			,IFNULL(SUM(GB.unsolve_cnt),0) AS unsolve_cnt
			,IFNULL(SUM(GB.cancel_cnt),0) AS cancel_cnt
			,IFNULL(SUM(GB.trans_cnt),0) AS trans_cnt			
		FROM (
					(
						SELECT
							0 AS suim_cnt
							,0 AS end_cnt
							,GA.unsolve_cnt
							,0 AS cancel_cnt
							,0 AS trans_cnt									
						FROM
							(
				
								SELECT
									user_no
									,team_id
									,0 AS suim_cnt
									,0 AS end_cnt
									,unsolve_cnt
									,0 AS cancel_cnt
									,0 AS trans_cnt
								FROM top_rpt_written_info
								WHERE 1=1
								<!-- AND base_date >= #{sdate} -->
								<!-- AND base_date &lt; #{edate} -->
								AND base_date >= #{sdate}
								AND base_date &lt; #{base_date}
								AND team_id = #{team_id}
								ORDER BY base_date DESC			
							)GA
						GROUP BY GA.user_no
					)
		
				UNION ALL
			
					(
				
						SELECT		
							suim_cnt
							,end_cnt
							,0 AS unsolve_cnt
							,cancel_cnt
							,trans_cnt
						FROM top_rpt_written_info
						WHERE 1=1						
						AND base_date >= #{sdate}
						AND base_date &lt; #{edate}
						AND team_id = #{team_id}
						ORDER BY base_date DESC
					)
			)GB    
    </select>
    
    <select id="selectSumWrittenList_20200514" parameterType="hashmap" resultType="AsraMap">
    	SELECT
			IFNULL(SUM(GA.suim_cnt),0) AS suim_cnt
			,IFNULL(SUM(GA.end_cnt),0) AS end_cnt	
			,GA.unsolve_cnt
		FROM		
		(
	    	SELECT 
				 suim_cnt 	
				,end_cnt 	
				,unsolve_cnt
			FROM 
				top_mbr_bsc a, top_rpt_written_info b 
			WHERE a.user_no = b.user_no
			AND a.user_state != 1
			AND a.team_id_main = #{team_id}
			AND b.base_date >= #{sdate}
			AND b.base_date &lt; #{edate}
			ORDER BY base_date desc
		)GA    
    </select>
    
    <!-- 1종 전체 팀 통계 -->
	<!-- new기본 - statistics_basic_team_list1 -->
	<select id="selectBasicTeamList1Quick" parameterType="hashmap" resultType="AsraMap">
		SELECT  GA.TEAM_ID 
		       ,GA.TEAM_NAME 
		       ,GA.TEAM_WRITTEN
		       ,IFNULL(GB.RECEIVE_MONTH_CNT, 0) AS RECEIVE_MONTH_CNT
		       ,IFNULL(GB.RECEIVE_YEAR_CNT, 0) AS RECEIVE_YEAR_CNT
		       ,IFNULL(GB.CLOSE_MONTH_CNT, 0) AS CLOSE_MONTH_CNT
		       ,IFNULL(GB.CLOSE_YEAR_CNT, 0) AS CLOSE_YEAR_CNT
		       ,IFNULL(GB.CLOSE_MONTH_EA, 0) AS CLOSE_MONTH_EA
		       ,IFNULL(GB.CLOSE_YEAR_EA, 0) AS CLOSE_YEAR_EA
		       ,IFNULL(GB.PENDING_CURRENT_CNT, 0) AS PENDING_CURRENT_CNT
		       ,IFNULL(GB.PENDING_OVER45_CNT, 0) AS PENDING_OVER45_CNT
		       ,IFNULL(GB.PENDING_MONTHLY_CNT, 0) AS PENDING_MONTHLY_CNT
		       ,IFNULL(GB.AMT_BASIC , 0) AS AMT_BASIC
		       ,IFNULL(GB.AMT_DAILY , 0) AS AMT_DAILY
		       ,IFNULL(GB.AMT_TRAFFIC , 0) AS AMT_TRAFFIC
		       ,IFNULL(GB.AMT_COUNSEL , 0) AS AMT_COUNSEL
		       ,IFNULL(GB.AMT_ETC, 0) AS AMT_ETC
		       ,IFNULL(GB.AMT_TOTAL, 0) AS AMT_TOTAL
		       ,IFNULL(GB.OUT_AMT, 0) AS OUT_AMT
		       ,IFNULL(GB.SHARE_AMT_BASIC, 0) AS SHARE_AMT_BASIC
		       ,IFNULL(GB.SHARE_AMT_DAILY, 0) AS SHARE_AMT_DAILY
		       ,IFNULL(GB.SHARE_AMT_TRAFFIC, 0) AS SHARE_AMT_TRAFFIC
		       ,IFNULL(GB.SHARE_AMT_COUNSEL, 0) AS SHARE_AMT_COUNSEL
		       ,IFNULL(GB.SHARE_AMT_ETC, 0) AS SHARE_AMT_ETC
		       ,IFNULL(GB.SHARE_AMT_TOTAL, 0) AS SHARE_AMT_TOTAL		       
		  FROM  top_tm_bsc GA
		  LEFT  JOIN (
		              SELECT  GA.TEAM_ID
		                     ,SUM(GA.RECEIVE_MONTH_CNT) AS RECEIVE_MONTH_CNT
		                     ,SUM(GA.RECEIVE_YEAR_CNT) AS RECEIVE_YEAR_CNT
		                     ,SUM(GA.CLOSE_MONTH_CNT) AS CLOSE_MONTH_CNT
		                     ,SUM(GA.CLOSE_YEAR_CNT) AS CLOSE_YEAR_CNT
		                     ,SUM(GA.CLOSE_MONTH_EA) AS CLOSE_MONTH_EA
		                     ,SUM(GA.CLOSE_YEAR_EA) AS CLOSE_YEAR_EA
		                     ,SUM(GA.PENDING_CURRENT_CNT) AS PENDING_CURRENT_CNT
		                     ,SUM(GA.PENDING_OVER45_CNT) AS PENDING_OVER45_CNT
		                     ,SUM(GA.PENDING_MONTHLY_CNT) AS PENDING_MONTHLY_CNT
		                     ,SUM(GA.AMT_BASIC) AS AMT_BASIC
		                     ,SUM(GA.AMT_DAILY) AS AMT_DAILY
		                     ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
		                     ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
		                     ,SUM(GA.AMT_ETC) AS AMT_ETC
		                     ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
		                     ,SUM(GA.OUT_AMT) AS OUT_AMT
		                     ,SUM(GA.SHARE_PLUS_AMT_BASIC - GA.SHARE_MINUS_AMT_BASIC) AS SHARE_AMT_BASIC
		                     ,SUM(GA.SHARE_PLUS_AMT_DAILY - GA.SHARE_MINUS_AMT_DAILY) AS SHARE_AMT_DAILY
		                     ,SUM(GA.SHARE_PLUS_AMT_TRAFFIC - GA.SHARE_MINUS_AMT_TRAFFIC) AS SHARE_AMT_TRAFFIC
		                     ,SUM(GA.SHARE_PLUS_AMT_COUNSEL - GA.SHARE_MINUS_AMT_COUNSEL) AS SHARE_AMT_COUNSEL
		                     ,SUM(GA.SHARE_PLUS_AMT_ETC - GA.SHARE_MINUS_AMT_ETC) AS SHARE_AMT_ETC
		                     ,SUM(GA.SHARE_PLUS_AMT_TOTAL - GA.SHARE_MINUS_AMT_TOTAL) AS SHARE_AMT_TOTAL		                     
		                FROM  (
		                        SELECT  -1 AS TEAM_ID 
		                               ,-1 AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT     
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                                  
		                          FROM  DUAL
		                           
		                        UNION ALL
		                        SELECT  A.team_id 
		                               ,B.user_no 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT      
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                                                                                                                                          
		                          FROM top_tm_bsc A, top_mbr_bsc B	                          
		                         WHERE  1=1
		                           AND  A.team_id = B.team_id_main AND B.user_state != 1		                           
		                        GROUP BY B.user_no 
		                           
		                        <if test='basicYN == "Y"'>
		                        UNION ALL                
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT      
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       								   
		                          FROM  top_rpt_head A
		                         FORCE  INDEX (REG_DATE) 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       						   
		                          FROM  top_rpt_head A
		                         FORCE  INDEX (REG_DATE)  
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									   
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									   
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       							   
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									   
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT       
		                               ,0 AS PENDING_MONTHLY_CNT 
		                               ,SUM( (B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) ) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									   
		                          FROM  top_rpt_head A 
		                               ,top_rpt_invoice B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO       
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT 
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       							   
		                          FROM  top_rpt_head A 
		                               ,top_rpt_invoice B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3 
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       				   
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 1
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.TEAM_ID, A.USER_NO
								 UNION ALL
		                        SELECT  B.SHARE_TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT
								       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC -->								       								       
								       ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC
								       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_PLUS_AMT_DAILY
								       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL		
								       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									                                          
						           FROM  top_rpt_head A
						                ,top_rpt_collabo B
						                ,top_rpt_invoice C 
						          WHERE  1=1
						            AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
						            AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
						            AND  A.SUIM_RPT_TYPE1 NOT IN(3, 4)						            
						            AND  A.SUIM_RPT_STATE != 3
						            AND  B.SHARE_TEAM_ID IS NOT NULL
						            AND  A.CLOSE_DATE >= UNIX_TIMESTAMP((#{bgnDe}))
						            AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP((#{endDe}))
						         GROUP BY B.SHARE_TEAM_ID		                         
								 UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
								       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC -->
								       ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       					   
						           FROM  top_rpt_head A
						                ,top_rpt_collabo B
						                ,top_rpt_invoice C 
						          WHERE  1=1
						            AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
						            AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
						            AND  A.SUIM_RPT_TYPE1 NOT IN(3, 4)						            
						            AND  A.SUIM_RPT_STATE != 3
						            AND  B.SHARE_TEAM_ID IS NOT NULL
						            AND  A.CLOSE_DATE >= UNIX_TIMESTAMP((#{bgnDe}))
						            AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP((#{endDe}))
						         GROUP BY A.TEAM_ID		    
		                        </if> 
		                        <if test='primYN == "Y"'>
		                        -- 농산물
		                        UNION ALL 
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT   
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC	
								       ,0 AS SHARE_PLUS_AMT_TOTAL	
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       						   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL		
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT        
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       						   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT      
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       			   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       			   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT     
		                               ,0 AS PENDING_MONTHLY_CNT		                                  
		                               ,SUM(B.AMT_BASIC) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                          
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO       
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT 
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									   
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									   
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 2
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.TEAM_ID, A.USER_NO		
		                         UNION ALL
		                        SELECT  B.SHARE_TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC			
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL			
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC	
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL	
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									   
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY B.SHARE_TEAM_ID
		                         
		                         UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC						
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL		
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC		
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL                                       
                                       		   
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY A.TEAM_ID		                           		                                      
		                                    
		                        </if>
		                        <if test='contractYN == "Y"'>
		                        -- 적부
		                        UNION ALL 
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT          
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       	   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       								   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       							   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       			   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT      
		                               ,0 AS PENDING_MONTHLY_CNT		                                 
		                               ,SUM(B.AMT_BASIC) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									   
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO       
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       							   
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.TEAM_ID, A.USER_NO

		                         UNION ALL
		                        SELECT  B.SHARE_TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC		
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_TOTAL
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       									   
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY B.SHARE_TEAM_ID
		                         
		                         UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC	
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL		
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL                                       
                                       							   
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY A.TEAM_ID		    		                        
		                        </if>                                                                 
		                      ) GA
		               WHERE  1=1
		              GROUP BY GA.TEAM_ID              
		             ) GB
		    ON  GA.TEAM_ID = GB.TEAM_ID         
		 WHERE  1=1
		   AND  GA.TEAM_STATISTICS1 = 0
		   AND  GA.TEAM_TYPE != 4
		ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC, GA.TEAM_ID DESC         	
	</select>	
    
    <!-- 1종 전체 팀 통계 -->
	<!-- new기본 - statistics_basic_team_list1 -->
	<select id="selectBasicTeamList1" parameterType="hashmap" resultType="AsraMap">
		SELECT  GA.TEAM_ID 
		       ,GA.TEAM_NAME 
		       ,GA.TEAM_WRITTEN
		       ,IFNULL(GB.RECEIVE_MONTH_CNT, 0) AS RECEIVE_MONTH_CNT
		       ,IFNULL(GB.RECEIVE_YEAR_CNT, 0) AS RECEIVE_YEAR_CNT
		       ,IFNULL(GB.CLOSE_MONTH_CNT, 0) AS CLOSE_MONTH_CNT
		       ,IFNULL(GB.CLOSE_YEAR_CNT, 0) AS CLOSE_YEAR_CNT
		       ,IFNULL(GB.CLOSE_MONTH_EA, 0) AS CLOSE_MONTH_EA
		       ,IFNULL(GB.CLOSE_YEAR_EA, 0) AS CLOSE_YEAR_EA
		       ,IFNULL(GB.PENDING_CURRENT_CNT, 0) AS PENDING_CURRENT_CNT
		       ,IFNULL(GB.PENDING_OVER45_CNT, 0) AS PENDING_OVER45_CNT
		       ,IFNULL(GB.PENDING_MONTHLY_CNT, 0) AS PENDING_MONTHLY_CNT
		       ,IFNULL(GB.AMT_BASIC , 0) AS AMT_BASIC
		       ,IFNULL(GB.AMT_DAILY , 0) AS AMT_DAILY
		       ,IFNULL(GB.AMT_TRAFFIC , 0) AS AMT_TRAFFIC
		       ,IFNULL(GB.AMT_COUNSEL , 0) AS AMT_COUNSEL
		       ,IFNULL(GB.AMT_ETC, 0) AS AMT_ETC
		       ,IFNULL(GB.AMT_TOTAL, 0) AS AMT_TOTAL
		       ,IFNULL(GB.OUT_AMT, 0) AS OUT_AMT
		       ,IFNULL(GB.SHARE_AMT_BASIC, 0) AS SHARE_AMT_BASIC
		       ,IFNULL(GB.SHARE_AMT_DAILY, 0) AS SHARE_AMT_DAILY
		       ,IFNULL(GB.SHARE_AMT_TRAFFIC, 0) AS SHARE_AMT_TRAFFIC
		       ,IFNULL(GB.SHARE_AMT_COUNSEL, 0) AS SHARE_AMT_COUNSEL
		       ,IFNULL(GB.SHARE_AMT_ETC, 0) AS SHARE_AMT_ETC
		       ,IFNULL(GB.SHARE_AMT_TOTAL, 0) AS SHARE_AMT_TOTAL
		       
		       ,IFNULL(GB.WORKLOAD_YEAR_RESULT, 0) AS WORKLOAD_YEAR_RESULT		       
		  FROM  top_tm_bsc GA
		  LEFT  JOIN (
		              SELECT  GA.TEAM_ID
		                     ,SUM(GA.RECEIVE_MONTH_CNT) AS RECEIVE_MONTH_CNT
		                     ,SUM(GA.RECEIVE_YEAR_CNT) AS RECEIVE_YEAR_CNT
		                     ,SUM(GA.CLOSE_MONTH_CNT) AS CLOSE_MONTH_CNT
		                     ,SUM(GA.CLOSE_YEAR_CNT) AS CLOSE_YEAR_CNT
		                     ,SUM(GA.CLOSE_MONTH_EA) AS CLOSE_MONTH_EA
		                     ,SUM(GA.CLOSE_YEAR_EA) AS CLOSE_YEAR_EA
		                     ,SUM(GA.PENDING_CURRENT_CNT) AS PENDING_CURRENT_CNT
		                     ,SUM(GA.PENDING_OVER45_CNT) AS PENDING_OVER45_CNT
		                     ,SUM(GA.PENDING_MONTHLY_CNT) AS PENDING_MONTHLY_CNT
		                     ,SUM(GA.AMT_BASIC) AS AMT_BASIC
		                     ,SUM(GA.AMT_DAILY) AS AMT_DAILY
		                     ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
		                     ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
		                     ,SUM(GA.AMT_ETC) AS AMT_ETC
		                     ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
		                     ,SUM(GA.OUT_AMT) AS OUT_AMT
		                     ,SUM(GA.SHARE_PLUS_AMT_BASIC - GA.SHARE_MINUS_AMT_BASIC) AS SHARE_AMT_BASIC
		                     ,SUM(GA.SHARE_PLUS_AMT_DAILY - GA.SHARE_MINUS_AMT_DAILY) AS SHARE_AMT_DAILY
		                     ,SUM(GA.SHARE_PLUS_AMT_TRAFFIC - GA.SHARE_MINUS_AMT_TRAFFIC) AS SHARE_AMT_TRAFFIC
		                     ,SUM(GA.SHARE_PLUS_AMT_COUNSEL - GA.SHARE_MINUS_AMT_COUNSEL) AS SHARE_AMT_COUNSEL
		                     ,SUM(GA.SHARE_PLUS_AMT_ETC - GA.SHARE_MINUS_AMT_ETC) AS SHARE_AMT_ETC
		                     ,SUM(GA.SHARE_PLUS_AMT_TOTAL - GA.SHARE_MINUS_AMT_TOTAL) AS SHARE_AMT_TOTAL
		                     
		                     ,SUM(GA.WORKLOAD_YEAR) AS WORKLOAD_YEAR_RESULT		                     
		                FROM  (
		                        SELECT  -1 AS TEAM_ID 
		                               ,-1 AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT     
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORKLOAD_YEAR                                       
		                          FROM  DUAL
		                           
		                        UNION ALL
		                        SELECT  A.team_id 
		                               ,B.user_no 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT      
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       <!-- ,IFNULL( (SELECT calc_workload from top_rpt_workload_daily WHERE user_no = B.user_no AND base_date &lt; UNIX_TIMESTAMP(#{sEndyear}) ORDER BY base_date DESC LIMIT 1), 0) AS WORKLOAD_YEAR -->
                                       ,0 AS WORKLOAD_YEAR
                                                                                                                                                          
		                          FROM top_tm_bsc A, top_mbr_bsc B	                          
		                         WHERE  1=1
		                           AND  A.team_id = B.team_id_main AND B.user_state != 1		                           
		                        GROUP BY B.user_no 
		                           
		                        <if test='basicYN == "Y"'>
		                        UNION ALL                
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT      
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_rpt_head A
		                         FORCE  INDEX (REG_DATE) 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16 ,17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_rpt_head A
		                         FORCE  INDEX (REG_DATE)  
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16 ,17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16 ,17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16 ,17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16 ,17, 18, 19)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16 ,17, 18, 19)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT       
		                               ,0 AS PENDING_MONTHLY_CNT 
		                               <!-- ,SUM(B.AMT_BASIC) AS AMT_BASIC -->
		                               ,SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_rpt_head A 
		                               ,top_rpt_invoice B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16 ,17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO       
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT 
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_rpt_head A 
		                               ,top_rpt_invoice B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16 ,17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3 
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 1
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.TEAM_ID, A.USER_NO
								 UNION ALL
		                        SELECT  B.SHARE_TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT							       
								       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC -->
								       ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC								       
								       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_PLUS_AMT_DAILY
								       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL		
								       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									                                          
						           FROM  top_rpt_head A
						                ,top_rpt_collabo B
						                ,top_rpt_invoice C 
						          WHERE  1=1
						            AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
						            AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
						            AND  A.SUIM_RPT_TYPE1 NOT IN(3, 4)						            
						            AND  A.SUIM_RPT_STATE != 3
						            AND  B.SHARE_TEAM_ID IS NOT NULL
						            AND  A.CLOSE_DATE >= UNIX_TIMESTAMP((#{bgnDe}))
						            AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP((#{endDe}))
						         GROUP BY B.SHARE_TEAM_ID		                         
								 UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL								       
								       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC -->
								       ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC								       
                                       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
						           FROM  top_rpt_head A
						                ,top_rpt_collabo B
						                ,top_rpt_invoice C 
						          WHERE  1=1
						            AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
						            AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
						            AND  A.SUIM_RPT_TYPE1 NOT IN(3, 4)						            
						            AND  A.SUIM_RPT_STATE != 3
						            AND  B.SHARE_TEAM_ID IS NOT NULL
						            AND  A.CLOSE_DATE >= UNIX_TIMESTAMP((#{bgnDe}))
						            AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP((#{endDe}))
						         GROUP BY A.TEAM_ID		    
		                        </if> 
		                        <if test='primYN == "Y"'>
		                        -- 농산물
		                        UNION ALL 
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT   
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC	
								       ,0 AS SHARE_PLUS_AMT_TOTAL	
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL		
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT        
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT      
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT     
		                               ,0 AS PENDING_MONTHLY_CNT		                                  
		                               ,SUM(B.AMT_BASIC) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO       
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT 
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 2
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.TEAM_ID, A.USER_NO		
		                         UNION ALL
		                        SELECT  B.SHARE_TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC			
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL			
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC	
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL	
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY B.SHARE_TEAM_ID
		                         
		                         UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC						
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL		
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC		
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY A.TEAM_ID		                           		                                      
		                                    
		                        </if>
		                        <if test='contractYN == "Y"'>
		                        -- 적부
		                        UNION ALL 
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT          
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT      
		                               ,0 AS PENDING_MONTHLY_CNT		                                 
		                               ,SUM(B.AMT_BASIC) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO       
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT		                               
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.TEAM_ID, A.USER_NO

		                         UNION ALL
		                        SELECT  B.SHARE_TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC		
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_TOTAL
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY B.SHARE_TEAM_ID
		                         
		                         UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC	
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL		
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR									   
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY A.TEAM_ID		    		                        
		                        </if>                                                                 
		                      ) GA
		               WHERE  1=1
		              GROUP BY GA.TEAM_ID              
		             ) GB
		    ON  GA.TEAM_ID = GB.TEAM_ID         
		 WHERE  1=1
		   AND  GA.TEAM_STATISTICS1 = 0
		   AND  GA.TEAM_TYPE = 1
		ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC, GA.TEAM_ID DESC         	
	</select>	
    
	<!-- new기본 - statistics_basic_team_list4 -->
    <select id="selectBasicTeamList4Quick" parameterType="hashmap" resultType="AsraMap">
		SELECT  GA.TEAM_ID 
		       ,GA.TEAM_NAME 
		       ,IFNULL(GB.RECEIVE_MONTH_CNT, 0) AS RECEIVE_MONTH_CNT
		       ,IFNULL(GB.RECEIVE_YEAR_CNT, 0) AS RECEIVE_YEAR_CNT
		       ,IFNULL(GB.CLOSE_MONTH_CNT, 0) AS CLOSE_MONTH_CNT
		       ,IFNULL(GB.CLOSE_YEAR_CNT, 0) AS CLOSE_YEAR_CNT
		       ,IFNULL(GB.CLOSE_MONTH_EA, 0) AS CLOSE_MONTH_EA
		       ,IFNULL(GB.CLOSE_YEAR_EA, 0) AS CLOSE_YEAR_EA
		       ,IFNULL(GB.PENDING_CURRENT_CNT, 0) AS PENDING_CURRENT_CNT
		       ,IFNULL(GB.PENDING_OVER45_CNT, 0) AS PENDING_OVER45_CNT
		       ,IFNULL(GB.PENDING_MONTHLY_CNT, 0) AS PENDING_MONTHLY_CNT
		       ,IFNULL(GB.AMT_BASIC , 0) AS AMT_BASIC
		       ,IFNULL(GB.AMT_DAILY , 0) AS AMT_DAILY
		       ,IFNULL(GB.AMT_TRAFFIC , 0) AS AMT_TRAFFIC
		       ,IFNULL(GB.AMT_COUNSEL , 0) AS AMT_COUNSEL
		       ,IFNULL(GB.AMT_ETC, 0) AS AMT_ETC
		       ,IFNULL(GB.AMT_TOTAL, 0) AS AMT_TOTAL
		       ,IFNULL(GB.OUT_AMT, 0) AS OUT_AMT
		       ,IFNULL(GB.SHARE_AMT_BASIC, 0) AS SHARE_AMT_BASIC
		       ,IFNULL(GB.SHARE_AMT_DAILY, 0) AS SHARE_AMT_DAILY
		       ,IFNULL(GB.SHARE_AMT_TRAFFIC, 0) AS SHARE_AMT_TRAFFIC
		       ,IFNULL(GB.SHARE_AMT_COUNSEL, 0) AS SHARE_AMT_COUNSEL
		       ,IFNULL(GB.SHARE_AMT_ETC, 0) AS SHARE_AMT_ETC
		       ,IFNULL(GB.SHARE_AMT_TOTAL, 0) AS SHARE_AMT_TOTAL		       
		  FROM  top_tm_bsc GA
		  LEFT  JOIN (
		              SELECT  GA.TEAM_ID
		                     ,SUM(GA.RECEIVE_MONTH_CNT) AS RECEIVE_MONTH_CNT
		                     ,SUM(GA.RECEIVE_YEAR_CNT) AS RECEIVE_YEAR_CNT
		                     ,SUM(GA.CLOSE_MONTH_CNT) AS CLOSE_MONTH_CNT
		                     ,SUM(GA.CLOSE_YEAR_CNT) AS CLOSE_YEAR_CNT
		                     ,SUM(GA.CLOSE_MONTH_EA) AS CLOSE_MONTH_EA
		                     ,SUM(GA.CLOSE_YEAR_EA) AS CLOSE_YEAR_EA
		                     ,SUM(GA.PENDING_CURRENT_CNT) AS PENDING_CURRENT_CNT
		                     ,SUM(GA.PENDING_OVER45_CNT) AS PENDING_OVER45_CNT
		                     ,SUM(GA.PENDING_MONTHLY_CNT) AS PENDING_MONTHLY_CNT
		                     ,SUM(GA.AMT_BASIC) AS AMT_BASIC
		                     ,SUM(GA.AMT_DAILY) AS AMT_DAILY
		                     ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
		                     ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
		                     ,SUM(GA.AMT_ETC) AS AMT_ETC
		                     ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
		                     ,SUM(GA.OUT_AMT) AS OUT_AMT
		                     ,SUM(GA.SHARE_PLUS_AMT_BASIC - GA.SHARE_MINUS_AMT_BASIC) AS SHARE_AMT_BASIC
		                     ,SUM(GA.SHARE_PLUS_AMT_DAILY - GA.SHARE_MINUS_AMT_DAILY) AS SHARE_AMT_DAILY
		                     ,SUM(GA.SHARE_PLUS_AMT_TRAFFIC - GA.SHARE_MINUS_AMT_TRAFFIC) AS SHARE_AMT_TRAFFIC	
		                     ,SUM(GA.SHARE_PLUS_AMT_COUNSEL - GA.SHARE_MINUS_AMT_COUNSEL) AS SHARE_AMT_COUNSEL	
		                     ,SUM(GA.SHARE_PLUS_AMT_ETC - GA.SHARE_MINUS_AMT_ETC) AS SHARE_AMT_ETC	
		                     ,SUM(GA.SHARE_PLUS_AMT_TOTAL - GA.SHARE_MINUS_AMT_TOTAL) AS SHARE_AMT_TOTAL		                     
		                     
		                FROM  (
		                        SELECT  -1 AS TEAM_ID 
		                               ,-1 AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT         
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
		                          FROM  DUAL 
		                          
		                          UNION ALL
									SELECT  A.team_id 
								       ,B.user_no 
								       ,0 AS RECEIVE_MONTH_CNT
								       ,0 AS RECEIVE_YEAR_CNT
								       ,0 AS CLOSE_MONTH_CNT
								       ,0 AS CLOSE_YEAR_CNT
								       ,0 AS CLOSE_MONTH_EA
								       ,0 AS CLOSE_YEAR_EA
								       ,0 AS PENDING_CURRENT_CNT
								       ,0 AS PENDING_OVER45_CNT
								       ,0 AS PENDING_MONTHLY_CNT
								       ,0 AS AMT_BASIC 
								       ,0 AS AMT_DAILY 
								       ,0 AS AMT_TRAFFIC 
								       ,0 AS AMT_COUNSEL 
								       ,0 AS AMT_ETC
								       ,0 AS AMT_TOTAL
								       ,0 AS OUT_AMT      
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
									   ,0 AS SHARE_MINUS_AMT_BASIC
								       ,0 AS SHARE_MINUS_AMT_DAILY
								       ,0 AS SHARE_MINUS_AMT_TRAFFIC
								       ,0 AS SHARE_MINUS_AMT_COUNSEL
								       ,0 AS SHARE_MINUS_AMT_ETC
								       ,0 AS SHARE_MINUS_AMT_TOTAL								       
								                                                                                   
									  FROM top_tm_bsc A, top_mbr_bsc B	                          
									 WHERE  1=1
									   AND  A.team_id = B.team_id_main AND B.user_state != 1		                           
									GROUP BY B.user_no 
									
		                        <if test='basicYN == "Y"'>
		                        UNION ALL                
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
									   	                                       
		                          FROM  top_rpt_head A
		                         FORCE  INDEX (REG_DATE) 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT            
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                                                        
		                          FROM  top_rpt_head A
		                         FORCE  INDEX (REG_DATE) 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT        
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       	                                      
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT      
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       		                                       
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                                         
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       			                               
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,SUM(B.AMT_BASIC) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       		                               
		                          FROM  top_rpt_head A 
		                               ,top_rpt_invoice B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO       
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       		                                
		                          FROM  top_rpt_head A 
		                               ,top_rpt_invoice B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4) 
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       		                               
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 1
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.TEAM_ID, A.USER_NO			
		                         UNION ALL
		                        SELECT  B.SHARE_TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,SUM(B.COLLABO_PP) AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC
								       ,0 AS SHARE_PLUS_AMT_COUNSEL
								       ,0 AS SHARE_PLUS_AMT_ETC
								       ,0 AS SHARE_PLUS_AMT_TOTAL
								       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                                                              
						           FROM  top_rpt_head A
						                ,top_rpt_collabo B
						                ,top_rpt_invoice C 
						          WHERE  1=1
						            AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
						            AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
						            AND  A.SUIM_RPT_TYPE1 IN(3, 4)						            
						            AND  A.SUIM_RPT_STATE != 3
						            AND  B.SHARE_TEAM_ID IS NOT NULL
						            AND  A.CLOSE_DATE >= UNIX_TIMESTAMP((#{bgnDe}))
						            AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP((#{endDe}))
						         GROUP BY B.SHARE_TEAM_ID		                         
								 UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC			
								       ,0 AS SHARE_PLUS_AMT_TOTAL			
								       ,SUM(B.COLLABO_PP) AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC 
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
						           FROM  top_rpt_head A
						                ,top_rpt_collabo B
						                ,top_rpt_invoice C 
						          WHERE  1=1
						            AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
						            AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
						            AND  A.SUIM_RPT_TYPE1 IN(3, 4) 
						            AND  A.SUIM_RPT_STATE != 3
						            AND  B.SHARE_TEAM_ID IS NOT NULL
						            AND  A.CLOSE_DATE >= UNIX_TIMESTAMP((#{bgnDe}))
						            AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP((#{endDe}))
						         GROUP BY A.TEAM_ID			                                                 
		                        </if>
		                        <if test='primYN == "Y"'>
		                        -- 농산물
		                        UNION ALL 
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                                
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       	                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                        
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,SUM(B.AMT_BASIC) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO       
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
		                               
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 2
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.TEAM_ID, A.USER_NO			     
		                         UNION ALL
		                        SELECT  B.SHARE_TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC	
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL	
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY B.SHARE_TEAM_ID
		                         
		                         UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC		
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		        
								       ,0 AS SHARE_PLUS_AMT_TOTAL		        
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC	
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL	
		                               ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL		                               
		                               
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY A.TEAM_ID		      		                                            
		                        </if>
		                        <if test='contractYN == "Y"'>
		                        -- 적부
		                        UNION ALL 
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                              
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,SUM(B.AMT_BASIC) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO       
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                       
                                       
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        
		                         UNION ALL
		                        SELECT  B.SHARE_TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC				
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL				
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC		
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL		
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC
		                               ,0 AS SHARE_MINUS_AMT_COUNSEL
		                               ,0 AS SHARE_MINUS_AMT_ETC
		                               ,0 AS SHARE_MINUS_AMT_TOTAL		                               
		                               
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY B.SHARE_TEAM_ID
		                         
		                         UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC						         
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL						         
                                       ,0 AS SHARE_PLUS_AMT_ETC				
                                       ,0 AS SHARE_PLUS_AMT_TOTAL				
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
		                               ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL		                               
		                               
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY A.TEAM_ID		      		              		                        
		                        </if>                                                                 
		                      ) GA
		               WHERE  1=1
		              GROUP BY GA.TEAM_ID              
		             ) GB
		    ON  GA.TEAM_ID = GB.TEAM_ID         
		 WHERE  1=1
		   AND  GA.TEAM_STATISTICS4 = 0
		   AND  GA.TEAM_TYPE = 4
		ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC, GA.TEAM_ID DESC 
    </select>
	
	
	<!-- new기본 - statistics_basic_team_list4 -->
    <select id="selectBasicTeamList4" parameterType="hashmap" resultType="AsraMap">
		SELECT  GA.TEAM_ID 
		       ,GA.TEAM_NAME 
		       ,IFNULL(GB.RECEIVE_MONTH_CNT, 0) AS RECEIVE_MONTH_CNT
		       ,IFNULL(GB.RECEIVE_YEAR_CNT, 0) AS RECEIVE_YEAR_CNT
		       ,IFNULL(GB.CLOSE_MONTH_CNT, 0) AS CLOSE_MONTH_CNT
		       ,IFNULL(GB.CLOSE_YEAR_CNT, 0) AS CLOSE_YEAR_CNT
		       ,IFNULL(GB.CLOSE_MONTH_EA, 0) AS CLOSE_MONTH_EA
		       ,IFNULL(GB.CLOSE_YEAR_EA, 0) AS CLOSE_YEAR_EA
		       ,IFNULL(GB.PENDING_CURRENT_CNT, 0) AS PENDING_CURRENT_CNT
		       ,IFNULL(GB.PENDING_OVER45_CNT, 0) AS PENDING_OVER45_CNT
		       ,IFNULL(GB.PENDING_MONTHLY_CNT, 0) AS PENDING_MONTHLY_CNT
		       ,IFNULL(GB.AMT_BASIC , 0) AS AMT_BASIC
		       ,IFNULL(GB.AMT_DAILY , 0) AS AMT_DAILY
		       ,IFNULL(GB.AMT_TRAFFIC , 0) AS AMT_TRAFFIC
		       ,IFNULL(GB.AMT_COUNSEL , 0) AS AMT_COUNSEL
		       ,IFNULL(GB.AMT_ETC, 0) AS AMT_ETC
		       ,IFNULL(GB.AMT_TOTAL, 0) AS AMT_TOTAL
		       ,IFNULL(GB.OUT_AMT, 0) AS OUT_AMT
		       ,IFNULL(GB.SHARE_AMT_BASIC, 0) AS SHARE_AMT_BASIC
		       ,IFNULL(GB.SHARE_AMT_DAILY, 0) AS SHARE_AMT_DAILY
		       ,IFNULL(GB.SHARE_AMT_TRAFFIC, 0) AS SHARE_AMT_TRAFFIC
		       ,IFNULL(GB.SHARE_AMT_COUNSEL, 0) AS SHARE_AMT_COUNSEL
		       ,IFNULL(GB.SHARE_AMT_ETC, 0) AS SHARE_AMT_ETC
		       ,IFNULL(GB.SHARE_AMT_TOTAL, 0) AS SHARE_AMT_TOTAL
		       
		       ,IFNULL(GB.WORKLOAD_YEAR_RESULT, 0) AS WORKLOAD_YEAR_RESULT
	           ,IFNULL(GB.WORKLOAD_MONTH_RESULT, 0) AS WORKLOAD_MONTH_RESULT
		  FROM  top_tm_bsc GA
		  LEFT  JOIN (
		              SELECT  GA.TEAM_ID
		                     ,SUM(GA.RECEIVE_MONTH_CNT) AS RECEIVE_MONTH_CNT
		                     ,SUM(GA.RECEIVE_YEAR_CNT) AS RECEIVE_YEAR_CNT
		                     ,SUM(GA.CLOSE_MONTH_CNT) AS CLOSE_MONTH_CNT
		                     ,SUM(GA.CLOSE_YEAR_CNT) AS CLOSE_YEAR_CNT
		                     ,SUM(GA.CLOSE_MONTH_EA) AS CLOSE_MONTH_EA
		                     ,SUM(GA.CLOSE_YEAR_EA) AS CLOSE_YEAR_EA
		                     ,SUM(GA.PENDING_CURRENT_CNT) AS PENDING_CURRENT_CNT
		                     ,SUM(GA.PENDING_OVER45_CNT) AS PENDING_OVER45_CNT
		                     ,SUM(GA.PENDING_MONTHLY_CNT) AS PENDING_MONTHLY_CNT
		                     ,SUM(GA.AMT_BASIC) AS AMT_BASIC
		                     ,SUM(GA.AMT_DAILY) AS AMT_DAILY
		                     ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
		                     ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
		                     ,SUM(GA.AMT_ETC) AS AMT_ETC
		                     ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
		                     ,SUM(GA.OUT_AMT) AS OUT_AMT
		                     ,SUM(GA.SHARE_PLUS_AMT_BASIC - GA.SHARE_MINUS_AMT_BASIC) AS SHARE_AMT_BASIC
		                     ,SUM(GA.SHARE_PLUS_AMT_DAILY - GA.SHARE_MINUS_AMT_DAILY) AS SHARE_AMT_DAILY
		                     ,SUM(GA.SHARE_PLUS_AMT_TRAFFIC - GA.SHARE_MINUS_AMT_TRAFFIC) AS SHARE_AMT_TRAFFIC	
		                     ,SUM(GA.SHARE_PLUS_AMT_COUNSEL - GA.SHARE_MINUS_AMT_COUNSEL) AS SHARE_AMT_COUNSEL	
		                     ,SUM(GA.SHARE_PLUS_AMT_ETC - GA.SHARE_MINUS_AMT_ETC) AS SHARE_AMT_ETC	
		                     ,SUM(GA.SHARE_PLUS_AMT_TOTAL - GA.SHARE_MINUS_AMT_TOTAL) AS SHARE_AMT_TOTAL	
		                     
		                     ,SUM(GA.WORKLOAD_YEAR) AS WORKLOAD_YEAR_RESULT
			     			 ,(SUM(GA.WORKLOAD_MONTH)-SUM(GA.WORKLOAD_LAST_MONTH)) AS WORKLOAD_MONTH_RESULT
		                FROM  (
		                        SELECT  -1 AS TEAM_ID 
		                               ,-1 AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT         
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORKLOAD_YEAR                                       
								       ,0 AS WORKLOAD_MONTH
								       ,0 AS WORKLOAD_LAST_MONTH    
		                          FROM  DUAL 
		                          
		                          UNION ALL
									SELECT  A.team_id 
								       ,B.user_no 
								       ,0 AS RECEIVE_MONTH_CNT
								       ,0 AS RECEIVE_YEAR_CNT
								       ,0 AS CLOSE_MONTH_CNT
								       ,0 AS CLOSE_YEAR_CNT
								       ,0 AS CLOSE_MONTH_EA
								       ,0 AS CLOSE_YEAR_EA
								       ,0 AS PENDING_CURRENT_CNT
								       ,0 AS PENDING_OVER45_CNT
								       ,0 AS PENDING_MONTHLY_CNT
								       ,0 AS AMT_BASIC 
								       ,0 AS AMT_DAILY 
								       ,0 AS AMT_TRAFFIC 
								       ,0 AS AMT_COUNSEL 
								       ,0 AS AMT_ETC
								       ,0 AS AMT_TOTAL
								       ,0 AS OUT_AMT      
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
									   ,0 AS SHARE_MINUS_AMT_BASIC
								       ,0 AS SHARE_MINUS_AMT_DAILY
								       ,0 AS SHARE_MINUS_AMT_TRAFFIC
								       ,0 AS SHARE_MINUS_AMT_COUNSEL
								       ,0 AS SHARE_MINUS_AMT_ETC
								       ,0 AS SHARE_MINUS_AMT_TOTAL
								       
								       ,IFNULL( (SELECT calc_workload from top_rpt_workload_daily WHERE user_no = B.user_no AND base_date &lt; UNIX_TIMESTAMP(#{sEndyear}) ORDER BY base_date DESC LIMIT 0, 1), 0) AS WORKLOAD_YEAR
								       ,IFNULL( (SELECT calc_workload from top_rpt_workload_daily WHERE user_no = B.user_no AND base_date &lt; UNIX_TIMESTAMP(#{chkMonthDate}) ORDER BY base_date DESC LIMIT 0, 1), 0) AS WORKLOAD_MONTH
								       ,IFNULL( (SELECT calc_workload from top_rpt_workload_daily WHERE user_no = B.user_no AND base_date &lt; UNIX_TIMESTAMP(#{chkLastMonthDate}) ORDER BY base_date DESC LIMIT 0, 1), 0) AS WORKLOAD_LAST_MONTH                                                                            
									  FROM top_tm_bsc A, top_mbr_bsc B	                          
									 WHERE  1=1
									   AND  A.team_id = B.team_id_main AND B.user_state != 1		                           
									GROUP BY B.user_no 
									
		                        <if test='basicYN == "Y"'>
		                        UNION ALL                
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
									   ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH	                                       
		                          FROM  top_rpt_head A
		                         FORCE  INDEX (REG_DATE) 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT            
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH	                                 
		                          FROM  top_rpt_head A
		                         FORCE  INDEX (REG_DATE) 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT        
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH		                                      
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT      
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH		                                       
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH		                               
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH			                               
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,SUM(B.AMT_BASIC) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH		                               
		                          FROM  top_rpt_head A 
		                               ,top_rpt_invoice B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO       
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH			                                
		                          FROM  top_rpt_head A 
		                               ,top_rpt_invoice B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 IN(3, 4) 
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH		                               
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 1
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.TEAM_ID, A.USER_NO			
		                         UNION ALL
		                        SELECT  B.SHARE_TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,SUM(B.COLLABO_PP) AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC
								       ,0 AS SHARE_PLUS_AMT_COUNSEL
								       ,0 AS SHARE_PLUS_AMT_ETC
								       ,0 AS SHARE_PLUS_AMT_TOTAL
								       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH                                       
						           FROM  top_rpt_head A
						                ,top_rpt_collabo B
						                ,top_rpt_invoice C 
						          WHERE  1=1
						            AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
						            AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
						            AND  A.SUIM_RPT_TYPE1 IN(3, 4)						            
						            AND  A.SUIM_RPT_STATE != 3
						            AND  B.SHARE_TEAM_ID IS NOT NULL
						            AND  A.CLOSE_DATE >= UNIX_TIMESTAMP((#{bgnDe}))
						            AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP((#{endDe}))
						         GROUP BY B.SHARE_TEAM_ID		                         
								 UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC			
								       ,0 AS SHARE_PLUS_AMT_TOTAL			
								       ,SUM(B.COLLABO_PP) AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC 
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH 
						           FROM  top_rpt_head A
						                ,top_rpt_collabo B
						                ,top_rpt_invoice C 
						          WHERE  1=1
						            AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
						            AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
						            AND  A.SUIM_RPT_TYPE1 IN(3, 4) 
						            AND  A.SUIM_RPT_STATE != 3
						            AND  B.SHARE_TEAM_ID IS NOT NULL
						            AND  A.CLOSE_DATE >= UNIX_TIMESTAMP((#{bgnDe}))
						            AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP((#{endDe}))
						         GROUP BY A.TEAM_ID			                                                 
		                        </if>
		                        <if test='primYN == "Y"'>
		                        -- 농산물
		                        UNION ALL 
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH	                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH	                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH	                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,SUM(B.AMT_BASIC) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH	                               
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO       
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
		                               ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 2
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.TEAM_ID, A.USER_NO			     
		                         UNION ALL
		                        SELECT  B.SHARE_TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC	
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL	
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY B.SHARE_TEAM_ID
		                         
		                         UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC		
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		        
								       ,0 AS SHARE_PLUS_AMT_TOTAL		        
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC	
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL	
		                               ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
		                               
		                               ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY A.TEAM_ID		      		                                            
		                        </if>
		                        <if test='contractYN == "Y"'>
		                        -- 적부
		                        UNION ALL 
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH	                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        UNION ALL   
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO     
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.TEAM_ID, A.USER_NO    
		                        UNION ALL
		                        SELECT  A.TEAM_ID 
		                               ,A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.TEAM_ID, A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,SUM(B.AMT_BASIC) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.TEAM_ID, A.USER_NO       
		                        UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       
                                       ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.TEAM_ID, A.USER_NO
		                        
		                         UNION ALL
		                        SELECT  B.SHARE_TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC				
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL				
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC		
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL		
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC
		                               ,0 AS SHARE_MINUS_AMT_COUNSEL
		                               ,0 AS SHARE_MINUS_AMT_ETC
		                               ,0 AS SHARE_MINUS_AMT_TOTAL
		                               
		                               ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY B.SHARE_TEAM_ID
		                         
		                         UNION ALL
		                        SELECT  A.TEAM_ID
		                               ,A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC						         
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL						         
                                       ,0 AS SHARE_PLUS_AMT_ETC				
                                       ,0 AS SHARE_PLUS_AMT_TOTAL				
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
		                               ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
		                               
		                               ,0 AS WORK_LOAD_YEAR
									   ,0 AS WORK_LOAD_MONTH
									   ,0 AS WORK_LOAD_LAST_MONTH
		                          FROM  top_prim_biz_rpt_head A
		                         INNER JOIN top_prim_biz_inv_share B
		                            ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_TYPE1 IN(6,7,8,9,10,99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  B.SHARE_TEAM_ID IS NOT NULL
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                         GROUP BY A.TEAM_ID		      		              		                        
		                        </if>                                                                 
		                      ) GA
		               WHERE  1=1
		              GROUP BY GA.TEAM_ID              
		             ) GB
		    ON  GA.TEAM_ID = GB.TEAM_ID         
		 WHERE  1=1
		   AND  GA.TEAM_STATISTICS4 = 0
		   AND  GA.TEAM_TYPE = 4
		ORDER BY GA.TEAM_GROUP_ORDER DESC, GA.TEAM_ORDER DESC, GA.TEAM_ID DESC 
    </select>
    
    <!-- 서면심사팀 포함여부 체크 -->
    <select id="selectWrittenPersonChk" parameterType="hashmap" resultType="AsraMap">
    	SELECT 
			b.team_written as team_written 
		FROM top_mbr_bsc a, top_tm_bsc b
		WHERE a.team_id_main = b.team_id
		AND a.user_no = #{user_no}
    	
    </select>
    
    <!-- 팀기준 통계 기준업무량 제외-->
    <!-- NEW기본통계 - statistics_basic_member_list - 팀기준1 기준업무량제외-->
    <select id="selectBasicMemberList1Quick" parameterType="hashmap" resultType="AsraMap">
		SELECT  GA.USER_NO 
		       ,GA.USER_NAME 
               ,IFNULL(GB.RECEIVE_MONTH_CNT, 0) AS RECEIVE_MONTH_CNT
               ,IFNULL(GB.RECEIVE_YEAR_CNT, 0) AS RECEIVE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_CNT, 0) AS CLOSE_MONTH_CNT
               ,IFNULL(GB.CLOSE_YEAR_CNT, 0) AS CLOSE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_EA, 0) AS CLOSE_MONTH_EA
               ,IFNULL(GB.CLOSE_MONTH_WORKLOAD_EA, 0) AS CLOSE_MONTH_WORKLOAD_EA
               ,IFNULL(GB.CLOSE_SHARE_EA, 0) AS CLOSE_SHARE_EA
               ,IFNULL(GB.CLOSE_SHARE_WORKLOAD_EA, 0) AS CLOSE_SHARE_WORKLOAD_EA
               
               ,IFNULL(GB.PENDING_CURRENT_CNT, 0) AS PENDING_CURRENT_CNT
               ,IFNULL(GB.PENDING_OVER45_CNT, 0) AS PENDING_OVER45_CNT
               ,IFNULL(GB.PENDING_MONTHLY_CNT, 0) AS PENDING_MONTHLY_CNT               
               ,IFNULL(GB.AMT_BASIC , 0) AS AMT_BASIC
               ,IFNULL(GB.AMT_DAILY , 0) AS AMT_DAILY
               ,IFNULL(GB.AMT_COUNSEL , 0) AS AMT_COUNSEL
               ,IFNULL(GB.AMT_ETC, 0) AS AMT_ETC
               ,IFNULL(GB.AMT_TOTAL, 0) AS AMT_TOTAL
               ,IFNULL(GB.AMT_TRAFFIC , 0) AS AMT_TRAFFIC
               ,IFNULL(GB.SHARE_AMT_BASIC,0) AS SHARE_AMT_BASIC
               ,IFNULL(GB.SHARE_AMT_DAILY,0) AS SHARE_AMT_DAILY
               ,IFNULL(GB.SHARE_AMT_TRAFFIC,0) AS SHARE_AMT_TRAFFIC
               ,IFNULL(GB.SHARE_AMT_COUNSEL,0) AS SHARE_AMT_COUNSEL
               ,IFNULL(GB.SHARE_AMT_ETC,0) AS SHARE_AMT_ETC
               ,IFNULL(GB.SHARE_AMT_TOTAL,0) AS SHARE_AMT_TOTAL
               ,IFNULL(GB.OUT_AMT, 0) AS OUT_AMT
               ,IFNULL(GB.YEAR_AMT_BASIC, 0) AS YEAR_AMT_BASIC
               ,IFNULL(GB.YEAR_SHARE_AMT_BASIC, 0) AS YEAR_SHARE_AMT_BASIC               
               
			   ,CASE GA.WORK_TYPE
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15	
				END AS NEW_WORK_ORDER
		  FROM  top_mbr_bsc GA
		 INNER  JOIN (
		              SELECT  GA.USER_NO
		                     ,SUM(GA.RECEIVE_MONTH_CNT) AS RECEIVE_MONTH_CNT
		                     ,SUM(GA.RECEIVE_YEAR_CNT) AS RECEIVE_YEAR_CNT
		                     ,SUM(GA.CLOSE_MONTH_CNT) AS CLOSE_MONTH_CNT
		                     ,SUM(GA.CLOSE_YEAR_CNT) AS CLOSE_YEAR_CNT
		                     ,SUM(GA.CLOSE_MONTH_EA) AS CLOSE_MONTH_EA
		                     ,SUM(GA.CLOSE_MONTH_WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA
		                     ,SUM(GA.CLOSE_MONTH_EA_CAL + GA.CLOSE_SHARE_PLUS_EA - GA.CLOSE_SHARE_MINUS_EA) AS CLOSE_SHARE_EA
		                     ,SUM(GA.CLOSE_MONTH_WORKLOAD_EA_CAL + GA.CLOSE_SHARE_PLUS_WORKLOAD_EA - GA.CLOSE_SHARE_MINUS_WORKLOAD_EA) AS CLOSE_SHARE_WORKLOAD_EA
		                                          
		                     ,SUM(GA.PENDING_CURRENT_CNT) AS PENDING_CURRENT_CNT
		                     ,SUM(GA.PENDING_OVER45_CNT) AS PENDING_OVER45_CNT
		                     ,SUM(GA.PENDING_MONTHLY_CNT) AS PENDING_MONTHLY_CNT
		                     ,SUM(GA.AMT_BASIC) AS AMT_BASIC
		                     ,SUM(GA.AMT_DAILY) AS AMT_DAILY
		                     ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
		                     ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
		                     ,SUM(GA.AMT_ETC) AS AMT_ETC
		                     ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
		                     ,SUM(GA.SHARE_PLUS_AMT_BASIC - GA.SHARE_MINUS_AMT_BASIC) AS SHARE_AMT_BASIC
		                     ,SUM(GA.SHARE_PLUS_AMT_DAILY - GA.SHARE_MINUS_AMT_DAILY) AS SHARE_AMT_DAILY
		                     ,SUM(GA.SHARE_PLUS_AMT_TRAFFIC - GA.SHARE_MINUS_AMT_TRAFFIC) AS SHARE_AMT_TRAFFIC
		                     ,SUM(GA.SHARE_PLUS_AMT_COUNSEL - GA.SHARE_MINUS_AMT_COUNSEL) AS SHARE_AMT_COUNSEL
		                     ,SUM(GA.SHARE_PLUS_AMT_ETC - GA.SHARE_MINUS_AMT_ETC) AS SHARE_AMT_ETC
		                     ,SUM(GA.SHARE_PLUS_AMT_TOTAL - GA.SHARE_MINUS_AMT_TOTAL) AS SHARE_AMT_TOTAL
		                     ,SUM(GA.OUT_AMT) AS OUT_AMT
		                     ,SUM(GA.YEAR_AMT_BASIC) AS YEAR_AMT_BASIC
                             ,SUM(GA.YEAR_SHARE_PLUS_AMT_BASIC - GA.YEAR_SHARE_MINUS_AMT_BASIC) AS YEAR_SHARE_AMT_BASIC
		                     
		                FROM  (
		                        SELECT -1 AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT         
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  DUAL
		                        <if test='basicYN == "Y"'>
		                        UNION ALL 		                        
		                        SELECT  A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                                       
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                        
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                                           
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
		                               ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                           
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                                            
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA 
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                          
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL
		                        SELECT  B.USER_ID AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,SUM(B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_PLUS_EA
		                               ,SUM(B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                                                                      
                                       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC -->
                                       ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  top_rpt_head A
		                               ,top_rpt_collabo B
		                               ,top_rpt_invoice C 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
								   AND  B.SHARE_TEAM_ID = #{team_id}
		                           AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
								   -- AND  B.USER_ID IN(SELECT USER_NO FROM top_mbr_bsc C WHERE C.TEAM_ID_MAIN = '122')
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY B.USER_ID
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,SUM(B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_MINUS_EA
		                               ,SUM(B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + SUM(B.WRITTEN_BASIC) AS SHARE_MINUS_AMT_BASIC -->
                                       ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + SUM(B.WRITTEN_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  top_rpt_head A
		                               ,top_rpt_collabo B
		                               ,top_rpt_invoice C
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3 
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO                              
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                       
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                                    
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.USER_NO    
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                           
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                              
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT       
		                               ,0 AS PENDING_MONTHLY_CNT 
		                               <!-- ,SUM(B.AMT_BASIC) AS AMT_BASIC --> 
		                               ,SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) AS AMT_BASIC
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  top_rpt_head A 
		                               ,top_rpt_invoice B
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id} 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO       
		                        UNION ALL
		                        SELECT  A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                          
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  top_rpt_head A 
		                               ,top_rpt_invoice B
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id} 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3 
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.USER_NO
		                        
								UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA 
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   <!-- ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC -->
									   ,SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})             
                                 GROUP BY A.USER_NO
                                 
                                 UNION ALL
                                 
                                SELECT  B.USER_ID AS USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT   
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_PLUS_AMT_BASIC -->
									   ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_PLUS_AMT_BASIC								   									   
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  B.SHARE_TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY B.USER_ID
                                 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + SUM(B.WRITTEN_BASIC) AS YEAR_SHARE_MINUS_AMT_BASIC -->
									   ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + SUM(B.WRITTEN_BASIC) AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY A.USER_NO     
								                   		                     
								 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC   		
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC   		
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 1
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO		
		                        </if>
		                        
		                        <if test='primYN == "Y"'>
		                        -- 농산물 --
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL       
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL            
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                                            
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL   
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                            
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT           
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                                  
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL 
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                          
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                         
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL		                        
		                        
								SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,SUM(B.AMT_BASIC) AS AMT_BASIC
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY
                                       ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.AMT_ETC) AS AMT_ETC
                                       ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT      
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC	                                    
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                           AND  A.TEAM_ID = #{team_id}
		                        GROUP BY A.USER_NO 		                         
		                        UNION ALL
		                        
		                        SELECT  B.SHARE_USER_NO AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
		                               ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
		                               ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY                         
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC
		                               ,0 AS SHARE_MINUS_AMT_COUNSEL
		                               ,0 AS SHARE_MINUS_AMT_ETC
		                               ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT       
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT           
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                                                    
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.USER_NO != B.SHARE_USER_NO
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
								   AND  B.SHARE_TEAM_ID = #{team_id}
		                        GROUP BY B.SHARE_USER_NO
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
		                               ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
		                               ,0 AS SHARE_PLUS_AMT_BASIC
		                               ,0 AS SHARE_PLUS_AMT_DAILY
		                               ,0 AS SHARE_PLUS_AMT_TRAFFIC
		                               ,0 AS SHARE_PLUS_AMT_COUNSEL
		                               ,0 AS SHARE_PLUS_AMT_ETC
		                               ,0 AS SHARE_PLUS_AMT_TOTAL
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
		                               ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT   
		                               ,0 AS PENDING_MONTHLY_CNT     
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT                          
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                                     
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.USER_NO != B.SHARE_USER_NO 
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                           AND  A.TEAM_ID = #{team_id}
		                        GROUP BY A.USER_NO		                        
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                                    
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.USER_NO    
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                      
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.USER_NO
		                        UNION ALL
		                        SELECT  A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                         
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                               
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id} 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.USER_NO
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                            
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT       
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
		                               ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC       
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv B 
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO 		                         		                        
		                        UNION ALL
		                        SELECT  B.SHARE_USER_NO AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                       
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT          
		                               ,0 AS YEAR_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_BASIC) AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC                            
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
								   AND  B.SHARE_TEAM_ID = #{team_id}
		                           AND  A.USER_NO != B.SHARE_USER_NO
								   -- AND  B.SHARE_USER_NO IN(SELECT USER_NO FROM top_mbr_bsc C WHERE C.TEAM_ID_MAIN = '122')
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY B.SHARE_USER_NO		                        
								UNION ALL									
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                            
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT   
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_BASIC) AS YEAR_MINUS_AMT_BASIC    		                                                            
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.USER_NO != B.SHARE_USER_NO 
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO
								 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC   		
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC   		
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 2
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO			                        		                        		                        
		                        </if>
		                        
		                        
		                        <if test='contractYN == "Y"'>
		                        -- 적부 --
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL       
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT           
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL   
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                                            
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL 
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                                       
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT           
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                                  
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO 
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(B.SHARE_EA) AS CLOSE_MONTH_EA
		                               ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
		                               ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT       
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,SUM(B.SHARE_AMT_BASIC) AS AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
		                               ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT                      
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                               
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.USER_NO = B.SHARE_USER_NO 
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO  
		                        UNION ALL
		                        SELECT  B.SHARE_USER_NO AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
		                               ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
		                               ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY     
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC     
		                               ,0 AS SHARE_MINUS_AMT_COUNSEL     
		                               ,0 AS SHARE_MINUS_AMT_ETC     
		                               ,0 AS SHARE_MINUS_AMT_TOTAL     
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
		                               ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT                       
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                                        
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
								   AND  B.SHARE_TEAM_ID = #{team_id}
		                           AND  A.USER_NO != B.SHARE_USER_NO
								   -- AND  B.SHARE_USER_NO IN(SELECT USER_NO FROM top_mbr_bsc C WHERE C.TEAM_ID_MAIN = '122')
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA 
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT   
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC                   
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO  		                        
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.USER_NO    
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.USER_NO
		                        UNION ALL
		                        SELECT  A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                               
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.USER_NO
		                        </if>                                                                                                                 
		                      ) GA
		               WHERE  1=1
		              GROUP BY GA.USER_NO              
		             ) GB
		    ON  GA.USER_NO = GB.USER_NO         
		 WHERE  1=1
		   AND  (
		             GB.RECEIVE_MONTH_CNT > 0 
		          OR GB.CLOSE_MONTH_CNT > 0
		          OR GB.CLOSE_MONTH_EA > 0
		          OR GB.CLOSE_SHARE_EA > 0		          
		          OR GB.PENDING_CURRENT_CNT > 0
		          OR GB.PENDING_OVER45_CNT > 0
		        )		 
		ORDER BY NEW_WORK_ORDER, GA.WORK_LEVEL DESC, GA.USER_NO ASC
    </select>
    
    <!-- 팀기준 통계 -->
    <!-- NEW기본통계 - statistics_basic_member_list - 팀기준1 -->
    <select id="selectBasicMemberList1" parameterType="hashmap" resultType="AsraMap">
		SELECT  GA.USER_NO 
		       ,GA.USER_NAME 
               ,IFNULL(GB.RECEIVE_MONTH_CNT, 0) AS RECEIVE_MONTH_CNT
               ,IFNULL(GB.RECEIVE_YEAR_CNT, 0) AS RECEIVE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_CNT, 0) AS CLOSE_MONTH_CNT
               ,IFNULL(GB.CLOSE_YEAR_CNT, 0) AS CLOSE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_EA, 0) AS CLOSE_MONTH_EA
               ,IFNULL(GB.CLOSE_MONTH_WORKLOAD_EA, 0) AS CLOSE_MONTH_WORKLOAD_EA
               ,IFNULL(GB.CLOSE_SHARE_EA, 0) AS CLOSE_SHARE_EA
               ,IFNULL(GB.CLOSE_SHARE_WORKLOAD_EA, 0) AS CLOSE_SHARE_WORKLOAD_EA
               
               ,IFNULL(GB.PENDING_CURRENT_CNT, 0) AS PENDING_CURRENT_CNT
               ,IFNULL(GB.PENDING_OVER45_CNT, 0) AS PENDING_OVER45_CNT
               ,IFNULL(GB.PENDING_MONTHLY_CNT, 0) AS PENDING_MONTHLY_CNT               
               ,IFNULL(GB.AMT_BASIC , 0) AS AMT_BASIC
               ,IFNULL(GB.AMT_DAILY , 0) AS AMT_DAILY
               ,IFNULL(GB.AMT_COUNSEL , 0) AS AMT_COUNSEL
               ,IFNULL(GB.AMT_ETC, 0) AS AMT_ETC
               ,IFNULL(GB.AMT_TOTAL, 0) AS AMT_TOTAL
               ,IFNULL(GB.AMT_TRAFFIC , 0) AS AMT_TRAFFIC
               ,IFNULL(GB.SHARE_AMT_BASIC,0) AS SHARE_AMT_BASIC
               ,IFNULL(GB.SHARE_AMT_DAILY,0) AS SHARE_AMT_DAILY
               ,IFNULL(GB.SHARE_AMT_TRAFFIC,0) AS SHARE_AMT_TRAFFIC
               ,IFNULL(GB.SHARE_AMT_COUNSEL,0) AS SHARE_AMT_COUNSEL
               ,IFNULL(GB.SHARE_AMT_ETC,0) AS SHARE_AMT_ETC
               ,IFNULL(GB.SHARE_AMT_TOTAL,0) AS SHARE_AMT_TOTAL
               ,IFNULL(GB.OUT_AMT, 0) AS OUT_AMT
               ,IFNULL(GB.YEAR_AMT_BASIC, 0) AS YEAR_AMT_BASIC
               ,IFNULL(GB.YEAR_SHARE_AMT_BASIC, 0) AS YEAR_SHARE_AMT_BASIC               
               <!-- ,IFNULL( (SELECT calc_workload FROM top_rpt_workload_daily WHERE USER_NO = GA.USER_NO AND BASE_DATE &lt; UNIX_TIMESTAMP(#{sEndyear}) ORDER BY BASE_DATE DESC LIMIT 0, 1), 0 ) AS WORK_LOAD_YEAR -->
			   <!-- ,IFNULL( (SELECT calc_workload FROM top_rpt_workload_daily WHERE USER_NO = GA.USER_NO AND BASE_DATE &lt; UNIX_TIMESTAMP(#{chkMonthDate}) ORDER BY BASE_DATE DESC LIMIT 0, 1), 0 ) AS WORK_LOAD_MONTH -->
			   <!-- ,IFNULL( (SELECT calc_workload FROM top_rpt_workload_daily WHERE USER_NO = GA.USER_NO AND BASE_DATE &lt; UNIX_TIMESTAMP(#{chkLastMonthDate}) ORDER BY BASE_DATE DESC LIMIT 0, 1), 0 ) AS WORK_LOAD_LAST_MONTH -->
			   , 0 AS WORK_LOAD_YEAR
			   , 0 AS WORK_LOAD_MONTH
			   , 0 AS WORK_LOAD_LAST_MONTH
			   ,CASE GA.WORK_TYPE
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15	
				END AS NEW_WORK_ORDER
		  FROM  top_mbr_bsc GA
		 INNER  JOIN (
		              SELECT  GA.USER_NO
		                     ,SUM(GA.RECEIVE_MONTH_CNT) AS RECEIVE_MONTH_CNT
		                     ,SUM(GA.RECEIVE_YEAR_CNT) AS RECEIVE_YEAR_CNT
		                     ,SUM(GA.CLOSE_MONTH_CNT) AS CLOSE_MONTH_CNT
		                     ,SUM(GA.CLOSE_YEAR_CNT) AS CLOSE_YEAR_CNT
		                     ,SUM(GA.CLOSE_MONTH_EA) AS CLOSE_MONTH_EA
		                     ,SUM(GA.CLOSE_MONTH_WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA
		                     ,SUM(GA.CLOSE_MONTH_EA_CAL + GA.CLOSE_SHARE_PLUS_EA - GA.CLOSE_SHARE_MINUS_EA) AS CLOSE_SHARE_EA
		                     ,SUM(GA.CLOSE_MONTH_WORKLOAD_EA_CAL + GA.CLOSE_SHARE_PLUS_WORKLOAD_EA - GA.CLOSE_SHARE_MINUS_WORKLOAD_EA) AS CLOSE_SHARE_WORKLOAD_EA
		                                          
		                     ,SUM(GA.PENDING_CURRENT_CNT) AS PENDING_CURRENT_CNT
		                     ,SUM(GA.PENDING_OVER45_CNT) AS PENDING_OVER45_CNT
		                     ,SUM(GA.PENDING_MONTHLY_CNT) AS PENDING_MONTHLY_CNT
		                     ,SUM(GA.AMT_BASIC) AS AMT_BASIC
		                     ,SUM(GA.AMT_DAILY) AS AMT_DAILY
		                     ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
		                     ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
		                     ,SUM(GA.AMT_ETC) AS AMT_ETC
		                     ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
		                     ,SUM(GA.SHARE_PLUS_AMT_BASIC - GA.SHARE_MINUS_AMT_BASIC) AS SHARE_AMT_BASIC
		                     ,SUM(GA.SHARE_PLUS_AMT_DAILY - GA.SHARE_MINUS_AMT_DAILY) AS SHARE_AMT_DAILY
		                     ,SUM(GA.SHARE_PLUS_AMT_TRAFFIC - GA.SHARE_MINUS_AMT_TRAFFIC) AS SHARE_AMT_TRAFFIC
		                     ,SUM(GA.SHARE_PLUS_AMT_COUNSEL - GA.SHARE_MINUS_AMT_COUNSEL) AS SHARE_AMT_COUNSEL
		                     ,SUM(GA.SHARE_PLUS_AMT_ETC - GA.SHARE_MINUS_AMT_ETC) AS SHARE_AMT_ETC
		                     ,SUM(GA.SHARE_PLUS_AMT_TOTAL - GA.SHARE_MINUS_AMT_TOTAL) AS SHARE_AMT_TOTAL
		                     ,SUM(GA.OUT_AMT) AS OUT_AMT
		                     ,SUM(GA.YEAR_AMT_BASIC) AS YEAR_AMT_BASIC
                             ,SUM(GA.YEAR_SHARE_PLUS_AMT_BASIC - GA.YEAR_SHARE_MINUS_AMT_BASIC) AS YEAR_SHARE_AMT_BASIC
		                     
		                FROM  (
		                        SELECT -1 AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT         
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  DUAL
		                        <if test='basicYN == "Y"'>
		                        UNION ALL 		                        
		                        SELECT  A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                                       
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                        
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                                           
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
		                               ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
		                               ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                           
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                                            
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA 
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                          
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL
		                        SELECT  B.USER_ID AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,SUM(B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_PLUS_EA
		                               ,SUM(B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA		                               
                                       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC -->
                                       ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  top_rpt_head A
		                               ,top_rpt_collabo B
		                               ,top_rpt_invoice C 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
								   AND  B.SHARE_TEAM_ID = #{team_id}
		                           AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
								   -- AND  B.USER_ID IN(SELECT USER_NO FROM top_mbr_bsc C WHERE C.TEAM_ID_MAIN = '122')
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY B.USER_ID
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,SUM(B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_MINUS_EA
		                               ,SUM(B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC -->
                                       ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  top_rpt_head A
		                               ,top_rpt_collabo B
		                               ,top_rpt_invoice C
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3 
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO                              
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                       
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                                    
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.USER_NO    
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                           
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  top_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.USER_NO 
		                        UNION ALL   
		                        SELECT  A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                              
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT       
		                               ,0 AS PENDING_MONTHLY_CNT 
		                               <!-- ,SUM(B.AMT_BASIC) AS AMT_BASIC -->
		                               ,SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) AS AMT_BASIC 
		                               ,SUM(B.AMT_DAILY) AS AMT_DAILY 
		                               ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
		                               ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
		                               ,SUM(B.AMT_ETC) AS AMT_ETC
		                               ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  top_rpt_head A 
		                               ,top_rpt_invoice B
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id} 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO       
		                        UNION ALL
		                        SELECT  A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                                                          
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC     		                               
		                          FROM  top_rpt_head A 
		                               ,top_rpt_invoice B
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id} 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		                           AND  A.SUIM_RPT_STATE != 3 
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.USER_NO
		                        
								UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA 
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
                                       <!-- ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC -->
									   ,SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})             
                                 GROUP BY A.USER_NO
                                 
                                 UNION ALL
                                 
                                SELECT  B.USER_ID AS USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT   
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_PLUS_AMT_BASIC -->
									   ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  B.SHARE_TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY B.USER_ID
                                 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_MINUS_AMT_BASIC -->
									   ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY A.USER_NO     
								                   		                     
								 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC   		
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC   		
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 1
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO		
		                        </if>
		                        
		                        <if test='primYN == "Y"'>
		                        -- 농산물 --
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL       
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL            
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                                            
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL   
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                            
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT           
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                                  
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL 
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                          
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                         
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL		                        
		                        
								SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,SUM(B.AMT_BASIC) AS AMT_BASIC
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY
                                       ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.AMT_ETC) AS AMT_ETC
                                       ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT      
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC	                                    
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                           AND  A.TEAM_ID = #{team_id}
		                        GROUP BY A.USER_NO 		                         
		                        UNION ALL
		                        
		                        SELECT  B.SHARE_USER_NO AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
		                               ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
		                               ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY                         
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC
		                               ,0 AS SHARE_MINUS_AMT_COUNSEL
		                               ,0 AS SHARE_MINUS_AMT_ETC
		                               ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT       
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT           
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                                                    
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.USER_NO != B.SHARE_USER_NO
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
								   AND  B.SHARE_TEAM_ID = #{team_id}
		                        GROUP BY B.SHARE_USER_NO
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
		                               ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
		                               ,0 AS SHARE_PLUS_AMT_BASIC
		                               ,0 AS SHARE_PLUS_AMT_DAILY
		                               ,0 AS SHARE_PLUS_AMT_TRAFFIC
		                               ,0 AS SHARE_PLUS_AMT_COUNSEL
		                               ,0 AS SHARE_PLUS_AMT_ETC
		                               ,0 AS SHARE_PLUS_AMT_TOTAL
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
		                               ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT   
		                               ,0 AS PENDING_MONTHLY_CNT     
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT                          
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                                     
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.USER_NO != B.SHARE_USER_NO 
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                           AND  A.TEAM_ID = #{team_id}
		                        GROUP BY A.USER_NO		                        
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                                    
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.USER_NO    
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                      
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.USER_NO
		                        UNION ALL
		                        SELECT  A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                         
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC		                               
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id} 
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.USER_NO
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                            
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT       
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
		                               ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC       
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv B 
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO 		                         		                        
		                        UNION ALL
		                        SELECT  B.SHARE_USER_NO AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                       
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT          
		                               ,0 AS YEAR_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_BASIC) AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC                            
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
								   AND  B.SHARE_TEAM_ID = #{team_id}
		                           AND  A.USER_NO != B.SHARE_USER_NO
								   -- AND  B.SHARE_USER_NO IN(SELECT USER_NO FROM top_mbr_bsc C WHERE C.TEAM_ID_MAIN = '122')
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY B.SHARE_USER_NO		                        
								UNION ALL									
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                            
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT   
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_BASIC) AS YEAR_MINUS_AMT_BASIC    		                                                            
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.USER_NO != B.SHARE_USER_NO 
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO
								 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC   		
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC   		
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 2
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO			                        		                        		                        
		                        </if>
		                        
		                        
		                        <if test='contractYN == "Y"'>
		                        -- 적부 --
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL       
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT           
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO    
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL   
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT 
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                                            
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL 
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                                       
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO
		                        UNION ALL   
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT           
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                                  
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO 
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,SUM(B.SHARE_EA) AS CLOSE_MONTH_EA
		                               ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA
		                               ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
		                               ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT       
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,SUM(B.SHARE_AMT_BASIC) AS AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
		                               ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT                      
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                               
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.USER_NO = B.SHARE_USER_NO 
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY A.USER_NO  
		                        UNION ALL
		                        SELECT  B.SHARE_USER_NO AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
		                               ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
		                               ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
		                               ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
		                               ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY     
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC     
		                               ,0 AS SHARE_MINUS_AMT_COUNSEL     
		                               ,0 AS SHARE_MINUS_AMT_ETC     
		                               ,0 AS SHARE_MINUS_AMT_TOTAL     
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
		                               ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
		                               ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
		                               ,0 AS OUT_AMT                       
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                                        
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
								   AND  B.SHARE_TEAM_ID = #{team_id}
		                           AND  A.USER_NO != B.SHARE_USER_NO
								   -- AND  B.SHARE_USER_NO IN(SELECT USER_NO FROM top_mbr_bsc C WHERE C.TEAM_ID_MAIN = '122')
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
		                        GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA 
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT   
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC                   
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO  		                        
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                        GROUP BY A.USER_NO    
		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT       
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                               
		                          FROM  top_prim_biz_rpt_head A
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE IN(0,1,4,11)
		                           AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
		                        GROUP BY A.USER_NO
		                        UNION ALL
		                        SELECT  A.USER_NO
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
		                               
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT 
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC 
		                               ,0 AS AMT_DAILY 
		                               ,0 AS AMT_TRAFFIC 
		                               ,0 AS AMT_COUNSEL 
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,SUM(B.AMT_TOTAL) AS OUT_AMT 
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC    		                               
		                          FROM  top_prim_biz_rpt_head A 
		                               ,top_prim_biz_inv B
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		                           AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE > 0
		                           AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		                        GROUP BY A.USER_NO
		                        </if>                                                                                                                 
		                      ) GA
		               WHERE  1=1
		              GROUP BY GA.USER_NO              
		             ) GB
		    ON  GA.USER_NO = GB.USER_NO         
		 WHERE  1=1
		   AND  (
		             GB.RECEIVE_MONTH_CNT > 0 
		          OR GB.CLOSE_MONTH_CNT > 0
		          OR GB.CLOSE_MONTH_EA > 0
		          OR GB.CLOSE_SHARE_EA > 0		          
		          OR GB.PENDING_CURRENT_CNT > 0
		          OR GB.PENDING_OVER45_CNT > 0
		        )		 
		ORDER BY NEW_WORK_ORDER, GA.WORK_LEVEL DESC, GA.USER_NO ASC
    </select>
	
    <!-- NEW기본통계 - statistics_basic_member_list - 팀기준4 -->
    <select id="selectBasicMemberList4" parameterType="hashmap" resultType="AsraMap">
        SELECT  GA.USER_NO 
               ,GA.USER_NAME 
               ,IFNULL(GB.RECEIVE_MONTH_CNT, 0) AS RECEIVE_MONTH_CNT
               ,IFNULL(GB.RECEIVE_YEAR_CNT, 0) AS RECEIVE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_CNT, 0) AS CLOSE_MONTH_CNT
               ,IFNULL(GB.CLOSE_YEAR_CNT, 0) AS CLOSE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_EA, 0) AS CLOSE_MONTH_EA
               ,IFNULL(GB.CLOSE_SHARE_EA, 0) AS CLOSE_SHARE_EA
               ,IFNULL(GB.PENDING_CURRENT_CNT, 0) AS PENDING_CURRENT_CNT
               ,IFNULL(GB.PENDING_OVER45_CNT, 0) AS PENDING_OVER45_CNT
               ,IFNULL(GB.PENDING_MONTHLY_CNT, 0) AS PENDING_MONTHLY_CNT
               ,IFNULL(GB.AMT_BASIC , 0) AS AMT_BASIC
               ,IFNULL(GB.AMT_DAILY , 0) AS AMT_DAILY
               ,IFNULL(GB.SHARE_AMT_BASIC,0) AS SHARE_AMT_BASIC
               ,IFNULL(GB.SHARE_AMT_DAILY,0) AS SHARE_AMT_DAILY
               ,IFNULL(GB.SHARE_AMT_TRAFFIC,0) AS SHARE_AMT_TRAFFIC
               ,IFNULL(GB.AMT_TRAFFIC , 0) AS AMT_TRAFFIC
               ,IFNULL(GB.AMT_COUNSEL , 0) AS AMT_COUNSEL
               ,IFNULL(GB.AMT_ETC, 0) AS AMT_ETC
               ,IFNULL(GB.AMT_TOTAL, 0) AS AMT_TOTAL
               ,IFNULL(GB.OUT_AMT, 0) AS OUT_AMT
               ,IFNULL(GB.YEAR_AMT_BASIC, 0) AS YEAR_AMT_BASIC
               ,IFNULL(GB.YEAR_SHARE_AMT_BASIC, 0) AS YEAR_SHARE_AMT_BASIC
          FROM  top_mbr_bsc GA
         INNER  JOIN (
                      SELECT  GA.USER_NO
                             ,SUM(GA.RECEIVE_MONTH_CNT) AS RECEIVE_MONTH_CNT
                             ,SUM(GA.RECEIVE_YEAR_CNT) AS RECEIVE_YEAR_CNT
                             ,SUM(GA.CLOSE_MONTH_CNT) AS CLOSE_MONTH_CNT
                             ,SUM(GA.CLOSE_YEAR_CNT) AS CLOSE_YEAR_CNT
                             ,SUM(GA.CLOSE_MONTH_EA) AS CLOSE_MONTH_EA
                             ,SUM(GA.CLOSE_MONTH_EA_CAL + GA.CLOSE_SHARE_PLUS_EA - GA.CLOSE_SHARE_MINUS_EA) AS CLOSE_SHARE_EA                     
                             ,SUM(GA.PENDING_CURRENT_CNT) AS PENDING_CURRENT_CNT
                             ,SUM(GA.PENDING_OVER45_CNT) AS PENDING_OVER45_CNT
                             ,SUM(GA.PENDING_MONTHLY_CNT) AS PENDING_MONTHLY_CNT
                             ,SUM(GA.AMT_BASIC) AS AMT_BASIC
                             ,SUM(GA.AMT_DAILY) AS AMT_DAILY
                             ,SUM(GA.SHARE_PLUS_AMT_BASIC - GA.SHARE_MINUS_AMT_BASIC) AS SHARE_AMT_BASIC
                             ,SUM(GA.SHARE_PLUS_AMT_DAILY - GA.SHARE_MINUS_AMT_DAILY) AS SHARE_AMT_DAILY
                             ,SUM(GA.SHARE_PLUS_AMT_TRAFFIC - GA.SHARE_MINUS_AMT_TRAFFIC) AS SHARE_AMT_TRAFFIC
                             ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
                             ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
                             ,SUM(GA.AMT_ETC) AS AMT_ETC
                             ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
                             ,SUM(GA.OUT_AMT) AS OUT_AMT
                             ,SUM(GA.YEAR_AMT_BASIC) AS YEAR_AMT_BASIC
                             ,SUM(GA.YEAR_SHARE_PLUS_AMT_BASIC - GA.YEAR_SHARE_MINUS_AMT_BASIC) AS YEAR_SHARE_AMT_BASIC
                        FROM  (
                                SELECT -1 AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS SHARE_PLUS_AMT_BASIC
		                               ,0 AS SHARE_PLUS_AMT_DAILY
		                               ,0 AS SHARE_PLUS_AMT_TRAFFIC
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY  
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC                               
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC    
                                  FROM  DUAL
                                <if test='basicYN == "Y"'>
                                UNION ALL                               
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS SHARE_PLUS_AMT_BASIC
		                               ,0 AS SHARE_PLUS_AMT_DAILY
		                               ,0 AS SHARE_PLUS_AMT_TRAFFIC
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY  
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC                                
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT             
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                             
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                 GROUP BY A.USER_NO    
                                 UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS SHARE_PLUS_AMT_BASIC
		                               ,0 AS SHARE_PLUS_AMT_DAILY
		                               ,0 AS SHARE_PLUS_AMT_TRAFFIC
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY  
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                             
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT        
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                 
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS SHARE_PLUS_AMT_BASIC
		                               ,0 AS SHARE_PLUS_AMT_DAILY
		                               ,0 AS SHARE_PLUS_AMT_TRAFFIC
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY  
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                             
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT          
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                 GROUP BY A.USER_NO
                                 UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS SHARE_PLUS_AMT_BASIC
		                               ,0 AS SHARE_PLUS_AMT_DAILY
		                               ,0 AS SHARE_PLUS_AMT_TRAFFIC
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY  
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                       
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT            
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                             
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                 GROUP BY A.USER_NO
                                 UNION ALL
                                SELECT  B.USER_ID AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.COLLABO_PP) AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY  
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC  
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
								   AND  B.SHARE_TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.USER_ID
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.COLLABO_PP) AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                              
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                 
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                             
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO 
                                UNION ALL   
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,SUM(B.AMT_BASIC) AS AMT_BASIC 
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY 
                                       ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
                                       ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
                                       ,SUM(B.AMT_ETC) AS AMT_ETC
                                       ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id} 
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO       
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                             
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id} 
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO

								UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})             
                                 GROUP BY A.USER_NO
                                 
                                 UNION ALL
                                 
                                SELECT  B.USER_ID AS USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT   
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,SUM(B.COLLABO_PP) AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  B.SHARE_TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY B.USER_ID
                                 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,SUM(B.COLLABO_PP) AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY A.USER_NO                 
								 UNION ALL
								 
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC   		
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC   		
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 1
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO										 
								                       
                                </if>
                                <if test='primYN == "Y"'>
                                -- 농산물 --
                                 UNION ALL
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                        
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL   
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                       
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                              
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL 
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                       
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT          
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                          
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                       
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT                                        
                                       ,SUM(B.AMT_BASIC) AS AMT_BASIC
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                 
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv B 
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                               
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(B.SHARE_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                         
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT                                         
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                      
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO = B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO  
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT    
                                       ,0 AS PENDING_MONTHLY_CNT                                           
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                       
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC            
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SHARE_TEAM_ID = #{team_id}
                                   AND  A.USER_NO != B.SHARE_USER_NO
                                   -- AND  B.SHARE_USER_NO IN(SELECT USER_NO FROM top_mbr_bsc C WHERE C.TEAM_ID_MAIN = '122')
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY    
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC    
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT    
                                       ,0 AS PENDING_MONTHLY_CNT                                           
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                             
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                              
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY                               
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                               
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY                               
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                          
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY                               
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                              
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A 
                                       ,top_prim_biz_inv B
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id} 
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO

		                        UNION ALL
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS SHARE_PLUS_AMT_BASIC
		                               ,0 AS SHARE_PLUS_AMT_DAILY
		                               ,0 AS SHARE_PLUS_AMT_TRAFFIC
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY  
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC                               
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT       
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT               
		                               ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC       
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv B 
		                         WHERE  1=1
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY A.USER_NO 		                         		                        
		                        UNION ALL
		                        SELECT  B.SHARE_USER_NO AS USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS SHARE_PLUS_AMT_BASIC
		                               ,0 AS SHARE_PLUS_AMT_DAILY
		                               ,0 AS SHARE_PLUS_AMT_TRAFFIC
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY  
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC                           
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL
		                               ,0 AS OUT_AMT          
		                               ,0 AS YEAR_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_BASIC) AS YEAR_PLUS_AMT_BASIC
		                               ,0 AS YEAR_MINUS_AMT_BASIC                            
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
								   AND  B.SHARE_TEAM_ID = #{team_id}
		                           AND  A.USER_NO != B.SHARE_USER_NO
								   -- AND  B.SHARE_USER_NO IN(SELECT USER_NO FROM top_mbr_bsc C WHERE C.TEAM_ID_MAIN = '122')
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
		                           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
		                           AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                        GROUP BY B.SHARE_USER_NO		                        
								UNION ALL									
		                        SELECT  A.USER_NO 
		                               ,0 AS RECEIVE_MONTH_CNT
		                               ,0 AS RECEIVE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_CNT
		                               ,0 AS CLOSE_YEAR_CNT
		                               ,0 AS CLOSE_MONTH_EA
		                               ,0 AS CLOSE_MONTH_EA_CAL
		                               ,0 AS CLOSE_YEAR_EA
		                               ,0 AS CLOSE_SHARE_PLUS_EA
		                               ,0 AS CLOSE_SHARE_MINUS_EA
		                               ,0 AS SHARE_PLUS_AMT_BASIC
		                               ,0 AS SHARE_PLUS_AMT_DAILY
		                               ,0 AS SHARE_PLUS_AMT_TRAFFIC
		                               ,0 AS SHARE_MINUS_AMT_BASIC
		                               ,0 AS SHARE_MINUS_AMT_DAILY  
		                               ,0 AS SHARE_MINUS_AMT_TRAFFIC                               
		                               ,0 AS PENDING_CURRENT_CNT
		                               ,0 AS PENDING_OVER45_CNT        
		                               ,0 AS PENDING_MONTHLY_CNT
		                               ,0 AS AMT_BASIC
		                               ,0 AS AMT_DAILY
		                               ,0 AS AMT_TRAFFIC
		                               ,0 AS AMT_COUNSEL
		                               ,0 AS AMT_ETC
		                               ,0 AS AMT_TOTAL 
		                               ,0 AS OUT_AMT   
		                               ,0 AS YEAR_AMT_BASIC
		                               ,0 AS YEAR_PLUS_AMT_BASIC
		                               ,SUM(B.SHARE_AMT_BASIC) AS YEAR_MINUS_AMT_BASIC    		                                                            
		                          FROM  top_prim_biz_rpt_head A
		                               ,top_prim_biz_inv_share B 
		                         WHERE  1=1
		                           AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                           AND  A.USER_NO != B.SHARE_USER_NO 
		                           AND  A.TEAM_ID = #{team_id}
		                           AND  A.SUIM_RPT_TYPE1 = 5
		                           AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
		                         GROUP BY A.USER_NO		
								 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC   		
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC   		
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 2
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO				                                                                  
                                </if>
                                <if test='contractYN == "Y"'>
                                -- 적부 --
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY                               
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL   
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY                               
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                              
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                              
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL 
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY                               
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                          
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY                               
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO 
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(B.SHARE_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY                               
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                     
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT                                         
                                       ,SUM(C.AMT_BASIC) AS AMT_BASIC
                                       ,SUM(C.AMT_DAILY) AS AMT_DAILY
                                       ,SUM(C.AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(C.AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(C.AMT_ETC) AS AMT_ETC
                                       ,SUM(C.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                      
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                       ,top_prim_biz_inv C
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.USER_NO = B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO  
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY                    
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                    
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT   
                                       ,0 AS PENDING_MONTHLY_CNT                                            
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                         
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                  
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SHARE_TEAM_ID = #{team_id}
                                   AND  A.USER_NO != B.SHARE_USER_NO
                                   -- AND  B.SHARE_USER_NO IN(SELECT USER_NO FROM top_mbr_bsc C WHERE C.TEAM_ID_MAIN = '122')
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY       
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC       
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT                                          
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                                
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                                  
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY                               
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                               
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY                               
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                    
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY                               
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                 
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT
                                       ,0 AS YEAR_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_PLUS_AMT_BASIC           
                                       ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                            
                                  FROM  top_prim_biz_rpt_head A 
                                       ,top_prim_biz_inv B
                                 WHERE  1=1
                                   AND  A.TEAM_ID = #{team_id}
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO
                                </if>                                                                                                                 
                              ) GA
                       WHERE  1=1
                      GROUP BY GA.USER_NO              
                     ) GB
            ON  GA.USER_NO = GB.USER_NO         
         WHERE  1=1
           AND  (
                     GB.RECEIVE_MONTH_CNT > 0 
                  OR GB.CLOSE_MONTH_CNT > 0
                  OR GB.CLOSE_MONTH_EA > 0
                  OR GB.CLOSE_SHARE_EA > 0                  
                  OR GB.PENDING_CURRENT_CNT > 0
                  OR GB.PENDING_OVER45_CNT > 0
                )            
        ORDER BY GA.WORK_TYPE, GA.WORK_LEVEL DESC, GA.USER_NO ASC
    </select>
    
    <!-- 팀아이디 기준으로 미수금을 가져온다. (과거 팀 미수금 계산을 위함) -->
    <select id="selectSumOutAmtByTeamId" parameterType="hashmap" resultType="Long">
    	SELECT 
			IFNULL(SUM(B.AMT_TOTAL),0) AS OUT_AMT
		FROM top_rpt_head A 
				,top_rpt_invoice B
		WHERE 1=1
			AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO			
			AND  A.SUIM_RPT_STATE != 3 
			AND  A.CLOSE_DATE > 0
			AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
			AND A.TEAM_ID = #{team_id}    
    </select>

	<!-- 개인기준 개인별 통계 시작 개선 (기준업무량 제외)-->    
    <select id="selectBasicMemberPersonStandardList1Quick" parameterType="hashmap" resultType="AsraMap">
        SELECT  GA.USER_NO 
               ,GA.USER_NAME
               ,CASE GA.WORK_TYPE
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15	
				END AS NEW_WORK_ORDER 
               ,IFNULL(GB.RECEIVE_MONTH_CNT, 0) AS RECEIVE_MONTH_CNT
               ,IFNULL(GB.RECEIVE_YEAR_CNT, 0) AS RECEIVE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_CNT, 0) AS CLOSE_MONTH_CNT
               ,IFNULL(GB.CLOSE_YEAR_CNT, 0) AS CLOSE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_EA, 0) AS CLOSE_MONTH_EA
               ,IFNULL(GB.CLOSE_MONTH_WORKLOAD_EA, 0) AS CLOSE_MONTH_WORKLOAD_EA               
               ,IFNULL(GB.CLOSE_SHARE_EA, 0) AS CLOSE_SHARE_EA
               ,IFNULL(GB.CLOSE_SHARE_WORKLOAD_EA, 0) AS CLOSE_SHARE_WORKLOAD_EA
               
               ,IFNULL(GB.PENDING_CURRENT_CNT, 0) AS PENDING_CURRENT_CNT
               ,IFNULL(GB.PENDING_OVER45_CNT, 0) AS PENDING_OVER45_CNT
               ,IFNULL(GB.PENDING_MONTHLY_CNT, 0) AS PENDING_MONTHLY_CNT
               ,IFNULL(GB.AMT_BASIC , 0) AS AMT_BASIC
               ,IFNULL(GB.AMT_DAILY , 0) AS AMT_DAILY
               ,IFNULL(GB.AMT_TRAFFIC , 0) AS AMT_TRAFFIC
               ,IFNULL(GB.AMT_COUNSEL , 0) AS AMT_COUNSEL
               ,IFNULL(GB.AMT_ETC, 0) AS AMT_ETC
               ,IFNULL(GB.AMT_TOTAL, 0) AS AMT_TOTAL
               ,IFNULL(GB.SHARE_AMT_BASIC,0) AS SHARE_AMT_BASIC
               ,IFNULL(GB.SHARE_AMT_DAILY,0) AS SHARE_AMT_DAILY
               ,IFNULL(GB.SHARE_AMT_TRAFFIC,0) AS SHARE_AMT_TRAFFIC
               ,IFNULL(GB.SHARE_AMT_COUNSEL,0) AS SHARE_AMT_COUNSEL
               ,IFNULL(GB.SHARE_AMT_ETC,0) AS SHARE_AMT_ETC
               ,IFNULL(GB.SHARE_AMT_TOTAL,0) AS SHARE_AMT_TOTAL
               ,IFNULL(GB.OUT_AMT, 0) AS OUT_AMT
               ,IFNULL(GB.YEAR_AMT_BASIC, 0) AS YEAR_AMT_BASIC
               ,IFNULL(GB.YEAR_SHARE_AMT_BASIC, 0) AS YEAR_SHARE_AMT_BASIC               			   
               
          FROM  top_mbr_bsc GA
          LEFT  JOIN (
                      SELECT  GA.USER_NO
                             ,SUM(GA.RECEIVE_MONTH_CNT) AS RECEIVE_MONTH_CNT
                             ,SUM(GA.RECEIVE_YEAR_CNT) AS RECEIVE_YEAR_CNT
                             ,SUM(GA.CLOSE_MONTH_CNT) AS CLOSE_MONTH_CNT
                             ,SUM(GA.CLOSE_YEAR_CNT) AS CLOSE_YEAR_CNT
                             ,SUM(GA.CLOSE_MONTH_EA) AS CLOSE_MONTH_EA
                             ,SUM(GA.CLOSE_MONTH_WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA                             
                             ,SUM(GA.CLOSE_MONTH_EA_CAL + GA.CLOSE_SHARE_PLUS_EA - GA.CLOSE_SHARE_MINUS_EA) AS CLOSE_SHARE_EA
                             ,SUM(GA.CLOSE_MONTH_WORKLOAD_EA_CAL + GA.CLOSE_SHARE_PLUS_WORKLOAD_EA - GA.CLOSE_SHARE_MINUS_WORKLOAD_EA) AS CLOSE_SHARE_WORKLOAD_EA
                                                  
                             ,SUM(GA.PENDING_CURRENT_CNT) AS PENDING_CURRENT_CNT
                             ,SUM(GA.PENDING_OVER45_CNT) AS PENDING_OVER45_CNT
                             ,SUM(GA.PENDING_MONTHLY_CNT) AS PENDING_MONTHLY_CNT
                             ,SUM(GA.AMT_BASIC) AS AMT_BASIC
                             ,SUM(GA.AMT_DAILY) AS AMT_DAILY
                             ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
                             ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
                             ,SUM(GA.AMT_ETC) AS AMT_ETC
                             ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
                             ,SUM(GA.SHARE_PLUS_AMT_BASIC - GA.SHARE_MINUS_AMT_BASIC) AS SHARE_AMT_BASIC
                             ,SUM(GA.SHARE_PLUS_AMT_DAILY - GA.SHARE_MINUS_AMT_DAILY) AS SHARE_AMT_DAILY
                             ,SUM(GA.SHARE_PLUS_AMT_TRAFFIC - GA.SHARE_MINUS_AMT_TRAFFIC) AS SHARE_AMT_TRAFFIC
                             ,SUM(GA.SHARE_PLUS_AMT_COUNSEL - GA.SHARE_MINUS_AMT_COUNSEL) AS SHARE_AMT_COUNSEL
                             ,SUM(GA.SHARE_PLUS_AMT_ETC - GA.SHARE_MINUS_AMT_ETC) AS SHARE_AMT_ETC
                             ,SUM(GA.SHARE_PLUS_AMT_TOTAL - GA.SHARE_MINUS_AMT_TOTAL) AS SHARE_AMT_TOTAL
                             ,SUM(GA.OUT_AMT) AS OUT_AMT
                             ,SUM(GA.YEAR_AMT_BASIC) AS YEAR_AMT_BASIC
                             ,SUM(GA.YEAR_SHARE_PLUS_AMT_BASIC - GA.YEAR_SHARE_MINUS_AMT_BASIC) AS YEAR_SHARE_AMT_BASIC
                        FROM  (
                                SELECT -1 AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                                                              
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL

                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  DUAL
                                <if test='basicYN == "Y"'>
                                UNION ALL                               
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 FORCE  INDEX (REG_DATE) 
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT            
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                         
                                  FROM  top_rpt_head A
                                 FORCE  INDEX (REG_DATE) 
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT     
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                 
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT     
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  B.USER_ID AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       -- ,SUM(B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,IFNULL(SUM(B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA),0) + IFNULL(SUM(B.WRITTEN_CNT),0) AS CLOSE_SHARE_PLUS_EA
                                       -- ,SUM(B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) AS CLOSE_SHARE_PLUS_WORKLOAD_EA                                       
                                       ,IFNULL(SUM(B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) ,0) + IFNULL(SUM(B.WRITTEN_CNT),0) AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC -->                                       
                                       ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC                                       
                                       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.USER_ID
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                      
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA                                       
                                       -- ,SUM(B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,IFNULL(SUM(B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA),0) + IFNULL(SUM(B.WRITTEN_CNT),0) AS CLOSE_SHARE_MINUS_EA
                                       -- ,SUM(B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       ,IFNULL(SUM(B.COLLABO_PP * 0.01 * A.WORKLOAD_EA),0) + IFNULL(SUM(B.WRITTEN_CNT),0) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       -- ,SUM(C.AMT_BASIC * B.COLLABO_PP * 0.01) AS SHARE_MINUS_AMT_BASIC
                                       
                                       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC -->
                                       ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC              
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL              
                                       ,0 AS SHARE_MINUS_AMT_ETC              
                                       ,0 AS SHARE_MINUS_AMT_TOTAL              
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                              
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO 
                                UNION ALL   
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       <!-- ,SUM(B.AMT_BASIC) AS AMT_BASIC -->
                                       ,SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) AS AMT_BASIC 
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY 
                                       ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
                                       ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
                                       ,SUM(B.AMT_ETC) AS AMT_ETC
                                       ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO       
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO
                                
								UNION ALL
								
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   <!-- ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC -->
									   ,SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})             
                                 GROUP BY A.USER_NO
                                 
                                 UNION ALL
                                 
                                SELECT  B.USER_ID AS USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_PLUS_AMT_BASIC -->
									   ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY B.USER_ID
                                 UNION ALL
                                 
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   
									   <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC -->
									   ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY A.USER_NO  
      
								 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC   		
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC   		
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 1
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO								 
								 
								 
                                </if>
                                <if test='primYN == "Y"'>
                                -- 농산물 --
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                         
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                     
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL 
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT        
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC        
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                      
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL                                
                                
								SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,SUM(B.AMT_BASIC) AS AMT_BASIC
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY
                                       ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.AMT_ETC) AS AMT_ETC
                                       ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT      
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC  
               
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                               
                                
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA                                       
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_PLUS_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY   
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT    
                                       ,0 AS PENDING_MONTHLY_CNT    
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                        
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                 
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.USER_NO != B.SHARE_USER_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                      
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT        
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                    
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                     
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO   
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                         
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                              
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_prim_biz_rpt_head A 
                                       ,top_prim_biz_inv B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO
                                
 								UNION ALL
 								
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT      
									   ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC  
               
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO                               								                               
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT  
                                       ,0 AS PENDING_MONTHLY_CNT      
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                        
									   ,0 AS YEAR_AMT_BASIC
									   ,SUM(B.SHARE_AMT_BASIC) AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                 
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT       
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                        
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,SUM(B.SHARE_AMT_BASIC) AS YEAR_SHARE_MINUS_AMT_BASIC                                                      
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO      
                                
								 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC   		   
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC   		   
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 2
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO		                                                                      
                                </if>
                                <if test='contractYN == "Y"'>
                                -- 적부 --
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL      
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL 
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO 
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(B.SHARE_EA) AS CLOSE_MONTH_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT 
                                       ,SUM(B.SHARE_AMT_BASIC) AS AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.USER_NO = B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO  
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY    
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC    
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL    
                                       ,0 AS SHARE_MINUS_AMT_ETC    
                                       ,0 AS SHARE_MINUS_AMT_TOTAL    
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT        
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                                      
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT       
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                                         
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                                   
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL                                       
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC      
                                  FROM  top_prim_biz_rpt_head A 
                                       ,top_prim_biz_inv B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO
                                 UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                  
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT            
									   ,SUM(B.SHARE_AMT_BASIC) AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC         
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.USER_NO = B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO  
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                       
									   ,0 AS YEAR_AMT_BASIC
									   ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                                   
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC                                                               
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                                                  
                                
                                </if>                                                                                                                 
                              ) GA
                       WHERE  1=1
                      GROUP BY GA.USER_NO              
                     ) GB
            ON  GA.USER_NO = GB.USER_NO         
         WHERE  1=1
           AND  GA.TEAM_ID_MAIN = #{team_id}
           AND  GA.USER_STATE != 1
		   -- AND  (GA.USER_STATE !=1 OR (GA.USER_STATE = 1 AND GA.OUT_DATE >= UNIX_TIMESTAMP('20171216') AND GA.OUT_DATE &lt; UNIX_TIMESTAMP('20181116')))
		ORDER BY NEW_WORK_ORDER, GA.WORK_LEVEL DESC, GA.USER_NO ASC
    </select>
    
    <!-- 개인기준 개인별 통계 시작 개선-->    
    <select id="selectBasicMemberPersonStandardList1_retire" parameterType="hashmap" resultType="AsraMap">
        SELECT  GA.USER_NO 
               ,GA.USER_NAME
               ,CASE GA.WORK_TYPE
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15	
				END AS NEW_WORK_ORDER 
               ,IFNULL(GB.RECEIVE_MONTH_CNT, 0) AS RECEIVE_MONTH_CNT
               ,IFNULL(GB.RECEIVE_YEAR_CNT, 0) AS RECEIVE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_CNT, 0) AS CLOSE_MONTH_CNT
               ,IFNULL(GB.CLOSE_YEAR_CNT, 0) AS CLOSE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_EA, 0) AS CLOSE_MONTH_EA
               ,IFNULL(GB.CLOSE_MONTH_WORKLOAD_EA, 0) AS CLOSE_MONTH_WORKLOAD_EA               
               ,IFNULL(GB.CLOSE_SHARE_EA, 0) AS CLOSE_SHARE_EA
               ,IFNULL(GB.CLOSE_SHARE_WORKLOAD_EA, 0) AS CLOSE_SHARE_WORKLOAD_EA
               
               ,IFNULL(GB.PENDING_CURRENT_CNT, 0) AS PENDING_CURRENT_CNT
               ,IFNULL(GB.PENDING_OVER45_CNT, 0) AS PENDING_OVER45_CNT
               ,IFNULL(GB.PENDING_MONTHLY_CNT, 0) AS PENDING_MONTHLY_CNT
               ,IFNULL(GB.AMT_BASIC , 0) AS AMT_BASIC
               ,IFNULL(GB.AMT_DAILY , 0) AS AMT_DAILY
               ,IFNULL(GB.AMT_TRAFFIC , 0) AS AMT_TRAFFIC
               ,IFNULL(GB.AMT_COUNSEL , 0) AS AMT_COUNSEL
               ,IFNULL(GB.AMT_ETC, 0) AS AMT_ETC
               ,IFNULL(GB.AMT_TOTAL, 0) AS AMT_TOTAL
               ,IFNULL(GB.SHARE_AMT_BASIC,0) AS SHARE_AMT_BASIC
               ,IFNULL(GB.SHARE_AMT_DAILY,0) AS SHARE_AMT_DAILY
               ,IFNULL(GB.SHARE_AMT_TRAFFIC,0) AS SHARE_AMT_TRAFFIC
               ,IFNULL(GB.SHARE_AMT_COUNSEL,0) AS SHARE_AMT_COUNSEL
               ,IFNULL(GB.SHARE_AMT_ETC,0) AS SHARE_AMT_ETC
               ,IFNULL(GB.SHARE_AMT_TOTAL,0) AS SHARE_AMT_TOTAL
               ,IFNULL(GB.OUT_AMT, 0) AS OUT_AMT
               ,IFNULL(GB.YEAR_AMT_BASIC, 0) AS YEAR_AMT_BASIC
               ,IFNULL(GB.YEAR_SHARE_AMT_BASIC, 0) AS YEAR_SHARE_AMT_BASIC
               
               <!-- ,IFNULL( (SELECT calc_workload FROM top_rpt_workload_daily WHERE USER_NO = GA.USER_NO AND BASE_DATE &lt; UNIX_TIMESTAMP(#{sEndyear}) ORDER BY BASE_DATE DESC LIMIT 0, 1), 0 ) AS WORK_LOAD_YEAR -->			   
               ,0 AS WORK_LOAD_YEAR 
               
          FROM  top_mbr_bsc GA
          LEFT  JOIN (
                      SELECT  GA.USER_NO
                             ,SUM(GA.RECEIVE_MONTH_CNT) AS RECEIVE_MONTH_CNT
                             ,SUM(GA.RECEIVE_YEAR_CNT) AS RECEIVE_YEAR_CNT
                             ,SUM(GA.CLOSE_MONTH_CNT) AS CLOSE_MONTH_CNT
                             ,SUM(GA.CLOSE_YEAR_CNT) AS CLOSE_YEAR_CNT
                             ,SUM(GA.CLOSE_MONTH_EA) AS CLOSE_MONTH_EA
                             ,SUM(GA.CLOSE_MONTH_WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA                             
                             ,SUM(GA.CLOSE_MONTH_EA_CAL + GA.CLOSE_SHARE_PLUS_EA - GA.CLOSE_SHARE_MINUS_EA) AS CLOSE_SHARE_EA
                             ,SUM(GA.CLOSE_MONTH_WORKLOAD_EA_CAL + GA.CLOSE_SHARE_PLUS_WORKLOAD_EA - GA.CLOSE_SHARE_MINUS_WORKLOAD_EA) AS CLOSE_SHARE_WORKLOAD_EA
                                                  
                             ,SUM(GA.PENDING_CURRENT_CNT) AS PENDING_CURRENT_CNT
                             ,SUM(GA.PENDING_OVER45_CNT) AS PENDING_OVER45_CNT
                             ,SUM(GA.PENDING_MONTHLY_CNT) AS PENDING_MONTHLY_CNT
                             ,SUM(GA.AMT_BASIC) AS AMT_BASIC
                             ,SUM(GA.AMT_DAILY) AS AMT_DAILY
                             ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
                             ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
                             ,SUM(GA.AMT_ETC) AS AMT_ETC
                             ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
                             ,SUM(GA.SHARE_PLUS_AMT_BASIC - GA.SHARE_MINUS_AMT_BASIC) AS SHARE_AMT_BASIC
                             ,SUM(GA.SHARE_PLUS_AMT_DAILY - GA.SHARE_MINUS_AMT_DAILY) AS SHARE_AMT_DAILY
                             ,SUM(GA.SHARE_PLUS_AMT_TRAFFIC - GA.SHARE_MINUS_AMT_TRAFFIC) AS SHARE_AMT_TRAFFIC
                             ,SUM(GA.SHARE_PLUS_AMT_COUNSEL - GA.SHARE_MINUS_AMT_COUNSEL) AS SHARE_AMT_COUNSEL
                             ,SUM(GA.SHARE_PLUS_AMT_ETC - GA.SHARE_MINUS_AMT_ETC) AS SHARE_AMT_ETC
                             ,SUM(GA.SHARE_PLUS_AMT_TOTAL - GA.SHARE_MINUS_AMT_TOTAL) AS SHARE_AMT_TOTAL
                             ,SUM(GA.OUT_AMT) AS OUT_AMT
                             ,SUM(GA.YEAR_AMT_BASIC) AS YEAR_AMT_BASIC
                             ,SUM(GA.YEAR_SHARE_PLUS_AMT_BASIC - GA.YEAR_SHARE_MINUS_AMT_BASIC) AS YEAR_SHARE_AMT_BASIC
                        FROM  (
                                SELECT -1 AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                                                              
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL

                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  DUAL
                                <if test='basicYN == "Y"'>
                                UNION ALL                               
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 FORCE  INDEX (REG_DATE) 
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT            
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                         
                                  FROM  top_rpt_head A
                                 FORCE  INDEX (REG_DATE) 
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT     
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                 
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT     
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  B.USER_ID AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_PLUS_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC -->
									   ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC	
                                        
                                       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO 
                                   <!-- 안빠진부분 by top3009 -->                                  
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.USER_ID
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                      
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA                                       
                                       ,SUM(B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       
                                       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + SUM(B.WRITTEN_BASIC) AS SHARE_MINUS_AMT_BASIC -->
									   ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + SUM(B.WRITTEN_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       
                                       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC              
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL              
                                       ,0 AS SHARE_MINUS_AMT_ETC              
                                       ,0 AS SHARE_MINUS_AMT_TOTAL              
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                              
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO 
                                UNION ALL   
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       <!-- ,SUM(B.AMT_BASIC) AS AMT_BASIC -->
                                       ,SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) AS AMT_BASIC 
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY 
                                       ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
                                       ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
                                       ,SUM(B.AMT_ETC) AS AMT_ETC
                                       ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO       
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO
                                
								UNION ALL
								
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT
                                       <!-- ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC --> 
									   ,SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})             
                                 GROUP BY A.USER_NO
                                 
                                 UNION ALL
                                 
                                SELECT  B.USER_ID AS USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_PLUS_AMT_BASIC -->
									   ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY B.USER_ID
                                 UNION ALL
                                 
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + SUM(B.WRITTEN_BASIC) AS YEAR_SHARE_MINUS_AMT_BASIC -->
									   ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + SUM(B.WRITTEN_BASIC) AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY A.USER_NO  
      
								 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC   		
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC   		
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 1
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO								 
								 
								 
                                </if>
                                <if test='primYN == "Y"'>
                                -- 농산물 --
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                         
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                     
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL 
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT        
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC        
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                      
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL                                
                                
								SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,SUM(B.AMT_BASIC) AS AMT_BASIC
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY
                                       ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.AMT_ETC) AS AMT_ETC
                                       ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT      
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC  
               
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                               
                                
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA                                       
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_PLUS_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY   
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT    
                                       ,0 AS PENDING_MONTHLY_CNT    
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                        
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                 
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.USER_NO != B.SHARE_USER_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                      
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT        
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                    
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                     
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO   
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                         
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                              
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_prim_biz_rpt_head A 
                                       ,top_prim_biz_inv B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO
                                
 								UNION ALL
 								
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT      
									   ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC  
               
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO                               								                               
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT  
                                       ,0 AS PENDING_MONTHLY_CNT      
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                        
									   ,0 AS YEAR_AMT_BASIC
									   ,SUM(B.SHARE_AMT_BASIC) AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                 
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT       
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                        
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,SUM(B.SHARE_AMT_BASIC) AS YEAR_SHARE_MINUS_AMT_BASIC                                                      
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO      
                                
								 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC   		   
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC   		   
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 2
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO		                                                                      
                                </if>
                                <if test='contractYN == "Y"'>
                                -- 적부 --
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL      
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL 
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO 
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(B.SHARE_EA) AS CLOSE_MONTH_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT 
                                       ,SUM(B.SHARE_AMT_BASIC) AS AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.USER_NO = B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO  
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY    
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC    
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL    
                                       ,0 AS SHARE_MINUS_AMT_ETC    
                                       ,0 AS SHARE_MINUS_AMT_TOTAL    
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT        
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                                      
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT       
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                                         
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                                   
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL                                       
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC      
                                  FROM  top_prim_biz_rpt_head A 
                                       ,top_prim_biz_inv B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO
                                 UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                  
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT            
									   ,SUM(B.SHARE_AMT_BASIC) AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC         
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.USER_NO = B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO  
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                       
									   ,0 AS YEAR_AMT_BASIC
									   ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                                   
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC                                                               
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                                                  
                                
                                </if>                                                                                                                 
                              ) GA
                       WHERE  1=1
                      GROUP BY GA.USER_NO              
                     ) GB
            ON  GA.USER_NO = GB.USER_NO         
         WHERE  1=1
           AND  GA.TEAM_ID_MAIN = #{team_id}
           -- AND  GA.USER_STATE != 1
		   AND  (GA.USER_STATE !=1 OR (GA.USER_STATE = 1 AND GA.OUT_DATE >= UNIX_TIMESTAMP(#{bgnYearDe}) AND GA.OUT_DATE &lt; UNIX_TIMESTAMP(#{today})))
		ORDER BY NEW_WORK_ORDER, GA.WORK_LEVEL DESC, GA.USER_NO ASC
    </select>    	

	<!-- 개인기준 개인별 통계 시작 개선 기존 -->    
    <select id="selectBasicMemberPersonStandardList1" parameterType="hashmap" resultType="AsraMap">
        SELECT  GA.USER_NO 
               ,GA.USER_NAME
               ,CASE GA.WORK_TYPE
					WHEN 1 THEN 1
					WHEN 2 THEN 2
					WHEN 6 THEN 3
					WHEN 14 THEN 4
					WHEN 15 THEN 5
					WHEN 3 THEN 6
					WHEN 7 THEN 7
					WHEN 4 THEN 8
					WHEN 8 THEN 9
					WHEN 5 THEN 10
					WHEN 9 THEN 11
					WHEN 10 THEN 12
					WHEN 12 THEN 13
					WHEN 11 THEN 14
					WHEN 13 THEN 15	
				END AS NEW_WORK_ORDER 
               ,IFNULL(GB.RECEIVE_MONTH_CNT, 0) AS RECEIVE_MONTH_CNT
               ,IFNULL(GB.RECEIVE_YEAR_CNT, 0) AS RECEIVE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_CNT, 0) AS CLOSE_MONTH_CNT
               ,IFNULL(GB.CLOSE_YEAR_CNT, 0) AS CLOSE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_EA, 0) AS CLOSE_MONTH_EA
               ,IFNULL(GB.CLOSE_MONTH_WORKLOAD_EA, 0) AS CLOSE_MONTH_WORKLOAD_EA               
               ,IFNULL(GB.CLOSE_SHARE_EA, 0) AS CLOSE_SHARE_EA
               ,IFNULL(GB.CLOSE_SHARE_WORKLOAD_EA, 0) AS CLOSE_SHARE_WORKLOAD_EA
               
               ,IFNULL(GB.PENDING_CURRENT_CNT, 0) AS PENDING_CURRENT_CNT
               ,IFNULL(GB.PENDING_OVER45_CNT, 0) AS PENDING_OVER45_CNT
               ,IFNULL(GB.PENDING_MONTHLY_CNT, 0) AS PENDING_MONTHLY_CNT
               ,IFNULL(GB.AMT_BASIC , 0) AS AMT_BASIC
               ,IFNULL(GB.AMT_DAILY , 0) AS AMT_DAILY
               ,IFNULL(GB.AMT_TRAFFIC , 0) AS AMT_TRAFFIC
               ,IFNULL(GB.AMT_COUNSEL , 0) AS AMT_COUNSEL
               ,IFNULL(GB.AMT_ETC, 0) AS AMT_ETC
               ,IFNULL(GB.AMT_TOTAL, 0) AS AMT_TOTAL
               ,IFNULL(GB.SHARE_AMT_BASIC,0) AS SHARE_AMT_BASIC
               ,IFNULL(GB.SHARE_AMT_DAILY,0) AS SHARE_AMT_DAILY
               ,IFNULL(GB.SHARE_AMT_TRAFFIC,0) AS SHARE_AMT_TRAFFIC
               ,IFNULL(GB.SHARE_AMT_COUNSEL,0) AS SHARE_AMT_COUNSEL
               ,IFNULL(GB.SHARE_AMT_ETC,0) AS SHARE_AMT_ETC
               ,IFNULL(GB.SHARE_AMT_TOTAL,0) AS SHARE_AMT_TOTAL
               ,IFNULL(GB.OUT_AMT, 0) AS OUT_AMT
               ,IFNULL(GB.YEAR_AMT_BASIC, 0) AS YEAR_AMT_BASIC
               ,IFNULL(GB.YEAR_SHARE_AMT_BASIC, 0) AS YEAR_SHARE_AMT_BASIC
               
               <!-- ,IFNULL( (SELECT calc_workload FROM top_rpt_workload_daily WHERE USER_NO = GA.USER_NO AND BASE_DATE &lt; UNIX_TIMESTAMP(#{sEndyear}) ORDER BY BASE_DATE DESC LIMIT 0, 1), 0 ) AS WORK_LOAD_YEAR -->			   
               ,0 AS WORK_LOAD_YEAR 
               
          FROM  top_mbr_bsc GA
          LEFT  JOIN (
                      SELECT  GA.USER_NO
                             ,SUM(GA.RECEIVE_MONTH_CNT) AS RECEIVE_MONTH_CNT
                             ,SUM(GA.RECEIVE_YEAR_CNT) AS RECEIVE_YEAR_CNT
                             ,SUM(GA.CLOSE_MONTH_CNT) AS CLOSE_MONTH_CNT
                             ,SUM(GA.CLOSE_YEAR_CNT) AS CLOSE_YEAR_CNT
                             ,SUM(GA.CLOSE_MONTH_EA) AS CLOSE_MONTH_EA
                             ,SUM(GA.CLOSE_MONTH_WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA                             
                             ,SUM(GA.CLOSE_MONTH_EA_CAL + GA.CLOSE_SHARE_PLUS_EA - GA.CLOSE_SHARE_MINUS_EA) AS CLOSE_SHARE_EA
                             ,SUM(GA.CLOSE_MONTH_WORKLOAD_EA_CAL + GA.CLOSE_SHARE_PLUS_WORKLOAD_EA - GA.CLOSE_SHARE_MINUS_WORKLOAD_EA) AS CLOSE_SHARE_WORKLOAD_EA
                                                  
                             ,SUM(GA.PENDING_CURRENT_CNT) AS PENDING_CURRENT_CNT
                             ,SUM(GA.PENDING_OVER45_CNT) AS PENDING_OVER45_CNT
                             ,SUM(GA.PENDING_MONTHLY_CNT) AS PENDING_MONTHLY_CNT
                             ,SUM(GA.AMT_BASIC) AS AMT_BASIC
                             ,SUM(GA.AMT_DAILY) AS AMT_DAILY
                             ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
                             ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
                             ,SUM(GA.AMT_ETC) AS AMT_ETC
                             ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
                             ,SUM(GA.SHARE_PLUS_AMT_BASIC - GA.SHARE_MINUS_AMT_BASIC) AS SHARE_AMT_BASIC
                             ,SUM(GA.SHARE_PLUS_AMT_DAILY - GA.SHARE_MINUS_AMT_DAILY) AS SHARE_AMT_DAILY
                             ,SUM(GA.SHARE_PLUS_AMT_TRAFFIC - GA.SHARE_MINUS_AMT_TRAFFIC) AS SHARE_AMT_TRAFFIC
                             ,SUM(GA.SHARE_PLUS_AMT_COUNSEL - GA.SHARE_MINUS_AMT_COUNSEL) AS SHARE_AMT_COUNSEL
                             ,SUM(GA.SHARE_PLUS_AMT_ETC - GA.SHARE_MINUS_AMT_ETC) AS SHARE_AMT_ETC
                             ,SUM(GA.SHARE_PLUS_AMT_TOTAL - GA.SHARE_MINUS_AMT_TOTAL) AS SHARE_AMT_TOTAL
                             ,SUM(GA.OUT_AMT) AS OUT_AMT
                             ,SUM(GA.YEAR_AMT_BASIC) AS YEAR_AMT_BASIC
                             ,SUM(GA.YEAR_SHARE_PLUS_AMT_BASIC - GA.YEAR_SHARE_MINUS_AMT_BASIC) AS YEAR_SHARE_AMT_BASIC
                        FROM  (
                                SELECT -1 AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                                                              
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL

                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  DUAL
                                <if test='basicYN == "Y"'>
                                UNION ALL                               
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 FORCE  INDEX (REG_DATE) 
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT            
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                         
                                  FROM  top_rpt_head A
                                 FORCE  INDEX (REG_DATE) 
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT     
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                 
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT     
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  B.USER_ID AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_PLUS_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC -->
                                       ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC 
                                       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.USER_ID
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                      
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA                                       
                                       ,SUM(B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) + SUM(B.WRITTEN_CNT) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC -->
                                       ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(IF(B.COLLABO_DAILY_TYPE = 0, C.AMT_DAILY * B.COLLABO_DAILY * 0.01, B.COLLABO_DAILY)) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.COLLABO_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC              
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL              
                                       ,0 AS SHARE_MINUS_AMT_ETC              
                                       ,0 AS SHARE_MINUS_AMT_TOTAL              
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                              
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO 
                                UNION ALL   
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       <!-- ,SUM(B.AMT_BASIC) AS AMT_BASIC -->
                                       ,SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) AS AMT_BASIC 
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY 
                                       ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
                                       ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
                                       ,SUM(B.AMT_ETC) AS AMT_ETC
                                       ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO       
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO
                                
								UNION ALL
								
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                                        
									   <!-- ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC -->
									   ,SUM((B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO))) AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})             
                                 GROUP BY A.USER_NO
                                 
                                 UNION ALL
                                 
                                SELECT  B.USER_ID AS USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_PLUS_AMT_BASIC -->
									   ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY B.USER_ID
                                 UNION ALL
                                 
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   <!-- ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, C.AMT_BASIC * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_MINUS_AMT_BASIC -->
									   ,SUM(IF(B.COLLABO_PRICE_TYPE = 0, (C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01, B.COLLABO_PRICE)) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   -- AND  A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY A.USER_NO  
      
								 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC   		
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC   		
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 1
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO								 
								 
								 
                                </if>
                                <if test='primYN == "Y"'>
                                -- 농산물 --
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                         
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                     
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL 
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT        
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC        
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                      
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL                                
                                
								SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,SUM(B.AMT_BASIC) AS AMT_BASIC
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY
                                       ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.AMT_ETC) AS AMT_ETC
                                       ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT      
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC  
               
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                               
                                
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA                                       
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_PLUS_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY   
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT    
                                       ,0 AS PENDING_MONTHLY_CNT    
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                        
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                 
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.USER_NO != B.SHARE_USER_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                      
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT        
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                    
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                     
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO   
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                         
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                              
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_prim_biz_rpt_head A 
                                       ,top_prim_biz_inv B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO
                                
 								UNION ALL
 								
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT      
									   ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC  
               
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO                               								                               
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT  
                                       ,0 AS PENDING_MONTHLY_CNT      
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                        
									   ,0 AS YEAR_AMT_BASIC
									   ,SUM(B.SHARE_AMT_BASIC) AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                 
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT       
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                        
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,SUM(B.SHARE_AMT_BASIC) AS YEAR_SHARE_MINUS_AMT_BASIC                                                      
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO      
                                
								 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC   		   
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC   		   
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 2
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO		                                                                      
                                </if>
                                <if test='contractYN == "Y"'>
                                -- 적부 --
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL      
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL 
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO 
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(B.SHARE_EA) AS CLOSE_MONTH_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.WORKLOAD_EA) AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT 
                                       ,SUM(B.SHARE_AMT_BASIC) AS AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                  
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                           
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.USER_NO = B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO  
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_PLUS_AMT_TOTAL
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY    
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC    
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL    
                                       ,0 AS SHARE_MINUS_AMT_ETC    
                                       ,0 AS SHARE_MINUS_AMT_TOTAL    
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT        
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                                      
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_WORKLOAD_EA) AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_PLUS_AMT_COUNSEL
                                       ,0 AS SHARE_PLUS_AMT_ETC
                                       ,0 AS SHARE_PLUS_AMT_TOTAL
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT       
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                                         
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                                   
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL                                       
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC      
                                  FROM  top_prim_biz_rpt_head A 
                                       ,top_prim_biz_inv B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO
                                 UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL                  
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT            
									   ,SUM(B.SHARE_AMT_BASIC) AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC         
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.USER_NO = B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO  
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                       
									   ,0 AS YEAR_AMT_BASIC
									   ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
									   ,0 AS SHARE_MINUS_AMT_BASIC                                                   
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA                                       
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_MONTH_WORKLOAD_EA_CAL                                       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_PLUS_WORKLOAD_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_WORKLOAD_EA
                                       
								       ,0 AS SHARE_PLUS_AMT_BASIC
								       ,0 AS SHARE_PLUS_AMT_DAILY
								       ,0 AS SHARE_PLUS_AMT_TRAFFIC					
								       ,0 AS SHARE_PLUS_AMT_COUNSEL					
								       ,0 AS SHARE_PLUS_AMT_ETC		
								       ,0 AS SHARE_PLUS_AMT_TOTAL
						         	   ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_COUNSEL
                                       ,0 AS SHARE_MINUS_AMT_ETC
                                       ,0 AS SHARE_MINUS_AMT_TOTAL
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS SHARE_PLUS_AMT_BASIC
									   ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC                                                               
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                                                  
                                
                                </if>                                                                                                                 
                              ) GA
                       WHERE  1=1
                      GROUP BY GA.USER_NO              
                     ) GB
            ON  GA.USER_NO = GB.USER_NO         
         WHERE  1=1
           AND  GA.TEAM_ID_MAIN = #{team_id}
           AND  GA.USER_STATE != 1
		   -- AND  (GA.USER_STATE !=1 OR (GA.USER_STATE = 1 AND GA.OUT_DATE >= UNIX_TIMESTAMP('20171216') AND GA.OUT_DATE &lt; UNIX_TIMESTAMP('20181116')))
		ORDER BY NEW_WORK_ORDER, GA.WORK_LEVEL DESC, GA.USER_NO ASC
    </select>
	    
    <!-- NEW기본통계 - statistics_basic_member_list - 개인기준4 기존-->
    <select id="selectBasicMemberPersonStandardList4" parameterType="hashmap" resultType="AsraMap">
        SELECT  GA.USER_NO 
               ,GA.USER_NAME 
               ,IFNULL(GB.RECEIVE_MONTH_CNT, 0) AS RECEIVE_MONTH_CNT
               ,IFNULL(GB.RECEIVE_YEAR_CNT, 0) AS RECEIVE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_CNT, 0) AS CLOSE_MONTH_CNT
               ,IFNULL(GB.CLOSE_YEAR_CNT, 0) AS CLOSE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_EA, 0) AS CLOSE_MONTH_EA
               ,IFNULL(GB.CLOSE_SHARE_EA, 0) AS CLOSE_SHARE_EA
               ,IFNULL(GB.PENDING_CURRENT_CNT, 0) AS PENDING_CURRENT_CNT
               ,IFNULL(GB.PENDING_OVER45_CNT, 0) AS PENDING_OVER45_CNT
               ,IFNULL(GB.PENDING_MONTHLY_CNT, 0) AS PENDING_MONTHLY_CNT
               ,IFNULL(GB.AMT_BASIC , 0) AS AMT_BASIC
               ,IFNULL(GB.AMT_DAILY , 0) AS AMT_DAILY
               ,IFNULL(GB.SHARE_AMT_BASIC,0) AS SHARE_AMT_BASIC
               ,IFNULL(GB.SHARE_AMT_DAILY,0) AS SHARE_AMT_DAILY
               ,IFNULL(GB.SHARE_AMT_TRAFFIC,0) AS SHARE_AMT_TRAFFIC
               ,IFNULL(GB.AMT_TRAFFIC , 0) AS AMT_TRAFFIC
               ,IFNULL(GB.AMT_COUNSEL , 0) AS AMT_COUNSEL
               ,IFNULL(GB.AMT_ETC, 0) AS AMT_ETC
               ,IFNULL(GB.AMT_TOTAL, 0) AS AMT_TOTAL
               ,IFNULL(GB.OUT_AMT, 0) AS OUT_AMT
               ,IFNULL(GB.YEAR_AMT_BASIC, 0) AS YEAR_AMT_BASIC
               ,IFNULL(GB.YEAR_SHARE_AMT_BASIC, 0) AS YEAR_SHARE_AMT_BASIC
          FROM  top_mbr_bsc GA
          LEFT  JOIN (
                      SELECT  GA.USER_NO
                             ,SUM(GA.RECEIVE_MONTH_CNT) AS RECEIVE_MONTH_CNT
                             ,SUM(GA.RECEIVE_YEAR_CNT) AS RECEIVE_YEAR_CNT
                             ,SUM(GA.CLOSE_MONTH_CNT) AS CLOSE_MONTH_CNT
                             ,SUM(GA.CLOSE_YEAR_CNT) AS CLOSE_YEAR_CNT
                             ,SUM(GA.CLOSE_MONTH_EA) AS CLOSE_MONTH_EA
                             ,SUM(GA.CLOSE_MONTH_EA_CAL + GA.CLOSE_SHARE_PLUS_EA - GA.CLOSE_SHARE_MINUS_EA) AS CLOSE_SHARE_EA                     
                             ,SUM(GA.PENDING_CURRENT_CNT) AS PENDING_CURRENT_CNT
                             ,SUM(GA.PENDING_OVER45_CNT) AS PENDING_OVER45_CNT
                             ,SUM(GA.PENDING_MONTHLY_CNT) AS PENDING_MONTHLY_CNT
                             ,SUM(GA.AMT_BASIC) AS AMT_BASIC
                             ,SUM(GA.AMT_DAILY) AS AMT_DAILY
                             ,SUM(GA.SHARE_PLUS_AMT_BASIC - GA.SHARE_MINUS_AMT_BASIC) AS SHARE_AMT_BASIC
                             ,SUM(GA.SHARE_PLUS_AMT_DAILY - GA.SHARE_MINUS_AMT_DAILY) AS SHARE_AMT_DAILY
                             ,SUM(GA.SHARE_PLUS_AMT_TRAFFIC - GA.SHARE_MINUS_AMT_TRAFFIC) AS SHARE_AMT_TRAFFIC
                             ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
                             ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
                             ,SUM(GA.AMT_ETC) AS AMT_ETC
                             ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
                             ,SUM(GA.OUT_AMT) AS OUT_AMT
                             ,SUM(GA.YEAR_AMT_BASIC) AS YEAR_AMT_BASIC
                             ,SUM(GA.YEAR_SHARE_PLUS_AMT_BASIC - GA.YEAR_SHARE_MINUS_AMT_BASIC) AS YEAR_SHARE_AMT_BASIC
                        FROM  (
                                SELECT -1 AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC 
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT    
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC           
                                  FROM  DUAL
                                <if test='basicYN == "Y"'>
                                UNION ALL                               
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                         
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC  
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT             
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC 
                                  FROM  top_rpt_head A
                                 FORCE  INDEX (REG_DATE) 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                         
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_rpt_head A
                                 FORCE  INDEX (REG_DATE) 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                   
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  B.USER_ID AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       -- ,SUM(A.SUIM_RPT_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,IFNULL(SUM(A.SUIM_RPT_EA),0) + IFNULL(SUM(B.WRITTEN_CNT),0) AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       -- ,SUM(B.COLLABO_PP) AS SHARE_PLUS_AMT_BASIC
                                       ,IFNULL(SUM(B.COLLABO_PP),0) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC 
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.USER_ID
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       -- ,SUM(A.SUIM_RPT_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,IFNULL(SUM(A.SUIM_RPT_EA),0) + IFNULL(SUM(B.WRITTEN_CNT),0) AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       -- ,SUM(B.COLLABO_PP) AS SHARE_MINUS_AMT_BASIC
                                       ,IFNULL(SUM(B.COLLABO_PP),0) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                              
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                             
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                              
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO 
                                UNION ALL   
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                               
                                       ,SUM(B.AMT_BASIC) AS AMT_BASIC 
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY 
                                       ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
                                       ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
                                       ,SUM(B.AMT_ETC) AS AMT_ETC
                                       ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO       
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                        
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4) 
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                 GROUP BY A.USER_NO
                                 
								UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})             
                                 GROUP BY A.USER_NO
                                 
                                 UNION ALL
                                SELECT  B.USER_ID AS USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT   
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   -- ,SUM(B.COLLABO_PP) AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,IFNULL(SUM(B.COLLABO_PP),0) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY B.USER_ID
                                 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   -- ,SUM(B.COLLABO_PP) AS YEAR_SHARE_MINUS_AMT_BASIC
									   ,IFNULL(SUM(B.COLLABO_PP),0) + IFNULL(SUM(B.WRITTEN_BASIC),0) AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY A.USER_NO                                     
                                 
                                 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 	
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 1
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO	                                
                                </if>
                                <if test='primYN == "Y"'>
                                -- 농산물 --
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                        
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                               
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL   
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                            
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC  
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                 GROUP BY A.USER_NO
                                 UNION ALL 
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                          
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                    
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                          
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                          
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,SUM(B.AMT_BASIC) AS AMT_BASIC
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                   
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                               
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(B.SHARE_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                       
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT       
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                   
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.USER_NO = B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO  
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY    
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC    
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT        
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                 
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT       
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                 GROUP BY A.USER_NO                              
                                 UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                              
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                       
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT 
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
                                  FROM  top_prim_biz_rpt_head A 
                                       ,top_prim_biz_inv B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                 GROUP BY A.USER_NO
                                 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 	
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 2
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO	                                              
                                </if>
                                <if test='contractYN == "Y"'>
                                -- 적부 --
                                 UNION ALL
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                     
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL   
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL 
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                             
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO 
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(B.SHARE_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                         
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,SUM(C.AMT_BASIC) AS AMT_BASIC
                                       ,SUM(C.AMT_DAILY) AS AMT_DAILY
                                       ,SUM(C.AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(C.AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(C.AMT_ETC) AS AMT_ETC
                                       ,SUM(C.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                   
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_prim_biz_rpt_head A
                                 INNER JOIN top_prim_biz_inv_share B
                                    ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                 INNER JOIN top_prim_biz_inv C
                                    ON  A.SUIM_RPT_NO = C.SUIM_RPT_NO
                                 WHERE  1=1
                                   AND  A.USER_NO = B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO  
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT 
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                            
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT 
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                   
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                    
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                                   
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                 GROUP BY A.USER_NO
                                 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A 
                                       ,top_prim_biz_inv B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO
                                </if>                                                                                                                 
                              ) GA
                       WHERE  1=1
                      GROUP BY GA.USER_NO              
                     ) GB
            ON  GA.USER_NO = GB.USER_NO         
         WHERE  1=1
           AND  GA.TEAM_ID_MAIN = #{team_id}
           AND  GA.USER_STATE != 1
		   -- AND  (GA.USER_STATE !=1 OR (GA.USER_STATE = 1 AND GA.OUT_DATE >= UNIX_TIMESTAMP('20171216') AND GA.OUT_DATE &lt; UNIX_TIMESTAMP('20181116')))
        ORDER BY GA.WORK_TYPE, GA.WORK_LEVEL DESC, GA.USER_NO ASC
    </select>    
    <!-- 개인기준 개인별 통계 끝  -->
    
    <!-- NEW기본통계 - statistics_basic_member_list - 개인기준4 -->
    <select id="selectBasicMemberPersonStandardList4_20191017" parameterType="hashmap" resultType="AsraMap">
        SELECT  GA.USER_NO 
               ,GA.USER_NAME 
               ,IFNULL(GB.RECEIVE_MONTH_CNT, 0) AS RECEIVE_MONTH_CNT
               ,IFNULL(GB.RECEIVE_YEAR_CNT, 0) AS RECEIVE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_CNT, 0) AS CLOSE_MONTH_CNT
               ,IFNULL(GB.CLOSE_YEAR_CNT, 0) AS CLOSE_YEAR_CNT
               ,IFNULL(GB.CLOSE_MONTH_EA, 0) AS CLOSE_MONTH_EA
               ,IFNULL(GB.CLOSE_SHARE_EA, 0) AS CLOSE_SHARE_EA
               ,IFNULL(GB.PENDING_CURRENT_CNT, 0) AS PENDING_CURRENT_CNT
               ,IFNULL(GB.PENDING_OVER45_CNT, 0) AS PENDING_OVER45_CNT
               ,IFNULL(GB.PENDING_MONTHLY_CNT, 0) AS PENDING_MONTHLY_CNT
               ,IFNULL(GB.AMT_BASIC , 0) AS AMT_BASIC
               ,IFNULL(GB.AMT_DAILY , 0) AS AMT_DAILY
               ,IFNULL(GB.SHARE_AMT_BASIC,0) AS SHARE_AMT_BASIC
               ,IFNULL(GB.SHARE_AMT_DAILY,0) AS SHARE_AMT_DAILY
               ,IFNULL(GB.SHARE_AMT_TRAFFIC,0) AS SHARE_AMT_TRAFFIC
               ,IFNULL(GB.AMT_TRAFFIC , 0) AS AMT_TRAFFIC
               ,IFNULL(GB.AMT_COUNSEL , 0) AS AMT_COUNSEL
               ,IFNULL(GB.AMT_ETC, 0) AS AMT_ETC
               ,IFNULL(GB.AMT_TOTAL, 0) AS AMT_TOTAL
               ,IFNULL(GB.OUT_AMT, 0) AS OUT_AMT
               ,IFNULL(GB.YEAR_AMT_BASIC, 0) AS YEAR_AMT_BASIC
               ,IFNULL(GB.YEAR_SHARE_AMT_BASIC, 0) AS YEAR_SHARE_AMT_BASIC
          FROM  top_mbr_bsc GA
          LEFT  JOIN (
                      SELECT  GA.USER_NO
                             ,SUM(GA.RECEIVE_MONTH_CNT) AS RECEIVE_MONTH_CNT
                             ,SUM(GA.RECEIVE_YEAR_CNT) AS RECEIVE_YEAR_CNT
                             ,SUM(GA.CLOSE_MONTH_CNT) AS CLOSE_MONTH_CNT
                             ,SUM(GA.CLOSE_YEAR_CNT) AS CLOSE_YEAR_CNT
                             ,SUM(GA.CLOSE_MONTH_EA) AS CLOSE_MONTH_EA
                             ,SUM(GA.CLOSE_MONTH_EA_CAL + GA.CLOSE_SHARE_PLUS_EA - GA.CLOSE_SHARE_MINUS_EA) AS CLOSE_SHARE_EA                     
                             ,SUM(GA.PENDING_CURRENT_CNT) AS PENDING_CURRENT_CNT
                             ,SUM(GA.PENDING_OVER45_CNT) AS PENDING_OVER45_CNT
                             ,SUM(GA.PENDING_MONTHLY_CNT) AS PENDING_MONTHLY_CNT
                             ,SUM(GA.AMT_BASIC) AS AMT_BASIC
                             ,SUM(GA.AMT_DAILY) AS AMT_DAILY
                             ,SUM(GA.SHARE_PLUS_AMT_BASIC - GA.SHARE_MINUS_AMT_BASIC) AS SHARE_AMT_BASIC
                             ,SUM(GA.SHARE_PLUS_AMT_DAILY - GA.SHARE_MINUS_AMT_DAILY) AS SHARE_AMT_DAILY
                             ,SUM(GA.SHARE_PLUS_AMT_TRAFFIC - GA.SHARE_MINUS_AMT_TRAFFIC) AS SHARE_AMT_TRAFFIC
                             ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
                             ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
                             ,SUM(GA.AMT_ETC) AS AMT_ETC
                             ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
                             ,SUM(GA.OUT_AMT) AS OUT_AMT
                             ,SUM(GA.YEAR_AMT_BASIC) AS YEAR_AMT_BASIC
                             ,SUM(GA.YEAR_SHARE_PLUS_AMT_BASIC - GA.YEAR_SHARE_MINUS_AMT_BASIC) AS YEAR_SHARE_AMT_BASIC
                        FROM  (
                                SELECT -1 AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC 
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT    
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC           
                                  FROM  DUAL
                                <if test='basicYN == "Y"'>
                                UNION ALL                               
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                         
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC  
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT             
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC 
                                  FROM  top_rpt_head A
                                 FORCE  INDEX (REG_DATE) 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                         
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_rpt_head A
                                 FORCE  INDEX (REG_DATE) 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                   
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  B.USER_ID AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.COLLABO_PP) AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC 
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.USER_ID
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.COLLABO_PP) AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                              
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                             
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                       
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                              
                                  FROM  top_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO 
                                UNION ALL   
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                               
                                       ,SUM(B.AMT_BASIC) AS AMT_BASIC 
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY 
                                       ,SUM(B.AMT_TRAFFIC) AS AMT_TRAFFIC 
                                       ,SUM(B.AMT_COUNSEL) AS AMT_COUNSEL 
                                       ,SUM(B.AMT_ETC) AS AMT_ETC
                                       ,SUM(B.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO       
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                                                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT                                        
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4) 
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                 GROUP BY A.USER_NO
                                 
								UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,SUM(B.AMT_BASIC) AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A 
                                       ,top_rpt_invoice B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})             
                                 GROUP BY A.USER_NO
                                 
                                 UNION ALL
                                SELECT  B.USER_ID AS USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT     
                                       ,0 AS PENDING_MONTHLY_CNT   
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,SUM(B.COLLABO_PP) AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY B.USER_ID
                                 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT      
                                       ,0 AS PENDING_MONTHLY_CNT  
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 
									   ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,SUM(B.COLLABO_PP) AS YEAR_SHARE_MINUS_AMT_BASIC
                                  FROM  top_rpt_head A
                                       ,top_rpt_collabo B
                                       ,top_rpt_invoice C
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(3, 4)
                                   AND  A.SUIM_RPT_STATE != 3 
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endYearDe})            
								 GROUP BY A.USER_NO                                     
                                 
                                 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 	
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 1
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO	                                
                                </if>
                                <if test='primYN == "Y"'>
                                -- 농산물 --
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                        
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                               
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL   
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                            
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC  
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                 GROUP BY A.USER_NO
                                 UNION ALL 
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                          
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT  
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                    
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                          
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                          
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,SUM(B.AMT_BASIC) AS AMT_BASIC
                                       ,SUM(B.AMT_DAILY) AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                   
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                               
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(B.SHARE_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                       
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT       
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                   
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.USER_NO = B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO  
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY    
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC    
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,0 AS PENDING_MONTHLY_CNT        
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                 
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT       
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                 GROUP BY A.USER_NO                              
                                 UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                              
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                GROUP BY A.USER_NO
                                UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                       
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT 
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
                                  FROM  top_prim_biz_rpt_head A 
                                       ,top_prim_biz_inv B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 = 5
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                 GROUP BY A.USER_NO
                                 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT        
                                       ,SUM(A.PENDING_CNT) AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT 	
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
		                          FROM  top_rpt_pending_cnt_monthly A 
		                         WHERE  1=1
		                           AND  A.SUIM_TYPE = 2
		                           AND  A.BASE_DATE = IF( DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-%d"),INTERVAL 1 DAY) &lt; DATE_FORMAT(#{endDe},"%Y-%m-16"),
		                           						  UNIX_TIMESTAMP(DATE_SUB(DATE_FORMAT(#{endDe},"%Y-%m-15"),INTERVAL 1 MONTH)),
		                           						  UNIX_TIMESTAMP(DATE_FORMAT(#{endDe},"%Y-%m-15")) )
		                         GROUP BY A.USER_NO	                                              
                                </if>
                                <if test='contractYN == "Y"'>
                                -- 적부 --
                                 UNION ALL
                                SELECT  A.USER_NO 
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL       
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                     
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO    
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL   
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.REG_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.REG_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO
                                UNION ALL 
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                           
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT               
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO
                                UNION ALL   
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                             
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT              
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnYearDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endYearDe})
                                GROUP BY A.USER_NO 
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,SUM(B.SHARE_EA) AS CLOSE_MONTH_EA
                                       ,SUM(A.SUIM_RPT_EA) AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY 
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC                         
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,SUM(C.AMT_BASIC) AS AMT_BASIC
                                       ,SUM(C.AMT_DAILY) AS AMT_DAILY
                                       ,SUM(C.AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(C.AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(C.AMT_ETC) AS AMT_ETC
                                       ,SUM(C.AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT                   
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                          
                                  FROM  top_prim_biz_rpt_head A
                                 INNER JOIN top_prim_biz_inv_share B
                                    ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                 INNER JOIN top_prim_biz_inv C
                                    ON  A.SUIM_RPT_NO = C.SUIM_RPT_NO
                                 WHERE  1=1
                                   AND  A.USER_NO = B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO  
                                UNION ALL
                                SELECT  B.SHARE_USER_NO AS USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT 
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_COUNSEL) AS AMT_COUNSEL
                                       ,SUM(B.SHARE_AMT_ETC) AS AMT_ETC
                                       ,SUM(B.SHARE_AMT_TOTAL) AS AMT_TOTAL
                                       ,0 AS OUT_AMT           
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                            
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY B.SHARE_USER_NO
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,SUM(B.SHARE_EA) AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                                       ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                       ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT       
                                       ,0 AS PENDING_MONTHLY_CNT 
                                       ,0 AS AMT_BASIC
                                       ,0 AS AMT_DAILY
                                       ,0 AS AMT_TRAFFIC
                                       ,0 AS AMT_COUNSEL
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT                   
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                                    
                                  FROM  top_prim_biz_rpt_head A
                                       ,top_prim_biz_inv_share B 
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                                   AND  A.USER_NO != B.SHARE_USER_NO 
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                                   AND  A.CLOSE_DATE &lt;  UNIX_TIMESTAMP(#{endDe})
                                GROUP BY A.USER_NO                                   
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                GROUP BY A.USER_NO    
                                UNION ALL
                                SELECT  A.USER_NO 
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,COUNT(A.SUIM_RPT_NO) AS PENDING_OVER45_CNT
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,0 AS OUT_AMT       
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE IN(0,1,4,11)
                                   AND  A.REG_DATE &lt; UNIX_TIMESTAMP(DATE_SUB(SYSDATE(), INTERVAL 45 DAY))
                                 GROUP BY A.USER_NO
                                 UNION ALL
                                SELECT  A.USER_NO
                                       ,0 AS RECEIVE_MONTH_CNT
                                       ,0 AS RECEIVE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_CNT
                                       ,0 AS CLOSE_YEAR_CNT
                                       ,0 AS CLOSE_MONTH_EA
                                       ,0 AS CLOSE_MONTH_EA_CAL
                                       ,0 AS CLOSE_YEAR_EA
                                       ,0 AS CLOSE_SHARE_PLUS_EA
                                       ,0 AS CLOSE_SHARE_MINUS_EA
                                       ,0 AS SHARE_PLUS_AMT_BASIC
                                       ,0 AS SHARE_PLUS_AMT_DAILY
                                       ,0 AS SHARE_PLUS_AMT_TRAFFIC
                                       ,0 AS SHARE_MINUS_AMT_BASIC
                                       ,0 AS SHARE_MINUS_AMT_DAILY
                                       ,0 AS SHARE_MINUS_AMT_TRAFFIC
                                       ,0 AS PENDING_CURRENT_CNT
                                       ,0 AS PENDING_OVER45_CNT 
                                       ,0 AS PENDING_MONTHLY_CNT
                                       ,0 AS AMT_BASIC 
                                       ,0 AS AMT_DAILY 
                                       ,0 AS AMT_TRAFFIC 
                                       ,0 AS AMT_COUNSEL 
                                       ,0 AS AMT_ETC
                                       ,0 AS AMT_TOTAL
                                       ,SUM(B.AMT_TOTAL) AS OUT_AMT 
                                       ,0 AS YEAR_AMT_BASIC
									   ,0 AS YEAR_SHARE_PLUS_AMT_BASIC
									   ,0 AS YEAR_SHARE_MINUS_AMT_BASIC                                       
                                  FROM  top_prim_biz_rpt_head A 
                                       ,top_prim_biz_inv B
                                 WHERE  1=1
                                   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                                   AND  A.SUIM_RPT_STATE != 3
                                   AND  A.CLOSE_DATE > 0
                                   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
                                GROUP BY A.USER_NO
                                </if>                                                                                                                 
                              ) GA
                       WHERE  1=1
                      GROUP BY GA.USER_NO              
                     ) GB
            ON  GA.USER_NO = GB.USER_NO         
         WHERE  1=1
           AND  GA.TEAM_ID_MAIN = #{team_id}
           AND  GA.USER_STATE != 1
		   -- AND  (GA.USER_STATE !=1 OR (GA.USER_STATE = 1 AND GA.OUT_DATE >= UNIX_TIMESTAMP('20171216') AND GA.OUT_DATE &lt; UNIX_TIMESTAMP('20181116')))
        ORDER BY GA.WORK_TYPE, GA.WORK_LEVEL DESC, GA.USER_NO ASC
    </select>    
    <!-- 개인기준 개인별 통계 끝  -->
    
    <!-- 개인 상세 - 팀기준 상세리스트 -->
	<!-- NEW 기본통계 - statistics_basic_member_detail - 팀기준 개인상세 -->
	<!-- 공동수행 기본금액 설정 추가  collabo_price, collabo_price_type -->    
	<select id="selectDetailList" parameterType="hashmap" resultType="AsraMap">
		SELECT  GA.GUBUN
		       ,GA.SUIM_RPT_NO
		       ,GA.SUIM_ACCEPT_NO
		       
		       ,IFNULL(SUM(GA.AMT_BASIC),0) AS AMT_BASIC
		       ,IFNULL(SUM(GA.AMT_DAILY),0) AS AMT_DAILY
		       ,IFNULL(SUM(GA.AMT_TRAFFIC),0) AS AMT_TRAFFIC
		       ,IFNULL(SUM(GA.AMT_COUNSEL),0) AS AMT_COUNSEL
		       ,IFNULL(SUM(GA.AMT_ETC),0) AS AMT_ETC
		       ,IFNULL(SUM(GA.AMT_ETC),0) AS AMT_TOTAL
		       ,IFNULL(SUM(GA.SUIM_RPT_EA),0) AS SUIM_RPT_EA
		       ,IFNULL(SUM(GA.WORKLOAD_EA),0) AS WORKLOAD_EA 
		       
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_BASIC),0) AS SHARE_MINUS_AMT_BASIC
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_DAILY),0) AS SHARE_MINUS_AMT_DAILY
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_TRAFFIC),0) AS SHARE_MINUS_AMT_TRAFFIC
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_COUNSEL),0) AS SHARE_MINUS_AMT_COUNSEL
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_ETC),0) AS SHARE_MINUS_AMT_ETC
               ,IFNULL(SUM(GA.SHARE_MINUS_EA),0) AS SHARE_MINUS_EA
               ,IFNULL(SUM(GA.SHARE_MINUS_WORKLOAD_EA),0) AS SHARE_MINUS_WORKLOAD_EA

               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_BASIC),0) AS SHARE_PLUS_AMT_BASIC
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_DAILY),0) AS SHARE_PLUS_AMT_DAILY
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_TRAFFIC),0) AS SHARE_PLUS_AMT_TRAFFIC
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_COUNSEL),0) AS SHARE_PLUS_AMT_COUNSEL
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_ETC),0) AS SHARE_PLUS_AMT_ETC
               ,IFNULL(SUM(GA.SHARE_PLUS_EA),0) AS SHARE_PLUS_EA
               ,IFNULL(SUM(GA.SHARE_PLUS_WORKLOAD_EA),0) AS SHARE_PLUS_WORKLOAD_EA
               ,IFNULL(SUM(GA.CALC_WORKLOAD),0) AS CALC_WORKLOAD
		       
		       ,MAX(GA.CLOSE_DATE) AS CLOSE_DATE
		  FROM  (
		          SELECT  '-1' AS GUBUN
		                 ,'' AS SUIM_RPT_NO 
		                 ,'' AS SUIM_ACCEPT_NO
		                 
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC 
                         ,0 AS AMT_COUNSEL 
                         ,0 AS AMT_ETC 
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
						 ,0 AS CALC_WORKLOAD
                         
		                 ,0 AS CLOSE_DATE 
		            FROM  DUAL
		          <if test='basicYN == "Y"'>  
		          -- 공동수행 반영 전
		          UNION ALL    
		          SELECT  '1' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO
                         
                         <!-- ,B.AMT_BASIC --> 
                         ,(B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) AS AMT_BASIC
                         ,B.AMT_DAILY 
                         ,B.AMT_TRAFFIC 
                         ,B.AMT_COUNSEL 
                         ,B.AMT_ETC 
                         ,B.AMT_TOTAL
                         ,A.SUIM_RPT_EA
                         ,A.WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE 
		            FROM  top_rpt_head A
		                 ,top_rpt_invoice B
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		             AND  A.SUIM_RPT_STATE != 3
		             AND  A.TEAM_ID = #{team_id}
		             AND  A.USER_NO = #{user_no} 
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		             
   		          -- 공동수행 지급
		          UNION ALL   
		          SELECT  '1' AS GUBUN
		                 ,A.SUIM_RPT_NO
		                 ,A.SUIM_ACCEPT_NO 
		                 
		                 ,0 AS AMT_BASIC 
		                 ,0 AS AMT_DAILY 
		                 ,0 AS AMT_TRAFFIC 
		                 ,0 AS AMT_COUNSEL 
		                 ,0 AS AMT_ETC 
		                 ,0 AS AMT_TOTAL
		                 ,0 AS SUIM_RPT_EA
		                 ,0 AS WORKLOAD_EA
		                  
		                 <!-- ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_BASIC * IFNULL(E.COLLABO_PP,0) * 0.01) + IFNULL(F.COLLABO_PRICE_MONEY,0) + IFNULL(B.WRITTEN_BASIC,0)
							   ELSE B.COLLABO_PP 
							   END AS SHARE_MINUS_AMT_BASIC --> 
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN ((C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * IFNULL(E.COLLABO_PP,0) * 0.01) + IFNULL(F.COLLABO_PRICE_MONEY,0) + IFNULL(B.WRITTEN_BASIC,0)
							   ELSE B.COLLABO_PP 
							   END AS SHARE_MINUS_AMT_BASIC
                          
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_DAILY * IFNULL(B.COLLABO_DAILY_RATIO,0) * 0.01) + IFNULL(D.COLLABO_DAILY_MONEY,0)
                          	   ELSE 0
                          END AS SHARE_MINUS_AMT_DAILY
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_TRAFFIC,0) + IFNULL(D.COLLABO_TRAFFIC,0))
                          	   ELSE 0
                          END AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC                          
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_PP,0) * 0.01 * A.SUIM_RPT_EA) + (IFNULL(D.COLLABO_PP,0) * 0.01 * A.SUIM_RPT_EA) + IFNULL(B.WRITTEN_CNT,0)
	                           ELSE 0
                          END AS SHARE_MINUS_EA
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_PP,0) * 0.01 * A.WORKLOAD_EA) + (IFNULL(D.COLLABO_PP,0) * 0.01 * A.WORKLOAD_EA) + IFNULL(B.WRITTEN_CNT,0)
			   				   ELSE 0
		  				  END AS SHARE_MINUS_WORKLOAD_EA                         
                          
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
		                 ,0 AS SHARE_PLUS_EA
		                 ,0 AS SHARE_PLUS_WORKLOAD_EA
		                 
		                 ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * ( (A.WORKLOAD_EA * (100 - (SELECT IFNULL(SUM(COLLABO_PP),0) FROM top_rpt_collabo WHERE SUIM_RPT_NO = A.SUIM_RPT_NO)) * 0.01) - (SELECT IFNULL(SUM(WRITTEN_CNT),0) FROM top_rpt_collabo WHERE SUIM_RPT_NO = A.SUIM_RPT_NO) ) ,3) ) 
		                AS CALC_WORKLOAD
		                 
		                 ,A.CLOSE_DATE              
		            FROM  top_rpt_head A
                    LEFT OUTER JOIN
                         (
                           SELECT  SUIM_RPT_NO 
                                  ,SUM(COLLABO_PP) AS COLLABO_PP
                                  ,SUM(COLLABO_DAILY) AS COLLABO_DAILY_RATIO
                                  ,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
                                  ,COUNT(*) AS COLLABO_CNT 
                                  ,SUM(WRITTEN_BASIC) AS WRITTEN_BASIC
                                  ,SUM(WRITTEN_CNT) AS WRITTEN_CNT 
                             FROM  top_rpt_collabo
                            WHERE  COLLABO_DAILY_TYPE = 0 
                            GROUP BY SUIM_RPT_NO  
                         ) B
                      ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
                   INNER JOIN top_rpt_invoice C
                      ON A.SUIM_RPT_NO = C.SUIM_RPT_NO
                    LEFT OUTER JOIN
						 (
                           SELECT  SUIM_RPT_NO
                           		  ,SUM(COLLABO_PP) AS COLLABO_PP
                           		  ,SUM(COLLABO_DAILY) AS COLLABO_DAILY_MONEY
                           		  ,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
                             FROM  top_rpt_collabo
                            WHERE  COLLABO_DAILY_TYPE = 1 
                            GROUP BY SUIM_RPT_NO  
                         ) D
                      ON A.SUIM_RPT_NO = D.SUIM_RPT_NO
                      
                      LEFT OUTER JOIN 
						 (
						   SELECT  SUIM_RPT_NO 
							  ,SUM(COLLABO_PP) AS COLLABO_PP
						     FROM  top_rpt_collabo
						    WHERE  COLLABO_PRICE_TYPE = 0 
						    GROUP BY SUIM_RPT_NO  
						 ) E
					      ON A.SUIM_RPT_NO = E.SUIM_RPT_NO                   
					   
					   LEFT OUTER JOIN 
						 (
						   SELECT  SUIM_RPT_NO 
							  ,SUM(COLLABO_PRICE) AS COLLABO_PRICE_MONEY
						     FROM  top_rpt_collabo
						    WHERE  COLLABO_PRICE_TYPE = 1 
						    GROUP BY SUIM_RPT_NO  
						 ) F
					      ON A.SUIM_RPT_NO = F.SUIM_RPT_NO
					      
		           WHERE  1=1
		             AND  A.TEAM_ID = #{team_id}
		             AND  A.USER_NO = #{user_no}
		             AND  A.SUIM_RPT_STATE != 3
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		               
		          -- 공동수행 수령
		          UNION ALL
                  SELECT  '4' AS GUBUN
                         ,A.SUIM_RPT_NO
                         ,A.SUIM_ACCEPT_NO 
                         
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC 
                         ,0 AS AMT_COUNSEL 
                         ,0 AS AMT_ETC 
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                                                  
                         <!-- ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_PRICE_TYPE = 0 THEN (C.AMT_BASIC * B.COLLABO_PP * 0.01) + IFNULL(B.WRITTEN_BASIC,0)
                         		  WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_PRICE_TYPE = 1 THEN B.COLLABO_PRICE
								  ELSE B.COLLABO_PP
                          END AS SHARE_PLUS_AMT_BASIC -->                          
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_PRICE_TYPE = 0 THEN ((C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01) + IFNULL(B.WRITTEN_BASIC,0)
                         		  WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_PRICE_TYPE = 1 THEN B.COLLABO_PRICE
								  ELSE B.COLLABO_PP
                          END AS SHARE_PLUS_AMT_BASIC 
                          
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_DAILY_TYPE = 0 THEN (C.AMT_DAILY * B.COLLABO_DAILY * 0.01)
                         	   WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_DAILY_TYPE = 1 THEN B.COLLABO_DAILY 
                          	   ELSE 0
                          END AS SHARE_PLUS_AMT_DAILY
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN B.COLLABO_TRAFFIC
							   ELSE 0
                          END AS SHARE_PLUS_TRAFFIC
                         ,0 AS SHARE_PLUS_COUNSEL
                         ,0 AS SHARE_PLUS_ETC
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) + IFNULL(B.WRITTEN_CNT,0)
                          	   ELSE 0
                          END AS SHARE_PLUS_EA
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) + IFNULL(B.WRITTEN_CNT,0)
			   				   ELSE 0
		  				  END AS SHARE_PLUS_WORKLOAD_EA
		  				  
                         ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * A.WORKLOAD_EA * B.COLLABO_PP * 0.01,3) )
                         + (SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * IFNULL(B.WRITTEN_CNT,0), 3) ) 
                         AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE
		            FROM  top_rpt_head A
		                 ,top_rpt_collabo B
		                 ,top_rpt_invoice C 
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		             AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
		             AND  B.SHARE_TEAM_ID = #{team_id}
		             AND  B.USER_ID = #{user_no}
		             AND  A.SUIM_RPT_STATE != 3
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		          </if>
		          <if test='primYN == "Y"'>
                  UNION ALL 
                  -- 농작물 공동수행 반영 전
                  SELECT '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,B.AMT_BASIC 
                         ,B.AMT_DAILY
                         ,B.AMT_TRAFFIC
                         ,B.AMT_COUNSEL
                         ,B.AMT_ETC                         
                         ,B.AMT_TOTAL
                         ,A.SUIM_RPT_EA 
                         ,A.WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  A.TEAM_ID = #{team_id}
                     AND  A.USER_NO = #{user_no}
                     AND  A.SUIM_RPT_STATE != 3
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
				  UNION ALL
                  -- 농작물 공동수행 지급
                  SELECT '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_MINUS_EA
                         ,SUM(B.SHARE_WORKLOAD_EA) AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  A.TEAM_ID = #{team_id}
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO != A.USER_NO
                     AND  A.SUIM_RPT_STATE != 3
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO                      
				  UNION ALL
                  -- 농작물 공동수행 수령
                  SELECT '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA 
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_EA
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  A.TEAM_ID = #{team_id}
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO = #{user_no}
                     AND  A.SUIM_RPT_STATE != 3
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO          
                   UNION ALL
                 SELECT  '5' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
                         
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,B.SHARE_AMT_BASIC AS SHARE_PLUS_AMT_BASIC
                         ,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_DAILY
                         ,B.SHARE_AMT_TRAFFIC AS SHARE_PLUS_AMT_TRAFFIC
                         ,B.SHARE_AMT_COUNSEL AS SHARE_PLUS_AMT_COUNSEL
                         ,B.SHARE_AMT_ETC AS SHARE_PLUS_AMT_ETC
                         ,B.SHARE_EA AS SHARE_PLUS_EA
                         ,B.SHARE_EA AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
                         ,top_prim_biz_inv_share B  
                   WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
		             AND  A.USER_NO != B.SHARE_USER_NO  
		             AND  A.SUIM_RPT_TYPE1 = 5
		             AND  B.SHARE_TEAM_ID = #{team_id}
		             AND  B.SHARE_USER_NO = #{user_no}
		             AND  A.SUIM_RPT_STATE != 3
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		          </if>
		          <if test='contractYN == "Y"'>
		          UNION ALL
                  -- 적부 공동수행 반영 전
                  SELECT '3' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,B.AMT_BASIC 
                         ,B.AMT_DAILY
                         ,B.AMT_TRAFFIC
                         ,B.AMT_COUNSEL
                         ,B.AMT_ETC                         
                         ,B.AMT_TOTAL
                         ,A.SUIM_RPT_EA 
                         ,A.WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 IN (6, 7, 8, 9, 10, 99)
                     AND  A.TEAM_ID = #{team_id}						                     
                     AND  A.USER_NO = #{user_no}
                     AND  A.SUIM_RPT_STATE != 3
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                 UNION ALL
                  -- 적부 공동수행 지급
                  SELECT '3' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_MINUS_EA
                         ,SUM(B.SHARE_WORKLOAD_EA) AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                     AND  A.TEAM_ID = #{team_id}                     
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO != A.USER_NO
                     AND  A.SUIM_RPT_STATE != 3
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO                   
				   UNION ALL
                  -- 적부 공동수행 수령
                  SELECT '3' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_EA
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                     AND  A.TEAM_ID = #{team_id}                     
                     AND  A.USER_NO = #{user_no}
                     AND  A.SUIM_RPT_STATE != 3
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO                                         
                     
		         UNION ALL
		         SELECT  '6' AS GUBUN
		                 ,A.SUIM_RPT_NO 
		                 ,A.SUIM_ACCEPT_NO 
		                 ,0 AS AMT_BASIC 
		                 ,0 AS AMT_DAILY 
		                 ,0 AS AMT_TRAFFIC
		                 ,B.SHARE_AMT_COUNSEL AS AMT_COUNSEL
		                 ,B.SHARE_AMT_ETC AS AMT_ETC
		                 ,B.SHARE_AMT_TOTAL AS AMT_TOTAL
		                 ,0 AS SUIM_RPT_EA
		                 ,0 AS WORKLOAD_EA
		                 
		                 ,0 AS SHARE_MINUS_AMT_BASIC
		                 ,0 AS SHARE_MINUS_AMT_DAILY
		                 ,0 AS SHARE_MINUS_AMT_TRAFFIC
		                 ,0 AS SHARE_MINUS_AMT_COUNSEL
		                 ,0 AS SHARE_MINUS_AMT_ETC
		                 ,0 AS SHARE_MINUS_EA
		                 ,0 AS SHARE_MINUS_WORKLOAD_EA
		                 
		                 ,B.SHARE_AMT_BASIC AS SHARE_PLUS_AMT_BASIC
		                 ,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_DAILY
		                 ,B.SHARE_AMT_TRAFFIC AS SHARE_PLUS_AMT_TRAFFIC
		                 ,B.SHARE_AMT_COUNSEL AS SHARE_PLUS_AMT_COUNSEL
		                 ,B.SHARE_AMT_ETC AS SHARE_PLUS_AMT_ETC
		                 ,B.SHARE_EA AS SHARE_PLUS_EA
		                 ,B.SHARE_EA AS SHARE_PLUS_WORKLOAD_EA
		                 
		                 ,0 AS CALC_WORKLOAD
		                 
		                 ,A.CLOSE_DATE       
		            FROM  top_prim_biz_rpt_head A
		                 ,top_prim_biz_inv_share B  
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
		             AND  A.USER_NO != B.SHARE_USER_NO  
		             AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		             AND  B.SHARE_TEAM_ID = #{team_id}
		             AND  B.SHARE_USER_NO = #{user_no}
		             AND  A.SUIM_RPT_STATE != 3
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		         </if>                                    
		        ) GA
		 WHERE  1=1
		   AND  GA.GUBUN > 0
		GROUP BY GA.GUBUN, GA.SUIM_RPT_NO, GA.SUIM_ACCEPT_NO 
		ORDER BY GA.GUBUN ASC, GA.CLOSE_DATE DESC, GA.SUIM_RPT_NO DESC	
	</select>    

	<select id="selectDetailList_20210924" parameterType="hashmap" resultType="AsraMap">
		SELECT  GA.GUBUN
		       ,GA.SUIM_RPT_NO
		       ,GA.SUIM_ACCEPT_NO
		       
		       ,IFNULL(SUM(GA.AMT_BASIC),0) AS AMT_BASIC
		       ,IFNULL(SUM(GA.AMT_DAILY),0) AS AMT_DAILY
		       ,IFNULL(SUM(GA.AMT_TRAFFIC),0) AS AMT_TRAFFIC
		       ,IFNULL(SUM(GA.AMT_COUNSEL),0) AS AMT_COUNSEL
		       ,IFNULL(SUM(GA.AMT_ETC),0) AS AMT_ETC
		       ,IFNULL(SUM(GA.AMT_ETC),0) AS AMT_TOTAL
		       ,IFNULL(SUM(GA.SUIM_RPT_EA),0) AS SUIM_RPT_EA
		       ,IFNULL(SUM(GA.WORKLOAD_EA),0) AS WORKLOAD_EA 
		       
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_BASIC),0) AS SHARE_MINUS_AMT_BASIC
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_DAILY),0) AS SHARE_MINUS_AMT_DAILY
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_TRAFFIC),0) AS SHARE_MINUS_AMT_TRAFFIC
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_COUNSEL),0) AS SHARE_MINUS_AMT_COUNSEL
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_ETC),0) AS SHARE_MINUS_AMT_ETC
               ,IFNULL(SUM(GA.SHARE_MINUS_EA),0) AS SHARE_MINUS_EA
               ,IFNULL(SUM(GA.SHARE_MINUS_WORKLOAD_EA),0) AS SHARE_MINUS_WORKLOAD_EA

               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_BASIC),0) AS SHARE_PLUS_AMT_BASIC
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_DAILY),0) AS SHARE_PLUS_AMT_DAILY
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_TRAFFIC),0) AS SHARE_PLUS_AMT_TRAFFIC
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_COUNSEL),0) AS SHARE_PLUS_AMT_COUNSEL
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_ETC),0) AS SHARE_PLUS_AMT_ETC
               ,IFNULL(SUM(GA.SHARE_PLUS_EA),0) AS SHARE_PLUS_EA
               ,IFNULL(SUM(GA.SHARE_PLUS_WORKLOAD_EA),0) AS SHARE_PLUS_WORKLOAD_EA
               ,IFNULL(SUM(GA.CALC_WORKLOAD),0) AS CALC_WORKLOAD
		       
		       ,MAX(GA.CLOSE_DATE) AS CLOSE_DATE
		  FROM  (
		          SELECT  '-1' AS GUBUN
		                 ,'' AS SUIM_RPT_NO 
		                 ,'' AS SUIM_ACCEPT_NO
		                 
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC 
                         ,0 AS AMT_COUNSEL 
                         ,0 AS AMT_ETC 
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
						 ,0 AS CALC_WORKLOAD
                         
		                 ,0 AS CLOSE_DATE 
		            FROM  DUAL
		          <if test='basicYN == "Y"'>  
		          -- 공동수행 반영 전
		          UNION ALL    
		          SELECT  '1' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO
                         
                         ,B.AMT_BASIC 
                         ,B.AMT_DAILY 
                         ,B.AMT_TRAFFIC 
                         ,B.AMT_COUNSEL 
                         ,B.AMT_ETC 
                         ,B.AMT_TOTAL
                         ,A.SUIM_RPT_EA
                         ,A.WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE 
		            FROM  top_rpt_head A
		                 ,top_rpt_invoice B
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		             AND  A.SUIM_RPT_STATE != 3
		             AND  A.TEAM_ID = #{team_id}
		             AND  A.USER_NO = #{user_no} 
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		             
   		          -- 공동수행 지급
		          UNION ALL   
		          SELECT  '1' AS GUBUN
		                 ,A.SUIM_RPT_NO
		                 ,A.SUIM_ACCEPT_NO 
		                 
		                 ,0 AS AMT_BASIC 
		                 ,0 AS AMT_DAILY 
		                 ,0 AS AMT_TRAFFIC 
		                 ,0 AS AMT_COUNSEL 
		                 ,0 AS AMT_ETC 
		                 ,0 AS AMT_TOTAL
		                 ,0 AS SUIM_RPT_EA
		                 ,0 AS WORKLOAD_EA
		                 
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_BASIC * IFNULL(B.COLLABO_PP,0) * 0.01) + (C.AMT_BASIC * IFNULL(D.COLLABO_PP,0) * 0.01) + IFNULL(B.WRITTEN_BASIC,0)
                          	   ELSE B.COLLABO_PP 
                          END AS SHARE_MINUS_AMT_BASIC
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_DAILY * IFNULL(B.COLLABO_DAILY_RATIO,0) * 0.01) + IFNULL(D.COLLABO_DAILY_MONEY,0)
                          	   ELSE 0
                          END AS SHARE_MINUS_AMT_DAILY
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_TRAFFIC,0) + IFNULL(D.COLLABO_TRAFFIC,0))
                          	   ELSE 0
                          END AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC                          
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_PP,0) * 0.01 * A.SUIM_RPT_EA) + (IFNULL(D.COLLABO_PP,0) * 0.01 * A.SUIM_RPT_EA) + IFNULL(B.WRITTEN_CNT,0)
	                           ELSE 0
                          END AS SHARE_MINUS_EA
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_PP,0) * 0.01 * A.WORKLOAD_EA) + (IFNULL(D.COLLABO_PP,0) * 0.01 * A.WORKLOAD_EA) + IFNULL(B.WRITTEN_CNT,0)
			   				   ELSE 0
		  				  END AS SHARE_MINUS_WORKLOAD_EA                         
                          
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
		                 ,0 AS SHARE_PLUS_EA
		                 ,0 AS SHARE_PLUS_WORKLOAD_EA
		                 
		                 ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * ( (A.WORKLOAD_EA * (100 - (SELECT IFNULL(SUM(COLLABO_PP),0) FROM top_rpt_collabo WHERE SUIM_RPT_NO = A.SUIM_RPT_NO)) * 0.01) - (SELECT IFNULL(SUM(WRITTEN_CNT),0) FROM top_rpt_collabo WHERE SUIM_RPT_NO = A.SUIM_RPT_NO) ) ,3) ) 
		                AS CALC_WORKLOAD
		                 
		                 ,A.CLOSE_DATE              
		            FROM  top_rpt_head A
                    LEFT OUTER JOIN
                         (
                           SELECT  SUIM_RPT_NO 
                                  ,SUM(COLLABO_PP) AS COLLABO_PP
                                  ,SUM(COLLABO_DAILY) AS COLLABO_DAILY_RATIO
                                  ,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
                                  ,COUNT(*) AS COLLABO_CNT 
                                  ,SUM(WRITTEN_BASIC) AS WRITTEN_BASIC
                                  ,SUM(WRITTEN_CNT) AS WRITTEN_CNT 
                             FROM  top_rpt_collabo
                            WHERE  COLLABO_DAILY_TYPE = 0 
                            GROUP BY SUIM_RPT_NO  
                         ) B
                      ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
                   INNER JOIN top_rpt_invoice C
                      ON A.SUIM_RPT_NO = C.SUIM_RPT_NO
                    LEFT OUTER JOIN
						 (
                           SELECT  SUIM_RPT_NO
                           		  ,SUM(COLLABO_PP) AS COLLABO_PP
                           		  ,SUM(COLLABO_DAILY) AS COLLABO_DAILY_MONEY
                           		  ,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
                             FROM  top_rpt_collabo
                            WHERE  COLLABO_DAILY_TYPE = 1 
                            GROUP BY SUIM_RPT_NO  
                         ) D
                      ON A.SUIM_RPT_NO = D.SUIM_RPT_NO
		           WHERE  1=1
		             AND  A.TEAM_ID = #{team_id}
		             AND  A.USER_NO = #{user_no}
		             AND  A.SUIM_RPT_STATE != 3
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		               
		          -- 공동수행 수령
		          UNION ALL
                  SELECT  '4' AS GUBUN
                         ,A.SUIM_RPT_NO
                         ,A.SUIM_ACCEPT_NO 
                         
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC 
                         ,0 AS AMT_COUNSEL 
                         ,0 AS AMT_ETC 
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                                                  
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_BASIC * B.COLLABO_PP * 0.01) + IFNULL(B.WRITTEN_BASIC,0)
                          	   ELSE B.COLLABO_PP
                          END AS SHARE_PLUS_AMT_BASIC
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_DAILY_TYPE = 0 THEN (C.AMT_DAILY * B.COLLABO_DAILY * 0.01)
                         	   WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_DAILY_TYPE = 1 THEN B.COLLABO_DAILY 
                          	   ELSE 0
                          END AS SHARE_PLUS_AMT_DAILY
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN B.COLLABO_TRAFFIC
							   ELSE 0
                          END AS SHARE_PLUS_TRAFFIC
                         ,0 AS SHARE_PLUS_COUNSEL
                         ,0 AS SHARE_PLUS_ETC
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) + IFNULL(B.WRITTEN_CNT,0)
                          	   ELSE 0
                          END AS SHARE_PLUS_EA
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) + IFNULL(B.WRITTEN_CNT,0)
			   				   ELSE 0
		  				  END AS SHARE_PLUS_WORKLOAD_EA
		  				  
                         ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * A.WORKLOAD_EA * B.COLLABO_PP * 0.01,3) )
                         + (SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * IFNULL(B.WRITTEN_CNT,0), 3) ) 
                         AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE
		            FROM  top_rpt_head A
		                 ,top_rpt_collabo B
		                 ,top_rpt_invoice C 
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		             AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
		             AND  B.SHARE_TEAM_ID = #{team_id}
		             AND  B.USER_ID = #{user_no}
		             AND  A.SUIM_RPT_STATE != 3
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		          </if>
		          <if test='primYN == "Y"'>
                  UNION ALL 
                  -- 농작물 공동수행 반영 전
                  SELECT '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,B.AMT_BASIC 
                         ,B.AMT_DAILY
                         ,B.AMT_TRAFFIC
                         ,B.AMT_COUNSEL
                         ,B.AMT_ETC                         
                         ,B.AMT_TOTAL
                         ,A.SUIM_RPT_EA 
                         ,A.WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  A.TEAM_ID = #{team_id}
                     AND  A.USER_NO = #{user_no}
                     AND  A.SUIM_RPT_STATE != 3
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
				  UNION ALL
                  -- 농작물 공동수행 지급
                  SELECT '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_MINUS_EA
                         ,SUM(B.SHARE_WORKLOAD_EA) AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  A.TEAM_ID = #{team_id}
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO != A.USER_NO
                     AND  A.SUIM_RPT_STATE != 3
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO                      
				  UNION ALL
                  -- 농작물 공동수행 수령
                  SELECT '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA 
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_EA
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  A.TEAM_ID = #{team_id}
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO = #{user_no}
                     AND  A.SUIM_RPT_STATE != 3
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO          
                   UNION ALL
                 SELECT  '5' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
                         
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,B.SHARE_AMT_BASIC AS SHARE_PLUS_AMT_BASIC
                         ,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_DAILY
                         ,B.SHARE_AMT_TRAFFIC AS SHARE_PLUS_AMT_TRAFFIC
                         ,B.SHARE_AMT_COUNSEL AS SHARE_PLUS_AMT_COUNSEL
                         ,B.SHARE_AMT_ETC AS SHARE_PLUS_AMT_ETC
                         ,B.SHARE_EA AS SHARE_PLUS_EA
                         ,B.SHARE_EA AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
                         ,top_prim_biz_inv_share B  
                   WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
		             AND  A.USER_NO != B.SHARE_USER_NO  
		             AND  A.SUIM_RPT_TYPE1 = 5
		             AND  B.SHARE_TEAM_ID = #{team_id}
		             AND  B.SHARE_USER_NO = #{user_no}
		             AND  A.SUIM_RPT_STATE != 3
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		          </if>
		          <if test='contractYN == "Y"'>
		          UNION ALL
                  -- 적부 공동수행 반영 전
                  SELECT '3' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,B.AMT_BASIC 
                         ,B.AMT_DAILY
                         ,B.AMT_TRAFFIC
                         ,B.AMT_COUNSEL
                         ,B.AMT_ETC                         
                         ,B.AMT_TOTAL
                         ,A.SUIM_RPT_EA 
                         ,A.WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 IN (6, 7, 8, 9, 10, 99)
                     AND  A.TEAM_ID = #{team_id}						                     
                     AND  A.USER_NO = #{user_no}
                     AND  A.SUIM_RPT_STATE != 3
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                 UNION ALL
                  -- 적부 공동수행 지급
                  SELECT '3' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_MINUS_EA
                         ,SUM(B.SHARE_WORKLOAD_EA) AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                     AND  A.TEAM_ID = #{team_id}                     
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO != A.USER_NO
                     AND  A.SUIM_RPT_STATE != 3
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO                   
				   UNION ALL
                  -- 적부 공동수행 수령
                  SELECT '3' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_EA
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                     AND  A.TEAM_ID = #{team_id}                     
                     AND  A.USER_NO = #{user_no}
                     AND  A.SUIM_RPT_STATE != 3
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO                                         
                     
		         UNION ALL
		         SELECT  '6' AS GUBUN
		                 ,A.SUIM_RPT_NO 
		                 ,A.SUIM_ACCEPT_NO 
		                 ,0 AS AMT_BASIC 
		                 ,0 AS AMT_DAILY 
		                 ,0 AS AMT_TRAFFIC
		                 ,B.SHARE_AMT_COUNSEL AS AMT_COUNSEL
		                 ,B.SHARE_AMT_ETC AS AMT_ETC
		                 ,B.SHARE_AMT_TOTAL AS AMT_TOTAL
		                 ,0 AS SUIM_RPT_EA
		                 ,0 AS WORKLOAD_EA
		                 
		                 ,0 AS SHARE_MINUS_AMT_BASIC
		                 ,0 AS SHARE_MINUS_AMT_DAILY
		                 ,0 AS SHARE_MINUS_AMT_TRAFFIC
		                 ,0 AS SHARE_MINUS_AMT_COUNSEL
		                 ,0 AS SHARE_MINUS_AMT_ETC
		                 ,0 AS SHARE_MINUS_EA
		                 ,0 AS SHARE_MINUS_WORKLOAD_EA
		                 
		                 ,B.SHARE_AMT_BASIC AS SHARE_PLUS_AMT_BASIC
		                 ,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_DAILY
		                 ,B.SHARE_AMT_TRAFFIC AS SHARE_PLUS_AMT_TRAFFIC
		                 ,B.SHARE_AMT_COUNSEL AS SHARE_PLUS_AMT_COUNSEL
		                 ,B.SHARE_AMT_ETC AS SHARE_PLUS_AMT_ETC
		                 ,B.SHARE_EA AS SHARE_PLUS_EA
		                 ,B.SHARE_EA AS SHARE_PLUS_WORKLOAD_EA
		                 
		                 ,0 AS CALC_WORKLOAD
		                 
		                 ,A.CLOSE_DATE       
		            FROM  top_prim_biz_rpt_head A
		                 ,top_prim_biz_inv_share B  
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
		             AND  A.USER_NO != B.SHARE_USER_NO  
		             AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		             AND  B.SHARE_TEAM_ID = #{team_id}
		             AND  B.SHARE_USER_NO = #{user_no}
		             AND  A.SUIM_RPT_STATE != 3
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		         </if>                                    
		        ) GA
		 WHERE  1=1
		   AND  GA.GUBUN > 0
		GROUP BY GA.GUBUN, GA.SUIM_RPT_NO, GA.SUIM_ACCEPT_NO 
		ORDER BY GA.GUBUN ASC, GA.CLOSE_DATE DESC, GA.SUIM_RPT_NO DESC	
	</select>    
	
    
	<!-- 개인 상세 - 개인기준 상세리스트 -->
	<!-- NEW 기본통계 - statistics_basic_member_detail - 개인기준 개인상세 WRITTEN 추가-->
	<!-- 공동수행 기본금액 설정 추가  collabo_price, collabo_price_type -->    
    <select id="selectDetailPersonStandardList" parameterType="hashmap" resultType="AsraMap">
        SELECT  GA.GUBUN
               ,GA.SUIM_RPT_NO
               ,GA.SUIM_ACCEPT_NO
               ,IFNULL(SUM(GA.AMT_BASIC),0) AS AMT_BASIC
               ,IFNULL(SUM(GA.AMT_DAILY),0) AS AMT_DAILY
               ,IFNULL(SUM(GA.AMT_TRAFFIC),0) AS AMT_TRAFFIC
               ,IFNULL(SUM(GA.AMT_COUNSEL),0) AS AMT_COUNSEL
               ,IFNULL(SUM(GA.AMT_ETC),0) AS AMT_ETC
               ,IFNULL(SUM(GA.AMT_TOTAL),0) AS AMT_TOTAL
               ,IFNULL(SUM(GA.SUIM_RPT_EA),0) AS SUIM_RPT_EA
               ,IFNULL(SUM(GA.WORKLOAD_EA),0) AS WORKLOAD_EA               
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_BASIC),0) AS SHARE_MINUS_AMT_BASIC
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_DAILY),0) AS SHARE_MINUS_AMT_DAILY
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_TRAFFIC),0) AS SHARE_MINUS_AMT_TRAFFIC
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_COUNSEL),0) AS SHARE_MINUS_AMT_COUNSEL
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_ETC),0) AS SHARE_MINUS_AMT_ETC
               ,IFNULL(SUM(GA.SHARE_MINUS_EA),0) AS SHARE_MINUS_EA
               ,IFNULL(SUM(GA.SHARE_MINUS_WORKLOAD_EA),0) AS SHARE_MINUS_WORKLOAD_EA                 
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_BASIC),0) AS SHARE_PLUS_AMT_BASIC
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_DAILY),0) AS SHARE_PLUS_AMT_DAILY
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_TRAFFIC),0) AS SHARE_PLUS_AMT_TRAFFIC
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_COUNSEL),0) AS SHARE_PLUS_AMT_COUNSEL
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_ETC),0) AS SHARE_PLUS_AMT_ETC
               ,IFNULL(SUM(GA.SHARE_PLUS_EA),0) AS SHARE_PLUS_EA
               ,IFNULL(SUM(GA.SHARE_PLUS_WORKLOAD_EA),0) AS SHARE_PLUS_WORKLOAD_EA
               ,IFNULL(SUM(GA.CALC_WORKLOAD),0) AS CALC_WORKLOAD                           
               ,MAX(GA.CLOSE_DATE) AS CLOSE_DATE               
          FROM  (
                  SELECT  '-1' AS GUBUN
                         ,'' AS SUIM_RPT_NO 
                         ,'' AS SUIM_ACCEPT_NO
                         
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC 
                         ,0 AS AMT_COUNSEL 
                         ,0 AS AMT_ETC 
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         ,0 AS CALC_WORKLOAD                         
                         
                         ,0 AS CLOSE_DATE 
                    FROM  DUAL
                  <if test='basicYN == "Y"'>
                  
                  -- 공동수행 반영 전  
                  UNION ALL    
                  SELECT  '1' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO
                         <!-- ,B.AMT_BASIC -->
                         ,(B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) AS AMT_BASIC
                         ,B.AMT_DAILY 
                         ,B.AMT_TRAFFIC 
                         ,B.AMT_COUNSEL 
                         ,B.AMT_ETC 
                         ,B.AMT_TOTAL
                         ,A.SUIM_RPT_EA
                         ,A.WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA                         
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE 
                    FROM  top_rpt_head A
                         ,top_rpt_invoice B
                   WHERE  1=1
                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                          
                     AND A.SUIM_RPT_STATE = 2 
                     AND  A.USER_NO = (SELECT USER_NO FROM top_mbr_bsc WHERE USER_NO = #{user_no} AND TEAM_ID_MAIN = #{team_id})
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                  
                  -- 공동수행 지급
                  UNION ALL   
		          SELECT  '1' AS GUBUN
		                 ,A.SUIM_RPT_NO
		                 ,A.SUIM_ACCEPT_NO 
		                 ,0 AS AMT_BASIC 
		                 ,0 AS AMT_DAILY 
		                 ,0 AS AMT_TRAFFIC 
		                 ,0 AS AMT_COUNSEL 
		                 ,0 AS AMT_ETC 
		                 ,0 AS AMT_TOTAL
		                 ,0 AS SUIM_RPT_EA
		                 ,0 AS WORKLOAD_EA
                         <!-- ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_BASIC * IFNULL(E.COLLABO_PP,0) * 0.01) + IFNULL(F.COLLABO_PRICE_MONEY,0) + IFNULL(B.WRITTEN_BASIC,0)
                          	   ELSE B.COLLABO_PP 
                          END AS SHARE_MINUS_AMT_BASIC -->
                          
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN ((C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * IFNULL(E.COLLABO_PP,0) * 0.01) + IFNULL(F.COLLABO_PRICE_MONEY,0) + IFNULL(B.WRITTEN_BASIC,0)
                          	   ELSE B.COLLABO_PP 
                          END AS SHARE_MINUS_AMT_BASIC
                          
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_DAILY * IFNULL(B.COLLABO_DAILY_RATIO,0) * 0.01) + IFNULL(D.COLLABO_DAILY_MONEY,0)
                          	   ELSE 0
                          END AS SHARE_MINUS_AMT_DAILY
                          
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_TRAFFIC,0) + IFNULL(D.COLLABO_TRAFFIC,0))
                          	   ELSE 0
                          END AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_PP,0) * 0.01 * A.SUIM_RPT_EA) + (IFNULL(D.COLLABO_PP,0) * 0.01 * A.SUIM_RPT_EA) + IFNULL(B.WRITTEN_CNT,0)
	                           ELSE 0
                          END AS SHARE_MINUS_EA
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_PP,0) * 0.01 * A.WORKLOAD_EA) + (IFNULL(D.COLLABO_PP,0) * 0.01 * A.WORKLOAD_EA) + IFNULL(B.WRITTEN_CNT,0)
	                           ELSE 0
                          END AS SHARE_MINUS_WORKLOAD_EA                          
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * ( (A.WORKLOAD_EA * (100 - (SELECT IFNULL(SUM(COLLABO_PP),0) FROM top_rpt_collabo WHERE SUIM_RPT_NO = A.SUIM_RPT_NO)) * 0.01) - (SELECT IFNULL(SUM(WRITTEN_CNT),0) FROM top_rpt_collabo WHERE SUIM_RPT_NO = A.SUIM_RPT_NO) ) ,3) ) 
		                AS CALC_WORKLOAD
                         
		                 ,A.CLOSE_DATE                  
                    FROM  top_rpt_head A
                    
                    LEFT OUTER JOIN 
                         (
                           SELECT  SUIM_RPT_NO 
                                  ,SUM(COLLABO_PP) AS COLLABO_PP
                                  ,SUM(COLLABO_DAILY) AS COLLABO_DAILY_RATIO
                                  ,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
                                  ,COUNT(*) AS COLLABO_CNT                                  
                                  ,SUM(WRITTEN_BASIC) AS WRITTEN_BASIC
                                  ,SUM(WRITTEN_CNT) AS WRITTEN_CNT 
                             FROM  top_rpt_collabo
                            WHERE  COLLABO_DAILY_TYPE = 0 
                            GROUP BY SUIM_RPT_NO  
                         ) B
                      ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
                   INNER JOIN top_rpt_invoice C
                      ON A.SUIM_RPT_NO = C.SUIM_RPT_NO
                      
                    LEFT OUTER JOIN
						 (
                           SELECT  SUIM_RPT_NO
                           		  ,SUM(COLLABO_PP) AS COLLABO_PP
                           		  ,SUM(COLLABO_DAILY) AS COLLABO_DAILY_MONEY
                           		  ,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
                             FROM  top_rpt_collabo
                            WHERE  COLLABO_DAILY_TYPE = 1 
                            GROUP BY SUIM_RPT_NO  
                         ) D
                      ON D.SUIM_RPT_NO = C.SUIM_RPT_NO
                   
                   LEFT OUTER JOIN 
                         (
                           SELECT  SUIM_RPT_NO 
                                  ,SUM(COLLABO_PP) AS COLLABO_PP
                             FROM  top_rpt_collabo
                            WHERE  COLLABO_PRICE_TYPE = 0 
                            GROUP BY SUIM_RPT_NO  
                         ) E
                      ON A.SUIM_RPT_NO = E.SUIM_RPT_NO                   
                   
                   LEFT OUTER JOIN 
                         (
                           SELECT  SUIM_RPT_NO 
                                  ,SUM(COLLABO_PRICE) AS COLLABO_PRICE_MONEY
                             FROM  top_rpt_collabo
                            WHERE  COLLABO_PRICE_TYPE = 1 
                            GROUP BY SUIM_RPT_NO  
                         ) F
                      ON A.SUIM_RPT_NO = F.SUIM_RPT_NO        
                      
                   WHERE  1=1
					 AND  A.USER_NO = (SELECT USER_NO FROM top_mbr_bsc WHERE USER_NO = #{user_no} AND TEAM_ID_MAIN = #{team_id})
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})  
                     
                  -- 공동수행 수령
                  UNION ALL
                  SELECT  '4' AS GUBUN
                         ,A.SUIM_RPT_NO
                         ,A.SUIM_ACCEPT_NO 
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC 
                         ,0 AS AMT_COUNSEL 
                         ,0 AS AMT_ETC 
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         <!-- ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_PRICE_TYPE = 0 THEN (C.AMT_BASIC * B.COLLABO_PP * 0.01) + IFNULL(B.WRITTEN_BASIC,0)
                         	WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_PRICE_TYPE = 1 THEN B.COLLABO_PRICE
                         	ELSE B.COLLABO_PP                         	
                         END SHARE_PLUS_AMT_BASIC -->
                         
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_PRICE_TYPE = 0 THEN ((C.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) * B.COLLABO_PP * 0.01) + IFNULL(B.WRITTEN_BASIC,0)
                         	WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_PRICE_TYPE = 1 THEN B.COLLABO_PRICE
                         	ELSE B.COLLABO_PP                         	
                         END SHARE_PLUS_AMT_BASIC
                          
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_DAILY_TYPE = 0 THEN (C.AMT_DAILY * B.COLLABO_DAILY * 0.01)
                         	   WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_DAILY_TYPE = 1 THEN B.COLLABO_DAILY 
                          	   ELSE 0
                          END AS SHARE_PLUS_AMT_DAILY
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN B.COLLABO_TRAFFIC
							   ELSE 0
                          END AS SHARE_PLUS_TRAFFIC
                         ,0 AS SHARE_PLUS_COUNSEL
                         ,0 AS SHARE_PLUS_ETC
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) + IFNULL(B.WRITTEN_CNT,0)
                          	   ELSE 0
                          END AS SHARE_PLUS_EA
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) + IFNULL(B.WRITTEN_CNT,0)
                          	   ELSE 0
                          END AS SHARE_PLUS_WORKLOAD_EA
                          
                         ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * A.WORKLOAD_EA * B.COLLABO_PP * 0.01, 3) )  
                         + (SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * IFNULL(B.WRITTEN_CNT,0), 3) )
                         AS CALC_WORKLOAD                         
                                                 
                         ,A.CLOSE_DATE
                    FROM  top_rpt_head A
                         ,top_rpt_collabo B
                         ,top_rpt_invoice C 
                   WHERE  1=1
                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                     AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                     AND  B.USER_ID = (SELECT USER_NO FROM top_mbr_bsc WHERE USER_NO = #{user_no} AND TEAM_ID_MAIN = #{team_id})
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                  </if>
                  <if test='primYN == "Y"'>
                  
                  UNION ALL 
                  -- 농작물 공동수행 반영 전
                  SELECT '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,B.AMT_BASIC 
                         ,B.AMT_DAILY
                         ,B.AMT_TRAFFIC
                         ,B.AMT_COUNSEL
                         ,B.AMT_ETC                         
                         ,B.AMT_TOTAL
                         ,A.SUIM_RPT_EA 
                         ,A.WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  A.USER_NO = #{user_no}
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                 
                 UNION ALL
                 
                  -- 농작물 공동수행 지급
                  SELECT '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_MINUS_EA
                         ,SUM(B.SHARE_WORKLOAD_EA) AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         <!-- ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.suim_rpt_type1) * B.share_workload_ea,3) ) AS CALC_WORKLOAD -->
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO != A.USER_NO
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO    
                 
                 UNION ALL                 
                 
                  -- 농작물 공동수행 수령
                  SELECT '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_EA
                         ,SUM(B.SHARE_WORKLOAD_EA) AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.suim_rpt_type1) * B.share_workload_ea,3) ) AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO = A.USER_NO
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO
                    
                   UNION ALL
                 SELECT  '5' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
                         
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA                        
                         
                         ,B.SHARE_AMT_BASIC AS SHARE_PLUS_AMT_BASIC
                         ,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_DAILY
                         ,B.SHARE_AMT_TRAFFIC AS SHARE_PLUS_AMT_TRAFFIC
                         ,B.SHARE_AMT_COUNSEL AS SHARE_PLUS_AMT_COUNSEL
                         ,B.SHARE_AMT_ETC AS SHARE_PLUS_AMT_ETC
                         ,B.SHARE_EA AS SHARE_PLUS_EA
                         ,B.SHARE_WORKLOAD_EA AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.suim_rpt_type1) * B.share_workload_ea,3) ) AS CALC_WORKLOAD
                                                  
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
                         ,top_prim_biz_inv_share B  
                   WHERE  1=1
                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
                     AND  A.USER_NO != B.SHARE_USER_NO  
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  B.SHARE_USER_NO = (SELECT USER_NO FROM top_mbr_bsc WHERE USER_NO = #{user_no} AND TEAM_ID_MAIN = #{team_id})
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                  </if>
                  <if test='contractYN == "Y"'>
                  UNION ALL 
                  -- 적부 공동수행 반영 전
                  SELECT '3' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,B.AMT_BASIC 
                         ,B.AMT_DAILY
                         ,B.AMT_TRAFFIC
                         ,B.AMT_COUNSEL
                         ,B.AMT_ETC                         
                         ,B.AMT_TOTAL
                         ,A.SUIM_RPT_EA 
                         ,A.WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 IN (6, 7, 8, 9, 10, 99)
                     AND  A.USER_NO = #{user_no}
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                 UNION ALL
                  -- 적부 공동수행 지급
                  SELECT '3' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_MINUS_EA
                         ,SUM(B.SHARE_WORKLOAD_EA) AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO != A.USER_NO
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO                   
				   UNION ALL
                  -- 적부 공동수행 수령
                  SELECT '3' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_EA
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO = A.USER_NO
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO                           
                  UNION ALL
                 SELECT  '6' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
                         
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,B.SHARE_AMT_BASIC AS SHARE_PLUS_AMT_BASIC
                         ,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_DAILY
                         ,B.SHARE_AMT_TRAFFIC AS SHARE_PLUS_AMT_TRAFFIC
                         ,B.SHARE_AMT_COUNSEL AS SHARE_PLUS_AMT_COUNSEL
                         ,B.SHARE_AMT_ETC AS SHARE_PLUS_AMT_ETC
                         ,B.SHARE_EA AS SHARE_PLUS_EA
                         ,B.SHARE_EA AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
                         ,top_prim_biz_inv_share B  
                   WHERE  1=1
                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
                     AND  A.USER_NO != B.SHARE_USER_NO  
                     AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                     AND  B.SHARE_USER_NO = (SELECT USER_NO FROM top_mbr_bsc WHERE USER_NO = #{user_no} AND TEAM_ID_MAIN = #{team_id})
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                 </if>                                    
                ) GA
         WHERE  1=1
           AND  GA.GUBUN > 0
        GROUP BY GA.GUBUN, GA.SUIM_RPT_NO, GA.SUIM_ACCEPT_NO 
        ORDER BY GA.GUBUN ASC, GA.CLOSE_DATE DESC, GA.SUIM_RPT_NO DESC  
    </select>	
	
	<select id="selectDetailPersonStandardList_20210924" parameterType="hashmap" resultType="AsraMap">
        SELECT  GA.GUBUN
               ,GA.SUIM_RPT_NO
               ,GA.SUIM_ACCEPT_NO
               ,IFNULL(SUM(GA.AMT_BASIC),0) AS AMT_BASIC
               ,IFNULL(SUM(GA.AMT_DAILY),0) AS AMT_DAILY
               ,IFNULL(SUM(GA.AMT_TRAFFIC),0) AS AMT_TRAFFIC
               ,IFNULL(SUM(GA.AMT_COUNSEL),0) AS AMT_COUNSEL
               ,IFNULL(SUM(GA.AMT_ETC),0) AS AMT_ETC
               ,IFNULL(SUM(GA.AMT_TOTAL),0) AS AMT_TOTAL
               ,IFNULL(SUM(GA.SUIM_RPT_EA),0) AS SUIM_RPT_EA
               ,IFNULL(SUM(GA.WORKLOAD_EA),0) AS WORKLOAD_EA               
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_BASIC),0) AS SHARE_MINUS_AMT_BASIC
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_DAILY),0) AS SHARE_MINUS_AMT_DAILY
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_TRAFFIC),0) AS SHARE_MINUS_AMT_TRAFFIC
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_COUNSEL),0) AS SHARE_MINUS_AMT_COUNSEL
               ,IFNULL(SUM(GA.SHARE_MINUS_AMT_ETC),0) AS SHARE_MINUS_AMT_ETC
               ,IFNULL(SUM(GA.SHARE_MINUS_EA),0) AS SHARE_MINUS_EA
               ,IFNULL(SUM(GA.SHARE_MINUS_WORKLOAD_EA),0) AS SHARE_MINUS_WORKLOAD_EA                 
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_BASIC),0) AS SHARE_PLUS_AMT_BASIC
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_DAILY),0) AS SHARE_PLUS_AMT_DAILY
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_TRAFFIC),0) AS SHARE_PLUS_AMT_TRAFFIC
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_COUNSEL),0) AS SHARE_PLUS_AMT_COUNSEL
               ,IFNULL(SUM(GA.SHARE_PLUS_AMT_ETC),0) AS SHARE_PLUS_AMT_ETC
               ,IFNULL(SUM(GA.SHARE_PLUS_EA),0) AS SHARE_PLUS_EA
               ,IFNULL(SUM(GA.SHARE_PLUS_WORKLOAD_EA),0) AS SHARE_PLUS_WORKLOAD_EA
               ,IFNULL(SUM(GA.CALC_WORKLOAD),0) AS CALC_WORKLOAD                           
               ,MAX(GA.CLOSE_DATE) AS CLOSE_DATE               
          FROM  (
                  SELECT  '-1' AS GUBUN
                         ,'' AS SUIM_RPT_NO 
                         ,'' AS SUIM_ACCEPT_NO
                         
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC 
                         ,0 AS AMT_COUNSEL 
                         ,0 AS AMT_ETC 
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         ,0 AS CALC_WORKLOAD                         
                         
                         ,0 AS CLOSE_DATE 
                    FROM  DUAL
                  <if test='basicYN == "Y"'>
                  
                  -- 공동수행 반영 전  
                  UNION ALL    
                  SELECT  '1' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO
                         ,B.AMT_BASIC 
                         ,B.AMT_DAILY 
                         ,B.AMT_TRAFFIC 
                         ,B.AMT_COUNSEL 
                         ,B.AMT_ETC 
                         ,B.AMT_TOTAL
                         ,A.SUIM_RPT_EA
                         ,A.WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA                         
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE 
                    FROM  top_rpt_head A
                         ,top_rpt_invoice B
                   WHERE  1=1
                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                                          
                     AND A.SUIM_RPT_STATE = 2 
                     AND  A.USER_NO = (SELECT USER_NO FROM top_mbr_bsc WHERE USER_NO = #{user_no} AND TEAM_ID_MAIN = #{team_id})
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                  
                  -- 공동수행 지급
                  UNION ALL   
		          SELECT  '1' AS GUBUN
		                 ,A.SUIM_RPT_NO
		                 ,A.SUIM_ACCEPT_NO 
		                 ,0 AS AMT_BASIC 
		                 ,0 AS AMT_DAILY 
		                 ,0 AS AMT_TRAFFIC 
		                 ,0 AS AMT_COUNSEL 
		                 ,0 AS AMT_ETC 
		                 ,0 AS AMT_TOTAL
		                 ,0 AS SUIM_RPT_EA
		                 ,0 AS WORKLOAD_EA
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_BASIC * IFNULL(B.COLLABO_PP,0) * 0.01) + (C.AMT_BASIC * IFNULL(D.COLLABO_PP,0) * 0.01) + IFNULL(B.WRITTEN_BASIC,0)
                          	   ELSE B.COLLABO_PP 
                          END AS SHARE_MINUS_AMT_BASIC
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_DAILY * IFNULL(B.COLLABO_DAILY_RATIO,0) * 0.01) + IFNULL(D.COLLABO_DAILY_MONEY,0)
                          	   ELSE 0
                          END AS SHARE_MINUS_AMT_DAILY
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_TRAFFIC,0) + IFNULL(D.COLLABO_TRAFFIC,0))
                          	   ELSE 0
                          END AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_PP,0) * 0.01 * A.SUIM_RPT_EA) + (IFNULL(D.COLLABO_PP,0) * 0.01 * A.SUIM_RPT_EA) + IFNULL(B.WRITTEN_CNT,0)
	                           ELSE 0
                          END AS SHARE_MINUS_EA
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (IFNULL(B.COLLABO_PP,0) * 0.01 * A.WORKLOAD_EA) + (IFNULL(D.COLLABO_PP,0) * 0.01 * A.WORKLOAD_EA) + IFNULL(B.WRITTEN_CNT,0)
	                           ELSE 0
                          END AS SHARE_MINUS_WORKLOAD_EA                          
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * ( (A.WORKLOAD_EA * (100 - (SELECT IFNULL(SUM(COLLABO_PP),0) FROM top_rpt_collabo WHERE SUIM_RPT_NO = A.SUIM_RPT_NO)) * 0.01) - (SELECT IFNULL(SUM(WRITTEN_CNT),0) FROM top_rpt_collabo WHERE SUIM_RPT_NO = A.SUIM_RPT_NO) ) ,3) ) 
		                AS CALC_WORKLOAD
                         
		                 ,A.CLOSE_DATE                  
                    FROM  top_rpt_head A
                    LEFT OUTER JOIN 
                         (
                           SELECT  SUIM_RPT_NO 
                                  ,SUM(COLLABO_PP) AS COLLABO_PP
                                  ,SUM(COLLABO_DAILY) AS COLLABO_DAILY_RATIO
                                  ,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
                                  ,COUNT(*) AS COLLABO_CNT                                  
                                  ,SUM(WRITTEN_BASIC) AS WRITTEN_BASIC
                                  ,SUM(WRITTEN_CNT) AS WRITTEN_CNT 
                             FROM  top_rpt_collabo
                            WHERE  COLLABO_DAILY_TYPE = 0 
                            GROUP BY SUIM_RPT_NO  
                         ) B
                      ON A.SUIM_RPT_NO = B.SUIM_RPT_NO
                   INNER JOIN top_rpt_invoice C
                      ON A.SUIM_RPT_NO = C.SUIM_RPT_NO
                    LEFT OUTER JOIN
						 (
                           SELECT  SUIM_RPT_NO
                           		  ,SUM(COLLABO_PP) AS COLLABO_PP
                           		  ,SUM(COLLABO_DAILY) AS COLLABO_DAILY_MONEY
                           		  ,SUM(COLLABO_TRAFFIC) AS COLLABO_TRAFFIC
                             FROM  top_rpt_collabo
                            WHERE  COLLABO_DAILY_TYPE = 1 
                            GROUP BY SUIM_RPT_NO  
                         ) D
                      ON D.SUIM_RPT_NO = C.SUIM_RPT_NO
                   WHERE  1=1
					 AND  A.USER_NO = (SELECT USER_NO FROM top_mbr_bsc WHERE USER_NO = #{user_no} AND TEAM_ID_MAIN = #{team_id})
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})  
                     
                  -- 공동수행 수령
                  UNION ALL
                  SELECT  '4' AS GUBUN
                         ,A.SUIM_RPT_NO
                         ,A.SUIM_ACCEPT_NO 
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC 
                         ,0 AS AMT_COUNSEL 
                         ,0 AS AMT_ETC 
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_BASIC * B.COLLABO_PP * 0.01) + IFNULL(B.WRITTEN_BASIC,0)
                          	   ELSE B.COLLABO_PP
                          END AS SHARE_PLUS_AMT_BASIC
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_DAILY_TYPE = 0 THEN (C.AMT_DAILY * B.COLLABO_DAILY * 0.01)
                         	   WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) AND B.COLLABO_DAILY_TYPE = 1 THEN B.COLLABO_DAILY 
                          	   ELSE 0
                          END AS SHARE_PLUS_AMT_DAILY
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN B.COLLABO_TRAFFIC
							   ELSE 0
                          END AS SHARE_PLUS_TRAFFIC
                         ,0 AS SHARE_PLUS_COUNSEL
                         ,0 AS SHARE_PLUS_ETC
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA) + IFNULL(B.WRITTEN_CNT,0)
                          	   ELSE 0
                          END AS SHARE_PLUS_EA
                         ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (B.COLLABO_PP * 0.01 * A.WORKLOAD_EA) + IFNULL(B.WRITTEN_CNT,0)
                          	   ELSE 0
                          END AS SHARE_PLUS_WORKLOAD_EA
                          
                         ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * A.WORKLOAD_EA * B.COLLABO_PP * 0.01, 3) )  
                         + (SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.SUIM_RPT_TYPE1) * IFNULL(B.WRITTEN_CNT,0), 3) )
                         AS CALC_WORKLOAD                         
                                                 
                         ,A.CLOSE_DATE
                    FROM  top_rpt_head A
                         ,top_rpt_collabo B
                         ,top_rpt_invoice C 
                   WHERE  1=1
                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
                     AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
                     AND  B.USER_ID = (SELECT USER_NO FROM top_mbr_bsc WHERE USER_NO = #{user_no} AND TEAM_ID_MAIN = #{team_id})
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                  </if>
                  <if test='primYN == "Y"'>
                  
                  UNION ALL 
                  -- 농작물 공동수행 반영 전
                  SELECT '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,B.AMT_BASIC 
                         ,B.AMT_DAILY
                         ,B.AMT_TRAFFIC
                         ,B.AMT_COUNSEL
                         ,B.AMT_ETC                         
                         ,B.AMT_TOTAL
                         ,A.SUIM_RPT_EA 
                         ,A.WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  A.USER_NO = #{user_no}
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                 
                 UNION ALL
                 
                  -- 농작물 공동수행 지급
                  SELECT '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_MINUS_EA
                         ,SUM(B.SHARE_WORKLOAD_EA) AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         <!-- ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.suim_rpt_type1) * B.share_workload_ea,3) ) AS CALC_WORKLOAD -->
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO != A.USER_NO
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO    
                 
                 UNION ALL                 
                 
                  -- 농작물 공동수행 수령
                  SELECT '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_EA
                         ,SUM(B.SHARE_WORKLOAD_EA) AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.suim_rpt_type1) * B.share_workload_ea,3) ) AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO = A.USER_NO
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO
                    
                   UNION ALL
                 SELECT  '5' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
                         
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA                        
                         
                         ,B.SHARE_AMT_BASIC AS SHARE_PLUS_AMT_BASIC
                         ,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_DAILY
                         ,B.SHARE_AMT_TRAFFIC AS SHARE_PLUS_AMT_TRAFFIC
                         ,B.SHARE_AMT_COUNSEL AS SHARE_PLUS_AMT_COUNSEL
                         ,B.SHARE_AMT_ETC AS SHARE_PLUS_AMT_ETC
                         ,B.SHARE_EA AS SHARE_PLUS_EA
                         ,B.SHARE_WORKLOAD_EA AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,(SELECT ROUND(#{yearEa} / getCodeValue("top_rpt_head", CONCAT("workload_type1_",#{year}), A.suim_rpt_type1) * B.share_workload_ea,3) ) AS CALC_WORKLOAD
                                                  
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
                         ,top_prim_biz_inv_share B  
                   WHERE  1=1
                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
                     AND  A.USER_NO != B.SHARE_USER_NO  
                     AND  A.SUIM_RPT_TYPE1 = 5
                     AND  B.SHARE_USER_NO = (SELECT USER_NO FROM top_mbr_bsc WHERE USER_NO = #{user_no} AND TEAM_ID_MAIN = #{team_id})
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                  </if>
                  <if test='contractYN == "Y"'>
                  UNION ALL 
                  -- 적부 공동수행 반영 전
                  SELECT '3' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,B.AMT_BASIC 
                         ,B.AMT_DAILY
                         ,B.AMT_TRAFFIC
                         ,B.AMT_COUNSEL
                         ,B.AMT_ETC                         
                         ,B.AMT_TOTAL
                         ,A.SUIM_RPT_EA 
                         ,A.WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 IN (6, 7, 8, 9, 10, 99)
                     AND  A.USER_NO = #{user_no}
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                 UNION ALL
                  -- 적부 공동수행 지급
                  SELECT '3' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_MINUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_MINUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_MINUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_MINUS_EA
                         ,SUM(B.SHARE_WORKLOAD_EA) AS SHARE_MINUS_WORKLOAD_EA
                         
                         ,0 AS SHARE_PLUS_AMT_BASIC
                         ,0 AS SHARE_PLUS_AMT_DAILY
                         ,0 AS SHARE_PLUS_AMT_TRAFFIC
                         ,0 AS SHARE_PLUS_AMT_COUNSEL
                         ,0 AS SHARE_PLUS_AMT_ETC
                         ,0 AS SHARE_PLUS_EA
                         ,0 AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO != A.USER_NO
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO                   
				   UNION ALL
                  -- 적부 공동수행 수령
                  SELECT '3' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
					     
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC                         
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA 
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,SUM(B.SHARE_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
                         ,SUM(B.SHARE_AMT_TRAFFIC) AS SHARE_PLUS_AMT_TRAFFIC
                         ,SUM(B.SHARE_AMT_COUNSEL) AS SHARE_PLUS_AMT_COUNSEL
                         ,SUM(B.SHARE_AMT_ETC) AS SHARE_PLUS_AMT_ETC
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_EA
                         ,SUM(B.SHARE_EA) AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,0 AS CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
              INNER JOIN  top_prim_biz_inv_share B 
                      ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                   WHERE  1=1     
                     AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                     AND  A.USER_NO = #{user_no}
                     AND  B.SHARE_USER_NO = A.USER_NO
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                   GROUP BY SUIM_RPT_NO                           
                  UNION ALL
                 SELECT  '6' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
                         
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS AMT_TRAFFIC
                         ,0 AS AMT_COUNSEL
                         ,0 AS AMT_ETC
                         ,0 AS AMT_TOTAL
                         ,0 AS SUIM_RPT_EA
                         ,0 AS WORKLOAD_EA
                         
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_AMT_TRAFFIC
                         ,0 AS SHARE_MINUS_AMT_COUNSEL
                         ,0 AS SHARE_MINUS_AMT_ETC
                         ,0 AS SHARE_MINUS_EA
                         ,0 AS SHARE_MINUS_WORKLOAD_EA 
                         
                         ,B.SHARE_AMT_BASIC AS SHARE_PLUS_AMT_BASIC
                         ,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_DAILY
                         ,B.SHARE_AMT_TRAFFIC AS SHARE_PLUS_AMT_TRAFFIC
                         ,B.SHARE_AMT_COUNSEL AS SHARE_PLUS_AMT_COUNSEL
                         ,B.SHARE_AMT_ETC AS SHARE_PLUS_AMT_ETC
                         ,B.SHARE_EA AS SHARE_PLUS_EA
                         ,B.SHARE_EA AS SHARE_PLUS_WORKLOAD_EA
                         
                         ,0 AS CALC_WORKLOAD
                         
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
                         ,top_prim_biz_inv_share B  
                   WHERE  1=1
                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
                     AND  A.USER_NO != B.SHARE_USER_NO  
                     AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                     AND  B.SHARE_USER_NO = (SELECT USER_NO FROM top_mbr_bsc WHERE USER_NO = #{user_no} AND TEAM_ID_MAIN = #{team_id})
                     AND  A.SUIM_RPT_STATE = 2
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                 </if>                                    
                ) GA
         WHERE  1=1
           AND  GA.GUBUN > 0
        GROUP BY GA.GUBUN, GA.SUIM_RPT_NO, GA.SUIM_ACCEPT_NO 
        ORDER BY GA.GUBUN ASC, GA.CLOSE_DATE DESC, GA.SUIM_RPT_NO DESC  
    </select>	
	
	
    <select id="selectDetailBasicList" parameterType="hashmap" resultType="AsraMap">
		SELECT  GA.GUBUN
		       ,GA.SUIM_RPT_NO
		       ,GA.SUIM_ACCEPT_NO
		       ,SUM(GA.AMT_BASIC) AS AMT_BASIC
		       ,SUM(GA.AMT_DAILY) AS AMT_DAILY
		       ,SUM(GA.SUIM_RPT_EA) AS SUIM_RPT_EA
		       ,SUM(GA.SHARE_MINUS_AMT_BASIC) AS SHARE_MINUS_AMT_BASIC
		       ,SUM(GA.SHARE_MINUS_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
		       ,SUM(GA.SHARE_MINUS_EA) AS SHARE_MINUS_EA
		       ,SUM(GA.SHARE_PLUS_AMT_BASIC) AS SHARE_PLUS_AMT_BASIC
		       ,SUM(GA.SHARE_PLUS_AMT_DAILY) AS SHARE_PLUS_AMT_DAILY
		       ,SUM(GA.SHARE_PLUS_EA) AS SHARE_PLUS_EA
		       ,SUM(GA.AMT_TRAFFIC) AS AMT_TRAFFIC
		       ,SUM(GA.AMT_COUNSEL) AS AMT_COUNSEL
		       ,SUM(GA.AMT_ETC) AS AMT_ETC
		       ,SUM(GA.AMT_TOTAL) AS AMT_TOTAL
		       ,MAX(GA.CLOSE_DATE) AS CLOSE_DATE
		  FROM  (
		          SELECT  '1' AS GUBUN
		                 ,A.SUIM_RPT_NO 
		                 ,A.SUIM_ACCEPT_NO
		                 ,B.AMT_BASIC 
		                 ,B.AMT_DAILY 
		                 ,A.SUIM_RPT_EA
		                 ,0 AS SHARE_MINUS_AMT_BASIC
		                 ,0 AS SHARE_MINUS_AMT_DAILY
		                 ,0 AS SHARE_MINUS_EA
		                 ,0 AS SHARE_PLUS_AMT_BASIC
		                 ,0 AS SHARE_PLUS_AMT_DAILY
		                 ,0 AS SHARE_PLUS_EA
		                 ,B.AMT_TRAFFIC 
		                 ,B.AMT_COUNSEL 
		                 ,B.AMT_ETC 
		                 ,B.AMT_TOTAL
		                 ,A.CLOSE_DATE 
		            FROM  top_rpt_head A
		                 ,top_rpt_invoice B
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		             -- AND  A.SUIM_RPT_STATE IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19)
		             AND  A.TEAM_ID = #{team_id}
		             AND  A.USER_NO = #{user_no} 
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		          UNION ALL   
		          SELECT  '1' AS GUBUN
		                 ,A.SUIM_RPT_NO
		                 ,A.SUIM_ACCEPT_NO 
		                 ,0 AS AMT_BASIC 
		                 ,0 AS AMT_DAILY 
		                 ,0 AS SUIM_RPT_EA
		                 ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_BASIC * B.COLLABO_PP * 0.01)
		                  ELSE B.COLLABO_PP 
		                  END AS SHARE_MINUS_AMT_BASIC
		                 ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_DAILY * B.COLLABO_PP * 0.01)
		                  ELSE 0
		                  END AS SHARE_MINUS_AMT_DAILY
		                 ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA)
		                  ELSE 0
		                  END AS SHARE_MINUS_EA 
		                 ,0 AS SHARE_PLUS_AMT_BASIC
		                 ,0 AS SHARE_PLUS_AMT_DAILY
		                 ,0 AS SHARE_PLUS_EA
		                 ,0 AS AMT_TRAFFIC 
		                 ,0 AS AMT_COUNSEL 
		                 ,0 AS AMT_ETC 
		                 ,0 AS AMT_TOTAL
		                 ,A.CLOSE_DATE              
		            FROM  top_rpt_head A
		                 ,(
		                   SELECT  SUIM_RPT_NO 
		                          ,SUM(COLLABO_PP) AS COLLABO_PP
		                          ,COUNT(*) AS COLLABO_CNT 
		                     FROM  top_rpt_collabo
		                   GROUP BY SUIM_RPT_NO  
		                   ) B
		                 ,top_rpt_invoice C
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		             AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
		             AND  A.TEAM_ID = #{team_id}
		             AND  A.USER_NO = #{user_no}
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})  
		          UNION ALL
		          SELECT  '2' AS GUBUN
		                 ,A.SUIM_RPT_NO
		                 ,A.SUIM_ACCEPT_NO 
		                 ,0 AS AMT_BASIC 
		                 ,0 AS AMT_DAILY 
		                 ,0 AS SUIM_RPT_EA
		                 ,0 AS SHARE_MINUS_AMT_BASIC
		                 ,0 AS SHARE_MINUS_AMT_DAILY
		                 ,0 AS SHARE_MINUS_EA 
		                 ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_BASIC * B.COLLABO_PP * 0.01)
		                  ELSE B.COLLABO_PP
		                  END AS SHARE_PLUS_AMT_BASIC
		                 ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_DAILY * B.COLLABO_PP * 0.01)
		                  ELSE 0
		                  END AS SHARE_PLUS_AMT_DAILY
		                 ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (B.COLLABO_PP * 0.01 * A.SUIM_RPT_EA)
		                  ELSE 0
		                  END AS SHARE_PLUS_EA
		                 ,0 AS AMT_TRAFFIC 
		                 ,0 AS AMT_COUNSEL 
		                 ,0 AS AMT_ETC 
		                 ,CASE WHEN A.SUIM_RPT_TYPE1 IN(1, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19) THEN (C.AMT_BASIC * B.COLLABO_PP * 0.01) + (C.AMT_DAILY * B.COLLABO_PP * 0.01)
		                  ELSE B.COLLABO_PP 
		                  END AS AMT_TOTAL
		                 ,A.CLOSE_DATE
		            FROM  top_rpt_head A
		                 ,top_rpt_collabo B
		                 ,top_rpt_invoice C 
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		             AND  B.SUIM_RPT_NO = C.SUIM_RPT_NO
		             AND  B.USER_ID = #{user_no}
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})   
		        ) GA
		 WHERE  1=1
		 GROUP BY GA.GUBUN, GA.SUIM_RPT_NO, GA.SUIM_ACCEPT_NO 
		 ORDER BY GA.GUBUN ASC, GA.CLOSE_DATE DESC, GA.SUIM_RPT_NO DESC     
    </select>    
    <select id="selectDetailPrimList" parameterType="hashmap" resultType="AsraMap">
		SELECT  GA.GUBUN
		       ,GA.SUIM_RPT_NO
		       ,GA.SUIM_ACCEPT_NO
		       ,GA.AMT_BASIC
		       ,GA.AMT_DAILY
		       ,GA.SUIM_RPT_EA
		       ,GA.SHARE_MINUS_AMT_BASIC
		       ,GA.SHARE_MINUS_AMT_DAILY
		       ,GA.SHARE_MINUS_EA
		       ,GA.SHARE_PLUS_AMT_BASIC
		       ,GA.SHARE_PLUS_AMT_DAILY
		       ,GA.SHARE_PLUS_EA
		       ,GA.AMT_TRAFFIC
		       ,GA.AMT_COUNSEL
		       ,GA.AMT_ETC
		       ,GA.AMT_TOTAL
		       ,GA.CLOSE_DATE
		  FROM  (
		        SELECT  '1' AS GUBUN
		               ,A.SUIM_RPT_NO 
		               ,A.SUIM_ACCEPT_NO 
		               ,B.AMT_BASIC 
		               ,B.AMT_DAILY 
		               ,C.SHARE_EA AS SUIM_RPT_EA
		               ,D.SHARE_MINUS_AMT_BASIC
		               ,D.SHARE_MINUS_AMT_DAILY
		               ,D.SHARE_MINUS_EA
		               ,0 AS SHARE_PLUS_AMT_BASIC
		               ,0 AS SHARE_PLUS_AMT_DAILY
		               ,0 AS SHARE_PLUS_EA
		               ,C.SHARE_AMT_TRAFFIC AS AMT_TRAFFIC
		               ,C.SHARE_AMT_COUNSEL AS AMT_COUNSEL
		               ,C.SHARE_AMT_ETC AS AMT_ETC
		               ,0 AS AMT_TOTAL
		               ,A.CLOSE_DATE       
		          FROM  top_prim_biz_rpt_head A
		    INNER JOIN  top_prim_biz_inv B 
		            ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		    INNER JOIN  top_prim_biz_inv_share C
		            ON  A.SUIM_RPT_NO = C.SUIM_RPT_NO
		           AND  A.USER_NO = C.SHARE_USER_NO 
		     LEFT JOIN  (
		                  SELECT  A.SUIM_RPT_NO 
		                         ,SUM(B.SHARE_AMT_BASIC)  AS SHARE_MINUS_AMT_BASIC
		                         ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
		                         ,SUM(B.SHARE_EA)  AS SHARE_MINUS_EA      
		                    FROM  top_prim_biz_rpt_head A
		                         ,top_prim_biz_inv_share B
		                   WHERE  1=1
		                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
		                     AND  A.USER_NO != B.SHARE_USER_NO
		                     AND  A.SUIM_RPT_TYPE1 = 5
		                     AND  A.TEAM_ID = #{team_id}
		                     AND  A.USER_NO = #{user_no}
		                  GROUP BY A.SUIM_RPT_NO                    
		                 ) D
		            ON  A.SUIM_RPT_NO = D.SUIM_RPT_NO       
		         WHERE  1=1     
		           AND  A.SUIM_RPT_TYPE1 = 5
		           AND  A.TEAM_ID = #{team_id}
		           AND  A.USER_NO = #{user_no}
		           AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		           AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
		         UNION ALL
		         SELECT  '2' AS GUBUN
		                 ,A.SUIM_RPT_NO 
		                 ,A.SUIM_ACCEPT_NO 
		                 ,0 AS AMT_BASIC 
		                 ,0 AS AMT_DAILY 
		                 ,0 AS SUIM_RPT_EA
		                 ,0 AS SHARE_MINUS_AMT_BASIC
		                 ,0 AS SHARE_MINUS_AMT_DAILY
		                 ,0 AS SHARE_MINUS_EA
		                 ,B.SHARE_AMT_BASIC AS SHARE_PLUS_AMT_BASIC
		                 ,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_DAILY
		                 ,B.SHARE_EA AS SHARE_PLUS_EA
		                 ,B.SHARE_AMT_TRAFFIC AS AMT_TRAFFIC
		                 ,B.SHARE_AMT_COUNSEL AS AMT_COUNSEL
		                 ,B.SHARE_AMT_ETC AS AMT_ETC
		                 ,B.SHARE_AMT_TOTAL AS AMT_TOTAL
		                 ,A.CLOSE_DATE       
		            FROM  top_prim_biz_rpt_head A
		                 ,top_prim_biz_inv_share B  
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
		             AND  A.USER_NO != B.SHARE_USER_NO  
		             AND  A.SUIM_RPT_TYPE1 = 5
		             AND  B.SHARE_USER_NO = #{user_no}
		             AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
		             AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})    
		        ) GA
		 WHERE  1=1
		ORDER BY GA.GUBUN ASC, GA.CLOSE_DATE DESC, GA.SUIM_RPT_NO DESC        
    </select>    
    <select id="selectDetailContractList" parameterType="hashmap" resultType="AsraMap">
        SELECT  GA.GUBUN
               ,GA.SUIM_RPT_NO
               ,GA.SUIM_ACCEPT_NO
               ,GA.AMT_BASIC
               ,GA.AMT_DAILY
               ,GA.SUIM_RPT_EA
               ,GA.SHARE_MINUS_AMT_BASIC
               ,GA.SHARE_MINUS_AMT_DAILY
               ,GA.SHARE_MINUS_EA
               ,GA.SHARE_PLUS_AMT_BASIC
               ,GA.SHARE_PLUS_AMT_DAILY
               ,GA.SHARE_PLUS_EA
               ,GA.AMT_TRAFFIC
               ,GA.AMT_COUNSEL
               ,GA.AMT_ETC
               ,GA.AMT_TOTAL
               ,GA.CLOSE_DATE
          FROM  (
                SELECT  '1' AS GUBUN
                       ,A.SUIM_RPT_NO 
                       ,A.SUIM_ACCEPT_NO 
                       ,B.AMT_BASIC 
                       ,B.AMT_DAILY 
                       ,C.SHARE_EA AS SUIM_RPT_EA
                       ,D.SHARE_MINUS_AMT_BASIC
                       ,D.SHARE_MINUS_AMT_DAILY
                       ,D.SHARE_MINUS_EA
                       ,0 AS SHARE_PLUS_AMT_BASIC
                       ,0 AS SHARE_PLUS_AMT_DAILY
                       ,0 AS SHARE_PLUS_EA
                       ,C.SHARE_AMT_TRAFFIC AS AMT_TRAFFIC
                       ,C.SHARE_AMT_COUNSEL AS AMT_COUNSEL
                       ,C.SHARE_AMT_ETC AS AMT_ETC
                       ,0 AS AMT_TOTAL
                       ,A.CLOSE_DATE       
                  FROM  top_prim_biz_rpt_head A
            INNER JOIN  top_prim_biz_inv B 
                    ON  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
            INNER JOIN  top_prim_biz_inv_share C
                    ON  A.SUIM_RPT_NO = C.SUIM_RPT_NO
                   AND  A.USER_NO = C.SHARE_USER_NO 
             LEFT JOIN  (
                          SELECT  A.SUIM_RPT_NO 
                                 ,SUM(B.SHARE_AMT_BASIC)  AS SHARE_MINUS_AMT_BASIC
                                 ,SUM(B.SHARE_AMT_DAILY) AS SHARE_MINUS_AMT_DAILY
                                 ,SUM(B.SHARE_EA)  AS SHARE_MINUS_EA      
                            FROM  top_prim_biz_rpt_head A
                                 ,top_prim_biz_inv_share B
                           WHERE  1=1
                             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO 
                             AND  A.USER_NO != B.SHARE_USER_NO
                             AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                             AND  A.TEAM_ID = #{team_id}
                             AND  A.USER_NO = #{user_no}
                          GROUP BY A.SUIM_RPT_NO                    
                         ) D
                    ON  A.SUIM_RPT_NO = D.SUIM_RPT_NO       
                 WHERE  1=1     
                   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                   AND  A.TEAM_ID = #{team_id}
                   AND  A.USER_NO = #{user_no}
                   AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                   AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})
                 UNION ALL
                 SELECT  '2' AS GUBUN
                         ,A.SUIM_RPT_NO 
                         ,A.SUIM_ACCEPT_NO 
                         ,0 AS AMT_BASIC 
                         ,0 AS AMT_DAILY 
                         ,0 AS SUIM_RPT_EA
                         ,0 AS SHARE_MINUS_AMT_BASIC
                         ,0 AS SHARE_MINUS_AMT_DAILY
                         ,0 AS SHARE_MINUS_EA
                         ,B.SHARE_AMT_BASIC AS SHARE_PLUS_AMT_BASIC
                         ,B.SHARE_AMT_DAILY AS SHARE_PLUS_AMT_DAILY
                         ,B.SHARE_EA AS SHARE_PLUS_EA
                         ,B.SHARE_AMT_TRAFFIC AS AMT_TRAFFIC
                         ,B.SHARE_AMT_COUNSEL AS AMT_COUNSEL
                         ,B.SHARE_AMT_ETC AS AMT_ETC
                         ,B.SHARE_AMT_TOTAL AS AMT_TOTAL
                         ,A.CLOSE_DATE       
                    FROM  top_prim_biz_rpt_head A
                         ,top_prim_biz_inv_share B  
                   WHERE  1=1
                     AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO    
                     AND  A.USER_NO != B.SHARE_USER_NO  
                     AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
                     AND  B.SHARE_USER_NO = #{user_no}
                     AND  A.CLOSE_DATE >= UNIX_TIMESTAMP(#{bgnDe})
                     AND  A.CLOSE_DATE &lt; UNIX_TIMESTAMP(#{endDe})    
                ) GA
         WHERE  1=1
        ORDER BY GA.GUBUN ASC, GA.CLOSE_DATE DESC, GA.SUIM_RPT_NO DESC     
    </select>
        
    <select id="selectDetailOutAmtList" parameterType="hashmap" resultType="AsraMap">
		SELECT  GA.GUBUN
		       ,GA.SUIM_RPT_NO
		       ,GA.SUIM_ACCEPT_NO
		       ,GA.PTNR_NM
		       ,GA.POLICYHOLDER_NM
		       ,GA.BENEFICIARY_NM
		       ,GA.CLOSE_DATE
		       ,GA.AMT_BASIC
		       ,GA.AMT_DAILY
		       ,GA.AMT_TRAFFIC
		       ,GA.AMT_COUNSEL
		       ,GA.AMT_ETC
		       ,GA.OUT_AMT
		  FROM  (
		          SELECT  '-1' AS GUBUN
		                 ,'' AS SUIM_RPT_NO 
		                 ,'' AS SUIM_ACCEPT_NO 
		                 ,'' AS PTNR_NM
		                 ,'' POLICYHOLDER_NM
		                 ,'' BENEFICIARY_NM 
		                 ,0 AS CLOSE_DATE
		                 ,0 AS AMT_BASIC 
		                 ,0 AS AMT_DAILY 
		                 ,0 AS AMT_TRAFFIC 
		                 ,0 AS AMT_COUNSEL 
		                 ,0 AS AMT_ETC 
		                 ,0 AS OUT_AMT
		            FROM  DUAL
		          <if test='basicYN == "Y"'> 
		          UNION ALL   
		          SELECT  '1' AS GUBUN 
		                 ,A.SUIM_RPT_NO
		                 ,A.SUIM_ACCEPT_NO 
		                 ,GETTOPPTNRBSCPTNRNICK(A.PTNR_ID) AS PTNR_NM
		                 ,A.POLICYHOLDER_NM
		                 ,A.BENEFICIARY_NM 
		                 ,FROM_UNIXTIME(A.CLOSE_DATE,'%Y-%m-%d') AS CLOSE_DATE
		                 <!-- ,B.AMT_BASIC -->
		                 ,(B.AMT_BASIC+getCollaboApprovalAmt(A.SUIM_RPT_NO)) AS AMT_BASIC 
		                 ,B.AMT_DAILY 
		                 ,B.AMT_TRAFFIC 
		                 ,B.AMT_COUNSEL 
		                 ,B.AMT_ETC 
		                 ,B.AMT_TOTAL AS OUT_AMT
		            FROM  top_rpt_head A
		                 ,top_rpt_invoice B
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		             -- AND  A.TEAM_ID = '24'
		             AND  A.USER_NO = #{user_no}
		             AND  A.CLOSE_DATE > 0
		             AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		          </if>
		          <if test='primYN == "Y"'>   
		          UNION ALL -- 농작물 
		          SELECT  '2' AS GUBUN
		                 ,A.SUIM_RPT_NO 
		                 ,A.SUIM_ACCEPT_NO 
		                 ,GETTOPPTNRBSCPTNRNICK(A.PTNR_ID) AS PTNR_NM
		                 ,A.POLICYHOLDER_NM
		                 ,A.BENEFICIARY_NM 
		                 ,FROM_UNIXTIME(A.CLOSE_DATE,'%Y-%m-%d') AS CLOSE_DATE
		                 ,B.AMT_BASIC 
		                 ,B.AMT_DAILY 
		                 ,B.AMT_TRAFFIC 
		                 ,B.AMT_COUNSEL 
		                 ,B.AMT_ETC 
		                 ,B.AMT_TOTAL AS OUT_AMT
		            FROM  top_prim_biz_rpt_head A
		                 ,top_prim_biz_inv B
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		             AND  A.USER_NO = #{user_no}
		             AND  A.SUIM_RPT_TYPE1 = 5
		             AND  A.CLOSE_DATE > 0
		             AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		          </if>
		          <if test='contractYN == "Y"'>
		          UNION ALL -- 적부    
		          SELECT  '3' AS GUBUN
		                 ,A.SUIM_RPT_NO 
		                 ,A.SUIM_ACCEPT_NO 
		                 ,GETTOPPTNRBSCPTNRNICK(A.PTNR_ID) AS PTNR_NM
		                 ,A.POLICYHOLDER_NM
		                 ,A.BENEFICIARY_NM 
		                 ,FROM_UNIXTIME(A.CLOSE_DATE,'%Y-%m-%d') AS CLOSE_DATE
		                 ,B.AMT_BASIC 
		                 ,B.AMT_DAILY 
		                 ,B.AMT_TRAFFIC 
		                 ,B.AMT_COUNSEL 
		                 ,B.AMT_ETC 
		                 ,B.AMT_TOTAL AS OUT_AMT
		                 -- ,A.TEAM_ID 
		            FROM  top_prim_biz_rpt_head A
		                 ,top_prim_biz_inv B
		           WHERE  1=1
		             AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		             AND  A.USER_NO = #{user_no}
		             AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		             AND  A.CLOSE_DATE > 0
		             AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		          </if>     
		        ) GA
		 WHERE  1=1
		   AND  GA.GUBUN > 0
		ORDER BY GA.CLOSE_DATE DESC       
    </select>
    
    <select id="selectDetailBasicOutAmtList" parameterType="hashmap" resultType="AsraMap">
		SELECT  A.SUIM_RPT_NO 
		       ,A.SUIM_ACCEPT_NO 
		       ,GETTOPPTNRBSCPTNRNICK(A.PTNR_ID) AS PTNR_NM
		       ,A.POLICYHOLDER_NM
		       ,A.BENEFICIARY_NM 
		       ,FROM_UNIXTIME(A.CLOSE_DATE,'%Y-%m-%d') AS CLOSE_DATE
		       ,B.AMT_BASIC 
		       ,B.AMT_DAILY 
		       ,B.AMT_TRAFFIC 
		       ,B.AMT_COUNSEL 
		       ,B.AMT_ETC 
		       ,B.AMT_TOTAL AS OUT_AMT
		       -- ,A.TEAM_ID
		  FROM  top_rpt_head A
		       ,top_rpt_invoice B
		 WHERE  1=1
		   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		   AND  A.TEAM_ID = #{team_id}
		   AND  A.USER_NO = #{user_no}
		   AND  A.CLOSE_DATE > 0
		   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		ORDER BY A.CLOSE_DATE DESC     
    </select>    
    <select id="selectDetailPrimOutAmtList" parameterType="hashmap" resultType="AsraMap">
		SELECT  A.SUIM_RPT_NO 
		       ,A.SUIM_ACCEPT_NO 
		       ,GETTOPPTNRBSCPTNRNICK(A.PTNR_ID) AS PTNR_NM
		       ,A.POLICYHOLDER_NM
		       ,A.BENEFICIARY_NM 
		       ,FROM_UNIXTIME(A.CLOSE_DATE,'%Y-%m-%d') AS CLOSE_DATE
		       ,B.AMT_BASIC 
		       ,B.AMT_DAILY 
		       ,B.AMT_TRAFFIC 
		       ,B.AMT_COUNSEL 
		       ,B.AMT_ETC 
		       ,B.AMT_TOTAL AS OUT_AMT
		       -- ,A.TEAM_ID 
		  FROM  top_prim_biz_rpt_head A
		       ,top_prim_biz_inv B
		 WHERE  1=1
		   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		   AND  A.TEAM_ID = #{team_id}
		   AND  A.USER_NO = #{user_no}
		   AND  A.SUIM_RPT_TYPE1 = 5
		   AND  A.CLOSE_DATE > 0
		   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		ORDER BY A.CLOSE_DATE DESC     
    </select>    
    <select id="selectDetailContractOutAmtList" parameterType="hashmap" resultType="AsraMap">
		SELECT  A.SUIM_RPT_NO 
		       ,A.SUIM_ACCEPT_NO 
		       ,GETTOPPTNRBSCPTNRNICK(A.PTNR_ID) AS PTNR_NM
		       ,A.POLICYHOLDER_NM
		       ,A.BENEFICIARY_NM 
		       ,FROM_UNIXTIME(A.CLOSE_DATE,'%Y-%m-%d') AS CLOSE_DATE
		       ,B.AMT_BASIC 
		       ,B.AMT_DAILY 
		       ,B.AMT_TRAFFIC 
		       ,B.AMT_COUNSEL 
		       ,B.AMT_ETC 
		       ,B.AMT_TOTAL AS OUT_AMT
		       -- ,A.TEAM_ID 
		  FROM  top_prim_biz_rpt_head A
		       ,top_prim_biz_inv B
		 WHERE  1=1
		   AND  A.SUIM_RPT_NO = B.SUIM_RPT_NO
		   AND  A.TEAM_ID = #{team_id}
		   AND  A.USER_NO = #{user_no}
		   AND  A.SUIM_RPT_TYPE1 IN(6, 7, 8, 9, 10, 99)
		   AND  A.CLOSE_DATE > 0
		   AND  (B.DEPOSIT_DATE IS NULL OR B.DEPOSIT_DATE &lt; 1)
		ORDER BY A.CLOSE_DATE DESC     
    </select>
    
    
    <!-- 미결 건수 카운트 배치 쿼리 -->
    <insert id="insertSuimPendingCnt">
    	INSERT INTO top_rpt_pending_cnt_monthly
    	(BASE_DATE, USER_NO, TEAM_ID, PENDING_CNT, SUIM_TYPE)
    	SELECT UNIX_TIMESTAMP(DATE_FORMAT(NOW(),"%Y-%m-%15")), A.USER_NO, A.TEAM_ID, COUNT(*) PENDING_CNT, 1
		  FROM top_rpt_head A
		 INNER JOIN top_mbr_bsc B
		    ON A.USER_NO = B.USER_NO
		 WHERE 1=1
		   AND A.SUIM_RPT_STATE &lt; 2
		   AND B.USER_STATE != 1
		 GROUP BY A.USER_NO, A.TEAM_ID;
	</insert>
	
	<insert id="insertPrimBizPendingCnt">
    	INSERT INTO top_rpt_pending_cnt_monthly
    	(BASE_DATE, USER_NO, TEAM_ID, PENDING_CNT, SUIM_TYPE)
		SELECT UNIX_TIMESTAMP(DATE_FORMAT(NOW(),"%Y-%m-%15")), A.USER_NO, A.TEAM_ID, COUNT(*) PENDING_CNT, 2
		  FROM top_prim_biz_rpt_head A
		 INNER JOIN top_mbr_bsc B
		    ON A.USER_NO = B.USER_NO
		 WHERE 1=1
		   AND A.SUIM_RPT_STATE &lt; 2
		   AND B.USER_STATE != 1
		 GROUP BY A.USER_NO, A.TEAM_ID		     
    </insert>
    
</mapper>
